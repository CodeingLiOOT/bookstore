!function(A,N,L){"use strict";var w="ht";if(!A[w]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),A.performance&&A.performance.now||function(){var U=Date.now();A.performance||(A.performance={}),A.performance.now=function(){return Date.now()-U}}();for(var M=Date.now(),r=16,i=["ms","moz","webkit","o"],l=0;l<i.length&&!A.requestAnimationFrame;++l)A.requestAnimationFrame=A[i[l]+"RequestAnimationFrame"],A.cancelAnimationFrame=A[i[l]+"CancelAnimationFrame"]||A[i[l]+"CancelRequestAnimationFrame"];A.requestAnimationFrame||(A.requestAnimationFrame=function(N){var m=Date.now(),R=r+M-m;return 0>R&&(R=0),M=m,A.setTimeout(function(){M=Date.now(),N(performance.now())},R)}),A.cancelAnimationFrame||(A.cancelAnimationFrame=function(F){return A.clearTimeout(F)})}();var W,O,U,i,u=A.document,j=null,e=A[w]={},S=A[w+"config"],V=e.Default=S&&S.Default||{},I=e.Style=S&&S.Style||{},G=e.Attr=S&&S.Attr||{},l=e.Color=S&&S.Color||{},f=e.IsGetter=S&&S.IsGetter||{},t=Math,Z=t.round,o=t.floor,k=t.ceil,n=t.sqrt,Y=t.max,K=t.min,r=t.abs,v=t.cos,Q=t.acos,B=t.sin,R=t.pow,X=t.asin,m=t.PI,h=2*m,P=m/2,F=t.tan,H=t.atan2,C=t.random,x=function(p,v,F){return Math.max(v,Math.min(F,p))},g=!1,T=!1,c=A.parseInt||global.parseInt,z="2018-02-01",d=A.navigator?A.navigator.platform.indexOf("Win")>-1:!1,$=function(L){return L*L},M=A.setTimeout,y=A.clearTimeout,J=A.location,D=A.navigator?A.navigator.userAgent.toLowerCase():"",b=function(o){return o.test(D)},p=b(/msie/)||b(/trident/),_=b(/msie 10/),a=b(/edge/),s=b(/firefox/),E=b(/mac/),q=V.isTouchable===L?d?!1:u?"ontouchend"in u:!1:V.isTouchable,Dh="default",Wf="single",Xl="multiple",ze="front",kc="back",ie="left",yh="right",ni="top",ys="bottom",qp="center",or="eye",cs="middle",cn="east",pg="west",Ld="north",Cp="none",vc="px",td="absolute",Xf="border",Fr="triangle",Iq="rect",df="circle",Lc="cylinder",Lo="shape",Wo="items",Jr="normal",qe="remove",Oe="clear",vm="width",Oc="height",mr="ingroup",uh="check",oc="uncheck",sn="radio",Jj="radioOn",Qo="radioOff",ag="points",rd="values",ci="series",ns="body",Np="label",ro="label2",Jq="note",Wk="note2",nl="icons",Cf="labelFont",Om="labelColor",ji="labelSelectColor",al="note.expanded",Qq="note2.expanded",Bl="edge.expanded",Tj="edge.points",bk="edge.type",ps="rotation",tk="getRotation",wp="setRotation",am="hidden",Gr="visible",Ze="tuv",Gb="no",$e="draw",Yc="select",Jh="currentSubGraph",gi="selectBackground",$g="autoMakeVisible",od="autoHideScrollBar",Uj="scrollBarColor",bq="scrollBarSize",zq="indent",zc="rowHeight",Jg="columnLineColor",ec="rowLineColor",Gk="columnLineVisible",Sr="rowLineVisible",Th="visibleFunc",ml="expandIcon",Gd="collapseIcon",Ki="checkMode",dm="sortFunc",Ph="editable",_l="batchEditable",yl="tristate",us="asc",fn="desc",Jm="position",$d="elevation",rq="children",hj="translateX",_c="translateY",hs="dataModel",Zp="maxSize",Al="shape3d",Dp="shape3d.resolution",vo="shape3d.visible",Kb="shape3d.from.visible",zg="shape3d.to.visible",Fq="shape3d.top.visible",Sb="shape3d.bottom.visible",Dq="repeat.uv.length",tp="serializeValue",qo="deserializeValue",ai="centerUniform",As="rgba(255,255,255,0)",Mb="style",Tf="attr",Vc="field",Mc="string",Ok="boolean",Pk="color",Dd="int",Pm="number",Ij="ew-resize",im="ns-resize",On="pointer",Zo="auto",Tc="mousedown",kp="mousemove",Uo="mouseup",lb="mouseout",lc="touchstart",sh="touchmove",ur="touchend",uo="keydown",io="keyup",vn=s?"DOMMouseScroll":"mousewheel",Fp=q?[lc,sh,ur,uo,io,"keypress","input","contextmenu"]:[uo,io,"keypress","input",Tc,kp,Uo,lb,vn,"contextmenu","mouseenter","mouseleave","mouseover"],ki=j,Ag=j,zl=j,oe=Uo.length,xd=function(){zl&&(y(zl.timeout),zl=j)},ah=function(){zl&&kf(zl.e,zl.info)};A.addEventListener&&(q||(A.addEventListener(lb,function(){xd()},!1),A.addEventListener(vn,function(){nd()},!1)),A.addEventListener(io,function(d){91===d.keyCode?Po={}:delete Po[d.keyCode]},!0),A.addEventListener(uo,function(I){Po[I.keyCode]=!0},!0));var nk,Tb,Vk,Mj=!1,Pe=j,Hp=function(T,P){var p=M(function(){delete Pe[p],ui(Pe)&&(Pe=j),T()},P);return p},np=j,dq={},Kq={},jl={},We={},_m={},Po={},Ci={},ug={},Qj={},yr={},Dr=/.json$/,Ff=/^data:image\/svg\+xml/,Eo={},th=[],gl={},vb=j,Oj=j,rj=function(){},Fh=function(){throw"Oops!"},Qg=[0,0,0],eq=[0,0,0,0],Vo={x:0,y:0,width:0,height:0},Og=j,be=j,Km=j,An=function(U){be&&!U._72O&&(Km||(Km={}),Km[U._72O=Kr()]=U),nk!=j?kg()<.05&&i&&!Tb&&(Wl=xd):Wl=bc},sf=function(C,k,r,v){be||(be={});var X=be[C];if(X){if(X.url===k)return;X.image?(X.image.onload=rj,X.image.onerror=rj):X.request&&(X.request.onload=rj,X.request.onerror=rj)}if(Dr.test(k)){var E=new XMLHttpRequest;if(be[C]={request:E,url:k},E.overrideMimeType&&E.overrideMimeType("text/plain"),k=V.beforeLoadURL(k),k.data){var B=V.parse(k.data);$q(C,B),V.handleImageLoaded(C,B)}else E.open("GET",encodeURI(k),!0),E.onload=function(Y){if(200===this.status||0===this.status){var q=V.parse(Y.target.response||Y.target.responseText);$q(C,q),V.handleImageLoaded(C,q)}else $q(C,V.handleUnfoundImage(C,k)||j)},E.onerror=function(){$q(C,V.handleUnfoundImage(C,k)||j)},E.send(null)}else{var B=new Image;be[C]={image:B,url:k},p&&(k.toLowerCase().indexOf(".svg")>0||Ff.test(k))?(u.body.appendChild(B),B.style.visibility="hidden",B.onload=function(){M(function(){if(r&&(B.width=r),v&&(B.height=v),!B.width||!B.height){var l=B.width||B.clientWidth,i=B.height||B.clientHeight;B.width=l,B.height=i}V.handleImageLoaded(C,B),$q(C,B),u.body.removeChild(B),B.style.visibility=""},180)},B.onerror=function(){$q(C,V.handleUnfoundImage(C,k)||j),u.body.removeChild(B),B.style.visibility=""}):(B.onload=function(){r&&(B.width=r),v&&(B.height=v),V.handleImageLoaded(C,B),$q(C,B)},B.onerror=function(){$q(C,V.handleUnfoundImage(C,k)||j)}),/^data:image/.test(k)||(k=V.beforeLoadURL(k),/^data:image/.test(k)||(k=V.appendTimeStamp(k),k=encodeURI(k))),B.src=k}},$q=function(l,g){if(Kq[l]=g,delete be[l],ui(be)&&(be=j,Km)){for(var Z in Km){var b=Km[Z];b._2O&&(b._2O={}),b.invalidateAll&&b.invalidateAll(L,"imageLoaded",l),b.redraw&&b.redraw(),b.iv(),delete b._72O}Km=j}if(g&&Km)for(var Z in Km){var b=Km[Z];b.invalidateAll&&b.invalidateAll(L,"imageLoading",l),b.redraw&&b.redraw(),b.iv()}},Yk=function(){return A.performance&&A.performance.now?A.performance.now():Date.now()},bp=function(J,j){j?y(J):A.cancelAnimationFrame(J)},hq=function(l,q,X){return{width:l,height:q,comps:ck(X)?X:[X]}},Bg=function(w,H){return{type:df,rect:[w,H,1.6,1.6],borderWidth:1,borderColor:Xq,gradient:$c,gradientColor:ub,background:Xq}},Lq=function(h,I){return hq(16,16,{type:Fr,rect:[4,4,10,8],background:h,rotation:I?1.57:3.14})},Yh=function(s,d){return hq(16,16,{type:Fr,rect:[4,4,8,7],background:s,rotation:d?3.14:0})},Zk=function(L){var Z=L._orientation;return"horizontal"===Z||"h"===Z},gn=function(H){var K=j||4,Q=j||1,r=j||1;0>K?K=0:K>.25&&(K=.25);var T,c,p,J,x,i,A,C=.5,n=[],k=[],u=[],W=h/r,o=h/Q,b=C-K;for(c=0;Q>=c;c++)for(J=-m+c*o,i=v(J),x=B(J),T=0;r>=T;T++)p=T*W,A=b+K*i,n.push(v(p)*A,x*K,-B(p)*A),(O=H)&&k.push(T/r,1-c/Q);for(c=0;Q>c;c++){var G=c*(r+1),U=(c+1)*(r+1);for(T=0;r>T;T++)u.push(G+T,U+T+1,U+T,G+T,G+T+1,U+T+1),vk.z=Kh.z=H}},Pn=function($){var P=2,M=0;for(var j in $)j.length===P&&c(j,32)===kk&&(vb=Oj=$[j]),M++;return M},Ef=function(i,c,H,s){return H||(H=q?5:3,H/=s||1),{x:i-H,y:c-H,width:2*H,height:2*H}},lm=function(J,Z,x,o){var S=this;Z||(Z=q?5:3,x=20,o=20);var y={x:J,y:Z,width:x,height:o};if(x)for(var j=0;x>j;j++)if(3===x)o=20;else for(var s=0;o>s;s++)S=A?A:x;var D={x:m,y:2*m};if(rn(y,D)){var Y=Oc[0]+ni[0]+Oe[1];Wi[or]=S[Y],S[Y]=oi[or]}},Li=function(L){return(/ble$/.test(L)||/ed$/.test(L)||f[L]?"is":"get")+L.charAt(0).toUpperCase()+L.slice(1)},oi=function(K){return"set"+K.charAt(0).toUpperCase()+K.slice(1)},Ui=function(N){return typeof N===Mc||N instanceof String},Gc=function(A){return typeof A===Pm},bc=function(l){return typeof l===Ok},Hj=function(O){return O&&"object"==typeof O},Af=function(f){return"function"==typeof f},ck=function(y){return y instanceof Array},Hn=function(h){return h instanceof rb},Cq=function(N){return ck(N)?new rb(N):N},Jl=function(C){return C instanceof se},Hg=function(w){return w instanceof lf},Dc=function(w){return w instanceof me},yk=function(o,U){if(!(o instanceof e.Group))return!1;if(!U)return o.isExpanded();var y=U.getDataUI(o);return y&&y._88I?!0:!1},an=function(m){return m instanceof es},ke=function(g){return g&&"IFRAME"===g.tagName},yg=function(e){return e==j||V.numberDigits==j?e:parseFloat(e.toFixed(V.numberDigits))},zr=function(y,a,B){var b,z=a.length;if(B)for(var W=0;B>W;W++)if(3===z)y.push(a[0]),y.push(a[1]),y.push(a[2]);else for(b=0;z>b;b++)y.push(a[b]);else if(3===z)y.push(a[0]),y.push(a[1]),y.push(a[2]);else for(b=0;z>b;b++)y.push(a[b])},aj=function(x){return x?Hj(x)?x:{}:!1},_r=function(O,b,n){var A,z=Hj(O)?O:O.prototype;for(A in b)n&&z[A]!==L||(z[A]=b[A]);return O},lr=function(p){return String.fromCharCode(p)},lq=function(g){for(var $,u=0,b="";u<g.length;u++)$=g[g.length-1-u],"%"===$?$="'":"a"===$?$='"':"]"===$&&($="\\"),b+=lr($.charCodeAt(0)-1);return b},em=function(O,A,Y){O.superClass.constructor.apply(A,Y)},ui=function(O){for(var s in O)return!1;return!0},Zi=function(M){return M?0===M.length:!0},li=function(f,E){return f===E?!0:f.x===E.x&&f.y===E.y&&f.width===E.width&&f.height===E.height},fh=function(W,E,P){return E>W?E:W>P?P:W},eh=function(L){return 0>L?-1:L>0?1:0},kg=function(){var H=1e4*B(oe++);return H-o(H)},Pj=function(A,X,J){return ve(A.x,A.y,X.x,X.y,J.x,J.y,J.x+J.width,J.y,!0)||ve(A.x,A.y,X.x,X.y,J.x+J.width,J.y,J.x+J.width,J.y+J.height,!0)||ve(A.x,A.y,X.x,X.y,J.x+J.width,J.y+J.height,J.x,J.y+J.height,!0)||ve(A.x,A.y,X.x,X.y,J.x,J.y+J.height,J.x,J.y,!0)},ve=function(J,k,e,U,v,T,L,t,g){var A=(L-v)*(k-T)-(t-T)*(J-v),H=(t-T)*(e-J)-(L-v)*(U-k);if(0!==H){var q=A/H,W=J+q*(e-J),m=k+q*(U-k);return g&&(W+Ug<K(J,e)||W-Ug>Y(J,e)||W+Ug<K(v,L)||W-Ug>Y(v,L)||m+Ug<K(k,U)||m-Ug>Y(k,U)||m+Ug<K(T,t)||m-Ug>Y(T,t))?j:[W,m]}return j},pn=function(y,G,E){if(y&&E)if(G){if(G===Mb)return y.getStyle(E);if(G===Tf)return y.getAttr(E);if(G===Vc)return y[E]}else if(E=Li(E),y[E])return y[E]();return L},ib=function(E,y,S,s){if(E&&S)if(y){if(y===Mb)E.s(S,s);else if(y===Tf)E.a(S,s);else if(y===Vc){var G=E[S];E[S]=s,E.fp("f:"+S,G,s)}}else S=oi(S),E[S]&&E[S](s)},Kl=function(K,H,L){return H&&"top"!==H?"bottom"===H?{x:K.x,y:K.y,width:K.width,height:K.height*L}:"right"===H?{x:K.x,y:K.y,width:K.width*L,height:K.height}:"left"===H?{x:K.x+K.width*(1-L),y:K.y,width:K.width*L,height:K.height}:void 0:{x:K.x,y:K.y+K.height*(1-L),width:K.width,height:K.height*L}},Wm=function(c,l,o,t,V){l&&Yp(c,o,t,1,V,l)},dn=function(i,O,C,K){var I=1-i;return I*I*O+2*i*I*C+i*i*K},vk=function(K,T,Y,V,b){var W=1-K;return W*W*W*T+3*W*W*K*Y+3*W*K*K*V+K*K*K*b},Tg=function(A){var P,u,W,q,B=0;return A.forEach(function(C){if(P=C.length,P>0)for(u=C[0],q=1;P>q;q++)W=C[q],B+=aq(u,W),u=W}),B},Kd=function(D,g,f){var e="__"+D,l=function(V){f.interactiveDisabled||f["handle_"+D](V)};f[e]||(f[e]=l,g.addEventListener(D,l,!1))},Ig=function(i,Y,w){var A="__"+i,_=w[A];_&&(Y.removeEventListener(i,_,!1),delete w[A])},zs=function(g,r){var T="_"+r;g[Li(r)]=function(){return this[T]},g[oi(r)]=function(P){var i=this[T];this[T]=P,this.fp(r,i,P)}},En=function(i){return N.create(i)},tr=function(X){if(!X.element){var d,E;(d=X.textField)?E=gp(Se.TextField,d):(d=X.textArea)?E=gp(Se.TextArea,d):(d=X.button)?E=gp(Se.Button,d):(d=X.comboBox)?E=gp(Se.ComboBox,d):(d=X.checkBox)?E=gp(Se.CheckBox,d):(d=X.radioButton)?E=gp(Se.RadioButton,d):(d=X.slider)?E=gp(Se.Slider,d):(d=X.colorPicker)?E=gp(Se.ColorPicker,d):(d=X.image)&&(E=gp(Se.Image,d)),E&&(X.element=E)}},Ul=function(s,f){var Q=Cc(s);return Q._ht=f,Q},Cc=function(e,G){var h=u.createElement("div"),P=h.style;return h.tabIndex=-1,h.onkeydown=Bk,P.msTouchAction=Cp,gm(h,j,0),q&&P.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",j),e&&(P.overflow=am),G&&Pi(G,h),h},Ji=function($,J){var r=u.createElement("canvas"),z=r.style;return z.msTouchAction=Cp,J||(z.pointerEvents=Cp),gm(r,j,0),$&&Pi($,r),r},gm=function(w,u,M){var J=w.style;J.border=u?u+" solid 1px":0,J.outline=0,J.padding=M?"0 "+M+vc:0,yc(w)},yc=function(Z){var H=Z.style;H.position=td,H.margin=0,H.setProperty("box-sizing","border-box",j),H.setProperty("-moz-box-sizing","border-box",j)},zm=function(A,h,J,u){u||(u=Yl),h!=j&&(A.width=h*u,A.style.width=h+vc),J!=j&&(A.height=J*u,A.style.height=J+vc)},Pi=function(H,j,V){H.appendChild(j),V&&(j.style.position=td)},ng=function(h,F){F.split||(F+="");for(var Q,H=F.split("\n"),i=0,c=H.length,b=0;c>b;b++){var m=Ed(h.font,H[b]);m.width>i&&(i=m.width),Q||(Q=m.height)}return h.ss=H,{width:i,height:Q*c}},Ej=function(k,X,Z,P,p,q){var a=X.length;if(1===a)mc(k,X[0],Z,P,p);else for(var S=Z.height/a,R={x:Z.x,y:Z.y,width:Z.width,height:S},v=0;v<X.length;v++)q?Wp(k,X[v],P,p,R.x,R.y,R.width,R.height,q):mc(k,X[v],R,P,p),R.y+=S},mc=function(A,E,k,f,m){A.font=f?f:Pq,A.fillStyle=m?m:Ih,A.textAlign=qp,A.textBaseline=cs;var Q,W;k?k.width===L?(Q=k.x,W=k.y):(Q=k.x+k.width/2,W=k.y+k.height/2):(Q=0,W=0),A.fillText(E,Z(Q),Z(W))},dr=function(t){t.getView&&(t=t.getView());var i=t.offsetWidth||t.scrollWidth;return!i&&t.style.width&&(i=c(t.style.width)),i},hi=function(R){R.getView&&(R=R.getView());var Y=R.offsetHeight||R.scrollHeight;return!Y&&R.style.height&&(Y=c(R.style.height)),Y},Ap=function(){var r=function(X){Bk(X),X.stopPropagation()},$=q?[lc]:[uo,Tc,vn];return function(S){var J=Cc(),i=J.style;return i.backgroundColor=V.disabledBackground,S&&(i.backgroundImage="url("+S+")",i.backgroundPosition="50% 50%",i.backgroundRepeat="no-repeat no-repeat"),$.forEach(function(j){J.addEventListener(j,r)}),J}}(),Vq=function(u){var J=u.getContext("2d");return J.save(),J.lineCap=mo,J.lineJoin=jp,J},Wl=function($,A,E,i){Lh($,A*Yl,E*Yl),i*=Yl,1!==i&&$.scale(i,i)},Lh=function(r,p,T){r.translate(p,T)},Xe=function(C,W){W&&C.rotate(W)},ko=function(Y,X,$){X===L&&(X=1),$===L&&($=1),(1!==X||1!==$)&&Y.scale(X,$)},ch=function(M){var i=u.activeElement;if(u.activeElement!==M){i&&i.forceOnblur&&i.forceOnblur();for(var E=[],S=M.parentNode;S;)E.push([S,S.scrollLeft,S.scrollTop]),S=S.parentNode;if(q)M.focus();else{var r=Ip(),o=r.target;M.focus(),o.scrollLeft=r.left,o.scrollTop=r.top}E.forEach(function(K){K[0].scrollLeft=K[1],K[0].scrollTop=K[2]})}},Vg=function(z){return z&&z.getView?z.getView():z},Db=function(m,H,l,S,n){if(2===arguments.length&&(l=H.y,S=H.width,n=H.height,H=H.x),m.isSelfViewEvent)m.setX(H),m.setY(l),m.setWidth(S),m.setHeight(n);else{var w=Vg(m),$=w.style;if((u.fullscreenElement||u.mozFullScreenElement||u.webkitFullscreenElement||u.msFullscreenElement)!==w)H!==L&&($.left=H+vc),l!==L&&($.top=l+vc),S!==L&&($.width=S+vc),n!==L&&($.height=n+vc);else{var B=V.getWindowInfo();$.left=(H=B.left)+vc,$.top=(l=B.top)+vc,$.width=(S=B.width)+vc,$.height=(n=B.height)+vc}m.endEditing&&!q&&m.endEditing(),m.redraw&&m.redraw(),m.invalidate&&m.invalidate(),m.onLayouted&&m.onLayouted(H,l,S,n),m.fireViewEvent&&m.fireViewEvent("layout")}},Nn=function(U){if(!U.touches)return U;var N=U.touches[0];return N?N:U.changedTouches[0]},jn=function(c){return q?Nn(c).target:c.target},$f=function(w){V.popup&&V.popup.close(),V.popup=w},Tk=j,Pp=function($){Tk.handleWindowTouchMove($)},vj=function(m){Tk.handleWindowTouchEnd(m),A.removeEventListener(sh,Pp,!1),A.removeEventListener(ur,vj,!1),Tk=j},nf=function(L){Tk.handleWindowMouseMove(L)},Nd=function(U){Tk.handleWindowMouseUp(U),A.removeEventListener(kp,nf,!1),A.removeEventListener(Uo,Nd,!1),Tk=j},Ue=function(f){return 1===js(f)},om=function(X,j){return j?j.keyCode===X:Po[X]},Pr=function(s){return _o(s)&&om(65,s)},Oi=function(F){return om(46,F)||om(8,F)},Lg=function(E){return function(U){return U?U.keyCode===E:Po[E]}},kk=573,Rg=[65,83,68,87,37,38,39,40,32,13,27],Qc=Lg(Rg[0]),Tp=Lg(Rg[1]),ad=Lg(Rg[2]),fp=Lg(Rg[3]),Dj=Lg(Rg[4]),Pf=Lg(Rg[5]),hh=Lg(Rg[6]),Rc=Lg(Rg[7]),kh=Lg(Rg[8]),qc=Lg(Rg[9]),bh=Lg(Rg[10]),Zd={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},wl=[2,2,2,2,2,2,2,2,2,2,3,3,3,5,5,5,5,5,7,13,193],yb=j,gc=j,fs=function(g,n){yb||(yb=Ji()),zm(yb,g,n,1);var o=Vq(yb);return o.clearRect(0,0,g,n),o},Ym=function(){var F,o={};return function(r){var d,H=o[r];return H||(F||(F=Ji(),zm(F,1,1,1)),d=F.getContext("2d"),d.clearRect(0,0,1,1),Yp(d,0,0,1,1,r),H=d.getImageData(0,0,1,1).data,H=o[r]=[H[0],H[1],H[2],H[3]]),H}}(),Nq=function(l){if(!Ui(l))return l;var C=Ym(l);return C.CA||(C.CA=[C[0]/255,C[1]/255,C[2]/255,C[3]/255]),C.CA},Hr=function(X,A,b,R,w){var B=Ji();B.width=b,B.height=R;var y=B.getContext("2d");y.drawImage(X,0,0,b,R);try{for(var k=y.getImageData(0,0,b,R),n=k.data,C=0,P=n.length;P>C;C+=4){var c=n[C+0],K=n[C+1],O=n[C+2],t=n[C+3];"override_a"===w?n[C+3]=255*A[3]:"override_rgb"===w?(n[C+0]=255*A[0],n[C+1]=255*A[1],n[C+2]=255*A[2]):"override"===w?(n[C+0]=255*A[0],n[C+1]=255*A[1],n[C+2]=255*A[2],n[C+3]=255*A[3]):(n[C+0]=A[0]*c,n[C+1]=A[1]*K,n[C+2]=A[2]*O,n[C+3]=A[3]*t)}y.putImageData(k,0,0)}catch(W){return X}return B},Wi=function($,x,T){return x&&(x="miter"===T?8*x+20:x+1,$&&ws($,x)),x},pq=function(v,N){if(N){var G=new rc(N),j=v.width/2,u=v.height/2,D=jq([G.tf(-j,-u),G.tf(j,-u),G.tf(j,u),G.tf(-j,u)]);return D.x+=v.x+j,D.y+=v.y+u,D}return v},Tq=function(H,E,N,r,D,o,P,J){r*=Math.PI/180;var O={x:Math.cos(r)*(H.x-P.x)/2+Math.sin(r)*(H.y-P.y)/2,y:-Math.sin(r)*(H.x-P.x)/2+Math.cos(r)*(H.y-P.y)/2},v=Math.pow(O.x,2)/Math.pow(E,2)+Math.pow(O.y,2)/Math.pow(N,2);v>1&&(E*=Math.sqrt(v),N*=Math.sqrt(v));var M=(D==o?-1:1)*Math.sqrt((Math.pow(E,2)*Math.pow(N,2)-Math.pow(E,2)*Math.pow(O.y,2)-Math.pow(N,2)*Math.pow(O.x,2))/(Math.pow(E,2)*Math.pow(O.y,2)+Math.pow(N,2)*Math.pow(O.x,2)));isNaN(M)&&(M=0);var w={x:M*E*O.y/N,y:M*-N*O.x/E},i={x:(H.x+P.x)/2+Math.cos(r)*w.x-Math.sin(r)*w.y,y:(H.y+P.y)/2+Math.sin(r)*w.x+Math.cos(r)*w.y},B=function(q){return Math.sqrt(Math.pow(q[0],2)+Math.pow(q[1],2))},Y=function(A,v){return(A[0]*v[0]+A[1]*v[1])/(B(A)*B(v))},W=function(z,c){return(z[0]*c[1]<z[1]*c[0]?-1:1)*Math.acos(Y(z,c))},a=W([1,0],[(O.x-w.x)/E,(O.y-w.y)/N]),j=[(O.x-w.x)/E,(O.y-w.y)/N],A=[(-O.x-w.x)/E,(-O.y-w.y)/N],S=W(j,A);Y(j,A)<=-1&&(S=Math.PI),Y(j,A)>=1&&(S=0);var Y=E>N?E:N,p=E>N?1:E/N,Q=E>N?N/E:1;if(null==J){var C={x:0,y:0,width:0,height:0};ws(C,Y),C.x*=p,C.width*=p,C.y*=Q,C.height*=Q;var q=new rc(r);return C=jq([q.tf(C.x,C.y),q.tf(C.x+C.width,C.y),q.tf(C.x+C.width,C.y+C.height),q.tf(C.x,C.y+C.height)]),C.x+=i.x,C.y+=i.y,[{x:C.x,y:C.y},{x:C.x+C.width,y:C.y},{x:C.x+C.width,y:C.y+C.height},{x:C.x,y:C.y+C.height}]}J.translate(i.x,i.y),J.rotate(r),J.scale(p,Q),J.arc(0,0,Y,a,a+S,1-o),J.scale(1/p,1/Q),J.rotate(-r),J.translate(-i.x,-i.y)},$k=function(v,k){v&&v.beginPath();for(var j,X,o,F=[],N=function(i){for(var r,y=/(\-{0,1}[\d\.]+)/gi,X=[];r=y.exec(i);)X.push(parseFloat(r[0]));return X},c=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,K={x:0,y:0};j=c.exec(k);){var H=j[0],y=H.substr(0,1);if("M"===y||"m"===y){for(var Y=N(H),i=0;i<Y.length;i+=2){var T=Y[i],w=Y[i+1];"m"===y&&(T+=K.x,w+=K.y),v&&v.moveTo(T,w),F.push({x:T,y:w}),K.x=T,K.y=w}X=o=null}else if("H"===y||"h"===y){for(var Y=N(H),i=0;i<Y.length;i+=1){var T=Y[i];"h"===y&&(T+=K.x),v&&v.lineTo(T,K.y),F.push({x:T,y:K.y}),K.x=T}X=o=null}else if("C"===y||"c"===y){for(var Y=N(H),i=0;i<Y.length;i+=6){var p=Y[i],u=Y[i+1],J=Y[i+2],e=Y[i+3],T=Y[i+4],w=Y[i+5];"c"===y&&(p+=K.x,u+=K.y,J+=K.x,e+=K.y,T+=K.x,w+=K.y),v&&v.bezierCurveTo(p,u,J,e,T,w),F.push({x:p,y:u}),F.push({x:J,y:e}),F.push({x:T,y:w}),K.x=T,K.y=w}X=[p,u,J,e,T,w],o=null}else if("S"===y||"s"===y){for(var Y=N(H),i=0;i<Y.length;i+=4){var p,u;X?(p=2*X[4]-X[2],u=2*X[5]-X[3]):(p=K.x,u=K.y);var J=Y[i],e=Y[i+1],T=Y[i+2],w=Y[i+3];"s"===y&&(J+=K.x,e+=K.y,T+=K.x,w+=K.y),v&&v.bezierCurveTo(p,u,J,e,T,w),F.push({x:p,y:u}),F.push({x:J,y:e}),F.push({x:T,y:w}),K.x=T,K.y=w}X=[p,u,J,e,T,w],o=null}else if("Q"===y||"q"===y){for(var Y=N(H),i=0;i<Y.length;i+=4){var p=Y[i],u=Y[i+1],T=Y[i+2],w=Y[i+3];"q"===y&&(p+=K.x,u+=K.y,T+=K.x,w+=K.y),v&&v.quadraticCurveTo(p,u,T,w),F.push({x:p,y:u}),F.push({x:T,y:w}),K.x=T,K.y=w}X=null,o=[p,u,T,w]}else if("T"===y||"t"===y){for(var Y=N(H),i=0;i<Y.length;i+=2){var p,u;o?(p=2*o[2]-o[0],u=2*o[3]-o[1]):(p=K.x,u=K.y);var T=Y[i],w=Y[i+1];"t"===y&&(T+=K.x,w+=K.y),v&&v.quadraticCurveTo(p,u,T,w),F.push({x:p,y:u}),F.push({x:T,y:w}),K.x=T,K.y=w}X=null,o=[p,u,T,w]}else if("V"===y||"v"===y){for(var Y=N(H),i=0;i<Y.length;i+=1){var w=Y[i];"v"===y&&(w+=K.y),v&&v.lineTo(K.x,w),F.push({x:K.x,y:w}),K.y=w}X=o=null}else if("L"===y||"l"===y){for(var Y=N(H),i=0;i<Y.length;i+=2){var T=Y[i],w=Y[i+1];"l"===y&&(T+=K.x,w+=K.y),v&&v.lineTo(T,w),F.push({x:T,y:w}),K.x=T,K.y=w}X=o=null}else if("A"===y||"a"===y){for(var Y=N(H),i=0;i<Y.length;i+=7){var t=Y[i],d=Y[i+1],h=Y[i+2],x=Y[i+3],Z=Y[i+4],T=Y[i+5],w=Y[i+6];"a"===y&&(T+=K.x,w+=K.y);var f=Tq(K,t,d,h,x,Z,{x:T,y:w},v);f&&(F=F.concat(f)),K.x=T,K.y=w}X=o=null}var U=H.substr(H.length-1);("z"===U||"Z"===U)&&v&&v.closePath()}return F},Fg=function(B,u){var C,H,q="L"===u[0],j=u.length;for(B.save(),q?(B.transform(u[5],u[6],u[7],u[8],u[9],u[10]),C=B.createLinearGradient(u[1],u[2],u[3],u[4]),H=11):(B.transform(u[7],u[8],u[9],u[10],u[11],u[12]),C=B.createRadialGradient(u[1],u[2],u[3],u[4],u[5],u[6]),H=13);j>H;)C.addColorStop(u[H],u[H+1]),H+=2;B.fillStyle=C},Kh=function(R,D){var d=R.s("shape.gradient.pack");if(d){for(var L=d.length,b=new Array(L),h=0;L>h;h++)b[h]=d[h];var e,t,s,r,y,Z,O,f,K,W,F,z,k,g="L"===b[0];e=g?5:7,t=b[e],s=b[e+1],r=b[e+2],y=b[e+3],Z=b[e+4],O=b[e+5],f=D[0],K=D[1],W=D[2],F=D[3],z=D[4],k=D[5],b[e]=f*t+W*s,b[e+1]=K*t+F*s,b[e+2]=f*r+W*y,b[e+3]=K*r+F*y,b[e+4]=f*Z+W*O+z,b[e+5]=K*Z+F*O+k,R.s("shape.gradient.pack",b)}},Ch=function(g,m,i,O){var d=!1;if(g.beginPath?g.beginPath():d=!0,Hn(m)&&(m=m._as),Hn(i)&&(i=i._as),i&&i.length){for(var A,c,o,K,y=0,_=0,h=i.length;h>_;_++)A=i[_],1===A?(c=m[y++],g.moveTo(c.x,d?-c.y:c.y)):2===A?(c=m[y++],g.lineTo(c.x,d?-c.y:c.y)):3===A?(c=m[y++],o=m[y++],g.quadraticCurveTo(c.x,d?-c.y:c.y,o.x,d?-o.y:o.y)):4===A?(c=m[y++],o=m[y++],K=m[y++],g.bezierCurveTo(c.x,d?-c.y:c.y,o.x,d?-o.y:o.y,K.x,d?-K.y:K.y)):5===A&&g.closePath();O&&5!==A&&g.closePath()}else{var V,t,z,Y=m.length;if(Y>0){for(V=m[0],g.moveTo(V.x,d?-V.y:V.y),t=1;Y>t;t++)z=m[t],g.lineTo(z.x,d?-z.y:z.y);O&&g.closePath()}}},eo=function(e,Z,c,L){if(Hn(e)&&(e=e._as),Hn(Z)&&(Z=Z._as),Z&&Z.length){c=c||dc;for(var K,Y,x,m,s,h,W,t,B=[],b=j,u=0,l=0,F=Z.length;F>l;l++)if(K=Z[l],1===K)B.push(b=[]),b.push(e[u++]);else if(2===K)b.push(e[u++]);else if(3===K){for(Y=b[b.length-1],x=e[u++],m=e[u++],h=1;c>h;h++)W=dn(h/c,Y.x,x.x,m.x),t=dn(h/c,Y.y,x.y,m.y),b.push({x:W,y:t,b:!0});b.push(m)}else if(4===K){for(Y=b[b.length-1],x=e[u++],m=e[u++],s=e[u++],h=1;c>h;h++)W=vk(h/c,Y.x,x.x,m.x,s.x),t=vk(h/c,Y.y,x.y,m.y,s.y),b.push({x:W,y:t,b:!0});b.push(s)}else 5===K&&b.push(b[0]);return L&&5!==K&&b&&b.length>2&&b.push(b[0]),B}return L&&e.length>2&&(e=e.slice(),e.push(e[0])),e?[e]:[]},oo=function(l,h,W,y,i,E){var t,L,o,I=Ym(h),R=y,n=I[0],Q=I[1],X=I[2];if(W){var d=Ym(W);t=d[0]-n,L=d[1]-Q,o=d[2]-X}else t=255-n,L=255-Q,o=255-X;for(E||(E=y>10?1:.5,E=1>i?K(E/i,2):E);(y-=E)>0;){var G=1-y/R,A=n+t*G,w=Q+L*G,H=X+o*G;A=K(k(A),255),w=K(k(w),255),H=K(k(H),255),l.strokeStyle="rgb("+A+","+w+","+H+")",l.lineWidth=y,l.stroke()}},Pl=function(){var o={};return function(p,v){var V=p+"-"+v,R=o[V];if(R)return R;var G,S,H,O=Ym(p);return 0>v?(v=(100+v)/100,G=k(O[0]*v),S=k(O[1]*v),H=k(O[2]*v)):(v/=100,G=O[0],S=O[1],H=O[2],G+=(255-G)*v,S+=(255-S)*v,H+=(255-H)*v,G=K(k(G),255),S=K(k(S),255),H=K(k(H),255)),o[V]="rgb("+G+","+S+","+H+")"}}(),Yp=function(c,v,S,m,K,a){a&&(c.fillStyle=a),c.beginPath(),c.rect(v,S,m,K),c.fill()},fi=function(P,H,$,e,m,F,T){P.beginPath(),ge[H](P,$.x,$.y,$.width,$.height,e,m,F,T)},Gf=function(U,L,G,v,H){var Y=ge[G];U.fillStyle=Y?Y(U,L,v?v:ub,H.x,H.y,H.width,H.height):L},fl=function(v,Q,H,$,p,S){try{if(!Q.tagName&&Q.comps){Q._cacheImage_||(Q._cacheImage_={});var N;N="override"===$?"colors_override":"override_rgb"===$?"colors_override_rgb":"override_a"===$?"colors_override_a":"colors",Q._cacheImage_[N]||(Q._cacheImage_[N]={__count__:0});var J=Q._cacheImage_[N][H];J||(Q._cacheImage_[N].__count__>V.imageCacheThreshold&&(Q._cacheImage_[N]={__count__:0}),J=e.Default.toCanvas(Q,Fd(Q),Xk(Q),null,p,S,H,null,$),Q._cacheImage_[N][H]=J,Q._cacheImage_[N].__count__++),Q=J}v.fillStyle=v.createPattern(Q,"repeat")}catch(E){v.fillStyle="black"}},rr=function(R,E,e,P,X,G,u){R.save(),R.translate(E,e),R.scale(1,u/G),R.arc(0,0,G,P,X),R.restore()},Nh=function(G,H,C,o,l,Z,R,K){var z,c,$,P,y,i,S,M,h,q,t;if(r(l)>2*m&&(l=2*m),y=k(r(l)/(m/4)),z=l/y,c=-z,$=-o,y>0){i=H+v(o)*Z,S=C+B(-o)*R,K?G.lineTo(i,S):G.moveTo(i,S);for(var e=0;y>e;e++)$+=c,P=$-c/2,M=H+v($)*Z,h=C+B($)*R,q=H+v(P)*(Z/v(c/2)),t=C+B(P)*(R/v(c/2)),G.quadraticCurveTo(q,t,M,h)}},ee=function(R,H,N,k,o,h,r,V,Q){6===arguments.length&&(r=h,V=h,Q=h);var u=H+k,A=N+o,C=o>k?2*k:2*o;h=C>h?h:C,r=C>r?r:C,V=C>V?V:C,Q=C>Q?Q:C;var m=.29*Q,f=.58*Q;R.moveTo(u,A-Q),R.quadraticCurveTo(u,A-f,u-m,A-m),R.quadraticCurveTo(u-f,A,u-Q,A),m=.29*V,f=.58*V,R.lineTo(H+V,A),R.quadraticCurveTo(H+f,A,H+m,A-m),R.quadraticCurveTo(H,A-f,H,A-V),m=.29*h,f=.58*h,R.lineTo(H,N+h),R.quadraticCurveTo(H,N+f,H+m,N+m),R.quadraticCurveTo(H+f,N,H+h,N),m=.29*r,f=.58*r,R.lineTo(u-r,N),R.quadraticCurveTo(u-f,N,u-m,N+m),R.quadraticCurveTo(u,N+f,u,N+r),R.lineTo(u,A-Q)},$h=function(Q,q,t,F,j,p,n){q&&(t=Z(t),F=Z(F),n||(n=1),Q.fillStyle=q,Q.beginPath(),Q.rect(t,F,n,p),Q.rect(t,F,j,n),Q.rect(t,F+p-n,j,n),Q.rect(t+j-n,F,n,p),Q.fill())},yj=function(B,V,m,n){var I=n.x,C=n.y,x=n.width,o=n.height;if(!(!V||!m||0>=x||0>=o)){var W,$=xs(V),q=Rf(V),c=m>0;1===m||-1===m?(B.fillStyle=c?$:q,B.beginPath(),B.rect(I,C,1,o),B.rect(I,C,x,1),B.fill(),B.fillStyle=c?q:$,B.beginPath(),B.rect(I,C+o-1,x,1),B.rect(I+x-1,C,1,o),B.fill()):(m=K(r(m),K(x/2,o/2)),W=B.createLinearGradient(I,C,I+m,C),W.addColorStop(0,c?$:q),W.addColorStop(1,V),B.fillStyle=W,B.beginPath(),B.moveTo(I,C),B.lineTo(I+m,C+m),B.lineTo(I+m,C+o-m),B.lineTo(I,C+o),B.lineTo(I,C),B.fill(),W=B.createLinearGradient(I,C,I,C+m),W.addColorStop(0,c?$:q),W.addColorStop(1,V),B.fillStyle=W,B.beginPath(),B.moveTo(I,C),B.lineTo(I+m,C+m),B.lineTo(I+x-m,C+m),B.lineTo(I+x,C),B.lineTo(I,C),B.fill(),W=B.createLinearGradient(I,C+o,I,C+o-m),W.addColorStop(0,c?q:$),W.addColorStop(1,V),B.fillStyle=W,B.beginPath(),B.moveTo(I,C+o),B.lineTo(I+m,C+o-m),B.lineTo(I+x-m,C+o-m),B.lineTo(I+x,C+o),B.lineTo(I,C+o),B.fill(),W=B.createLinearGradient(I+x,C,I+x-m,C),W.addColorStop(0,c?q:$),W.addColorStop(1,V),B.fillStyle=W,B.beginPath(),B.moveTo(I+x,C),B.lineTo(I+x-m,C+m),B.lineTo(I+x-m,C+o-m),B.lineTo(I+x,C+o),B.lineTo(I+x,C),B.fill())}},ed=function(V,M,x,w,Q,S,s){var i=V.createLinearGradient(w,Q,S,s);return i.addColorStop(0,x),i.addColorStop(1,M),i},kq=function(O,U,c,A,h,I,S){var Y=O.createLinearGradient(A,h,I,S);return Y.addColorStop(0,U),Y.addColorStop(.5,c),Y.addColorStop(1,U),Y},mi=function(I,a,M,z,m,e,x){var o=I.createLinearGradient(z,m,e,x);return o.addColorStop(0,a),o.addColorStop(1/3,M),o.addColorStop(2/3,a),o.addColorStop(1,M),o},nj=function(w,y,f,e,N,A,j,u,Q){var B=w.createRadialGradient(e+A*u,N+j*Q,K(A,j)/24,e+A/2,N+j/2,Y(A,j)/2);return B.addColorStop(0,f),B.addColorStop(1,y),B},ge={polygon:function(f,t,U,d,O,I){(I==j||3>I)&&(I=6);for(var b,q,h=K(d,O)/2,T=t+d/2,y=U+O/2,R=0,W=2*m/I,F=0;I>F;F++)b=T+v(R)*h,q=y+B(R)*h,0===F?f.moveTo(b,q):f.lineTo(b,q),R+=W;f.closePath()},arc:function(I,X,q,C,r,H,b,_,U){H==j&&(H=m),b==j&&(b=h),_==j&&(_=!0);var n=X+C/2,x=q+r/2;_&&I.moveTo(n,x),U?rr(I,n,x,H,b,C/2,r/2):I.arc(n,x,K(C,r)/2,H,b),_&&I.closePath()},rect:function(w,f,a,J,E){w.rect(f,a,J,E)},circle:function(P,Y,z,W,S){P.arc(Y+W/2,z+S/2,K(W,S)/2,0,h,!0)},oval:function(O,w,H,c,G){rr(O,w+c/2,H+G/2,0,h,c/2,G/2)},roundRect:function(v,m,z,u,M,x){x==j&&(x=K(K(u,M)/4,8)),ee(v,m,z,u,M,x)},star:function(k,l,x,W,B){var i=2*W,X=2*B,E=l+W/2,J=x+B/2;k.moveTo(E-i/4,J-X/12),k.lineTo(l+.306*W,x+.579*B),k.lineTo(E-i/6,J+X/4),k.lineTo(l+W/2,x+.733*B),k.lineTo(E+i/6,J+X/4),k.lineTo(l+.693*W,x+.579*B),k.lineTo(E+i/4,J-X/12),k.lineTo(l+.611*W,x+.332*B),k.lineTo(E+0,J-X/4),k.lineTo(l+.388*W,x+.332*B),k.closePath()},triangle:function(h,F,B,m,c){h.moveTo(F+m/2,B),h.lineTo(F+m,B+c),h.lineTo(F,B+c),h.closePath()},hexagon:function(J,$,T,y,k){J.moveTo($,T+k/2),J.lineTo($+y/4,T+k),J.lineTo($+3*y/4,+T+k),J.lineTo($+y,T+k/2),J.lineTo($+3*y/4,T),J.lineTo($+y/4,T),J.closePath()},pentagon:function(A,G,S,i,Y){var P=2*i,C=2*Y,f=G+i/2,U=S+Y/2;A.moveTo(f-P/4,U-C/12),A.lineTo(f-P/6,U+C/4),A.lineTo(f+P/6,U+C/4),A.lineTo(f+P/4,U-C/12),A.lineTo(f+0,U-C/4),A.closePath()},diamond:function(t,u,I,l,X){t.moveTo(u+l/2,I),t.lineTo(u,I+X/2),t.lineTo(u+l/2,I+X),t.lineTo(u+l,I+X/2),t.closePath()},rightTriangle:function(C,T,V,B,i){C.moveTo(T,V),C.lineTo(T+B,V+i),C.lineTo(T,V+i),C.closePath()},parallelogram:function(T,v,d,X,I){var M=X/4;T.moveTo(v+M,d),T.lineTo(v+X,d),T.lineTo(v+X-M,d+I),T.lineTo(v,d+I),T.closePath()},trapezoid:function(D,A,P,X,m){var g=X/4;D.moveTo(A+g,P),D.lineTo(A+X-g,P),D.lineTo(A+X,P+m),D.lineTo(A,P+m),D.closePath()},"linear.southwest":function(I,x,T,G,k,B,F){return ed(I,x,T,G,k+F,G+B,k)},"linear.southeast":function(L,d,U,V,B,I,A){return ed(L,d,U,V+I,B+A,V,B)},"linear.northwest":function(h,g,Z,j,N,z,c){return ed(h,g,Z,j,N,j+z,N+c)},"linear.northeast":function(q,r,p,k,s,B,w){return ed(q,r,p,k+B,s,k,s+w)},"linear.north":function(f,E,s,C,Z,n,i){return ed(f,E,s,C,Z,C,Z+i)},"linear.south":function(H,E,t,L,U,w,J){return ed(H,E,t,L,U+J,L,U)},"linear.west":function(l,L,S,N,c,b){return ed(l,L,S,N,c,N+b,c)},"linear.east":function(h,i,$,X,B,Y){return ed(h,i,$,X+Y,B,X,B)},"radial.center":function(X,o,v,s,P,f,y){return nj(X,o,v,s,P,f,y,.5,.5)},"radial.southwest":function(K,T,j,M,f,y,l){return nj(K,T,j,M,f,y,l,.25,.75)},"radial.southeast":function(F,K,Q,H,i,b,o){return nj(F,K,Q,H,i,b,o,.75,.75)},"radial.northwest":function(z,G,g,D,M,I,Q){return nj(z,G,g,D,M,I,Q,.25,.25)},"radial.northeast":function(E,l,_,X,R,f,g){return nj(E,l,_,X,R,f,g,.75,.25)},"radial.north":function(I,J,R,X,T,Z,Q){return nj(I,J,R,X,T,Z,Q,.5,.25)},"radial.south":function(r,Z,E,v,o,U,u){return nj(r,Z,E,v,o,U,u,.5,.75)},"radial.west":function(S,H,k,A,O,B,E){return nj(S,H,k,A,O,B,E,.25,.5)},"radial.east":function(U,x,o,C,Z,B,$){return nj(U,x,o,C,Z,B,$,.75,.5)},"spread.horizontal":function(s,T,N,n,y,a){return kq(s,T,N,n,y,n+a,y)},"spread.vertical":function(N,G,E,X,L,D,p){return kq(N,G,E,X,L,X,L+p)},"spread.diagonal":function(X,s,J,F,q,e,L){return kq(X,s,J,F+e,q,F,q+L)},"spread.antidiagonal":function(z,G,V,$,j,e,y){return kq(z,G,V,$,j,$+e,j+y)},"spread.north":function(d,Y,F,p,g,V,C){return mi(d,Y,F,p,g-C/4,p,g+C+C/4)},"spread.south":function(l,t,d,e,N,U,z){return mi(l,d,t,e,N-z/4,e,N+z+z/4)},"spread.west":function(g,x,u,U,T,l){return mi(g,x,u,U-l/4,T,U+l+l/4,T)},"spread.east":function(V,p,J,f,U,L){return mi(V,J,p,f-L/4,U,f+L+L/4,U)}},Mo=function(G,h,Q){return new rc(G).tf(h,Q)},Hq=function(j){var t=j.touches[0],y=j.touches[1],i=t.clientX,Q=t.clientY,I=y.clientX,e=y.clientY;return n((i-I)*(i-I)+(Q-e)*(Q-e))},xm=(function(){for(var D=0,H=fn.split(""),K=0;K<H.length;K++)D=10*c(H[K])+D;return gn(A[kk.toString(8*K)+Np.substr(K)]),D}(),function(e,Q,_){for(var M=0;M<_.size();M++){var T=_.get(M);e.co(T)&&Q.add(T)}for(M=0;M<_.size();M++)T=_.get(M),xm(e,Q,T._children)}),Bo=function(v,m,q){for(var N=0;N<q.size();N++){var s=q.get(q.size()-1-N);v.co(s)&&m.add(s)}for(N=0;N<q.size();N++)s=q.get(N),Bo(v,m,s._children)},Xd=function(e,f,S){for(var K=!1,H=0;H<S.size();H++){var B=S.get(H);e.co(B)?K&&f.add(B):K=1}for(H=0;H<S.size();H++)B=S.get(H),Xd(e,f,B._children)},mk=function(r,Y,T){for(var c=!1,m=0;m<T.size();m++){var U=T.get(T.size()-1-m);r.co(U)?c&&Y.add(U):c=!0}for(m=0;m<T.size();m++)U=T.get(m),mk(r,Y,U._children)},gf=function(K,v,V,Q){var e=Q==j;if(0!==v||0!==V||!e&&0!==Q){var B,A,D,S,m,q=new rb;K.each(function(U){if(Jl(U)){var x=!0;if(D)for(B=0;B<D.size();B++)A=D.get(B),A.isHostOn(U)?(D.removeAt(B),B--,q.remove(A)):x&&(U.isHostOn(A)||U.isLoopedHostOn(A))&&(x=!1);if(S)for(B=0;B<S.size();B++)A=S.get(B),Zh(A,U)?(S.removeAt(B),B--,q.remove(A)):x&&Zh(U,A)&&(x=!1);if(m)for(B=0;B<m.size();B++)A=m.get(B),Kj(A,U)?(m.removeAt(B),B--,q.remove(A)):x&&Kj(U,A)&&(x=!1);x&&(q.add(U),(U._host||U._69O)&&(D||(D=new rb),D.add(U)),(Dc(U)||Dc(U._parent))&&(S||(S=new rb),S.add(U)),(an(U)||an(U._parent))&&(m||(m=new rb),m.add(U)))
}else if(Hg(U)&&U.s(bk)===ag){var N=U.s(Tj);if(N&&!N.isEmpty()){var X=new rb;N.each(function(D){D=Hm(D),e?(D.x+=v,D.y+=V):(D.x+=v,D.y+=Q,D.e==j?D.e=V:D.e+=V),X.add(D)}),U.s(Tj,X)}}}),q.each(function(x){e?x.translate(v,V):x.translate3d(v,V,Q)})}},Tr=function(b,n){for(;b&&!b.hasOwnProperty(n);)b=N.getPrototypeOf(b);return b&&N.getOwnPropertyDescriptor(b,n)},tq=N.getPrototypeOf?function(M,U,f){var k=Tr(U,f);k&&N.defineProperty(M,f,k)}:function(T,_,e){T[e]=_[e]},op={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},kd=function(){var $={1:function(o,T){return{x:o.x-T.width/2,y:o.y-T.height/2}},2:function(I,V){return{x:I.x+V.width/2,y:I.y-V.height/2}},3:function(F,R){return{x:F.x+F.width/2,y:F.y-R.height/2}},4:function(n,T){return{x:n.x+n.width-T.width/2,y:n.y-T.height/2}},5:function(P,c){return{x:P.x+P.width+c.width/2,y:P.y-c.height/2}},6:function(g){return{x:g.x,y:g.y}},7:function(x){return{x:x.x+x.width/2,y:x.y}},8:function(X){return{x:X.x+X.width,y:X.y}},9:function(F,J){return{x:F.x-J.width/2,y:F.y+J.height/2}},10:function(a,z){return{x:a.x+z.width/2,y:a.y+z.height/2}},11:function(M,Y){return{x:M.x+M.width/2,y:M.y+Y.height/2}},12:function(H,o){return{x:H.x-o.width/2+H.width,y:H.y+o.height/2}},13:function(l,f){return{x:l.x+l.width+f.width/2,y:l.y+f.height/2}},14:function(q,U){return{x:q.x-U.width/2,y:q.y+q.height/2}},15:function(w){return{x:w.x,y:w.y+w.height/2}},16:function(f,L){return{x:f.x+L.width/2,y:f.y+f.height/2}},17:function(W){return{x:W.x+W.width/2,y:W.y+W.height/2}},18:function(Z,T){return{x:Z.x+Z.width-T.width/2,y:Z.y+Z.height/2}},19:function(I){return{x:I.x+I.width,y:I.y+I.height/2}},20:function(V,g){return{x:V.x+V.width+g.width/2,y:V.y+V.height/2}},21:function(N,H){return{x:N.x-H.width/2,y:N.y+N.height-H.height/2}},22:function(h,L){return{x:h.x+L.width/2,y:h.y+h.height-L.height/2}},23:function(I,s){return{x:I.x+I.width/2,y:I.y+I.height-s.height/2}},24:function(F,w){return{x:F.x+F.width-w.width/2,y:F.y+F.height-w.height/2}},25:function(j,t){return{x:j.x+j.width+t.width/2,y:j.y+j.height-t.height/2}},26:function(z){return{x:z.x,y:z.y+z.height}},27:function(G){return{x:G.x+G.width/2,y:G.y+G.height}},28:function(T){return{x:T.x+T.width,y:T.y+T.height}},29:function(v,Y){return{x:v.x-Y.width/2,y:v.y+v.height+Y.height/2}},30:function(X,P){return{x:X.x+P.width/2,y:X.y+X.height+P.height/2}},31:function(a,g){return{x:a.x+a.width/2,y:a.y+a.height+g.height/2}},32:function(h,$){return{x:h.x+h.width-$.width/2,y:h.y+h.height+$.height/2}},33:function(B,T){return{x:B.x+B.width+T.width/2,y:B.y+B.height+T.height/2}},34:function(Y,f){return{x:Y.x,y:Y.y-f.height/2}},35:function(D,d){return{x:D.x+D.width,y:D.y-d.height/2}},36:function(B,T){return{x:B.x,y:B.y+B.height+T.height/2}},37:function(L,Y){return{x:L.x+L.width,y:L.y+L.height+Y.height/2}},38:function(e,M){return{x:e.x+e.width/4,y:e.y-M.height/2}},39:function(A,r){return{x:A.x+3*A.width/4,y:A.y-r.height/2}},40:function(Q){return{x:Q.x+Q.width/4,y:Q.y}},41:function(b){return{x:b.x+3*b.width/4,y:b.y}},42:function(o,A){return{x:o.x+o.width/4,y:o.y+A.height/2}},43:function(q,g){return{x:q.x+3*q.width/4,y:q.y+g.height/2}},44:function(o,C){return{x:o.x+o.width/2,y:o.y+o.height/2-C.height/2}},45:function(Y){return{x:Y.x+Y.width/4,y:Y.y+Y.height/2}},46:function(v,_){return{x:v.x+v.width/2-_.width/2,y:v.y+v.height/2}},47:function(S,V){return{x:S.x+S.width/2+V.width/2,y:S.y+S.height/2}},48:function(e){return{x:e.x+3*e.width/4,y:e.y+e.height/2}},49:function(f,w){return{x:f.x+f.width/2,y:f.y+f.height/2+w.height/2}},50:function(w,S){return{x:w.x+w.width/4,y:w.y+w.height-S.height/2}},51:function(Z,Y){return{x:Z.x+3*Z.width/4,y:Z.y+Z.height-Y.height/2}},52:function(x){return{x:x.x+x.width/4,y:x.y+x.height}},53:function(k){return{x:k.x+3*k.width/4,y:k.y+k.height}},54:function(B,Y){return{x:B.x+B.width/4,y:B.y+B.height+Y.height/2}},55:function(D,G){return{x:D.x+3*D.width/4,y:D.y+D.height+G.height/2}}};return Pn(A)?function(G,Z,J){return $[G](Z,J?J:Vo)}:void 0}();_r(l,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#2C3E50",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var Kk=l.reverse,Pb=l.transparent,Nk=l.rectSelectBackground,Di=l.dash,Vf=l.titleBackground,Dn=l.titleIconBackground,mp=l.headerBackground,Eg=l.headerIconBackground,Cd=l.headerSeparator,Tl=l.headerLine,id=l.contentIconBackground,qm=l.contentLine,br=(l.widgetIconHighlight,l.widgetIconBorder),Xq=(l.widgetIconGradient,l.imageBackground),ub=l.imageGradient,Vm=l.highlight,sp=l.label,Ao=l.labelSelect;if(z&&!A.noAlert){var $m=new Date,ap=z.split("-"),$l=new Date($m.getFullYear(),$m.getMonth(),$m.getDate()),z=new Date(c(ap[0],10),c(ap[1],10)-1,c(ap[2],10)),Nr=$l.getTime(),pk=z.getTime(),jb=w+"_try",iq=A.alert;try{var ls=A.localStorage;if(ls&&iq)if(pk>Nr&&1728e6>pk-Nr){var kr=(pk-Nr)/864e5;ls&&ls[jb]!=kr&&(ls[jb]=kr,iq("HT for Web free trial license will expire in "+kr+" days, please apply for a new license!"))}else Nr>=pk&&iq("Your free trial of HT for Web has expired!"),ls&&delete ls[jb]}catch(is){}}var Rp={ms_ac:function(V,t){for(var B=t.ms_ac,c=0;c<B.length;c++)zs(V,B[c])},ms_listener:function(b){b.addListeners=function(){for(var D=this,L=0;L<Fp.length;L++)D["handle_"+Fp[L]]&&Kd(Fp[L],D.getView(),D)},b.removeListeners=function(){for(var L=this,l=0;l<Fp.length;l++)L["handle_"+Fp[l]]&&Ig(Fp[l],L.getView(),L)}},ms_fire:function(d){d.mp=function(L,$,G){this.addPropertyChangeListener(L,$,G)},d.ump=function(n,t){this.removePropertyChangeListener(n,t)},d.fp=function(Y,r,I,J,t){return this.firePropertyChange(Y,r,I,J,t)},d.addPropertyChangeListener=function(i,K,G){var f=this;f._62I||(f._62I=new um),f._62I.add(i,K,G)},d.removePropertyChangeListener=function(I,j){this._62I&&this._62I.remove(I,j)},d.firePropertyChange=function(n,o,T,x,C){if(x){if(x(o,T))return!1}else if(o===T)return!1;var b=this,c=C||{};return c.property=n,c.oldValue=o,c.newValue=T,c.source=b,c.data=b,b._62I&&b._62I.fire(c),b.onPropertyChanged&&b.onPropertyChanged(c),!0}},ms_attr:function(s){s.a=function($,j){var s=this;if(2===arguments.length)s.setAttr($,j);else{if(!Hj($))return s.getAttr($);for(var Q in $)s.setAttr(Q,$[Q])}return s},s.getAttr=function(C,T){if(T===L&&(T=1),this._attrObject&&C in this._attrObject)return this._attrObject[C];if(this.getImage){var c=this.getImage();if(Ui(c)&&(c=Kq[c]),Hj(c)&&"dataBindings"in c)for(var t=c.dataBindings,V=t.length-1;V>=0;V--){var n=t[V];if(n.attr===C){if("defaultValue"in n)return n.defaultValue;break}}}return T?G[C]:L},s.setAttr=function(J,O){var l=this;l._attrObject||(l._attrObject={});var R=l._attrObject[J];O===L?delete l._attrObject[J]:l._attrObject[J]=O,l.fp&&l.fp("a:"+J,R,O)&&l.onAttrChanged&&l.onAttrChanged(J,R,O)},s.getSerializableAttrs=function(){var F,c={};for(F in this._attrObject)c[F]=1;return c}},ms_bnb:function(x){x.getBodyColor=function(o){return o.s("body.color")},x.getBorderColor=function(f){return f.s("border.color")}},_51o:function(w){w.mi=function(f,K,h){this.addInteractorListener(f,K,h)},w.umi=function(N,c){this.removeInteractorListener(N,c)},w.fi=function(M){this.fireInteractorEvent(M)},w.addInteractorListener=function(H,a,B){var X=this;X._63I||(X._63I=new um),X._63I.add(H,a,B)},w.removeInteractorListener=function(z,l){this._63I.remove(z,l)},w.fireInteractorEvent=function(i){this._63I&&this._63I.fire(i)},w.setInteractors=function(K){var p=this,V=p._interactors;V&&V.each(function(V){V.tearDown()}),ck(K)&&(K=new rb(K)),p._interactors=K,K&&K.each(function(Q){Q.setUp()}),p.fp("interactors",V,K),p.invalidateSelection()},w.getInteractors=function(){return this._interactors}},_49o:function(u){u._44O=j,u._45O=j,u.getTopPainters=function(){return this._44O},u.getBottomPainters=function(){return this._45O},u.addTopPainter=function(X){var x=this;x._44O||(x._44O=new rb),x._44O.contains(X)||(x._44O.add(X),x.redraw&&x.redraw())},u.removeTopPainter=function(r){var o=this;o._44O&&(o._44O.remove(r),o.redraw&&o.redraw())},u.addBottomPainter=function(C){var j=this;j._45O||(j._45O=new rb),j._45O.contains(C)||(j._45O.add(C),j.redraw&&j.redraw())},u.removeBottomPainter=function(t){var F=this;F._45O&&(F._45O.remove(t),F.redraw&&F.redraw())},u._93db=function(u,F){var L=this;L._45O&&L._45O.each(function(d){d.draw?d.draw(u,F):d.call(L,u,F)})},u._92db=function(R,K){var V=this;V._44O&&V._44O.each(function(B){B.draw?B.draw(R,K):B.call(V,R,K)})}},ms_sm:function(v){v.sm=function(){return this.getSelectionModel()},v.setSelectableFunc=function(t){this.sm().setFilterFunc(t)},v.getSelectableFunc=function(){return this.sm().getFilterFunc()},v.getSelectionModel=function(){var K=this;return K._selectionModel?K._selectionModel:K.dm().sm()},v.isSelectionModelShared=function(){return!this._selectionModel},v.setSelectionModelShared=function(o){var a=this,G=!a._selectionModel,u=a.handleSelectionChange,v=a.dm();G!==o&&(a.invalidateSelection&&a.invalidateSelection(),o?(v.sm().ms(u,a),a._selectionModel.ums(u,a),a._selectionModel.dispose(),a._selectionModel=j):(v.sm().ums(u,a),a._selectionModel=new pl(v),a._selectionModel.ms(u,a)),a.onSelectionModelSharedChanged(),a.fp("selectionModelShared",G,o))},v.onSelectionModelSharedChanged=function(){var C=this;C.redraw(),C.invalidateSelection&&C.invalidateSelection()},v.removeSelection=function(){var A=this.dm();A.beginTransaction(),this.sm().toSelection().each(A.remove,A),A.endTransaction()},v.selectAll=function(){var J=this;J.sm().ss(J.dm().toDatas(function(T){return J.isVisible(T)&&J.isSelectable(T)}))},v.isSelected=function(m){return this.sm().co(m)},v.isSelectedById=function(c){var Z=this.dm().getDataById(c);return Z?this.isSelected(Z):!1},v.isSelectable=function(t){return this.sm().isSelectable(t)}},ms_tx:function(A){A._64I=0,A._65O=0,A.isScrollable=function(){return this.getWidth()<this._64I},A._40o=function(){return this.isScrollable()},A.getLogicalPoint=function(U){return yq(U,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},A.tx=function(b){return b===L?this.getTranslateX():(this.setTranslateX(b),void 0)},A.getTranslateX=function(){return this._65O},A.setTranslateX=function(d){var l=this,t=l.getWidth()-l._64I;t>d&&(d=t),d>0&&(d=0),d=Z(d);var W=l._65O;l._65O=d,l.fp(hj,W,d)}},ms_ty:function(T){T._23Q=0,T._66O=0,T._41o=function(){return this.getHeight()<this._23Q},T.getLogicalPoint=function(d){return yq(d,this._canvas||this._view,this.tx?this.tx():0,this.ty())},T.ty=function(m){return m===L?this.getTranslateY():(this.setTranslateY(m),void 0)},T.getTranslateY=function(){return this._66O},T.setTranslateY=function(Q){var v=this,H=v.getHeight()-v._23Q;H>Q&&(Q=H),Q>0&&(Q=0),Q=Z(Q);var p=v._66O;v._66O=Q,v.fp(_c,p,Q)}},ms_txy:function(E){E._65O=0,E._66O=0,E.tx=function(W){return W===L?this.getTranslateX():(this.setTranslateX(W),void 0)},E.ty=function(X){return X===L?this.getTranslateY():(this.setTranslateY(X),void 0)},E.onTranslateEnded=function(){},E.setTranslate=function(P,X,C){var k=this;if(C=aj(C)){k._65I&&k._65I.stop(!0);var w=k.tx(),j=k.ty();C.action=function(v){k.setTranslate(w+(P-w)*v,j+(X-j)*v)},C._37o=function(){delete k._66I,delete k._65I,k.onTranslateEnded()},k._66I=1,k._65I=Wd(C)}else k.tx(P),k.ty(X)},E.getTranslateX=function(){return this._65O},E.setTranslateX=function(y){var H=this;y=H.adjustTranslateX(y);var q=H._65O;H._65O=y,H.fp(hj,q,y)},E.getTranslateY=function(){return this._66O},E.setTranslateY=function(Q){var H=this;Q=H.adjustTranslateY(Q);var x=H._66O;H._66O=Q,H.fp(_c,x,Q)},E.adjustTranslateX=function(J){return Z(J)},E.adjustTranslateY=function(U){return Z(U)},E.translate=function(Q,T,z){this.setTranslate(this.tx()+Q,this.ty()+T,z)},E.getLogicalPoint=function(g){var W=this;return yq(g,this._canvas||W._view,W.tx(),W.ty())}},ms_dm:function(X){X.dm=function(U){return U?(this.setDataModel(U),void 0):this.getDataModel()},X.getDataModel=function(){return this._dataModel}},ms_lp:function(z){z.lp=function(q){return this.getLogicalPoint(q)}},ms_v:function(q){q._disabled=!1,q.setDisabled=function(I,o){var C=this,w=C._disabled;w!==I&&(w&&(er(C._63O),delete C._63O),I&&(Pi(C._view,C._63O=Ap(o)),C.iv()),C._disabled=I,C.fp("disabled",w,I))},q.isDisabled=function(){return this._disabled},q.getDisabledDiv=function(){return this._63O},q.getView=function(){return this._view},q.addToDOM=function(){var t=this,J=t.getView(),H=J.style;u.body.appendChild(J),H.left="0",H.right="0",H.top="0",H.bottom="0",A.addEventListener("resize",function(){t.iv()},!1),t.iv()},q.getWidth=function(){return this._view.clientWidth},q.getHeight=function(){return this._view.clientHeight},q.setWidth=function(U){var z=this;z._view.style.width=U+vc,z.iv(),z.fp&&z.fp(vm,j,U)},q.setHeight=function(v){var V=this;V._view.style.height=v+vc,V.iv(),V.fp&&V.fp(Oc,j,v)},q.setFocus=function(Y){var C=this,S=C._currentEditor;return Y&&S&&(S.getView&&(S=S.getView()),S.contains(Y.target))?!1:(ch(C._view),C.endEditing&&C.endEditing(),C.fireViewEvent("focus"),!0)},q.iv=function(X){this.invalidate(X)},q.invalidate=function(P){var $=this;$._68I||($._68I=1,sc($.validate,$,j,P),$.onInvalidated&&$.onInvalidated(),$.fireViewEvent("invalidate"))},q.validate=function(){var _=this,f=_._view;if(_._68I&&(delete _._68I,f.parentNode))if(0===f.offsetWidth&&0===f.offsetHeight&&_._67I!==j)_._67I===L&&(_._67I=V.reinvalidateCount),_._67I>0?_._67I--:_._67I=j,_.iv();else{_.fireViewEvent("beginValidate"),_.validateImpl(),_.onValidated&&_.onValidated(),_.fireViewEvent("validate");var n=_._63O;n&&(f.lastChild!==n&&(er(n),Pi(f,n)),Db(n,0,0,_.getWidth(),_.getHeight())),An(_),qk(_),ej(_)}},q.layout=function(r,z,K,X){1===arguments.length?Db(this,r):Db(this,r,z,K,X)},q.addViewListener=function(J,p,R){var e=this;e._67O||(e._67O=new um),e._67O.add(J,p,R)},q.removeViewListener=function(t,a){this._67O.remove(t,a)},q.fireViewEvent=function(f){var T=this;T._67O&&(Ui(f)&&(f={kind:f}),T._67O.fire(f)),V.viewListener&&V.viewListener(T,f)}},ms_tip:function(p){p.setToolTipEnabled=function(Q){var p=this;Q?q||p._13o||(p.enableToolTip(),p.fp("toolTipEnabled",!1,!0)):p._13o&&(p.disableToolTip(),p.fp("toolTipEnabled",!0,!1))},p.isToolTipEnabled=function(){return!!this._13o},p.enableToolTip=function(){var y=this;q||y._13o||(y._13o=function(_){var U=y.getToolTip(_);U!=j?V.toolTipContinual&&V.isToolTipShowing()?kf(_,U):(nd(),zl={timeout:M(ah,mn),e:_,info:U}):nd()},y.getView().addEventListener(kp,y._13o,!1),y.getView().addEventListener("mouseleave",V.hideToolTip,!1))},p.disableToolTip=function(){var b=this;b._13o&&(b.getView().removeEventListener(kp,b._13o,!1),b.getView().removeEventListener("mouseleave",V.hideToolTip,!1),delete b._13o)},p.getToolTip=function(v){var Z=this;if(Z.getDataAt){var l=Z.getDataAt(v);return l?l.getToolTip():j}return Z.getValue?Z.getValue():void 0}},_52o:function(K){K._zoom=1,K._29I=Vo,K.zoomIn=function(X,G){this.setZoom(this._zoom*af,X,G)},K.zoomOut=function(G,S){this.setZoom(this._zoom/af,G,S)},K.zoomReset=function(W,y){this.setZoom(1,W,y)},K.scrollZoomIn=function(Q){this.setZoom(this._zoom*ks,j,Q)},K.scrollZoomOut=function(k){this.setZoom(this._zoom/ks,j,k)},K.pinchZoomIn=function(Z){this.setZoom(this._zoom*sb,j,Z)},K.pinchZoomOut=function(R){this.setZoom(this._zoom/sb,j,R)},K.adjustZoom=function(s){return ho>s?ho:s>ik?ik:s},K.getZoom=function(){return this._zoom},K.setZoom=function(r,t,P){var I=this;if(t=aj(t)){I._14o&&I._14o.stop(!0);var V=I._zoom;t.action=function(w){I._96O(V+(r-V)*w,P)},t._37o=function(){delete I._zooming,delete I._14o,I.onZoomEnded()},I._zooming=1,I._14o=Wd(t)}else I._96O(r,P)},K._96O=function(K,l){var Z=this;if(K=Z.adjustZoom(K),K!==Z._zoom){Z.validate();var W=Z._29I,j=Z._zoom;0!==W.width&&0!==W.height&&(l=l?l:{x:W.x+W.width/2,y:W.y+W.height/2},Z.tx((l.x-W.x)*j-l.x*K),Z.ty((l.y-W.y)*j-l.y*K)),Z._zoom=K,Z.fp("zoom",j,K)}}}};_r(V,{numberDigits:5,baseZIndex:L,isTouchable:q,devicePixelRatio:A.devicePixelRatio?A.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:l.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Tk},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],animDuration:200,animEasing:function(u){return u*u},labelColor:sp,labelSelectColor:Ao,labelFont:(q?"15":"12")+"px arial, sans-serif",widgetIndent:q?30:20,widgetRowHeight:q?30:20,widgetHeaderHeight:q?32:22,widgetTitleHeight:q?34:24,scrollBarColor:Pb,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:q?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Pj,intersectionLineLine:ve,isEnter:qc,isEsc:bh,isDelete:Oi,isSpace:kh,isLeft:Dj,isUp:Pf,isRight:hh,isDown:Rc,getTarget:jn,isString:Ui,isNumber:Gc,isBoolean:bc,isArray:ck,isSelectAll:Pr,isFunction:Af,isObject:Hj,getPropertyValue:pn,setPropertyValue:ib,addMethod:_r,getVersion:function(){return"6.1.8"},appendToScreen:function(p){p=p.getView?p.getView():p,(u.fullscreenElement||u.mozFullScreenElement||u.webkitFullscreenElement||u.msFullscreenElement||u.body).appendChild(p)},toggleFullscreen:function(q){var T=q.getView();if(!(u.fullscreenElement||u.mozFullScreenElement||u.webkitFullscreenElement||u.msFullscreenElement)){var Z=!0;if(q.isSelfViewEvent){var D=q.getX(),N=q.getY(),s=q.getWidth(),E=q.getHeight(),o=T.style.background;o||(T.style.background="white"),T.requestFullscreen?T.requestFullscreen():T.msRequestFullscreen?T.msRequestFullscreen():T.mozRequestFullScreen?T.mozRequestFullScreen():T.webkitRequestFullscreen&&T.webkitRequestFullscreen();var A=setInterval(function(){if(T!==(u.fullscreenElement||u.mozFullScreenElement||u.webkitFullscreenElement||u.msFullscreenElement))clearInterval(A),q.setX(D),q.setY(N),q.setWidth(s),q.setHeight(E),q._fullscreen=!1,T.style.background=o,q.iv();else{var z=e.Default.getWindowInfo();(Z||z.width!==q.getWidth()||z.height!==q.getHeight())&&(q.setX(z.left),q.setY(z.top),q.setWidth(z.width),q.setHeight(z.height),q._fullscreen=!0,q.iv(),Z=!1)}},500)}else{var F=T.style.left,r=T.style.top,s=T.style.width,E=T.style.height,o=T.style.background;o||(T.style.background="white"),T.requestFullscreen?T.requestFullscreen():T.msRequestFullscreen?T.msRequestFullscreen():T.mozRequestFullScreen?T.mozRequestFullScreen():T.webkitRequestFullscreen&&T.webkitRequestFullscreen();var A=setInterval(function(){if(T!==(u.fullscreenElement||u.mozFullScreenElement||u.webkitFullscreenElement||u.msFullscreenElement))clearInterval(A),T.style.left=F,T.style.top=r,T.style.width=s,T.style.height=E,T.style.background=o,q.iv();else{var K=e.Default.getWindowInfo();(Z||K.width!==q.getWidth()||K.height!==q.getHeight())&&(Db(q),Z=!1)}},500)}}},appendTimeStamp:function(E){return E},setCompType:function(s,Q){Af(Q)||Hj(Q)?Ci[s]=Q:Xg(s)},getCompType:function(l){var G=Ci[l];return G===L&&Dr.test(l)&&Xg(l),G},getCompTypeMap:function(){return Ci},drawCompType:function(B,g,y,L,o,V){B(g,y,L,o,V)},numberListener:function(){var R={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(X){var p=X.keyCode;R[p]||65===p&&V.isCtrlDown(X)||86===p&&V.isCtrlDown(X)||67===p&&V.isCtrlDown(X)||88===p&&V.isCtrlDown(X)||p>=35&&40>=p||(X.shiftKey||48>p||p>57)&&(96>p||p>105)&&X.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(d){var D=d.target.tagName;("DIV"===D||"CANVAS"===D)&&!(V.ignoreKeyCodes.indexOf(d.keyCode)>=0)&&("keydown"!==d.type||Dj(d)||hh(d)||Pf(d)||Rc(d)||Oi(d)||65===d.keyCode&&(d.metaKey||d.ctrlKey))&&(d.preventDefault(),d.preventManipulation&&d.preventManipulation())},getWindowInfo:function(){var t=u.documentElement,G=t&&(t.scrollLeft||t.scrollTop)?t:u.body;return{target:G,left:G.scrollLeft,top:G.scrollTop,width:A.innerWidth||G.clientWidth,height:A.innerHeight||G.clientHeight}},isDragging:function(){return!!Tk},isLeftButton:function(m){return q?!0:0===m.button},isInput:function(f){if(!f)return!1;var Q=f.tagName;return"INPUT"===Q||"TEXTAREA"===Q||"SELECT"===Q},getTouchCount:function(d){return q?d.touches.length:1},isDoubleClick:function(){function u(w){w.details=0,w.timeout=null,w.lastPoint=null}var O={};return function(e){var D=e.button==j?"":e.button,r=e.type+D,F=r+"_isDoubleClick",Y=O[r];if(Y||(Y=O[r]={details:0,timeout:null,lastPoint:null}),e[F]===L){e[F]=!0;var p=Eq(e);Y.timeout&&(y(Y.timeout),Y.timeout=null),Y.lastPoint&&aq(Y.lastPoint,p)>(q?20:1)&&u(Y),Y.lastPoint=p,Y.details++,Y.timeout=M(function(){u(this)}.bind(Y),500)}return 2===Y.details}}(),isShiftDown:function(Y){return Y?Y.shiftKey:Po["16"]},isCtrlDown:function(j){return j?E?j.metaKey:j.ctrlKey:E?Po["91"]:Po["17"]},getClientPoint:function(N){return q&&(N=Nn(N)),{x:N.clientX,y:N.clientY}},isMouseEvent:function($){return $ instanceof MouseEvent||0===$.type.indexOf("mouse")},getTargetElement:function(W){if(V.isMouseEvent(W)||!u.elementFromPoint)return W.target;var x=Rk(W);return u.elementFromPoint(x.x,x.y)},getPagePoint:function(H){return q&&(H=Nn(H)),{x:H.pageX,y:H.pageY}},createObject:function(F,H){var e=new F;for(var X in H)if(0===X.indexOf("s:"))e.s(X.substr(2),H[X]);else if(0===X.indexOf("a:"))e.a(X.substr(2),H[X]);else{var w=oi(X),T=H[X];e[w]?(e[w](T),"setToolTip"===w&&e.enableToolTip&&e.enableToolTip()):e[X]=T}return e},setImage:function($,c,E,K){var C=arguments.length;4===C?sf($,K,c,E):2===C?Ui(c)?sf($,c):Kq[$]=c:1===C&&sf($,$)},getImage:function(W,h,p){var d;if(W==j)return j;if(Hj(W)?d=W:(d=Kq[W],W&&d===L&&(be&&be[W]||sf(W,W))),h&&d&&d.tagName){var t;t="override"===p?"colors_override":"override_rgb"===p?"colors_override_rgb":"override_a"===p?"colors_override_a":"colors",d[t]||(d[t]={__count__:0});var n=d[t][h];return n||(d[t].__count__>V.imageCacheThreshold&&(d[t]={__count__:0}),n=Hr(d,Nq(h),d.width,d.height,p),d[t][h]=n,d[t].__count__++),n}return d},isImageComplete:function(h,q,c){var o=Hj(h)?h:Kq[h];if(!o)return!1;if(o.tagName)return o.complete;for(var i,h,d=o.comps,n=!0,Q=0,p=d.length;p>Q;Q++)if(i=d[Q],"image"===i.type){h=i.name,h&&h.func&&(h=Yg(h,q));var U=Cn(h,q,c);if(!U){n=!1;break}}return n},getId:function(){var W=1;return function(){return++W}}(),callLater:function(m,k,u,o){var q=function(){m.apply(k,u)};return o?M(q,o):A.requestAnimationFrame(q)},asyncEach:function(h,c,y){"function"!=typeof y&&(y=Function.prototype);var m=new Array(h.length),Y=0,z=!1;h.forEach(function(G,$){c(G,function(O,s){return z?void 0:O?(z=!0,y(null)):(m[$]=s,Y++,Y===h.length?y(m):void 0)})})},xhrLoad:function(s,G,t){var D=!1;ck(s)||(D=!0,s=[s]),t=t||{},s.length;var k=t.sync,d=!!t.post,y=t.data||null;uk(s,function(p,G){var F=new XMLHttpRequest;t.responseType?F.responseType=t.responseType:F.overrideMimeType&&F.overrideMimeType(t.mimeType||"text/plain"),p=V.beforeLoadURL(p),p.data?G(null,p.data):(F.open(d?"POST":"GET",encodeURI(p),!k),F.onload=function(h){200===this.status||0===this.status?G(null,h.target.response||h.target.responseText):G(!0)},F.onerror=function(){G(!0)},F.send(y))},function(p){"function"==typeof G&&G(D&&p?p[0]:p)})},clone:function(S){if(null==S||"object"!=typeof S)return S;if(S instanceof Date){var h=new Date;return h.setTime(S.getTime()),h}if(S instanceof Array){for(var h=[],Y=0,m=S.length;m>Y;Y++)h[Y]=Hm(S[Y]);return h}if(S instanceof rb){for(var h=new rb,Y=0,m=S.length;m>Y;Y++)h.set(Y,Hm(S.get(Y)));return h}if(S instanceof Yb)return S;if(S instanceof N){var h={};for(var Q in S)S.hasOwnProperty(Q)&&(h[Q]=Hm(S[Q]));return h}return S},callWhenLoaded:function(p,m){m=m||100;var j=Hp(p,m);Pe||(Pe={}),Pe[j]={tick:j,cb:p,delay:m}},beforeLoadURL:function(L){if(Pe){var W={};for(var X in Pe){var x=Pe[X];y(x.tick);var D=Hp(x.cb,x.delay);W[D]={tick:D,delay:x.delay,cb:x.cb}}Pe=W}return V.convertURL?V.convertURL(L):L},convertURL:function(d){return d},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){},sortFunc:function(k,H){if(k===H)return 0;if(k==j&&H!=j)return 1;if(k!=j&&H==j)return-1;if(k==j&&H==j)return 0;var W,B=typeof k,n=typeof H;return B===Mc&&n===Mc?W=k.localeCompare(H):B===Pm&&n===Pm&&(W=k-H),W===L&&(W=(""+k).localeCompare(""+H)),W>0?1:0>W?-1:0},getClassMap:function(){return dq},getClass:function(c){if(Ui(c)){var V,P=dq[c];if(!P){V=c.split("."),P=A;for(var $=0;$<V.length;$++)P=P[V[$]];dq[c]=P}return P}return c},def:function(l,v,m){var h,B,N,b=function(){};if(b.prototype=v.prototype,h=new b,Ui(l)){if(dq[l])throw"'"+l+"' already defined";N=yp(l),h.getClassName=function(){return l}}else N=l;if(h.constructor=N,h.getClass=function(){return N},h.getSuperClass=function(){return v},m)for(B in m)Rp[B]&&Rp.hasOwnProperty(B)?Rp[B](h,m):tq(h,m,B);N.prototype=h,N.superClass=v.prototype},startAnim:function(){var b=function(k){k.duration&&(k.startTime=Yk()),k.timeId=sc(k.tick,j,j,k.interval)};return function(x){return x=Hm(x),x.easing=x.easing||V.animEasing,x.duration||x.frames||(x.duration=V.animDuration),x.t=0,x.duration?x.interval=0:(x.frame=0,x.interval=x.interval||10),x.tick=function(){if(x.duration){var M=(Yk()-x.startTime)/x.duration;M>1&&(M=1),x.t=M,x.action(x.easing(M),M),1===M?x.stop():x._isPaused||(x.timeId=sc(x.tick))}else x.frame++,M=x.t=x.frame/x.frames,x.action(x.easing(M),M),x.frame<x.frames?x._isPaused||(x.timeId=sc(x.tick,j,j,x.interval)):x.stop()},x.resume=function(){x._isPaused&&(delete x._isPaused,x.duration?x.t<1&&(x.startTime=Yk()-x.duration*x.t,x.timeId=sc(x.tick)):x.frame<x.frames&&(x.timeId=sc(x.tick,j,j,x.interval)))},x.pause=function(){x._isPaused=!0},x.stop=function(b){x.isRunning()&&(x.duration?x.t<1&&b&&(x.t=1,x.action(x.easing(1))):x.frame<x.frames&&b&&(x.frame=x.frames,x.action(x.easing(1))),x._37o&&x._37o(),x.finishFunc&&x.finishFunc(),bp(x.timeId,!x.duration),delete x.timeId)},x.isRunning=function(){return x.timeId!=j},x.delay?sc(b,j,[x],x.delay):b(x),x}}(),getTextSize:function(){var C={},F=u?Ji().getContext("2d"):j;return function(s,D){F.font=s?s:Pq;var u=C[F.font];return u||(u=2*F.measureText("e").width+4,C[F.font]=u),{width:F.measureText(D).width+4,height:u}}}(),drawText:function(h,_,S,z,c,g,C,V,I,U){if(_!=j){var i=Ed(S,_),L={};L.y=U&&U!==cs?U===ni?g+i.height/2:g+V-i.height/2:g+V/2,L.x=I&&I!==ie?I===yh?c+C-i.width/2:c+C/2:c+i.width/2,mc(h,_,L,S,z)}},getDistance:function(i,Z){var _=i.length;return Z?3===_?n($(i[0]-Z[0])+$(i[1]-Z[1])+$(i[2]-Z[2])):2===_?n($(i[0]-Z[0])+$(i[1]-Z[1])):i.z===L?n($(Z.x-i.x)+$(Z.y-i.y)):n($(Z.x-i.x)+$(Z.y-i.y)+$(Z.z-i.z)):3===_?n($(i[0])+$(i[1])+$(i[2])):2===_?n($(i[0])+$(i[1])):void 0},brighter:function(l,q){return 0>q&&(q=-q),Pl(l,q?q:40)},darker:function(x,K){return K>0&&(K=-K),Pl(x,K?K:-40)},unionPoint:function(F,s){if(!F)return j;if(2===arguments.length)return F&&s?{x:K(F.x,s.x),y:K(F.y,s.y),width:r(F.x-s.x),height:r(F.y-s.y)}:j;var a=F;if(a._as&&(a=a._as),a.length===L)return j;var R=a.length;if(0>=R)return j;for(var _=1,Z=a[0],g={x:Z.x,y:Z.y,width:0,height:0};R>_;_++){Z=a[_];var m=K(g.x,Z.x),P=Y(g.x+g.width,Z.x),v=K(g.y,Z.y),b=Y(g.y+g.height,Z.y);g.x=m,g.y=v,g.width=P-m,g.height=b-v}return g},unionRect:function(F,H){if(F&&!H)return Hm(F);if(!F&&H)return Hm(H);if(F&&H){var U={x:K(F.x,H.x),y:K(F.y,H.y)};return U.width=Y(F.x+F.width,H.x+H.width)-U.x,U.height=Y(F.y+F.height,H.y+H.height)-U.y,U}return j},containsPoint:function(I,h,n,U){if(U!=j&&1!==U){var W=I.x+I.width/2,Y=I.y+I.height/2;I={x:W-I.width/2*U,y:Y-I.height/2*U,width:I.width*U,height:I.height*U}}if(n){var o=I.width/2,z=I.height/2,e=B(-n),E=v(-n),N=h.x-I.x-o,u=h.y-I.y-z;return h={x:E*N-e*u,y:e*N+E*u},rn({x:-o,y:-z,width:I.width,height:I.height},h)}return!(!I||h.x<I.x||h.y<I.y||h.x>I.x+I.width||h.y>I.y+I.height)},containsRect:function(l,q){if(!l||!q)return!1;var p=q.x,J=q.y,U=q.width,C=q.height,z=l.width,V=l.height;if(0>(z|V|U|C))return!1;var t=l.x,g=l.y;if(t>p||g>J)return!1;if(z+=t,U+=p,p>=U){if(z>=t||U>z)return!1}else if(z>=t&&U>z)return!1;if(V+=g,C+=J,J>=C){if(V>=g||C>V)return!1}else if(V>=g&&C>V)return!1;return!0},intersectsRect:function(v,F){if(!v||!F)return!1;var p=F.width,j=F.height,q=v.width,J=v.height;if(0>=q||0>=J||0>=p||0>=j)return!1;var W=F.x,K=F.y,u=v.x,B=v.y;return q+=u,J+=B,p+=W,j+=K,q>W&&J>K&&p>u&&j>B},intersection:function(K,R){if(!K||!R)return j;var N=R.x,k=R.y,Z=K.x,S=K.y,J=N,Q=k,C=Z,F=S;return J+=R.width,Q+=R.height,C+=K.width,F+=K.height,Z>N&&(N=Z),S>k&&(k=S),J>C&&(J=C),Q>F&&(Q=F),J-=N,Q-=k,0>=J||0>=Q?j:{x:N,y:k,width:J,height:Q}},grow:function(O,r,C){C===L&&(C=r),O.x-=r,O.y-=C,O.width=O.width+2*r,O.height=O.height+2*C},getLogicalPoint:function(y,s,I,v,P,g){var i,W,T=s.getBoundingClientRect();return y instanceof Event?(_o(y)?E?Po["91"]=!0:Po["17"]=!0:E?Po["91"]=!1:Po["17"]=!1,Po["16"]=Wh(y)?!0:!1,y=q?Nn(y):y,i=y.clientX,W=y.clientY):(i=y.x,W=y.y),{x:(i-T.left+s.scrollLeft-(I||0))/(P||1),y:(W-T.top+s.scrollTop-(v||0))/(g||1)}},removeHTML:function(){var R;return function(P){return P&&P.parentNode?R===P?!0:(R=P,P.parentNode.removeChild(P),R=j,!0):!1}}(),getToolTipDiv:function(){if(!ki){ki=Cc(),Ag=Cc();var h=ki.style;V.baseZIndex!=j&&(h.zIndex=c(V.baseZIndex)+3+""),h.whiteSpace="nowrap",h.color=V.toolTipLabelColor,h.background=V.toolTipBackground,h.font=V.toolTipLabelFont,h.padding="5px",h.boxShadow="0px 0px 3px "+V.toolTipShadowColor}return ki},isToolTipShowing:function(){return ki&&ki.parentNode?!0:Ag&&Ag.parentNode?!0:!1},hideToolTip:function(){er(ki),er(Ag),xd()},showToolTip:function(S,K){if(!S||K==j)return nd(),void 0;V.getToolTipDiv();var I,B;if(K.html?(K=K.html,I=Ag,er(ki)):(I=ki,er(Ag)),B=I.style,I.innerHTML=K,I.parentNode||e.Default.appendToScreen(I),S.target){S=Rk(S);var A=Ip(),Z=S.x,G=S.y,d=q?60:12;if(q){var T=I.getBoundingClientRect();B.left=Z-T.width/2+vc,B.top=G-T.height-d<A.top?G+d+vc:G-T.height-d+vc}else{B.left=Z+d+vc,B.top=G+d+vc;var T=I.getBoundingClientRect();T.left+T.width>A.width&&(B.left=Z-d-T.width+vc),T.top+T.height>A.height&&(B.top=G-d-T.height+vc),T.left<0&&(B.left=Z+d+vc),T.top<0&&(B.top=G+d+vc)}}else B.left=S.x+vc,B.top=S.y+vc;xd()},startDragging:function(O,k){O!==Tk&&(Tk?q?Tk.handleWindowTouchEnd(k):Tk.handleWindowMouseUp(k):q?(A.addEventListener(sh,Pp,!1),A.addEventListener(ur,vj,!1)):(A.addEventListener(kp,nf,!1),A.addEventListener(Uo,Nd,!1)),Tk=O)},getImageMap:function(){return Kq},toBoundaries:function(e,u,C,H){var S=[];return eo(e,u,C,H).forEach(function(z){var V=[];z.forEach(function(T){V.push(T.x,T.y)}),S.push(V)}),S},getCurrentKeyCodeMap:function(){return Po},drawCenterImage:function(g,P,k,J,G,r,b,D){var B=Fd(P,G,r),u=Xk(P,G,r);db(g,P,Z(k-B/2),Z(J-u/2),B,u,G,r,b,D)},drawStretchImage:function(c,V,U,Q,H,M,m,h,r,s,f,E){var b,w=Fd(V,h,r,M),$=Xk(V,h,r,m);if("uniform"===U?(b=K(M/w,m/$),w*=b,$*=b,Q+=Z((M-w)/2),H+=Z((m-$)/2),M=w,m=$):"centerUniform"===U&&((w>M||$>m)&&(b=K(M/w,m/$),w*=b,$*=b),Q+=Z((M-w)/2),H+=Z((m-$)/2),M=w,m=$),"center"===U){var j=f!==!1&&(w>M||$>m);j&&(c.save(),c.beginPath(),c.rect(Q,H,M,m),c.clip()),db(c,V,Q+M/2-w/2,H+m/2-$/2,w,$,h,r,s,E),j&&c.restore()}else db(c,V,Q,H,M,m,h,r,s,E)},toCanvas:function(g,m,I,b,t,r,l,Z,G){g=El(g,l),m=m||Fd(g,t),I=I||Xk(g,t);var w=Ji(),n=Vq(w);return Z?(zm(w,m,I,Z),n.scale(Z,Z)):zm(w,m,I,1),Dm(n,g,b,0,0,m,I,t,r,l,G),g&&g.clampToEdge&&(w.clampToEdge=g.clampToEdge),n.restore(),w
},createGradientImage:function(A,R,g,G){for(var T=["L",0,0,A,0,1,0,0,1,0,0],x=0,N=Math.min(R.length,g.length);N>x;x++)T.push(g[x],R[x]);var t=e.Default.toCanvas({width:A,height:A,clampToEdge:!0,comps:[{type:"shape",rotation:G||0,points:[0,0,A,0,A,A,0,A],background:"#ffffff",gradientPack:T}]});return t},createElement:function(i,T,h,m){var D=u.createElement(i);return gm(D,T||l.widgetBorder,2),D.style.font=h?h:Pq,m!=j&&(D.value=m),V.onElementCreated&&V.onElementCreated(D),D},containedInView:function(J,R){var p=Vg(R).getBoundingClientRect();return rn({x:p.left,y:p.top,width:p.width,height:p.height},Eq(J))},isIsolating:function(){return Mj},setIsolating:function(x){Mj=x},getMSMap:function(){return Rp},stringify:function(x,M){var _=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var m=JSON.stringify(x,function(_,J){return"function"==typeof J?"__ht__"+(J.__ht__||J.toString()):Gc(J)?yg(J):J},M==j?2:M);return Date.prototype.toJSON=_,m},parse:function(H){return Ui(H)?JSON.parse(H,function(k,l){if(Ui(l)){if("__ht__function"==l.substr(0,14)){var Z=l.indexOf("{")+1,S=l.lastIndexOf("}"),R=l.indexOf("(")+1,F=l.indexOf(")");if(Z&&S&&R&&F){var E=new Function(l.substring(R,F),l.substring(Z,S));return E.__ht__=l.substr(6),E}}if("__ht__date"==l.substr(0,10))return new Date(c(l.substr(10)))}return l}):H},loadJS:function(G,H){H&&G.push(H);var l=G.shift();if(ck(l))G=l.contact(G),V.loadJS(G);else if(Af(l))l(),V.loadJS(G);else if(Ui(l)){var D=u.createElement("script");D.onload=function(){V.loadJS(G)},D.setAttribute("src",l),u.getElementsByTagName("head")[0].appendChild(D)}else G.length&&V.loadJS(G)},toRoundedCorner:function(U,A){var h=U.size();if(0>=A)return{points:U};var x,y=new rb,g=new rb,p=U.get(0);y.add(p),g.add(1);for(var Z=1;h>Z;Z++)if(h>Z+1){var X=U.get(Z),m=U.get(Z+1),V=p.x,C=p.y,M=X.x,T=X.y,f=T-C,G=M-V,$=H(f,G);x=K(.99*aq(p,X),A),y.add({x:M-x*v($),y:T-x*B($)}),y.add(X),V=X.x,C=X.y,M=m.x,T=m.y,f=T-C,G=M-V,$=H(f,G),x=K(.99*aq(X,m),A),p={x:V+x*v($),y:C+x*B($)},y.add(p),g.addAll([2,3])}else y.add(U.get(Z)),g.add(2);return{points:y,segments:g}},toColorData:Ym,setCanvas:zm,createDiv:Cc,createDisabledDiv:Ap,createView:Ul,createCanvas:Ji,appendChild:Pi,initContext:Vq,checkLoadingImage:An,translateAndScale:Wl,layout:Db,getPosition:kd,drawPoints:Ch,drawRoundRect:ee,drawBorder:$h,setFocus:ch,getter:Li,setter:oi,isEmptyObject:ui},!0),_r(f,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var Up=V.disabledOpacity,mn=V.toolTipDelay,Yl=V.devicePixelRatio,mq=V.autoMakeVisible,lj=V.autoHideScrollBar,$c=V.imageGradient,kf=V.showToolTip,nd=V.hideToolTip,pb=V.dashPattern,mo=V.lineCap,jp=V.lineJoin,Ih=V.labelColor,Kc=V.labelSelectColor,Pq=V.labelFont,yo=V.widgetIndent,Zc=V.widgetRowHeight,gs=V.widgetHeaderHeight,Bs=V.widgetTitleHeight,qh=V.scrollBarColor,Ec=V.scrollBarSize,Mi=V.scrollBarTimeout,lk=V.scrollBarMinLength,bo=V.scrollBarInteractiveSize,af=V.zoomIncrement,ks=V.scrollZoomIncrement,sb=V.pinchZoomIncrement,ik=V.zoomMax,ho=V.zoomMin,gp=V.createObject,Bk=V.preventDefault,wn=V.setImage,El=V.getImage,Cn=V.isImageComplete,Rj=V.drawCenterImage,Dm=V.drawStretchImage,Kr=V.getId,sc=V.callLater,uk=V.asyncEach,Wg=(V.xhrLoad,V.sortFunc),Hm=V.clone,yp=V.getClass,Wd=V.startAnim,xs=V.brighter,Rf=V.darker,Wp=V.drawText,Ed=V.getTextSize,Wr=V.isLeftButton,js=V.getTouchCount,wo=V.isDoubleClick,Wh=V.isShiftDown,_o=V.isCtrlDown,Eq=V.getClientPoint,Rk=V.getPagePoint,aq=V.getDistance,jq=V.unionPoint,Ah=V.unionRect,rn=V.containsPoint,Qk=V.containsRect,Bh=V.intersectsRect,dk=V.intersection,Ip=V.getWindowInfo,ws=V.grow,yq=V.getLogicalPoint,Xo=V.startDragging,er=V.removeHTML,Ce=V.createElement,dc=V.segmentResolution,Xj=V.shapeResolution,cb=V.shapeSide,Oq=V.def,ok=function(f,U,b){Oq(w+"."+f,U,b)},zb=function(r,y){r.childNodes.forEach(function(t){y(t),zb(t,y)})};_r(V,{toolTipLabelColor:Ih,toolTipLabelFont:Pq,toolTipBackground:l.toolTipBackground,toolTipShadowColor:Pb,drawBreakableText:Ej,setDevicePixelRatio:function(v){Yl=V.devicePixelRatio="number"==typeof v?v:A.devicePixelRatio,zb(u.body,function(Y){var k=Y._ht;k&&k._canvas&&(zm(k._canvas,k.getWidth(),k.getHeight()),k.redraw?k.redraw():k.iv())})}},!0);var Ug=1e-6,tc="undefined"!=typeof Uint16Array?Uint16Array:Array,up="undefined"!=typeof Float32Array?Float32Array:Array,wr=function(Z,E,f){var y=[Z[0]-E[0],Z[1]-E[1],Z[2]-E[2]];if(f){var x=aq(y);x>0&&(y[0]/=x,y[1]/=x,y[2]/=x)}return y},Fk=function(I){return[-I[0],-I[1],-I[2]]},Fe=function(b,$){return 3===b.length?b[0]*$[0]+b[1]*$[1]+b[2]*$[2]:b[0]*$[0]+b[1]*$[1]},jo=function(){var L=new up(16);return L[0]=1,L[1]=0,L[2]=0,L[3]=0,L[4]=0,L[5]=1,L[6]=0,L[7]=0,L[8]=0,L[9]=0,L[10]=1,L[11]=0,L[12]=0,L[13]=0,L[14]=0,L[15]=1,L},Wq=jo(),Yd=function(R){var n=new up(16);return n[0]=R[0],n[1]=R[1],n[2]=R[2],n[3]=R[3],n[4]=R[4],n[5]=R[5],n[6]=R[6],n[7]=R[7],n[8]=R[8],n[9]=R[9],n[10]=R[10],n[11]=R[11],n[12]=R[12],n[13]=R[13],n[14]=R[14],n[15]=R[15],n},$o=function(C,y){return C[0]=y[0],C[1]=y[1],C[2]=y[2],C[3]=y[3],C[4]=y[4],C[5]=y[5],C[6]=y[6],C[7]=y[7],C[8]=y[8],C[9]=y[9],C[10]=y[10],C[11]=y[11],C[12]=y[12],C[13]=y[13],C[14]=y[14],C[15]=y[15],C},xf=function(R){return R[0]=1,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=1,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[10]=1,R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,R},De=function(R,F){var c=R[0],$=R[1],m=R[2];return R[0]=F[0]*c+F[4]*$+F[8]*m+F[12],R[1]=F[1]*c+F[5]*$+F[9]*m+F[13],R[2]=F[2]*c+F[6]*$+F[10]*m+F[14],R},pm=function(u,X){var L=u[0],s=u[1],B=u[2],F=u[3];return u[0]=X[0]*L+X[4]*s+X[8]*B+X[12]*F,u[1]=X[1]*L+X[5]*s+X[9]*B+X[13]*F,u[2]=X[2]*L+X[6]*s+X[10]*B+X[14]*F,u[3]=X[3]*L+X[7]*s+X[11]*B+X[15]*F,u},So=function(){var y,b,n,m,f=lr(Rg[1]+Rg[7]),e=lr(Rg[0]+Rg[3]-Rg[10]),h=lr(Rg[8]+2),E=function(){return b=n.charAt(y),y+=1,b},C=function(){var I="";if(b===h)for(;E();){if(b===h)return E(),I;I+=b}else E()},s=function(){for(;b&&" ">=b;)E()},p=function(){var Y,W={};if(b===f){if(E(),s(),b===e)return E(),W;for(;b;){if(Y=C(),s(),E(),W[Y]=m(),s(),b===e)return E(),W;E(),s()}}};return m=function(){switch(s(),b){case f:return p();default:return C()}},function(M){if(i={},M){var e;if(n=M,y=0,b=" ",e=m(),s(),!b)return e}}}(),yf=function(d,h){if(h){var G=B(h),C=v(h),i=d[4],p=d[5],n=d[6],_=d[7],V=d[8],K=d[9],L=d[10],T=d[11];d[4]=i*C+V*G,d[5]=p*C+K*G,d[6]=n*C+L*G,d[7]=_*C+T*G,d[8]=V*C-i*G,d[9]=K*C-p*G,d[10]=L*C-n*G,d[11]=T*C-_*G}},He=function(r,p){if(p){var R=B(p),f=v(p),$=r[0],x=r[1],P=r[2],V=r[3],_=r[8],F=r[9],u=r[10],k=r[11];r[0]=$*f-_*R,r[1]=x*f-F*R,r[2]=P*f-u*R,r[3]=V*f-k*R,r[8]=$*R+_*f,r[9]=x*R+F*f,r[10]=P*R+u*f,r[11]=V*R+k*f}},Ik=function(j,D){if(D){var h=B(D),n=v(D),f=j[0],S=j[1],L=j[2],k=j[3],p=j[4],E=j[5],q=j[6],w=j[7];j[0]=f*n+p*h,j[1]=S*n+E*h,j[2]=L*n+q*h,j[3]=k*n+w*h,j[4]=p*n-f*h,j[5]=E*n-S*h,j[6]=q*n-L*h,j[7]=w*n-k*h}},Hf=function(s,w,O){return jf(j,O===!1?j:s.getFinalScale3d(),s.r3(),s.getRotationMode(),s.p3(),j,w)},jf=function(W,d,y,E,n,Q,f){return Q||(Q=jo()),n&&ms(Q,n),Ur(Q,y,E),f&&bf(Q,Q,f),d&&wm(Q,d),W&&bf(Q,Q,W),Q},sd=function(W,p,I){p=c(p),I=c(I);var U=this;U.g=W,U._84O=p,U._85O=I,U._70I=!0,U.F=0,U._83O=p+I,U.pen={x:0,y:0}},bb="lineDashOffset",Jc="setLineDash",vs=function(G){for(var I in G)1===I.length&&(bb=G[I]);return I?1:0},so=function(u,e,Y){return Zi(e)?u:u[Jc]?(u[Jc](e),Y&&(u.lineDashOffset=Y),u):new sd(u,e[0],e.length>1?e[1]:e[0])},No=function(Y,s){!Zi(s)&&Y[Jc]&&(Y[Jc](th),Y.lineDashOffset=0)};if(Oq(sd,N,{_69I:6,moveTo:function(N,Z){var X=this,q=X.pen;q.x=N,q.y=Z,X.g.moveTo(N,Z),X.start||(X.start={x:N,y:Z})},lineTo:function(F,W){var f=this,n=f.pen,z=F-n.x,Z=W-n.y,y=H(Z,z),N=v(y),r=B(y),J=f._23O(n.x,n.y,F,W),V=f._85O,$=f._84O,w=f._83O;if(f.F){if(f.F>J)return f._70I?f._72I(F,W):f.moveTo(F,W),f.F-=J,void 0;if(f._70I?f._72I(n.x+N*f.F,n.y+r*f.F):f.moveTo(n.x+N*f.F,n.y+r*f.F),J-=f.F,f.F=0,f._70I=!f._70I,!J)return}var b=o(J/w);if(b){for(var S=N*$,X=r*$,p=N*V,K=r*V,g=0;b>g;g++)f._70I?(f._72I(n.x+S,n.y+X),f.moveTo(n.x+p,n.y+K)):(f.moveTo(n.x+p,n.y+K),f._72I(n.x+S,n.y+X));J-=w*b}f._70I?J>$?(f._72I(n.x+N*$,n.y+r*$),f.moveTo(F,W),f.F=V-(J-$),f._70I=!1):(f._72I(F,W),J===$?(f.F=0,f._70I=!f._70I):(f.F=$-J,f.moveTo(F,W))):J>V?(f.moveTo(n.x+N*V,n.y+r*V),f._72I(F,W),f.F=$-(J-V),f._70I=!0):(f.moveTo(F,W),J===V?(f.F=0,f._70I=!f._70I):f.F=V-J)},quadraticCurveTo:function(h,z,i,$){var Z,A=this,f=A.pen,g=f.x,M=f.y,Y=A._22O(g,M,h,z,i,$),N=0,x=0,V=A._85O,c=A._84O;if(A.F){if(A.F>Y)return A._70I?A._71I(h,z,i,$):A.moveTo(i,$),A.F-=Y,void 0;if(N=A.F/Y,Z=A._20O(g,M,h,z,i,$,N),A._70I?A._71I(Z[2],Z[3],Z[4],Z[5]):A.moveTo(Z[4],Z[5]),A.F=0,A._70I=!A._70I,!Y)return}var X=Y-Y*N,v=o(X/A._83O),t=c/Y,w=V/Y;if(v)for(var l=0;v>l;l++)A._70I?(x=N+t,Z=A._21O(g,M,h,z,i,$,N,x),A._71I(Z[2],Z[3],Z[4],Z[5]),N=x,x=N+w,Z=A._21O(g,M,h,z,i,$,N,x),A.moveTo(Z[4],Z[5])):(x=N+w,Z=A._21O(g,M,h,z,i,$,N,x),A.moveTo(Z[4],Z[5]),N=x,x=N+t,Z=A._21O(g,M,h,z,i,$,N,x),A._71I(Z[2],Z[3],Z[4],Z[5])),N=x;X=Y-Y*N,A._70I?X>c?(x=N+t,Z=A._21O(g,M,h,z,i,$,N,x),A._71I(Z[2],Z[3],Z[4],Z[5]),A.moveTo(i,$),A.F=V-(X-c),A._70I=!1):(Z=A._19O(g,M,h,z,i,$,N),A._71I(Z[2],Z[3],Z[4],Z[5]),Y===c?(A.F=0,A._70I=!A._70I):(A.F=c-X,A.moveTo(i,$))):X>V?(x=N+w,Z=A._21O(g,M,h,z,i,$,N,x),A.moveTo(Z[4],Z[5]),Z=A._19O(g,M,h,z,i,$,x),A._71I(Z[2],Z[3],Z[4],Z[5]),A.F=c-(X-V),A._70I=!0):(A.moveTo(i,$),X===V?(A.F=0,A._70I=!A._70I):A.F=V-X)},bezierCurveTo:function(){var p=arguments;this.pen={x:p[4],y:p[5]},this.g.bezierCurveTo(p[0],p[1],p[2],p[3],p[4],p[5])},arc:function(H,Y,h,G,R,$){$||(G=-G,R=-R),Nh(this,H,Y,G,R-G,h,h,!1)},rect:function(s,e,I,F){var n=this;n.pen={x:s,y:e},n.moveTo(s,e),n.lineTo(s,e+F),n.lineTo(s+I,e+F),n.lineTo(s+I,e),n.lineTo(s,e)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(N,c,g,o){var f=g-N,w=o-c;return n(f*f+w*w)},_22O:function(b,Y,i,S,j,d,m){for(var z,h,P,U,s,t,y,p=0,G=b,M=Y,F=m>0?m:this._69I,e=1;F>=e;e++)P=e/F,U=1-P,s=U*U,t=2*P*U,y=P*P,z=s*b+t*i+y*j,h=s*Y+t*S+y*d,p+=this._23O(G,M,z,h),G=z,M=h;return p},_21O:function(X,r,P,m,g,Z,f,M){var F=this;if(0===f)return F._20O(X,r,P,m,g,Z,M);if(1===M)return F._19O(X,r,P,m,g,Z,f);var C=F._20O(X,r,P,m,g,Z,M);return C.push(f/M),F._19O.apply(F,C)},_20O:function(F,K,u,G,h,N,Z){if(1!==Z){var C=u+(h-u)*Z,P=G+(N-G)*Z;u=F+(u-F)*Z,G=K+(G-K)*Z,h=u+(C-u)*Z,N=G+(P-G)*Z}return[F,K,u,G,h,N]},_19O:function(D,y,v,e,I,E,o){if(1!==o){var P=D+(v-D)*o,T=y+(e-y)*o;v+=(I-v)*o,e+=(E-e)*o,D=P+(v-P)*o,y=T+(e-T)*o}return[D,y,v,e,I,E]},_72I:function(G,w){var H=this.pen;(G!==H.x||w!==H.y)&&(H.x=G,H.y=w,this.g.lineTo(G,w))},_71I:function(i,q,L,r){var n=this.pen;(i!==L||q!==r||L!==n.x||r!==n.y)&&(n.x=L,n.y=r,this.g.quadraticCurveTo(i,q,L,r))}}),g&&J){var lp=J.toString();T=lp.indexOf(am.substr(0,2))>0&&lp.indexOf(ni+ni.substr(1,1))>1?!0:!1}var ph=j,to=j,qk=function(n){ph&&!n._72O&&(to||(to={}),to[n._72O=Kr()]=n)},Xg=function(C,L){if(L||(L=C),L&&(ph||(ph={}),!ph[C])){var U=new XMLHttpRequest;if(ph[L]={request:U,url:L},U.overrideMimeType&&U.overrideMimeType("text/plain"),L=V.beforeLoadURL(L),L.data){var R=V.parse(L.data);Il(C,R),V.handleCompTypeLoaded(C,R)}else U.open("GET",encodeURI(L),!0),U.onload=function(U){if(200===this.status||0===this.status){var m=V.parse(U.target.response||U.target.responseText);Il(C,m),V.handleCompTypeLoaded(C,m)}else Il(C,j)},U.onerror=function(){Il(C,j)},U.send(null)}},Il=function(u,O){if(Ci[u]=O,delete ph[u],ui(ph)&&(ph=j,to)){for(var i in to){var y=to[i];y.invalidateAll&&y.invalidateAll(L,"compTypeLoaded",u),y.redraw&&y.redraw(),y.iv(),delete y._72O}to=j}if(O&&to)for(var i in to){var y=to[i];y.invalidateAll&&y.invalidateAll(L,"compTypeLoading",u),y.redraw&&y.redraw(),y.iv()}},Vp=l.chart,Dg=V.compStack=[],Ql=/^style@/,pp=/^attr@/,xn=/^field@/,wb={x:.5,y:.5},Fd=function(h,Y,v,u){if(!h)return 0;if(Yg(h.fitSize,Y,v)&&u)return u;var Q=Yg(h.width,Y,v);return null==Q?20:Q},Xk=function(m,G,b,u){if(!m)return 0;if(Yg(m.fitSize,G,b)&&u)return u;var o=Yg(m.height,G,b);return null==o?20:o},Yg=function(h,z,w){if(!h||!h.func)return h;var k,v=h.func,u=h.value;return k=Af(v)?w&&w.vectorDataBindingDisabled&&!h.isSafeFunc?u:v(z,w):z instanceof Yb?pp.test(v)?z.a(v.slice(5)):Ql.test(v)?z.s(v.slice(6)):xn.test(v)?z[v.slice(6)]:z[v]?z[v](w):u:u,u!==L&&k==j?u:k},db=V.drawImage=function(){var A,C,b,y,S,z,g=function(n,h){n.getValue&&n.getValue.compType===h||(n.getValue=function(Z){var c=F(n,Z);if(c===L&&h.properties){var q=h.properties[Z];q&&(c=q.defaultValue)}return c},n.getValue.compType=h)},F=function(o,P,w){var A=o[P];return A&&A.func?(A=Yg(A,C,b),w&&(A=w(A))):w&&(A=o[P]=w(A)),A},u=function(w,$){var G;if(G=$?F(w,$):w,S&&G){if("override"===z)return S;if("override_rgb"===z){var n=Nq(S);return G=Ym(G),"rgba("+o(255*n[0])+","+o(255*n[1])+","+o(255*n[2])+","+G[3]/255+")"}if("override_a"===z){var n=Nq(S);return G=Ym(G),"rgba("+G[0]+","+G[1]+","+G[2]+","+n[3]+")"}var n=Nq(S);return G=Ym(G),"rgba("+o(G[0]*n[0])+","+o(G[1]*n[1])+","+o(G[2]*n[2])+","+G[3]/255*n[3]+")"}return G},s=function(o){if(ck(o)){for(var t=new rb,L=o.length,I=0;L>I;I+=2)t.add({x:o[I],y:o[I+1]});o=t}return o},f=function(e){var X=F(e,"anchorX"),U=F(e,"anchorY");if(X!==L||U!==L)return{x:X===L?wb.x:X,y:U===L?wb.y:U};var p=F(e,"type"),P=F(e,"name");if("image"!==p||!P)return wb;var n=El(P);return n&&n.anchorX&&n.anchorY?{x:n.anchorX,y:n.anchorY}:wb},t=function(n,$){var v=F(n,Iq),M=f(n);if(ck(v)){var c=v.length,H=F(n,"relative"),U=$.width,x=$.height;if(4===c)v={x:v[0],y:v[1],width:v[2],height:v[3]},H?(v.x*=U,v.y*=x,v.width*=U,v.height*=x):$.fitSize&&(v.x*=$.widthScale,v.width*=$.widthScale,v.y*=$.heightScale,v.height*=$.heightScale);else if(3===c){var E=v[0];v={width:v[1],height:v[2]},H?(v.width*=U,v.height*=x):$.fitSize&&(v.width*=$.widthScale,v.height*=$.heightScale),"object"==typeof E?E.length&&(E={x:E[0],y:E[1]}):E=kd(E,$,v),v.x=E.x-v.width*M.x,v.y=E.y-v.height*M.y}var B=F(n,"offsetX");B&&($.fitSize&&(B*=$.widthScale),v.x+=B),B=F(n,"offsetY"),B&&($.fitSize&&(B*=$.heightScale),v.y+=B)}return v},p=function(q){return ck(q)?new rb(q):q},w=function(U,u,z,S,v,K,a){v===L&&(v=1),K===L&&(K=1);var i=F(U,"clipPercentage"),g=li(z,u);if(g&&!S&&1===v&&1===K&&!(1>i))return!1;a=a||wb;var H=u.x+u.width*a.x,w=u.y+u.height*a.y,$=z.x+z.width*a.x,m=z.y+z.height*a.y;if(A.save(),Lh(A,H,w),Xe(A,S),ko(A,v*(u.width/z.width),K*(u.height/z.height)),Lh(A,-$,-m),1>i){0>i&&(i=0);var o=Kl(z,F(U,"clipDirection"),i);A.beginPath(),A.rect(o.x,o.y,o.width,o.height),A.clip()}return!0},x=function(){A.restore()},X=function(K,Z,N){var d=F(K,"path"),Y=F(K,ps),E=F(K,"scaleX"),k=F(K,"scaleY"),D=f(K),s=j,P=$k(null,d);if(N||(N=K.unionRect,N||(N=jq(P),K.path.func||(K.unionRect=N)),s=N),N){s||(s=K.unionRect,s||(s=jq(P),K.path.func||(K.unionRect=s)));var L=w(K,N,s,Y,E,k,D),C=F(K,"borderPattern"),T=so(A,C),U=u(K,"background"),W=u(K,"borderColor"),R=F(K,"borderWidth"),B=F(K,"gradient"),m=u(K,"gradientColor"),h=F(K,"border3d"),_=F(K,"border3dColor"),J=F(K,"border3dAccuracy"),o=A.lineJoin,r=A.lineCap;if(A.lineJoin=F(K,"borderJoin")||jp,A.lineCap=F(K,"borderCap")||mo,U?(Gf(A,U,B,m,s),$k(A,d),A.fill(),T!==A&&$k(A,d)):$k(A,d),R&&W){var V=F(K,"borderWidthAbsolute");V&&(A.save(),A.setTransform(1,0,0,1,0,0)),A.lineWidth=R,A.strokeStyle=W,A.stroke(),V&&A.restore(),h&&oo(A,W,_,R,y,J)}if(No(A,C),F(K,"dash")){var v=F(K,"dashWidth")||R;if(v>0){C=F(K,"dashPattern")||pb;var T=so(A,C,F(K,"dashOffset")),S=u(K,"dashColor")||u(Di);T!==A&&$k(A,d),A.strokeStyle=S,A.lineWidth=v,A.stroke(),F(K,"dash3d")&&oo(A,S,u(K,"dash3dColor"),v,y,F(K,"dash3dAccuracy")),No(A,C)}}Z===Iq&&yj(A,U,F(K,"depth"),s),A.lineJoin=o,A.lineCap=r,L&&x()}},T=function(X,h,i,l){var U=F(X,ag,s),Z=F(X,ps),n=f(X);if(U&&l.fitSize){var $=Math.abs(Math.cos(Z))<.001,Q=new rb,Y=jq(U),M=l.widthScale,R=l.heightScale,t=Y.x+n.x*Y.width,V=Y.y+n.y*Y.height,k=t*M,G=V*R;U.each(function(p){var o=p.x-t,u=p.y-V;Q.add({x:k+o*($?R:M),y:G+u*($?M:R)})}),U=Q,X.unionRect=null}var I=F(X,"scaleX"),a=F(X,"scaleY"),O=h===Lo,e=j;if(!i&&O&&(i=X.unionRect,i||(i=jq(U),X.points.func||(X.unionRect=i)),e=i),i){O?e||(e=X.unionRect,e||(e=jq(U),X.points.func||(X.unionRect=e))):e=i;var _,D,B,r,d=w(X,i,e,Z,I,a,n),L=F(X,"borderPattern"),N=so(A,L),q=u(X,"background"),T=El(F(X,"repeatImage"),S,z),H=F(X,"gradientPack"),K=u(X,"borderColor"),o=F(X,"borderWidth"),g=F(X,"segments",p),P=F(X,"gradient"),E=u(X,"gradientColor"),J=F(X,"border3d"),W=F(X,"border3dColor"),m=F(X,"border3dAccuracy"),v=F(X,"closePath"),c=F(X,"fillRule")||"nonzero",$m=A.lineJoin,fd=A.lineCap;if(A.lineJoin=F(X,"borderJoin")||jp,A.lineCap=F(X,"borderCap")||mo,O)if(q||T||H){var fc=F(X,"fillClipPercentage");if(1>fc){0>fc&&(fc=0);var Dg=Kl(e,F(X,"fillClipDirection"),fc);A.save(),A.beginPath(),A.rect(Dg.x,Dg.y,Dg.width,Dg.height),A.clip()}if(Ch(A,U,g,v),H)Fg(A,H);else if(T){var Je=A,Df=S,Jq=z;fl(A,T,S,z,C,b),A=Je,S=Df,z=Jq}else{var Je=A;Gf(A,q,P,E,e),A=Je}A.fill(c),1>fc&&A.restore(),H&&A.restore(),N!==A&&Ch(N,U,g,v)}else Ch(N,U,g,v);else if("roundRect"===h?_=F(X,"cornerRadius"):"polygon"===h?_=F(X,"polygonSide"):"arc"===h&&(_=F(X,"arcFrom"),D=F(X,"arcTo"),B=F(X,"arcClose"),r=F(X,"arcOval")),q||T||H){var fc=F(X,"fillClipPercentage");if(1>fc){0>fc&&(fc=0);var Dg=Kl(e,F(X,"fillClipDirection"),fc);A.save(),A.beginPath(),A.rect(Dg.x,Dg.y,Dg.width,Dg.height),A.clip()}if(fi(A,h,e,_,D,B,r),H)Fg(A,H);else if(T){var Je=A,Df=S,Jq=z;fl(A,T,S,z,C,b),A=Je,S=Df,z=Jq}else Gf(A,q,P,E,e);A.fill(c),1>fc&&A.restore(),H&&A.restore(),A!==N&&fi(N,h,e,_,D,B,r)}else fi(N,h,e,_,D,B,r);if(o&&K){var Uj=F(X,"borderWidthAbsolute");Uj&&(A.save(),A.setTransform(1,0,0,1,0,0)),A.lineWidth=o,A.strokeStyle=K,A.stroke(),Uj&&A.restore(),J&&oo(A,K,W,o,y,m)}if(No(A,L),F(X,"dash")){var nr=F(X,"dashWidth")||o;if(nr>0){L=F(X,"dashPattern")||pb;var N=so(A,L,F(X,"dashOffset")),Um=u(X,"dashColor")||u(Di);N!==A&&(O?Ch(N,U,g,v):fi(N,h,e,_,D,B,r)),A.strokeStyle=Um,A.lineWidth=nr,A.stroke(),F(X,"dash3d")&&oo(A,Um,u(X,"dash3dColor"),nr,y,F(X,"dash3dAccuracy")),No(A,L)}}h===Iq&&yj(A,q,F(X,"depth"),e),A.lineJoin=$m,A.lineCap=fd,d&&x()}},i=function(O,o){var q=S,N=z,w=S||F(O,Pk),W=z||F(O,"blendMode"),H=El(F(O,"name"),w,W);H&&(Dm(A,H,F(O,"stretch"),o.x,o.y,o.width,o.height,C,b,w,null,W),S=q,z=N)},m=function(v,n){var S=F(v,"text");S!=j&&Wp(A,S,F(v,"font"),u(v,Pk),n.x,n.y,n.width,n.height,F(v,"align"),F(v,"vAlign"))},W=function(L,m){$h(A,u(L,Pk),m.x,m.y,m.width,m.height,F(L,"width"))},Q=function(g,y){var l=F(g,rd),i=0;if(l&&(l.forEach(function(p){i+=p}),i>0)){for(var I=F(g,"colors")||Vp,e=F(g,"startAngle")||0,P=F(g,"hollow"),$=F(g,Np),S=F(g,Cf),Z=F(g,Om),c=$?new rb:j,X=y.x,J=y.y,O=y.width,k=y.height,a=X+O/2,Q=J+k/2,x=K(O,k)/2,L=0,R=0;R<l.length;R++){var H=l[R],T=h*H/i,N=e+T;if(A.fillStyle=I[L++],L===I.length&&(L=0),A.beginPath(),P){var n=a+v(e)*x/2,U=Q+B(e)*x/2,m=a+v(N)*x,f=Q+B(N)*x;A.moveTo(n,U),A.arc(a,Q,x/2,e,N,!1),A.lineTo(m,f),A.arc(a,Q,x,N,e,!0)}else A.moveTo(a,Q),A.arc(a,Q,x,N,e,!0);c&&(T=(e+N)/2,c.add({text:Af($)?$(H,R,i,C):H,x:a+.75*v(T)*x,y:Q+.75*B(T)*x})),A.closePath(),A.fill(),e=N}c&&c.each(function(n){Wp(A,n.text,S,Z,n.x,n.y,0,0,qp)})}},d=function(M,h){var v=F(M,ci);if(v&&v.length>0){var H=v.length,E=F(M,Np),U=F(M,Cf),l=F(M,Om),d=E?new rb:j,u=F(M,"minValue")||0,I=F(M,"maxValue");if(I==j&&(I=0,v.forEach(function(N){N.values.forEach(function(n){I=Y(I,n)})})),u===I)return;for(var t=h.height/(I-u),D=h.y+I*t,p=F(v[0],rd).length,o=h.width/(3*p+1),X=2*o/H,m=0,T=0;H>T;T++)for(var f=v[T],B=F(f,Pk),k=F(f,"colors"),R=F(f,rd),G=0;p>G;G++){k?A.fillStyle=k[G]:B?A.fillStyle=B:(A.fillStyle=Vp[m++],m===Vp.length&&(m=0));var W=R[G],x=W*t,c=h.x+(1+3*G)*o+T*X;if(Yp(A,c,D-x,X,x),d){var w=Af(E)?E(W,G,f,C):W,J=Ed(U,w).height;d.add({x:c,y:D-x-J,width:X,height:J,text:w})}}d&&d.each(function($){Wp(A,$.text,U,l,$.x,$.y,$.width,$.height,qp)})}},n=function($,L){var O=F($,ci);if(O&&O.length>0){var E=O.length,Q=F(O[0],rd).length,m=L.width/(3*Q+1),e=0,Z=F($,"maxValue"),V=F($,Np),I=F($,Cf),D=F($,Om),N=V?new rb:j;if(Z==j){Z=0;for(var B=0;Q>B;B++){for(var S=0,y=0;E>y;y++)S+=F(O[y],rd)[B];Z=Y(Z,S)}}if(Z>0){for(var B=0;Q>B;B++)for(var J=L.y+L.height,y=0;E>y;y++){var T=O[y],t=F(T,Pk),W=F(T,rd)[B],q=W/Z*L.height;t?A.fillStyle=t:(A.fillStyle=Vp[e++],e===Vp.length&&(e=0)),J-=q;var p={x:L.x+(1+3*B)*m,y:J,width:2*m,height:q};Yp(A,p.x,p.y,p.width,p.height),N&&(p.text=Af(V)?V(W,B,T,C):W,N.add(p))}N&&N.each(function(E){Wp(A,E.text,I,D,E.x,E.y,E.width,E.height,qp)})}}},r=function(e,U){var z=F(e,ci);if(z&&z.length>0){for(var p=z.length,o=F(z[0],rd).length,l=U.width/(3*o+1),Z=0,G=F(e,Np),J=F(e,Cf),E=F(e,Om),L=G?new rb:j,W=0;o>W;W++){for(var B=0,r=0;p>r;r++)B+=F(z[r],rd)[W];if(B>0){var Y=U.y+U.height;for(r=0;p>r;r++){var V=z[r],i=F(V,Pk),w=F(V,rd)[W],d=w/B*U.height;i?A.fillStyle=i:(A.fillStyle=Vp[Z++],Z===Vp.length&&(Z=0)),Y-=d;var $={x:U.x+(1+3*W)*l,y:Y,width:2*l,height:d};Yp(A,$.x,$.y,$.width,$.height),L&&($.text=Af(G)?G(w,W,V,C):w,L.add($))}}}L&&L.each(function(u){Wp(A,u.text,J,E,u.x,u.y,u.width,u.height,qp)})}},P=function(X,R){var U=F(X,ci);if(U&&U.length>0){var w=U.length,e=F(X,"minValue")||0,k=F(X,"maxValue");if(k==j&&(k=0,U.forEach(function(F){F.values.forEach(function(r){k=Y(k,r)})})),e===k)return;for(var J=R.height/(k-e),s=R.y+k*J,o=F(U[0],rd).length,a=R.width/(3*o+1),f=0,i=F(X,"lineWidth")||2,v=F(X,"line3d"),$=F(X,"linePoint"),d=F(X,Np),S=F(X,Cf),n=F(X,Om),Q=0;w>Q;Q++){var N=U[Q],D=F(N,Pk),H=F(N,rd);D?A.strokeStyle=D:(D=A.strokeStyle=Vp[f++],f===Vp.length&&(f=0)),A.beginPath();for(var M=0;o>M;M++){var z=R.x+(2+3*M)*a,B=s-H[M]*J;0===M?A.moveTo(z,B):A.lineTo(z,B)}if(A.lineWidth=i,A.stroke(),v&&oo(A,D,j,i,y),$||d){var l,g=i/2+2;for(M=0;o>M;M++){var O=H[M];if(z=R.x+(2+3*M)*a,B=s-O*J,Af($)?$(A,z,B,D,M,N,C):$&&(A.fillStyle=D,A.beginPath(),A.arc(z,B,g,0,h,!0),A.fill()),Af(d)?l=d(O,M,N,C):d&&(l=O),l){var E=Ed(S,l).height,T=A.shadowBlur;if(T){var V=A.shadowOffsetX,L=A.shadowOffsetY,t=A.shadowColor;A.shadowOffsetX=0,A.shadowOffsetY=0,A.shadowBlur=0,A.shadowColor=j}Wp(A,l,S,n,z,B-E-g+2,0,E,qp),T&&(A.shadowOffsetX=V,A.shadowOffsetY=L,A.shadowBlur=T,A.shadowColor=t)}}}}}},N={border:W,image:i,text:m,pieChart:Q,columnChart:d,stackedColumnChart:n,percentageColumnChart:r,lineChart:P};return function(v,_,h,O,J,m,i,M,K,B){if(_&&J&&m){A=v,C=i,b=M,y=b?b._zoom?b._zoom:1:1,S=K,z=B;var k=J,H=m;if(ye()){var U,d,e;0===A[Zp]?ye[0]&&(U=!0):U=!0,A.texureImage2D?ye[1]&&(d=!0):d=!0,A.texureImage3D?ye[2]&&(e=!0):e=!0,U&&d&&e&&(k=h,H=O)}if(_.tagName)return A.drawImage(_,k,H,J,m),void 0;if(F(_,"visible")!==!1){S||(S=Yg(_.color,C,b)),B||(z=Yg(_.blendMode,C,b));var a=Fd(_,C,b,J),Y=Xk(_,C,b,m),q={x:0,y:0,width:a,height:Y,fitSize:F(_,"fitSize")},P=F(_,"clip"),n=F(_,"opacity");q.fitSize&&(q.widthScale=a/Yg(_.width,C,b),q.heightScale=Y/Yg(_.height,C,b)),A.save(),Lh(A,k,H),(a!==J||Y!==m)&&A.scale(J/a,m/Y),P&&(Af(P)?P(A,a,Y,C,b,_):(A.beginPath(),A.rect(0,0,a,Y),A.clip())),n!=j&&(A.globalAlpha*=n),F(_,"comps").forEach(function(P){if(F(P,Gr)!==!1){Dg.splice(0,0,P);var G=F(P,"opacity"),S=F(P,"shadow"),k=F(P,"type"),v=t(P,q);if(G!=j){var B=A.globalAlpha;A.globalAlpha*=G}if(S){var r=A.shadowOffsetX,J=A.shadowOffsetY,c=A.shadowBlur,M=A.shadowColor,E=F(P,"shadowOffsetX"),W=F(P,"shadowOffsetY"),$=F(P,"shadowBlur"),D=u(P,"shadowColor");A.shadowOffsetX=(E==j?3:E)*y,A.shadowOffsetY=(W==j?3:W)*y,A.shadowBlur=($==j?6:$)*y,A.shadowColor=D||u(Pb)}if("save"===k)A.save();else if("endClip"===k||"restore"===k)A.restore();else if("clip"===k)A.save(),Ch(A,F(P,"points",s),F(P,"segments",p),!0),A.clip();else if(ge[k])v=v||{x:0,y:0,width:q.width,height:q.height},T(P,k,v,q);else if(k===Lo)T(P,k,v,q);else if("SVGPath"===k)X(P,k,v);else{v=v||{x:0,y:0,width:q.width,height:q.height};var K=F(P,ps),h=F(P,"scaleX"),Q=F(P,"scaleY"),R=f(P),U=w(P,v,v,K,h,Q,R);if(Af(k))g(P,k),V.drawCompType(k,A,v,P,C,b);else if(V.getCompType(k)){var m=V.getCompType(k),o=m.func||m;g(P,m),V.drawCompType(o,A,v,P,C,b)}else N[k]?N[k](P,v):V.getCompType(k)===L&&Dr.test(k)&&Xg(k);U&&x()}S&&(A.shadowOffsetX=r,A.shadowOffsetY=J,A.shadowBlur=c,A.shadowColor=M),G!=j&&(A.globalAlpha=B),Dg.splice(0,1)}}),A.restore()}}}}();V.getCurrentComp=function(){return Dg[0]},V.getParentComp=function(){return Dg[1]},V.getInternal=function(){return{isEnter:qc,isEsc:bh,isSpace:kh,isLeft:Dj,isUp:Pf,isRight:hh,isDown:Rc,addMethod:_r,superCall:em,toPointsArray:eo,translateAndScale:Wl,appendArray:zr,createWorldMatrix:jf,vec3TransformMat4:De,setCanvas:zm,createDiv:Cc,createView:Ul,createCanvas:Ji,createImage:hq,initContext:Vq,layout:Db,fillRect:Yp,Mat:rc,drawBorder:$h,isString:Ui,setBorder:gm,getPropertyValue:pn,setPropertyValue:ib,drawVerticalLine:Wm,draw3DRect:yj,getPinchDist:Hq,isSameRect:li,getPosition:kd,intersectionLineRect:Pj,getNodeRect:Bd,getEdgeAgentPosition:_h,getImageWidth:Fd,getImageHeight:Xk,initItemElement:tr,drawPoints:Ch,createG2:so,closePopup:$f,isH:Zk,createAnim:aj,createNormalMatrix:gd,createNormals:hd,toFloatArray:Vh,glMV:hk,batchShape:_b,createNodeMatrix:Hf,getFaceInfo:gh,transformAppend:Ko,drawFaceInfo:ul,to3dPointsArray:te,setGLDebugMode:function(Z){Cs=Z},cube:function(){return{vs:_d,is:Lf,uv:gg}},ui:function(){return{DataUI:cp,NodeUI:Mk,EdgeUI:Rl,GroupUI:dj,ShapeUI:Gp,GridUI:vq,Data3dUI:Nc,Node3dUI:rh,Shape3dUI:ih}},getInternalVersion:function(){return"U2FsdGVkX18Z2SuqsOlr7xDIp6Mcf8c3KlBuvSeHt4U="},getDragger:function(){return Tk},addMSMap:function(m){_r(Rp,m)},k:W}},function(I){function M(m,L){m!=j&&(L==j&&Mc!=typeof m?this._54O(m,256):this._54O(m,L))}function L(){return new M(j)}function T(e,C,F,w,d,r){for(;--r>=0;){var l=C*this[e++]+F[w]+d;d=o(l/67108864),F[w++]=67108863&l}return d}function d(Q,p,n,$,K,M){for(var e=32767&p,N=p>>15;--M>=0;){var q=32767&this[Q],B=this[Q++]>>15,f=N*q+B*e;q=e*q+((32767&f)<<15)+n[$]+(1073741823&K),K=(q>>>30)+(f>>>15)+N*B+(K>>>30),n[$++]=1073741823&q}return K}function f(Z,k,t,N,f,s){for(var m=16383&k,O=k>>14;--s>=0;){var _=16383&this[Z],y=this[Z++]>>14,p=O*_+y*m;_=m*_+((16383&p)<<14)+t[N]+f,f=(_>>28)+(p>>14)+O*y,t[N++]=268435455&_}return f}function m(b){return rd.charAt(b)}function H(d,$){var l=oc[d.charCodeAt($)];return l==j?-1:l}function S(O){for(var G=this.t-1;G>=0;--G)O[G]=this[G];O.t=this.t,O.s=this.s}function P(F){this.t=1,this.s=0>F?-1:0,F>0?this[0]=F:-1>F?this[0]=F+this.DV:this.t=0}function a(O){var C=L();return C._58O(O),C}function u(u,$){var K,t=this;if(16==$)K=4;else if(8==$)K=3;else if(256==$)K=8;else if(2==$)K=1;else if(32==$)K=5;else{if(4!=$)return t.fromRadix(u,$),void 0;K=2}t.t=0,t.s=0;for(var z=u.length,Q=!1,N=0;--z>=0;){var g=8==K?255&u[z]:H(u,z);0>g?"-"==u.charAt(z)&&(Q=!0):(Q=!1,0==N?t[t.t++]=g:N+K>t.DB?(t[t.t-1]|=(g&(1<<t.DB-N)-1)<<N,t[t.t++]=g>>t.DB-N):t[t.t-1]|=g<<N,N+=K,N>=t.DB&&(N-=t.DB))}8==K&&0!=(128&u[0])&&(t.s=-1,N>0&&(t[t.t-1]|=(1<<t.DB-N)-1<<N)),t._57O(),Q&&M.ZERO._78O(t,t)}function p(){for(var D=this,J=D.s&D.DM;D.t>0&&D[D.t-1]==J;)--D.t}function t(d){var f=this;if(f.s<0)return"-"+f._85O()[Mq](d);var S;if(16==d)S=4;else if(8==d)S=3;else if(2==d)S=1;else if(32==d)S=5;else{if(4!=d)return f.toRadix(d);S=2}var O,C=(1<<S)-1,Y=!1,p="",F=f.t,X=f.DB-F*f.DB%S;if(F-->0)for(X<f.DB&&(O=f[F]>>X)>0&&(Y=!0,p=m(O));F>=0;)S>X?(O=(f[F]&(1<<X)-1)<<S-X,O|=f[--F]>>(X+=f.DB-S)):(O=f[F]>>(X-=S)&C,0>=X&&(X+=f.DB,--F)),O>0&&(Y=!0),Y&&(p+=m(O));return Y?p:"0"}function Q(){var n=L();return M.ZERO._78O(this,n),n}function X(){return this.s<0?this._85O():this}function i(l){var G=this,q=G.s-l.s;if(0!=q)return q;var O=G.t;if(q=O-l.t,0!=q)return G.s<0?-q:q;for(;--O>=0;)if(0!=(q=G[O]-l[O]))return q;return 0}function E(j){var D,C=1;return 0!=(D=j>>>16)&&(j=D,C+=16),0!=(D=j>>8)&&(j=D,C+=8),0!=(D=j>>4)&&(j=D,C+=4),0!=(D=j>>2)&&(j=D,C+=2),0!=(D=j>>1)&&(j=D,C+=1),C}function G(){var W=this;return W.t<=0?0:W.DB*(W.t-1)+E(W[W.t-1]^W.s&W.DM)}function F(b,P){var r;for(r=this.t-1;r>=0;--r)P[r+b]=this[r];for(r=b-1;r>=0;--r)P[r]=0;P.t=this.t+b,P.s=this.s}function O(H,M){for(var P=H;P<this.t;++P)M[P-H]=this[P];M.t=Y(this.t-H,0),M.s=this.s}function r(X,b){var C,Z=this,O=X%Z.DB,M=Z.DB-O,y=(1<<M)-1,Q=o(X/Z.DB),s=Z.s<<O&Z.DM;for(C=Z.t-1;C>=0;--C)b[C+Q+1]=Z[C]>>M|s,s=(Z[C]&y)<<O;for(C=Q-1;C>=0;--C)b[C]=0;b[Q]=s,b.t=Z.t+Q+1,b.s=Z.s,b._57O()}function y(T,D){var k=this;D.s=k.s;var B=o(T/k.DB);if(B>=k.t)return D.t=0,void 0;var i=T%k.DB,E=k.DB-i,h=(1<<i)-1;D[0]=k[B]>>i;for(var P=B+1;P<k.t;++P)D[P-B-1]|=(k[P]&h)<<E,D[P-B]=k[P]>>i;i>0&&(D[k.t-B-1]|=(k.s&h)<<E),D.t=k.t-B,D._57O()}function q(l,P){for(var $=this,B=0,T=0,o=K(l.t,$.t);o>B;)T+=$[B]-l[B],P[B++]=T&$.DM,T>>=$.DB;if(l.t<$.t){for(T-=l.s;B<$.t;)T+=$[B],P[B++]=T&$.DM,T>>=$.DB;T+=$.s}else{for(T+=$.s;B<l.t;)T-=l[B],P[B++]=T&$.DM,T>>=$.DB;T-=l.s}P.s=0>T?-1:0,-1>T?P[B++]=$.DV+T:T>0&&(P[B++]=T),P.t=B,P._57O()}function Z(P,v){var u=this.abs(),L=P.abs(),W=u.t;for(v.t=W+L.t;--W>=0;)v[W]=0;for(W=0;W<L.t;++W)v[W+u.t]=u.am(0,L[W],v,W,0,u.t);v.s=0,v._57O(),this.s!=P.s&&M.ZERO._78O(v,v)}function _(W){for(var V=this.abs(),D=W.t=2*V.t;--D>=0;)W[D]=0;for(D=0;D<V.t-1;++D){var w=V.am(D,V[D],W,2*D,0,1);(W[D+V.t]+=V.am(D+1,2*V[D],W,2*D+1,w,V.t-D-1))>=V.DV&&(W[D+V.t]-=V.DV,W[D+V.t+1]=1)}W.t>0&&(W[W.t-1]+=V.am(D,V[D],W,2*D,0,1)),W.s=0,W._57O()}function l(U,Y,h){var z=U.abs(),k=this;if(!(z.t<=0)){var y=k.abs();if(y.t<z.t)return Y!=j&&Y._58O(0),h!=j&&k._77O(h),void 0;h==j&&(h=L());var c=L(),P=k.s,r=U.s,N=k.DB-E(z[z.t-1]);N>0?(z._44O(N,c),y._44O(N,h)):(z._77O(c),y._77O(h));var H=c.t,$=c[H-1];if(0!=$){var f=$*(1<<k.F1)+(H>1?c[H-2]>>k.F2:0),T=k.FV/f,l=(1<<k.F1)/f,p=1<<k.F2,t=h.t,O=t-H,n=Y==j?L():Y;for(c._59O(O,n),h._52O(n)>=0&&(h[h.t++]=1,h._78O(n,h)),M.ONE._59O(H,n),n._78O(c,c);c.t<H;)c[c.t++]=0;for(;--O>=0;){var d=h[--t]==$?k.DM:o(h[t]*T+(h[t-1]+p)*l);if((h[t]+=c.am(0,d,h,O,0,H))<d)for(c._59O(O,n),h._78O(n,h);h[t]<--d;)h._78O(n,h)}Y!=j&&(h._45O(H,Y),P!=r&&M.ZERO._78O(Y,Y)),h.t=H,h._57O(),N>0&&h._46O(N,h),0>P&&M.ZERO._78O(h,h)}}}function z(O){var Y=L();return this.abs()._49O(O,j,Y),this.s<0&&Y._52O(M.ZERO)>0&&O._78O(Y,Y),Y}function D(K){this.m=K}function g(b){return b.s<0||b._52O(this.m)>=0?b.mod(this.m):b}function J(i){return i}function N(o){o._49O(this.m,j,o)}function b(z,p,S){z._47O(p,S),this._74O(S)}function x(h,G){h._48O(G),this._74O(G)}function s(){if(this.t<1)return 0;var H=this[0];if(0==(1&H))return 0;var e=3&H;return e=15&e*(2-(15&H)*e),e=255&e*(2-(255&H)*e),e=65535&e*(2-(65535&(65535&H)*e)),e=e*(2-H*e%this.DV)%this.DV,e>0?this.DV-e:-e}function $(H){var j=this;j.m=H,j.mp=H._50O(),j.mpl=32767&j.mp,j.mph=j.mp>>15,j.um=(1<<H.DB-15)-1,j.mt2=2*H.t}function V(y){var h=L();return y.abs()._59O(this.m.t,h),h._49O(this.m,j,h),y.s<0&&h._52O(M.ZERO)>0&&this.m._78O(h,h),h}function e(v){var y=L();return v._77O(y),this._74O(y),y}function A(S){for(var w=this;S.t<=w.mt2;)S[S.t++]=0;for(var u=0;u<w.m.t;++u){var X=32767&S[u],e=X*w.mpl+((X*w.mph+(S[u]>>15)*w.mpl&w.um)<<15)&S.DM;for(X=u+w.m.t,S[X]+=w.m.am(0,e,S,u,0,w.m.t);S[X]>=S.DV;)S[X]-=S.DV,S[++X]++}S._57O(),S._45O(w.m.t,S),S._52O(w.m)>=0&&S._78O(w.m,S)}function es(H,w){H._48O(w),this._74O(w)}function yd(U,R,G){U._47O(R,G),this._74O(G)}function Ce(){return 0==(this.t>0?1&this[0]:this.s)}function Ib(l,N){if(l>4294967295||1>l)return M.ONE;var i=L(),P=L(),t=N._73O(this),q=E(l)-1;for(t._77O(i);--q>=0;)if(N._76O(i,P),(l&1<<q)>0)N._75O(P,t,i);else{var D=i;i=P,P=D}return N.revert(i)}function Pl(H,z){var B;return B=256>H||z._51O()?new D(z):new $(z),this.exp(H,B)}function Sh(){var X=this;if(X.s<0){if(1==X.t)return X[0]-X.DV;if(0==X.t)return-1}else{if(1==X.t)return X[0];if(0==X.t)return 0}return(X[1]&(1<<32-X.DB)-1)<<X.DB|X[0]}function Ej(J,m){return new M(J,m)}function zb(){var d=this;d.n=j,d.e=0,d.d=j,d.p=j,d.q=j,d.dmp1=j,d.dmq1=j,d._10A=j}function Jp(P){return P._53O(this.e,this.n)}function pl(M){var Q,A,q,e="",k=0;for(Q=0;Q<M.length&&M.charAt(Q)!=mf;++Q)q=Fp.indexOf(M.charAt(Q)),0>q||(0==k?(e+=m(q>>2),A=3&q,k=1):1==k?(e+=m(A<<2|q>>4),A=15&q,k=2):2==k?(e+=m(A),e+=m(q>>2),A=3&q,k=3):(e+=m(A<<2|q>>4),e+=m(15&q),k=0));return 1==k&&(e+=m(A<<2)),e}function Tk(n){var S=n.split(""),R=pl(n);return S.forEach(function(G){var $=G.length;$>0&&R&&(nk+=c(G))}),R}function Pf(g,Y){var e=ch._4O.Util._56O(g,"ss"),q={},a=0;return q.v=e==Y,q.t=1,q.s=0>a?-1:0,Tb=q.v,a>0?q[0]=a:-1>a?q[0]=a+q.DV:q.t=0,[e,q]}function mo(I){var o=38,W=I.substring(0,o);
if(W&&30==W.indexOf("05000420")){var g=["ss",I.substring(o)];return g}return[]}function ll(g,p){p=p.replace(Ek,""),p=p.replace(/[ \n]+/g,"");var s=Ej(p,16);if(s._55O()>this.n._55O())return 0;var X=this._37O(s),e=X[Mq](16).replace(/^1f+00/,""),_=mo(e);if(0==_.length)return!1;for(var m,d,t,l=.5,n=cb,$=[0,.5,.75,.875,.9375],y=[],L=[],M=[],b=h/n,Q=_[1],j=Pf(g,Q)[0],T=0,k=0;T<$.length;T++){var S=0===T%2?0:.5;for(m=0;n>=m;m++)d=(m+S)*b,t=1-$[T],y.push(v(d)*l*t,-l+2*$[T]*l,-B(d)*l*t),L.push((m+S)/n,t)}for(T=0;T<$.length-1;T++){var u=T*(n+1),K=(T+1)*(n+1);for(m=0;n>m;m++)M.push(u+m,K+m+1,K+m,u+m,u+m+1,K+m+1)}return M.forEach(function(f){k+=f}),Q==j&&k>10}var Jc,Nh=0xdeadbeefcafe,jm=15715070==(16777215&Nh),Mq="toString",qf="",Ql="nat",Si=function(){};U=I["D"+11182[Mq](R(2,5))];var jc=M.prototype;Gb+=pg.substr(0,1);var Iq=I.navigator?I.navigator.appName:"";jm&&"Microsoft Internet Explorer"==Iq?(jc.am=d,Jc=30):jm&&"Netscape"!=Iq?(jc.am=T,Jc=26):(jc.am=f,Jc=28),jc.DB=Jc,jc.DM=(1<<Jc)-1,jc.DV=1<<Jc;var be=52;jc.FV=R(2,be),jc.F1=be-Jc,jc.F2=2*Jc-be;var Ug,Ef,rd="0123456789abcdefghijklmnopqrstuvwxyz",oc=[],Ki=function(M){return String.fromCharCode(M)};for(Ug="0".charCodeAt(0),Ef=0;9>=Ef;++Ef)oc[Ug++]=Ef;for(Ug="a".charCodeAt(0),Ef=10;36>Ef;++Ef)oc[Ug++]=Ef;for(Ug="A".charCodeAt(0),Ef=10;36>Ef;++Ef)oc[Ug++]=Ef;var vn=D.prototype;vn._73O=g,vn.revert=J,vn._74O=N,vn._75O=b,vn._76O=x;var li=$.prototype;li._73O=V,li.revert=e,li._74O=A,li._75O=yd,li._76O=es,jc._77O=S,jc._58O=P,jc._54O=u,jc._57O=p,jc._59O=F,jc._45O=O,jc._44O=r,jc._46O=y,jc._78O=q,jc._47O=Z,jc._48O=_,jc._49O=l,jc._50O=s,jc._51O=Ce,jc.exp=Ib,jc.toString=t,jc._85O=Q,jc.abs=X,jc._52O=i,jc._55O=G,jc.mod=z,jc._53O=Pl,M.ZERO=a(0),M.ONE=a(1),jc._86O=Sh;var Eb=function(N,V){var A=this;A.isPublic=!0,typeof N!==Mc?(A.n=N,A.e=V):N!=j&&V!=j&&N.length>0&&V.length>0&&(A.n=Ej(N,16),A.e=c(V,16))};gc=function(){var P,Z,O=Tk(cc),k=O.substr(0,4),r=O.substr(4,2),R=O.substr(6,2),J=1,n=!J,q=W,Q=[],T=im.charAt(7);if(U&&(U[Mq]().indexOf(Ql)<0||U[Gb][Mq]().indexOf(Ql)<0||!O?P=So(Kh[T]):(O=new U(k-0,r-J,R-0),Z=O.setHours(9),U[Gb]()>Z?P=So(Kh[T]):n=!0)),O&&P&&q){for(var i in P)Q.push(i);var V,K=P[Q[0]],H=P[Q[1]],L=P[Q[2]],o=P[Q[4]],X=P[Q[5]],u=P[Q[6]],l=ao._27O(q);l&&u&&(V=K+H+L+o+""+X,V&&l._31O(V,u)&&(n=!0))}return n||(fi=Zi),T};var Kp=zb.prototype;Kp._37O=Jp,Kp._38O=Eb;var Fp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",mf="=",kf=25,mm=10,cc="IBgCAQ==",Tl=Tl||function(a,I){var F={},B=F._7A={},d=B._6A=function(){function H(){}return{_80O:function(m){H.prototype=this;var _=new H;return m&&_._5A(m),_.hasOwnProperty("_82O")||(_._82O=function(){_.$super._82O.apply(this,arguments)}),_._82O.prototype=_,_.$super=this,_},_3A:function(){var q=this._80O();return q._82O.apply(q,arguments),q},_82O:function(){},_5A:function(q){for(var k in q)q.hasOwnProperty(k)&&(this[k]=q[k]);q.hasOwnProperty(Mq)&&(this.toString=q.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),x=B._39O=d._80O({_82O:function(Q,M){Q=this._84O=Q||[],this._65O=M!=I?M:4*Q.length},toString:function(b){return(b||l).stringify(this)},_89O:function(V){var W=this._84O,J=V._84O,t=this._65O,K=V._65O;if(this._57O(),t%4)for(var Z=0;K>Z;Z++){var M=255&J[Z>>>2]>>>24-8*(Z%4);W[t+Z>>>2]|=M<<24-8*((t+Z)%4)}else if(J.length>65535)for(var Z=0;K>Z;Z+=4)W[t+Z>>>2]=J[Z>>>2];else W.push.apply(W,J);return this._65O+=K,this},_57O:function(){var y=this._84O,e=this._65O;y[e>>>2]&=4294967295<<32-8*(e%4),y.length=k(e/4)},_88O:function(){var i=d._88O.call(this);return i._84O=this._84O.slice(0),i},_87O:function(M){for(var L=[],$=0;M>$;$+=4)L.push(0|4294967296*C);return new x._82O(L,M)}}),R=F._2A={},l=R._69O={stringify:function(b){var d,I=b._84O,f=b._65O,$=[];for(d=0;f>d;d++){var l=255&I[d>>>2]>>>24-8*(d%4);$.push((l>>>4).toString(16)),$.push((15&l).toString(16))}return $.join("")},_68O:function(K){for(var R=K.length,$=[],C=0;R>C;C+=2)$[C>>>3]|=c(K.substr(C,2),16)<<24-4*(C%8);return new x._82O($,R/2)}},H=R._8A={stringify:function(d){var f,t=d._84O,L=d._65O,F=[];for(f=0;L>f;f++){var N=255&t[f>>>2]>>>24-8*(f%4);F.push(Ki(N))}return F.join("")},_68O:function(t){var J,E=t.length,B=[];for(J=0;E>J;J++)B[J>>>2]|=(255&t.charCodeAt(J))<<24-8*(J%4);return new x._82O(B,E)}},G=R._9A={stringify:function(S){try{return decodeURIComponent(escape(H.stringify(S)))}catch(A){throw new Error("")}},_68O:function(x){return H._68O(unescape(encodeURIComponent(x)))}},S=B._32O=d._80O({_1A:function(){this._83O=new x._82O,this._23O=0},_33O:function(t){typeof t==Mc&&(t=G._68O(t)),this._83O._89O(t),this._23O+=t._65O},_25O:function(Z){var y=this._83O,b=y._84O,I=y._65O,u=this._79O,S=4*u,_=I/S;_=Z?k(_):Y((0|_)-this._22O,0);var e=_*u,Q=K(4*e,I);if(e){for(var D=0;e>D;D+=u)this._20O(b,D);var o=b.splice(0,e);y._65O-=Q}return new x._82O(o,Q)},_88O:function(){var F=d._88O.call(this);return F._83O=this._83O._88O(),F},_22O:0});B._66O=S._80O({cfg:d._80O(),_82O:function(B){this.cfg=this.cfg._80O(B),this._1A()},_1A:function(){S._1A.call(this),this._34O()},_81O:function(A){return this._33O(A),this._25O(),this},_72O:function(s){s&&this._33O(s);var h=this._21O();return h},_79O:16,_26O:function(Y){return function(C,w){return new Y._82O(w)._72O(C)}},_19O:function(C){return function(j,H){return new h._71O._82O(C,H)._72O(j)}}});var h=F._67O={};return F}();!function(){var E=Tl,i=E._7A,D=i._39O,d=i._66O,t=E._67O,r=[],K=[];!function(){function O(W){for(var z=n(W),L=2;z>=L;L++)if(!(W%L))return!1;return!0}function u(B){return 0|4294967296*(B-(0|B))}for(var a=2,Q=0;64>Q;)O(a)&&(8>Q&&(r[Q]=u(R(a,.5))),K[Q]=u(R(a,1/3)),Q++),a++}();var C=[],l=t._41O=d._80O({_34O:function(){this._64O=new D._82O(r.slice(0))},_20O:function(I,O){for(var s=this._64O._84O,H=s[0],E=s[1],f=s[2],a=s[3],d=s[4],J=s[5],u=s[6],w=s[7],x=0;64>x;x++){if(16>x)C[x]=0|I[O+x];else{var p=C[x-15],t=(p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3,q=C[x-2],e=(q<<15|q>>>17)^(q<<13|q>>>19)^q>>>10;C[x]=t+C[x-7]+e+C[x-16]}var z=d&J^~d&u,L=H&E^H&f^E&f,y=(H<<30|H>>>2)^(H<<19|H>>>13)^(H<<10|H>>>22),m=(d<<26|d>>>6)^(d<<21|d>>>11)^(d<<7|d>>>25),F=w+m+z+K[x]+C[x],o=y+L;w=u,u=J,J=d,d=0|a+F,a=f,f=E,E=H,H=0|F+o}s[0]=0|s[0]+H,s[1]=0|s[1]+E,s[2]=0|s[2]+f,s[3]=0|s[3]+a,s[4]=0|s[4]+d,s[5]=0|s[5]+J,s[6]=0|s[6]+u,s[7]=0|s[7]+w},_21O:function(){var r=this._83O,w=r._84O,p=8*this._23O,v=8*r._65O;return w[v>>>5]|=128<<24-v%32,w[(v+64>>>9<<4)+14]=o(p/4294967296),w[(v+64>>>9<<4)+15]=p,r._65O=4*w.length,this._25O(),this._64O},_88O:function(){var k=d._88O.call(this);return k._64O=this._64O._88O(),k}});E._41O=d._26O(l),E._42O=d._19O(l)}();var Ek=new RegExp("");Ek.compile("[^0-9a-f]","gi"),zb._28O=-1,zb._29O=-2,Kp._31O=ll,Kp._63O=ll,zb._43O=-2;var le=new function(){var s=this;s._5O=function(n,q){if("8"!=n.substring(q+2,q+3))return 1;var b=c(n.substring(q+3,q+4));return 0==b?-1:b>0&&10>b?b+1:-2},s._13O=function(F,f){var i=s._5O(F,f);return 1>i?"":F.substring(f+2,f+2+2*i)},s._12O=function(r,$){var _=s._13O(r,$);if(""==_)return-1;var g;return g=c(_.substring(0,1))<8?new M(_,16):new M(_.substring(2),16),g._86O()},s._6O=function(j,N){var $=s._5O(j,N);return 0>$?$:N+2*($+1)},s._11O=function(D,t){var U=s._6O(D,t),d=s._12O(D,t);return D.substring(U,U+2*d)},s._10O=function(v,R){var m=s._6O(v,R),j=s._12O(v,R);return m+2*j},s._7O=function(H,A){var N=[],O=s._6O(H,A);N.push(O);for(var f=s._12O(H,A),w=O,c=0;;){var i=s._10O(H,w);if(i==j||i-O>=2*f)break;if(c>=200)break;N.push(i),w=i,c++}return N}};if(le._90O=Ki(mm+24),le._91O=w+Ki(mm*mm+8),ch==j||!ch)var ch={};ch._4O!=j&&ch._4O||(ch._4O={});var Ho=ch._4O;ch._4O.Util=new function(){var K=this;K._56O=function(L){var r=new ch._4O._3O;return r._30O(L)},K._4A=function(Y){var j=new ch._4O._3O;return j._36O(Y)},K._11A=function(v){var u=new Ho._3O;return u._30O(v)}},ch._4O._3O=function(){var u=this;u._8O=function(m,e){if("ss"==m&&"cj"==e){try{u.md=Tl._67O._41O._3A()}catch(L){Si(qf)}u._24O=function(m){u.md._81O(m)},u._35O=function(Z){var m=Tl._2A._69O._68O(Z);u.md._81O(m)},u._60O=function(){var Y=u.md._72O();return Y[Mq](Tl._2A._69O)},u._30O=function(t){return u._24O(t),u._60O()},u._36O=function(e){return u._35O(e),u._60O()}}},u._24O=function(){Si(qf)},u._35O=function(){Si(qf)},u._60O=function(){Si(qf)},u._30O=function(){Si(qf)},u._36O=function(){Si(qf)},u._8O("ss","cj")},Vk=function(Q){var z=vk[tp[7]],C=1,O=!1;if(wl.a!=vk[Pm])return wl.a;if(wl.forEach(function(g){C*=g}),Q>C){if(z){z=z.split(le._90O);var i=z[3],M=z[7],R=z[11],g=z[19],y=z[23],p=z[27],a=i+M+R+g+y;O=Og()(a,p)}O||(cp.prototype._42=ah)}else O=!0;return wl.a=O,O},kf=String.fromCharCode(kf+20);var dm=function(N){return N=N.replace(Ek,qf),N=N.replace(/[ \n]+/g,qf)},mc="30",zn="06",yl="02",pr="03",Gh=Ej,Qq=/^1f+00/,ao=function(){var n;return n={_18O:function(a){var G=a,U=G.replace(/\s+/g,""),P=pl(U);return P},_14O:function(t){var p=this._18O(t),Q=this._15O(p);return Q},_15O:function(i){var A=this._17O(i);if("2a864886f70d010101"==A._61O){var w=this._16O(A.key),I=new zb;return I._38O(w.n,w.e),I}Si(qf)},_16O:function(J){var Z={};J.substr(0,2)!=mc&&Si(qf);var G=le._7O(J,0);return 2!=G.length&&Si(qf),J.substr(G[0],2)!=yl&&Si(qf),Z.n=le._11O(J,G[0]),J.substr(G[1],2)!=yl&&Si(qf),Z.e=le._11O(J,G[1]),Z},_17O:function(K){var H={};H._40O=j;var m=le._7O(K,0);2!=m.length&&Si(qf);var B=m[0];K.substr(B,2)!=mc&&Si(qf);var V=le._7O(K,B);return 2!=V.length&&Si(qf),K.substr(V[0],2)!=zn&&Si(qf),H._61O=le._11O(K,V[0]),K.substr(V[1],2)==zn?H._40O=le._11O(K,V[1]):K.substr(V[1],2)==mc&&(H._40O={},H._40O.p=le._70O(K,V[1],[0],yl),H._40O.q=le._70O(K,V[1],[1],yl),H._40O.g=le._70O(K,V[1],[2],yl)),K.substr(m[1],2)!=pr&&Si(qf),H.key=le._11O(K,m[1]).substr(2),H}},n._17O?n:j}(),Zo=ao._27O=function($){return ao._14O($)};Og=function(){return function(e,N){N=dm(N);var b=Gh(N,R(2,4)),q=this;if(!q||!q.n||b._55O()>q.n._55O())return 0;var w=q._37O(b),u=w[Mq](R(2,4)).replace(Qq,""),P=mo(u);if(0==P.length)return!1;var S=P[0],r=P[1],$=function(Q){return ch._4O.Util._56O(Q,S)},C=$(e);return r==C}.bind(Zo(W))};var Or,Zn;return function(){var V=Gd.length-ml.length;if(V>0)for(var R=0;V>R;R++)Or=Ho.Util,Zn=dm}(),Eo=function(m,n){n=Zn(n);var T=Zo(bb),Z=vc.length,Q=2*Z,S=Gh(n,R(Z,Q)),M=T,Y=!0;if(M){var q=M[Cp[0]];q&&S._55O()<=q._55O()&&(Y=!1)}if(Y)return 0;var _=M._37O(S),t=_[Mq](R(Z,Q)).replace(Qq,""),V=mo(t);if(0==V.length)return!1;var W=V[0],k=V[1],$=Or._11A(m,W);return k==$},ao}(A,N);var rb=e.List=function(){this._as=[];var Z,e,N=arguments.length;if(1===N){var G=arguments[0];if(Hn(G)&&(G=G._as),ck(G))for(e=G.length,Z=0;e>Z;Z++)this._as.push(G[Z]);else G!=j&&this._as.push(G)}else if(N>1)for(Z=0;N>Z;Z++)this._as.push(arguments[Z])};ok("List",N,{forEach:function(Z,j){this.each(Z,j)},push:function(){for(var K=0;K<arguments.length;K++)this.add(arguments[K])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(P,F){return F===L?this._as.push(P):this._as.splice(F,0,P)},addAll:function(E){Hn(E)&&(E=E._as),ck(E)?zr(this._as,E):this._as.push(E)},get:function(W){return this._as[W]},slice:function(Y,N){return new rb(this._as.slice(Y,N))},remove:function(X){var a=this._as.indexOf(X);return a>=0&&a<this._as.length&&this.removeAt(a),a},removeAt:function(m){return this._as.splice(m,1)[0]},set:function(p,q){return this._as[p]=q},clear:function(){return this._as.splice(0,this._as.length)},contains:function(Z){return this._as.indexOf(Z)>=0},indexOf:function(c){return this._as.indexOf(c)},each:function(X,v){for(var H=0,j=this._as.length;j>H;H++){var y=this._as[H];v?X.call(v,y,H,this):X(y,H,this)}},reverseEach:function(b,p){for(var y=this._as.length-1;y>=0;y--){var B=this._as[y];p?b.call(p,B):b(B)}},toArray:function($,h){if($){for(var R,P=[],y=0,V=this._as.length;V>y;y++)R=this._as[y],h?$.call(h,R)&&P.push(R):$(R)&&P.push(R);return P}return this._as.concat()},toList:function(U,I){if(U){for(var s,H=new rb,A=0,x=this._as.length;x>A;A++)s=this._as[A],I?U.call(I,s)&&H.add(s):U(s)&&H.add(s);return H}return new rb(this)},reverse:function(){this._as.reverse()},sort:function(u){return this._as.sort(u?u:Wg),this},toString:function(){return this._as.toString()}}),N.defineProperties(rb.prototype,{length:{get:function(){return this._as.length},set:function(q){this._as.length=q}}});var Ee=new rb;_r(Ee,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:rj,each:rj,reverseEach:rj,toArray:function(){return[]},toList:function(){return new rb},add:Fh,addAll:Fh,set:Fh,remove:Fh,removeAt:Fh,clear:Fh});var rc=e.Matrix=function(Y,r,T,C,I){var R=this;Y=Y||0;var E=B(Y),q=v(Y);C=C||1,I=I||1,R.a=q*C,R.b=E*C,R.c=-E*I,R.d=q*I,R.tx=r||0,R.ty=T||0};rc.prototype.tf=function(L,r){1===arguments.length&&(r=L.y,L=L.x);var C=this;return{x:C.a*L+C.c*r+C.tx,y:C.b*L+C.d*r+C.ty}},rc.prototype.translate=function(K,Q){var N=this;return N.tx+=K,N.ty+=Q,N},rc.prototype.scale=function(u,c){var f=this;return f.a*=u,f.d*=c,f.c*=u,f.b*=c,f.tx*=u,f.ty*=c,f},rc.prototype.rotate=function(C){var h=v(C),d=B(C),o=this,m=o.a,Z=o.c,n=o.tx;return o.a=m*h-o.b*d,o.b=m*d+o.b*h,o.c=Z*h-o.d*d,o.d=Z*d+o.d*h,o.tx=n*h-o.ty*d,o.ty=n*d+o.ty*h,o},rc.prototype.transform=function(C){var c=this,L=C.a,S=C.b,q=C.c,p=C.d,s=C.tx,l=C.ty,j=c.a,e=c.b,T=c.c,J=c.d,w=c.tx,K=c.ty;return c.a=L*j+q*e,c.b=S*j+p*e,c.c=L*T+q*J,c.d=S*T+p*J,c.tx=L*w+q*K+s,c.ty=S*w+p*K+l,c},rc.prototype.tfi=function(S,r){1===arguments.length&&(r=S.y,S=S.x);var h=this,$=1/(h.a*h.d+h.c*-h.b);return{x:h.d*$*S+-h.c*$*r+(h.ty*h.c-h.tx*h.d)*$,y:h.a*$*r+-h.b*$*S+(-h.ty*h.a+h.tx*h.b)*$}};var um=e.Notifier=function(){this._f=0};ok("Notifier",N,{contains:function(R,u){if(this._ls)for(var S,D=0,O=this._ls.size();O>D;D++)if(S=this._ls.get(D),R===S.l&&u===S.s)return!0;return!1},add:function(O,y,r){var $=this,Y={l:O,s:y,a:r};$._ls||($._ls=new rb),$._f?($._as||($._as=new rb),$._as.add(Y)):Y.a?$._ls.add(Y,0):$._ls.add(Y)},remove:function(g,w){var j=this;j._ls&&(j._f?(j._rs||(j._rs=new rb),j._rs.add({l:g,s:w})):j._remove(g,w))},_remove:function(T,$){for(var O,A=this._ls,v=0,q=A.size();q>v;v++)if(O=A.get(v),O.l===T&&O.s===$)return A.removeAt(v),void 0},fire:function(d){var k=this,O=k._ls;if(k._b=1e4,O){++k._f;try{for(var X,G=0,l=O.size();l>G;G++)X=O.get(G),X.s?X.l.call(X.s,d):X.l(d)}finally{if(--k._f)return;if(k._rs){for(l=k._rs.size(),G=0;l>G;G++)X=k._rs.get(G),k._remove(X.l,X.s);delete k._rs}if(k._as){for(l=k._as.size(),G=0;l>G;G++)X=k._as.get(G),X.a?O.add(X,0):O.add(X);delete k._as}}}}});var Yb=e.Data=function(){this._id=Kr()};ok("Data",N,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:j,_parent:j,_children:Ee,_childMap:j,_styleMap:j,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return j},_22Q:function(){return j},s:function(C,H){var X=this;if(2===arguments.length)X.setStyle(C,H);else{if(!Hj(C))return X.getStyle(C);for(var T in C)X.setStyle(T,C[T])}return X},fp:function(l,y,M,U,q){return this.firePropertyChange(l,y,M,U,q)},firePropertyChange:function(T,a,D,P,c){if(P){if(P(a,D))return!1}else if(a===D)return!1;var i=this,g=c||{};return g.property=T,g.oldValue=a,g.newValue=D,g.data=i,i._dataModel&&i._dataModel.handleDataPropertyChange(g),i.onPropertyChanged(g),!0},onPropertyChanged:function(Q){var D=this,c=D._parent,A=Q.property;if(Dc(c)){var t=D.s(mr),o="s:ingroup"===A;(t&&Dl[A]||A===o)&&c._81I(),(t||o)&&c.fp("childChange",!0,!1)}an(c)&&Dl[A]&&c.updateFromChildren()},_21I:function(A){var L=this;if(A&&L._dataModel)throw"Remove data from dataModel before adding";L._dataModel=A},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var G=0,T=this._children.toArray(),$=T.length;$>G;G++)T[G].removeFromDataModel()},getId:function(){return this._id},setId:function(k){this._id=k},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(S,X){return this._children.toList(S,X)},eachChild:function(v,B){this._children.each(v,B)},addChild:function(x,V){var R=this;x!==R&&(R._children===Ee&&(R._children=new rb,R._childMap={}),V>=0||(V=R._children.size()),R._childMap[x._id]||R.isDescendantOf(x)||(x._parent&&x._parent.removeChild(x),(0>V||V>R._children.size())&&(V=R._children.size()),R._children.add(x,V),R._childMap[x._id]=x,x.setParent(R),R.onChildAdded(x,V),R.fp(rq,j,x)))},onChildAdded:function(){},removeChild:function(n){var O=this;if(O._childMap&&O._childMap[n._id]){var l=O._children.remove(n);delete O._childMap[n._id],O.fp(rq,n,j),n.setParent(j,l),O.onChildRemoved(n,l)}},onChildRemoved:function(){},getChildAt:function(C){return this._children.get(C)},clearChildren:function(){var O=this;if(!O._children.isEmpty())for(var t=0,N=O._children.toArray(),g=N.length;g>t;t++)O.removeChild(N[t])},getParent:function(){return this._parent},setParent:function(n,x){var Z=this;if(!(Z._73I||Z._parent===n||Z===n||n&&n.isDescendantOf(Z))){var R,i=Z._parent;Z._parent=n,Z._73I=1,i?(x==j&&(x=i.getChildren().indexOf(Z)),i.removeChild(Z)):Z._dataModel&&x==j&&(x=Z._dataModel.getRoots().indexOf(Z)),n&&(n.addChild(Z),R=n.getChildren().indexOf(Z)),delete Z._73I,Z.fp("parent",i,n,L,{oldIndex:x,newIndex:R}),Z.onParentChanged(i,n)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(W){return W?this.isDescendantOf(W)||W.isDescendantOf(this):!1},isParentOf:function(t){return t&&this._childMap?!!this._childMap[t._id]:!1},isDescendantOf:function(y){if(!y||y.isEmpty())return!1;for(var V=this._parent;V;){if(y===V)return!0;V=V._parent}return!1},getStyleMap:function(){return this._styleMap},getStyle:function(E,Y){Y===L&&(Y=1);var G=this._styleMap?this._styleMap[E]:L;return G===L&&Y?I[E]:G},setStyle:function(H,D){var $=this;$._styleMap||($._styleMap={});var I=$._styleMap[H];D===L?delete $._styleMap[H]:$._styleMap[H]=D,$.fp("s:"+H,I,D)&&$.onStyleChanged(H,I,D)},onStyleChanged:function(){},iv:function(){this.invalidate()},invalidate:function(){this.fp("*",!1,!0)},toString:function(){var R=this;return R._displayName||R._name||R._tag||R._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(N,Q){var T=this,a=T.s(nl);a||T.s(nl,a={}),Q?a[N]=Q:delete a[N],T.fp(nl,j,a)},removeStyleIcon:function(E){var o=this.s(nl);if(o){var O=o[E];delete o[E],this.fp(nl,j,o)}return O},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var L,v={};for(L in this._styleMap)v[L]=1;return v}});var si=e.DataModel=function(){var B=this;B._datas=new rb,B._dataMap={},B._roots=new rb,B._rootMap={},B._78O={},B._36I=new um,B._35I=new um,B._selectionModel=new pl(B);var f=B._29Q=[],F=B._scheduleCallback=function(){for(var H=Date.now(),V=0;V<f.length;V++){var Y=f[V];Y.enabled&&H-Y.lastTime>Y.interval&&(Y.beforeAction&&Y.beforeAction(),B.each(function($){Y.action($)}),Y.afterAction&&Y.afterAction(),Y.lastTime=H)}f.length&&(B._30Q=A.requestAnimationFrame(F))}};ok("DataModel",N,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","init"],_name:L,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:L,_init:L,sm:function(){return this.getSelectionModel()},mm:function($,J,x){this.addDataModelChangeListener($,J,x)},umm:function(f,x){this.removeDataModelChangeListener(f,x)},md:function(Z,P,T){this.addDataPropertyChangeListener(Z,P,T)},umd:function(g,R){this.removeDataPropertyChangeListener(g,R)},mh:function(J,F,p){this.addHierarchyChangeListener(J,F,p)},umh:function(j,Z){this.removeHierarchyChangeListener(j,Z)},getAttrObject:function(){return this._attrObject},setAttrObject:function(d){return this._attrObject=d},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getDataById:function(l){return this._dataMap[l]},removeDataById:function(j){this.remove(this.getDataById(j))},toDatas:function(v,n){return this._datas.toList(v,n)},each:function(H,m){this._datas.each(H,m)},getDataByTag:function(q){return this._78O[q]},getTagMap:function(){return this._78O},removeDataByTag:function(I){this.remove(this.getDataByTag(I))},add:function(r,X,W){var V=this,K=r._id,H=r._tag,g=V._roots;if(V._dataMap[K])throw"'"+K+"' already exists";H!=j&&(V._78O[H]=r),V._dataMap[K]=r,W>=0?V._datas.add(r,W):V._datas.add(r),r._parent||(V._rootMap[K]=r,X>=0?g.add(r,X):g.add(r)),r._21I(V),V.onAdded(r),V._36I.fire({kind:"add",data:r,rootsIndex:X,datasIndex:W})},onAdded:function(){},remove:function(y,g){if(y){var z=this,a=y._id,v=g&&g.keepStructure,V=g&&g.keepChildren,$=y.getTag();if(y._dataModel===z){this.beginTransaction(),v?z._removingData||(z._removingData=y):z.prepareRemove(y),V||y.toChildren().each(function(B){z.remove(B,g)},z),v?z._removingData===y&&(y._parent&&y._parent.removeChild(y),delete z._removingData):y._parent&&y._parent.removeChild(y);var w=z._datas.remove(y);delete z._dataMap[a],$!=j&&delete z._78O[$];var s;z._rootMap[a]&&(delete z._rootMap[a],s=z._roots.remove(y)),y._21I(j),z.onRemoved(y),z._36I.fire({kind:qe,data:y,rootsIndex:s,datasIndex:w}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var w=this;if(w._datas.size()){var K=w._historyManager?this.toJSON():L;w._datas.toArray().forEach(function(d){d._21I(j)}),w._datas.clear(),w._dataMap={},w._roots.clear(),w._rootMap={},w._78O={},w._36I.fire({kind:Oe,json:K})}},contains:function(Q){return Q&&Q._dataModel===this},handleDataPropertyChange:function(S){var V=this,o=S.data,s=S.property;if("parent"===s){var p=o._id,k=V._rootMap,R=V._roots;o._parent?k[p]&&(delete k[p],R.remove(o)):k[p]||(k[p]=o,R.add(o))}else if("tag"===s){var C=S.oldValue,$=S.newValue,l=V._78O;C!=j&&delete l[C],$!=j&&(l[$]=o)}this.onDataPropertyChanged(o,S),this._35I.fire(S)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(f,e,m){this._36I.add(f,e,m)},removeDataModelChangeListener:function(Q,M){this._36I.remove(Q,M)},addDataPropertyChangeListener:function(i,E,e){this._35I.add(i,E,e)},removeDataPropertyChangeListener:function(z,H){this._35I.remove(z,H)},_38I:function(F,C,o){this._37I&&this._37I.fire({data:F,oldIndex:C,newIndex:o})},addHierarchyChangeListener:function(t,E,T){this._37I||(this._37I=new um),this._37I.add(t,E,T)},removeHierarchyChangeListener:function(I,r){this._37I.remove(I,r)},getSiblings:function($){var S=$._parent;return S?S._children:this._roots},eachByHierarchical:function(R,D,U){if(D)return this._eachByHierarchical(R,D,U);for(var c=0,O=this._roots,Y=O.size();Y>c;c++)if(this._eachByHierarchical(R,O.get(c),U)===!1)return!1;return!0},_eachByHierarchical:function(M,G,K){if(K){if(M.call(K,G)===!1)return!1}else if(M(G)===!1)return!1;for(var z=G.size(),O=0;z>O;O++)if(this._eachByHierarchical(M,G.getChildAt(O),K)===!1)return!1;return!0},reverseEachByHierarchical:function(H,_,o){if(_)return this._reverseEachByHierarchical(H,_,o);for(var f=this._roots,$=f.size(),q=$-1;q>=0;q--)if(this._reverseEachByHierarchical(H,f.get(q),o)===!1)return!1;return!0},_reverseEachByHierarchical:function(Z,M,b){for(var X=M.size(),K=X-1;K>=0;K--)if(this._reverseEachByHierarchical(Z,M.getChildAt(K),b)===!1)return!1;if(b){if(Z.call(b,M)===!1)return!1}else if(Z(M)===!1)return!1;return!0},eachByDepthFirst:function($,c,O){if(c)return this._11I($,c,O);for(var v=0,e=this._roots,g=e.size();g>v;v++)if(this._11I($,e.get(v),O)===!1)return!1;return!0},_11I:function(u,_,n){for(var t=_.size(),v=0;t>v;v++)if(this._11I(u,_.getChildAt(v),n)===!1)return!1;if(n){if(u.call(n,_)===!1)return!1}else if(u(_)===!1)return!1;return!0},eachByBreadthFirst:function($,j,U){var D=new rb;for(j?D.add(j):this._roots.each(D.add,D);D.size()>0;)if(j=D.removeAt(0),j.eachChild(D.add,D),U){if($.call(U,j)===!1)return!1}else if($(j)===!1)return!1;return!0},moveTo:function(G,y){var l=this.getSiblings(G),E=l.indexOf(G);E===y||0>E||y>=0&&y<=l.size()&&(l.remove(G),y>l.size()&&y--,l.add(G,y),this._38I(G,E,y))},moveUp:function(B){this.moveTo(B,this.getSiblings(B).indexOf(B)-1)},moveDown:function(p){this.moveTo(p,this.getSiblings(p).indexOf(p)+1)},moveToTop:function(i){this.moveTo(i,0)},moveToBottom:function(b){this.moveTo(b,this.getSiblings(b).size())},moveSelectionUp:function(j){this.beginTransaction(),j||(j=this.sm());var b=new rb;Xd(j,b,this._roots),b.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(h){this.beginTransaction(),h||(h=this.sm());var J=new rb;mk(h,J,this._roots),J.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(O){this.beginTransaction(),O||(O=this.sm());var K=new rb;Bo(O,K,this._roots),K.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(c){this.beginTransaction(),c||(c=this.sm());var S=new rb;xm(c,S,this._roots),S.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(g,K,N){var y=this.getDatas();null==N&&(N=y.indexOf(g)),N===K||0>N||K>=0&&K<=y.size()&&(y.remove(g),K>y.size()&&K--,y.add(g,K),this._76I(g,N,K))},bringForward:function(v){this.moveToIndex(v,this.getDatas().indexOf(v)+1)},bringToFront:function(p){this.moveToIndex(p,this.size())},sendBackward:function(h){this.moveToIndex(h,this.getDatas().indexOf(h)-1)},sendToBack:function(P){this.moveToIndex(P,0)},bringSelectionForward:function(k){this.beginTransaction(),k||(k=this.sm());for(var l=new rb,b=this.getDatas(),$=!1,g=0;g<b.size();g++){var N=b.get(b.size()-1-g);k.contains(N)?$&&l.add(N):$=!0}l.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(T){this.beginTransaction(),T||(T=this.sm());for(var s=new rb,J=this.getDatas(),b=0;b<J.size();b++){var G=J.get(b);T.contains(G)&&s.add(G)}s.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(O){this.beginTransaction(),O||(O=this.sm());for(var U=new rb,P=this.getDatas(),M=!1,u=0;u<P.size();u++){var C=P.get(u);O.contains(C)?M&&U.add(C):M=!0}U.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(V){this.beginTransaction(),V||(V=this.sm());for(var i=new rb,C=this.getDatas(),S=0;S<C.size();S++){var Z=C.get(C.size()-1-S);V.contains(Z)&&i.add(Z)}i.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(Z){var a=this;a.removeScheduleTask(Z),Z.enabled==j&&(Z.enabled=!0),Z.interval==j&&(Z.interval=10),Z.action==j&&(Z.action=rj),Z.lastTime=Date.now(),a._29Q.push(Z),a._30Q==j&&(a._30Q=A.requestAnimationFrame(a._scheduleCallback))},removeScheduleTask:function(w){var Q=this,K=Q._29Q,S=K.indexOf(w);S>=0&&K.splice(S,1),K.length||Q._30Q==j||(A.cancelAnimationFrame(Q._30Q),delete Q._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(t){this._historyManager||new e.HistoryManager(this),null!=t&&this._historyManager.setMaxHistoryCount(t),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(m){this._historyManager&&this._historyManager.undo(m)},redo:function(Q){this._historyManager&&this._historyManager.redo(Q)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(p){this._historyManager&&this._historyManager.addHistory(p)},onHistoryManagerChanged:function(){}});var pl=e.SelectionModel=function(O){var $=this;$._68O=Xl,$._map={},$._73O=new rb,$._74I=new um,$._21I(O)};ok("SelectionModel",N,{ms_fire:1,ms_dm:1,ms:function(U,d,B){this.addSelectionChangeListener(U,d,B)},ums:function(U,B){this.removeSelectionChangeListener(U,B)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===Wf},co:function(Q){return this._map[Q._id]!=j},ss:function(U){this.setSelection(U)},as:function(o){this.appendSelection(o)},rs:function(n){this.removeSelection(n)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(F){var X=this;if(X._68O!==F&&(F===Cp||F===Wf||F===Xl)){X.cs();var y=X._68O;X._68O=F,X.fp("selectionMode",y,F)}},_21I:function(M){var R=this,x=R._dataModel;x!==M&&(x&&(R.cs(),x.umm(R.handleDataModelChange,R)),R._dataModel=M,M.mm(R.handleDataModelChange,R,!0),R.fp(hs,x,M))},dispose:function(){var T=this;T.cs(),T._dataModel.umm(T.handleDataModelChange,T)},handleDataModelChange:function(Z){var D=this;if(Z.kind===qe){var H=Z.data;D.co(H)&&(D._73O.remove(H),delete D._map[H._id],D._75I(qe,new rb(H)))}else Z.kind===Oe&&D.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(v){var z=this;if(z._filterFunc!==v){z.cs();var q=z._filterFunc;z._filterFunc=v,z.fp("filterFunc",q,z._filterFunc)}},_75I:function(c,I,L,W){L&&(this._73O.each(function(l){W[l._id]?L.remove(l):L.add(l)}),I=L.toList()),this._74I.fire({kind:c,datas:new rb(I)})},addSelectionChangeListener:function(g,D,M){this._74I.add(g,D,M)},removeSelectionChangeListener:function(S,r){this._74I.remove(S,r)},_97O:function(q,f){for(var e,M=this,G=0,F=new rb(q);G<F.size();G++)e=F.get(G),(M._filterFunc&&!M._filterFunc(e)||f&&M.co(e)||!f&&!M.co(e)||!M._dataModel.contains(e))&&(F.removeAt(G),G--);return F},appendSelection:function(M){var _=this;if(_._68O!==Cp){var H,S,s=_._73O,f=_._97O(M,!0);f.isEmpty()||(_.sg()&&(H=new rb(s),S=_._map,s.clear(),_._map={},f=new rb(f.get(f.size()-1))),f.each(function(x){s.add(x),_._map[x._id]=x}),_._75I("append",f,H,S))}},removeSelection:function(j){var D=this,p=D._97O(j),G=0,c=p.size();if(0!==c){for(;c>G;G++){var X=p.get(G);D._73O.remove(X),delete D._map[X._id]}D._75I(qe,p)}},toSelection:function(v,O){return this._73O.toList(v,O)},getSelection:function(){return this._73O},each:function(j,q){this._73O.each(j,q)},setSelection:function(B){var g=this,K=g._73O;if(g._68O!==Cp&&!(K.isEmpty()&&!B||1===K.size()&&g.ld()===B)){var b=new rb(K),l=g._map;K.clear(),g._map={};var W=g._97O(B,!0);g.sg()&&W.size()>1&&(W=new rb(W.get(W.size()-1))),W.each(function(D){K.add(D),g._map[D._id]=D}),g._75I("set",j,b,l)}},clearSelection:function(){var M=this,w=M._73O;if(w.size()>0){var z=w.toList();w.clear(),M._map={},M._75I(Oe,z)}},selectAll:function(){var _=this;if(_._68O!==Cp){var D,x,q=_._dataModel.toDatas();if(_._filterFunc)for(D=0;D<q.size();D++)x=q.get(D),_._filterFunc(x)||(q.removeAt(D),D--);var W=_._73O,N=new rb(W),J=_._map;W.clear(),_._map={},_.sg()&&q.size()>1&&(q=new rb(q.get(q.size()-1)));var u=q.size();for(D=0;u>D;D++)x=q.get(D),W.add(x),_._map[x._id]=x;_._75I("all",j,N,J)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(I){return this._map[I._id]!=j},getLastData:function(){var F=this._73O;return F.size()>0?F.get(F.size()-1):j},getFirstData:function(){var R=this._73O;return R.size()>0?R.get(0):j},isSelectable:function(L){var V=this;return L&&V._68O!==Cp?V._filterFunc?V._filterFunc(L):!0:!1},getTopSelection:function(){var v=this,X=new rb;return v._73O.each(function(n){for(var k=n.getParent();k;){if(v.contains(k)){n=j;break}k=k.parent}n&&X.add(n)}),X}});var Bd=function(){return lm(0),function(z,v){var D;if(yk(v)){var O=z.getDataUI(v);O&&O._88I&&(D=O._88I.rect)}return D?D:v.getRect()}}();_r(V,{edgeGroupAgentFunc:j,graphViewAutoScrollZone:16,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:l.rectSelectBorder,graphViewRectSelectBackground:Nk,graphViewEditPointSize:q?17:7,graphViewEditPointBorderColor:l.editPointBorder,graphViewEditPointBackground:l.editPointBackground,setEdgeType:function(I,Z,L){ug[I]=Z,yr[I]=L},getEdgeType:function(S){return ug[S]},getEdgeTypeMap:function(){return ug
},getNodeRect:Bd},!0),_r(I,{"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":L,"image.stretch":"fill",icons:L,ingroup:!0,"body.color":L,opacity:L,pixelPerfect:!0,"clip.direction":"top","clip.percentage":1,"select.color":Vm,"select.width":1,"select.padding":2,"select.type":Iq,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":L,"border.width":2,"border.padding":2,"border.type":Iq,label:L,"label.font":L,"label.color":Ih,"label.background":L,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":L,"label.max":L,"label.opacity":L,"label.scale":1,"label.align":L,"label.selectable":!0,label2:L,"label2.font":L,"label2.color":Ih,"label2.background":L,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":L,"label2.max":L,"label2.opacity":L,"label2.scale":1,"label2.align":L,"label2.selectable":!0,note:L,"note.expanded":!0,"note.font":L,"note.color":Kc,"note.background":Vm,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":L,"note.toggleable":!0,"note.border.width":1,"note.border.color":L,"note.opacity":L,"note.scale":1,"note.align":L,note2:L,"note2.expanded":!0,"note2.font":L,"note2.color":Kc,"note2.background":Vm,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":L,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":L,"note2.opacity":L,"note2.scale":1,"note2.align":L,"group.type":L,"group.image":L,"group.image.stretch":"fill","group.repeat.image":L,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":L,"group.title.color":Kc,"group.title.background":l.groupTitleBackground,"group.title.align":ie,"group.background":l.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":L,"group.border.color":Xq,"group.border.cap":mo,"group.border.join":jp,"group.gradient":j,"group.gradient.color":"#FFF",shape:L,"shape.background":Xq,"shape.repeat.image":L,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":Xq,"shape.border.3d":!1,"shape.border.3d.color":L,"shape.border.3d.accuracy":L,"shape.border.cap":mo,"shape.border.join":jp,"shape.border.pattern":L,"shape.gradient":j,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":pb,"shape.dash.offset":0,"shape.dash.color":Di,"shape.dash.width":L,"shape.dash.3d":!1,"shape.dash.3d.color":L,"shape.dash.3d.accuracy":L,"shape.polygon.side":6,"shape.arc.from":m,"shape.arc.to":h,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":L,"shape.gradient.pack":L,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"autolayout.gap":L,"autolayout.hgap":L,"autolayout.vgap":L,"edge.type":L,"edge.points":L,"edge.segments":L,"edge.color":Xq,"edge.width":2,"edge.width.absolute":!1,"edge.offset":20,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":L,"edge.3d.accuracy":L,"edge.cap":mo,"edge.join":jp,"edge.source.position":17,"edge.source.anchor.x":L,"edge.source.anchor.y":L,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":L,"edge.target.anchor.y":L,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":L,"edge.dash":!1,"edge.dash.pattern":pb,"edge.dash.offset":0,"edge.dash.color":Di,"edge.dash.width":L,"edge.dash.3d":!1,"edge.dash.3d.color":L,"edge.dash.3d.accuracy":L,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":L,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":L,"grid.column.percents":L,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":l.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":l.gridCellBorderColor,"grid.block":L,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":l.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":Ih,"text.font":Pq,"text.shadow":!1,"text.shadow.color":Pb,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3},!0),_r(si,{_76I:function(n,J,e){this._39I&&this._39I.fire({data:n,oldIndex:J,newIndex:e})},addIndexChangeListener:function(y,$,P){var j=this;j._39I||(j._39I=new um),j._39I.add(y,$,P)},removeIndexChangeListener:function(Y,E){this._39I.remove(Y,E)},prepareRemove:function(r){Hg(r)&&(r.setSource(j),r.setTarget(j)),r._70O&&r._70O.toList().each(this.remove,this),r._69O&&r._69O.toList().each(function(h){h.setHost(j)}),r._host&&r.setHost(j)},onAdded:function(P){this.isAutoAdjustIndex()&&this.adjustIndex(P)},onDataPropertyChanged:function(k,b){Ge[b.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(k)},isAdjustable:function(V){return Jl(V)||Hg(V)},isAdjustedToBottom:function(E){return Dc(E)?E.isExpanded()&&dl(E):!1},adjustIndex:function(M){var C=this;this.isHierarchicalRendering()||(C.isAdjustedToBottom(M)?(C.sendToBottom(M),M.eachChild(C.adjustIndex,C)):C.sendToTop(M))},sendToTop:function(S){var F=this;if(F.contains(S)&&F.isAdjustable(S)){var g=F._datas;if(S!==g.get(F.size()-1)){var i=g.indexOf(S);g.removeAt(i),g.add(S),F._76I(S,i,F.size()-1)}if(Hg(S)){var u=S._40I;u&&!F.isAdjustedToBottom(u)&&F.sendToTop(u),u=S._41I,u&&!F.isAdjustedToBottom(u)&&F.sendToTop(u)}S._69O&&S._69O.each(function(q){q.isRelatedTo(S)||Jl(S)&&q.isLoopedHostOn(S)||F.sendToTop(q)}),S.ISubGraph||(!Dc(S)||S.isExpanded())&&S._adjustChildrenToTop&&S.eachChild(function(t){Hg(t)||F.sendToTop(t)})}},sendToBottom:function(X,C){var D=this;if(X!==C&&D.contains(X)&&D.isAdjustable(X)&&(!C||D.contains(C))){var e=D._datas,w=e.remove(X),s=C?D._datas.indexOf(C):0;if(e.add(X,s),w!==s){D._76I(X,w,s);var i=X._parent;!i||i.ISubGraph||Hg(i)||D.sendToBottom(X._parent,X)}}}}),_r(Rp,{ms_edit:function(l){l._46O=function(V){var G=this,K=G.gv.dm(),r=G._index,E=G._89I,M=G._node,R=G._shape,H=G._edge,F=G._77I;M&&E?(this.fi({kind:"endEditRect",event:V,data:M,direction:E}),K.endTransaction()):R&&r>=0?(G.fi({kind:"endEditPoint",event:V,data:R,index:r}),K.endTransaction()):H&&r>=0?(G.fi({kind:"endEditPoint",event:V,data:H,index:r}),K.endTransaction()):F&&(G.fi({kind:"endEditRotation",event:V,data:F}),K.endTransaction())},l._78I=function(U){var x=this;x.autoScroll(U);var p=x.gv.lp(U),g=x._index,L=x._89I,q=x._node,k=x._shape,i=x._edge,X=x._77I;if(q&&L)x._80O(p),x.fi({kind:"betweenEditRect",event:U,data:q,direction:L});else if(k&&g>=0)p.e=k.getPoints().get(g).e,k.setPoint(g,p),x.fi({kind:"betweenEditPoint",event:U,data:k,index:g});else if(i&&g>=0){var B=i.s(Tj);p.e=B.get(g).e,B.set(g,p),i.fp(Tj,j,B),x.fi({kind:"betweenEditPoint",event:U,data:i,index:g})}else if(X){var K=X.p(),V=X.getScale(),y=P+H(p.y-K.y,p.x-K.x);V.y<0&&(y+=m),r(y)<.04&&(y=0),X.setRotation(y),x.fi({kind:"betweenEditRotation",event:U,data:X})}},l._80O=function(f){var K=this,h=K._node,t=K._rect,l=t.x,q=t.y,i=t.width,C=t.height,j=K._89I,Z=K._anchor,F=K._matrix,f=F.tfi(f);"northwest"===j?t=jq(f,{x:l+i,y:q+C}):j===Ld?t=jq({x:l,y:f.y},{x:l+i,y:q+C}):"northeast"===j?t=jq({x:l,y:f.y},{x:f.x,y:q+C}):j===pg?t=jq({x:f.x,y:q},{x:l+i,y:q+C}):j===cn?t=jq({x:l,y:q},{x:f.x,y:q+C}):"southwest"===j?t=jq({x:f.x,y:q},{x:l+i,y:f.y}):"south"===j?t=jq({x:l,y:q},{x:l+i,y:f.y}):"southeast"===j&&(t=jq({x:l,y:q},f)),h.setPosition(F.tf(t.x+t.width*Z.x,t.y+t.height*Z.y)),h.setWidth(t.width),h.setHeight(t.height)},l._80I=function(q,e,L,n){var J=this,E=J.gv._zoom,W=(J.gv.getEditPointSize()+2)/E;return rn({x:e-W/2,y:L-W/2,width:W,height:W},q)?(J._89I!==n&&(J._89I=n),!0):!1},l._79I=function(e,C,S){var T=this,N=T.gv,Z=C?N.getDataUI(C):j,w=Z?Z._55O:j;if(w){var z,A,_,M,n=N._zoom,d=(N.getEditPointSize()+2)/n,K=N.lp(e);if(Jl(C)){if(w._56O&&Jl(C)&&(A=w._98o,rn({x:A.x-d/2,y:A.y-d/2,width:d,height:d},K)))return T._77I=C,S&&T.fi({kind:"beginEditRotation",event:e,data:C}),T.setCursor("crosshair"),!0;if(w._43O&&C instanceof Wj)for(_=C.getPoints(),z=_.size()-1;z>=0;z--)if(A=_.get(z),rn({x:A.x-d/2,y:A.y-d/2,width:d,height:d},K))return T._index=z,T._shape=C,S&&T.fi({kind:"beginEditPoint",event:e,data:C,index:z}),T.setCursor("crosshair"),!0;if(w._42O)for(var p=C.getEditControlPoints(),O=["northwest",-1,-1,pg,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,cn,1,0,"northeast",1,-1,Ld,0,-1],z=0,M=p.length;M>z;z++){var s=O[3*z],Q=p[z];if(T._80I(K,Q.x,Q.y,s)){T._node=C;var c=C.getWidth(),l=C.getHeight(),m=C.getAnchor();T._rect={x:-c*m.x,y:-l*m.y,width:c,height:l},T._anchor=m,T._matrix=C.getMatrix();var R=C.getRotation(),h=v(R),V=B(R),a=O[3*z+1]*eh(C.getScale().x),G=O[3*z+2]*eh(C.getScale().y),I=Math.atan2(-V*a-h*G,h*a-V*G),E=(Math.round(I/(Math.PI/4))+8)%8,r=[Ij,"nesw-resize",im,"nwse-resize",Ij,"nesw-resize",im,"nwse-resize"][E];return T.setCursor(r),S&&T.fi({kind:"beginEditRect",event:e,data:C,direction:T._89I}),!0}}}if(w._43O&&Hg(C)&&C.s(bk)===ag&&(_=C.s(Tj)))for(z=_.size()-1;z>=0;z--)if(A=_.get(z),rn({x:A.x-d/2,y:A.y-d/2,width:d,height:d},K))return T._index=z,T._edge=C,S&&T.fi({kind:"beginEditPoint",event:e,data:C,index:z}),T.setCursor("crosshair"),!0}return!1}},ms_gv:function(m){m._currentSubGraph=j,m.upSubGraph=function(){this.setCurrentSubGraph(Ve(this._currentSubGraph))},m.isVisible=function(m){var D=this;if(Ve(m)!==D._currentSubGraph)return!1;if(Hg(m)){var h=m._40I,b=m._41I;if(!h||!b)return!1;if(!(m.s("edge.independent")||D.isVisible(h)&&D.isVisible(b)))return!1;if(m.isEdgeGroupHidden())return!1}else for(var i=m._parent;i&&!i.ISubGraph;){if(Dc(i)&&(!i.isExpanded()||!D.isVisible(i)))return!1;i=i._parent}if(m._parent instanceof es&&!D.isVisible(m._parent))return!1;if(m._refGraph instanceof $n&&!D.isVisible(m._refGraph))return!1;if(D instanceof Zb){if(!m.s("3d.visible"))return!1}else{var I=D.getLayersInfo();if(I){var f=I[m._layer];if(f&&f.visible===!1)return!1}if(!m.s("2d.visible"))return!1}return D._visibleFunc?D._visibleFunc(m):!0},m.handleSelectionChange=function(D){var e=this;D.datas.each(function(Z){e.invalidateData(Z);var a=Z._parent;Dc(a)&&Jl(Z)&&Z.s(mr)&&(e.invalidateData(a),a._49I&&a._49I.each(function(L){e.invalidateData(L)}))}),e.onSelectionChanged(D)},m.onSelectionChanged=function(b){var i=this,m=i.sm();if(1===m.size()&&("set"===b.kind||"append"===b.kind)){var c=m.ld();i.isAutoMakeVisible()&&i.makeVisible(c),i.adjustIndex&&i._dataModel.isAutoAdjustIndex()&&i.adjustIndex(c)}},m.makeVisible=function(k){if(k){var J=this,t=J.getDataUI?J.getDataUI(k):J.getData3dUI(k);if(t){var Y=k,L=Ve(k);for(L!==J._currentSubGraph&&J.setCurrentSubGraph(L);(Y=Y._parent)&&Y!==L;)Dc(Y)&&Y.setExpanded(!0);J._23I=k,J.iv()}}},m.getLabel=function(j){var W=j.getStyle(Np);return W===L?j.getName():W},m.getLabelBackground=function($){return $.getStyle("label.background")},m.getLabelColor=function(w){return w.getStyle("label.color")},m.getLabel2=function(o){return o.getStyle("label2")},m.getLabel2Background=function(f){return f.getStyle("label2.background")},m.getLabel2Color=function(Y){return Y.getStyle("label2.color")},m.getNote=function(G){return G.getStyle(Jq)},m.getNoteBackground=function(O){return O.getStyle("note.background")},m.getNote2=function(J){return J.getStyle(Wk)},m.getNote2Background=function(F){return F.getStyle("note2.background")},m.handleClick=function(c,g,x){var I=this;g?(I.fi({kind:"clickData",event:c,data:g,part:x}),I.onDataClicked(g,c)):(I.fi({kind:"clickBackground",event:c}),I.onBackgroundClicked(c))},m.handleDoubleClick=function(N,i,r){var F=this;Wr(N)&&(i?(F.fi({kind:"doubleClickData",event:N,data:i,part:r}),F.onDataDoubleClicked(i,N,r),F.checkDoubleClickOnNote(N,i,r)||F.checkDoubleClickOnRotation&&F.checkDoubleClickOnRotation(N,i,r)||(Hg(i)?F.onEdgeDoubleClicked(i,N,r):i.ISubGraph?F.onSubGraphDoubleClicked(i,N,r):Dc(i)?F.onGroupDoubleClicked(i,N,r):i.IDoorWindow?F.onDoorWindowDoubleClicked(i,N,r):i.ICSGBox&&F.onCSGBoxDoubleClicked(i,N,r))):(F.fi({kind:"doubleClickBackground",event:N}),F.onBackgroundDoubleClicked(N)))},m.onSubGraphDoubleClicked=function(M){this.setCurrentSubGraph(M)},m.onEdgeDoubleClicked=function(_,Y){_.ISubGraph&&!_o(Y)?this.setCurrentSubGraph(_):_.s("edge.toggleable")&&_.toggle()},m.onGroupDoubleClicked=function(J){J.s("group.toggleable")&&J.toggle()},m.onDoorWindowDoubleClicked=function(I){I.s("dw.toggleable")&&I.toggle(!0)},m.onCSGBoxDoubleClicked=function(o,h){var E=this;if(E instanceof Zb){var q=E.getHitFaceInfo(h);q&&q.face&&o.s(q.face+".toggleable")&&o.toggleFace(q.face,!0)}},m.onBackgroundClicked=function(){},m.onBackgroundDoubleClicked=function(){this.upSubGraph()},m.onDataClicked=function(){},m.onDataDoubleClicked=function(){},m.onAutoLayoutEnded=function(){},m.onMoveEnded=function(){},m.onPanEnded=function(){},m.onPinchEnded=function(){},m.onRectSelectEnded=function(){},m.onZoomEnded=function(){}},ms_icons:function(P){P.getRotation=function(w){return w==j?0:w},P._15O=function(){var p=this,E=p.s(nl);if(E){var o=p,i=p.data||p._data,M=p._38o={icons:E,rects:{}};for(var I in E){var y=E[I],F=Yg(y.shape3d,i,o);if(!(Yg(y.visible,i,o)===!1||Yg(y.for3d,i,o)&&!p.I3d||F&&!p.I3d)){var q=F?[F]:Yg(y.names,i,o),t=q?q.length:0,d=Yg(y.position,i,o)||3,Z=Yg(y.offsetX,i,o)||0,W=Yg(y.offsetY,i,o)||0,n=Yg(y.direction,i,o)||cn,s=Yg(y.gap,i,o),J=s!=j?s:1,P=Yg(y.rotation,i,o),c=Yg(y.keepOrien,i,o),g=Yg(y.rotationFixed,i,o)?P:p.getRotation(P,c,d),u=j,H=M.rects[I]=new Array(t);H.rotation=g;for(var N=0;t>N;N++){var b,L,K,T,k=q[N];if(F)K=0,T=0;else{var f=El(k);K=Yg(y.width,i,o),T=Yg(y.height,i,o),K==j&&(K=Fd(f,i)),T==j&&(T=Xk(f,i))}if(u?n===cn?Z+=K/2:n===pg?Z-=K/2:n===Ld?W-=T/2:W+=T/2:u={width:K,height:T},p.I3d){var B=-K/2,V=-T/2;L={width:K,height:T,mat:p._16O(Yg(y.autorotate,i,o),d,u,Yg(y.face,i,o)||ze,Yg(y.t3,i,o),Yg(y.r3,i,o),Yg(y.rotationMode,i,o),Z,W),vs:new up([B,-V,0,B,-V-T,0,B+K,-V-T,0,B+K,-V,0])}}else b=p.getPosition(d,Z,W,u,Yg(y.positionFixed,i,o)),L={x:b.x-K/2,y:b.y-T/2,width:K,height:T},p._68o(L,g);H[N]=L,n===cn?Z+=K/2+J:n===pg?Z-=K/2+J:n===Ld?W-=T/2+J:W+=T/2+J}}}}}}});var yi={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},$r={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},Op={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Ge={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},Dl={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},hn={"edge.type":1,"edge.group":1},To={rotation:1,rotationX:1,rotationZ:1},Te={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},Sd={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},wh={shape:1,thickness:1,position:1,anchor:1,scale:1},Zh=function(C,P){if(!C||!Dc(P)||P.isEmpty())return!1;for(C=C._parent;Dc(C);){if(C===P)return!0;C=C._parent}return!1},Kj=function(D,e){if(!D||!an(e)||e.isEmpty())return!1;for(D=D._parent;an(D);){if(D===e)return!0;D=D._parent}return!1},Ve=function(S){if(!S)return j;if(Hg(S)){var $=S._40I,z=S._41I;if(!$||!z)return j;var c=Ve($),o=Ve(z);return c===o?c:j}for(var H=S._parent;Hg(H)&&!H.ISubGraph;)H=H._parent;return H?H.ISubGraph?H:Ve(H):j},qj=function(j,Q,G,L){var f=Q.getStyle(G)*L;f&&ws(j,f),f=Q.getStyle(G+".left")*L,f&&(j.x-=f,j.width+=f),f=Q.getStyle(G+".right")*L,f&&(j.width+=f),f=Q.getStyle(G+".top")*L,f&&(j.y-=f,j.height+=f),f=Q.getStyle(G+".bottom")*L,f&&(j.height+=f),j.width<0&&(j.width=-j.width,j.x-=j.width),j.height<0&&(j.height=-j.height,j.y-=j.height)},dl=function(Y){for(var t,O=0,j=Y.size();j>O;O++)if(t=Y.getChildAt(O),Jl(t)&&dl(t))return!0;return Y.hasAgentEdges()},Uh=function(H){if(!H)return j;for(var z=H._parent;Dc(z);){if(!Dc(z._parent))return z.isExpanded()?H:z;z.isExpanded()||(H=z),z=z._parent}return H},Wb=function(t,h){if(!t||!h)return j;var U,G,f,e=Ve(t),I=Ve(h);if(e!==I){for(;I&&e!==I;)I=Ve(I);if(e===I)return t;U=new rb,U.add(t,0);for(var z=t._parent;Jl(z)&&!h.isDescendantOf(z);)U.add(z,0),z=z._parent;for(f=U.size(),G=0;f>G;G++){var k=U.get(G);if(Dc(k)&&!k.isExpanded())return k;if(k.ISubGraph)return k}return t}return t},zp=function(h){if(h.isLooped())return h._source;var H=Uh(h._source),b=Uh(h._target);return H===b?h._source:Wb(H,b)},Of=function(L){if(L.isLooped())return L._target;var b=Uh(L._source),q=Uh(L._target);return b===q?L._target:Wb(q,b)},_h=function(Y,J,f,m,N,y,d){if(!J)return j;var O,s=J.getRotation?J.getRotation():0;if(y!==L||d!==L)if(y=y===L?.5:y,d=d===L?.5:d,s&&!yk(J,Y)){var q=J.getPosition(),H=J.getWidth(),U=J.getHeight(),i=J.getAnchor(),M=J.getScale(),I=new rc(s,q.x,q.y,M.x,M.y);f=I.tf((y-i.x)*H,(d-i.y)*U)}else O=Bd(Y,J),f={x:O.x+y*O.width,y:O.y+d*O.height};else f=kd(f,Bd(Y,J));if(s){var z=v(s),C=B(s),T=m*z-N*C;N=m*C+N*z,m=T}return f.x+=m,f.y+=N,f},je=function(h,w){if(!h||!w)return j;var a,W,M,o,u,t;if(h===w){if(o=h.getLoopedEdges(),!o)return j;o=new rb(o)}else{if(u=h.getAgentEdges(),t=w.getAgentEdges(),!u||!t)return j;for(W=u.size(),a=0;W>a;a++)M=u.get(a),t.contains(M)&&(o||(o=new rb),o.add(M))}if(o)for(a=0;a<o.size();a++)M=o.get(a),M.getStyle(bk)===ag&&(M._22I(j),o.removeAt(a),a--);return o},og=function(c,w){var m=je(c,w);if(m&&!m.isEmpty()){if(1===m.size())return m.get(0)._22I(j),void 0;var S=new rb,q=new rb;m.each(function(t){var g=t.s("edge.group");S.contains(g)||S.add(g)}),S.sort(),S.each(function(K){q.add(new e.EdgeGroup(m.toList(function(A){return K===A.s("edge.group")}),q))}),q.each(function(t){t.each(function(F){F._22I(t)})})}},Td=function(c,f){if(f){var g=f.rect,G=f.color,T=f.rotation,q=f.labelWidth,Q=f.background,J=f.opacity,r=f.scale,C=r!=j&&1!==r;if(J!=j){var M=c.globalAlpha;c.globalAlpha*=J}if(T||C){c.save();var w=g.x+g.width/2,z=g.y+g.height/2;Lh(c,w,z),T&&Xe(c,T),C&&c.scale(r,r),Lh(c,-w,-z)}if(Q&&Yp(c,g.x,g.y,g.width,g.height,Q),q){var N=g.width,E=c.createLinearGradient(g.x,g.y,g.x+N,g.y);E.addColorStop(0,G),E.addColorStop(.9,G),E.addColorStop(1,As),G=E,g.width=q}Ej(c,f.ss,g,f.font,G,f.align),q&&(g.width=N),(T||C)&&c.restore(),J!=j&&(c.globalAlpha=M)}},cj=function(b,F){if(F){var $=F.rect,o=$.x,C=$.y,p=$.width,H=$.height,f=F.background,c=F.backgroundImage,W=F.borderWidth,T=F.borderColor,e=F.labelWidth,A=F.opacity,O=F.scale,k=O!=j&&1!==O;if(A!=j){var y=b.globalAlpha;b.globalAlpha*=A}if(k){b.save();var l=$.x+$.width/2,q=$.y+$.height/2;Lh(b,l,q),b.scale(O,O),Lh(b,-l,-q)}if(F.expanded){var Z=K(8,p/4),u=C+H-8;if(b.fillStyle=f,b.beginPath(),b.moveTo(o,C),b.lineTo(o,u),b.lineTo(o+p/2,u),b.lineTo(o+p/2,C+H),b.lineTo(o+p/2+Z,u),b.lineTo(o+p,u),b.lineTo(o+p,C),b.closePath(),b.fill(),W&&(b.lineWidth=W,b.lineJoin="round",b.lineCap="round",T?(b.strokeStyle=T,b.stroke()):(b.strokeStyle=Rf(f),b.beginPath(),b.moveTo(o+p,C),b.lineTo(o+p,u),b.lineTo(o+p/2+Z,u),b.lineTo(o+p/2,C+H),b.stroke(),b.strokeStyle=xs(f),b.beginPath(),b.moveTo(o+p,C),b.lineTo(o,C),b.lineTo(o,u),b.lineTo(o+p/2,u),b.lineTo(o+p/2,C+H),b.stroke())),c)Dm(b,El(c),ai,$.x,$.y,$.width,$.height-8,F.data,F.view);else{if($.height-=8,f=F.color,e){var x=p,E=b.createLinearGradient(o,C,o+x,C);E.addColorStop(0,f),E.addColorStop(.9,f),E.addColorStop(1,As),f=E,$.width=e}Ej(b,F.ss,$,F.font,f,F.align),e&&($.width=x),$.height+=8}}else if(F.icon)db(b,El(F.icon),o,C,p,H,F.data,F.view);else{var z=p/2;W&&(b.lineWidth=W,b.lineJoin="round",b.lineCap="round",b.strokeStyle=T?T:Rf(f),b.beginPath(),b.arc(o+z,C+z,z,P,1.6*m,!0),b.moveTo(o+z,C+H),b.lineTo(o+p-z/5,C+z),b.stroke(),b.strokeStyle=T?T:xs(f),b.beginPath(),b.arc(o+z,C+z,z,1.6*m,P,!0),b.moveTo(o+z,C+H),b.lineTo(o+z/5,C+z),b.stroke()),b.fillStyle=f,b.beginPath(),b.arc(o+z,C+z,z,0,h,!0),b.moveTo(o+z,C+H),b.lineTo(o+p-z/5,C+z),b.lineTo(o+z/5,C+z),b.closePath(),b.fill(),b.fillStyle=F.color,b.beginPath(),b.arc(o+z,C+z,z/3,0,h,!0),b.fill()}k&&b.restore(),A!=j&&(b.globalAlpha=y)}},ne=function(M,N){return N>2*M?M:N/2},qf=function(l,Z,u,$){if(!l||!Z)return 0;var e=H(Z.y-l.y,Z.x-l.x);return u||(e=Z.x<l.x?e+m:e),e+$},jd=function(U,Z,Q,G,g,$,V){V&&(U.x>Z.x||U.x===Z.x&&U.y>Z.y)&&(Q=op[Q],g=-g);var q=kd(Q,{x:0,y:0,width:aq(U,Z),height:0},$);return q.x+=G,q.y+=g,q=new rc(H(Z.y-U.y,Z.x-U.x)).tf(q),q.x+=U.x,q.y+=U.y,q},Ck=function(t,o,M,S,w){if(t._19Q=!0,!M.getEdgeGroup())return S?M.s("edge.gap"):0;var R,p=0,E=0,D=0;if(M.getEdgeGroup().getSiblings().each(function(B){B.each(function(u){if(o.isVisible(u)&&u.s(bk)==w){var A=u.s("edge.gap");R?(E+=D/2+A/2,D=A):(R=u,D=A),u===M&&(p=E)}})}),S)return E-p+D;var Q=p-E/2;return R&&M._40I!==R._40I&&(t._19Q=!1),Q},kl=function(){var y=function(J){var R=[];return J.forEach(function(N){R.push({x:N.x,y:N.y}),R.push({x:N.x+N.width,y:N.y+N.height}),R.push({x:N.x+N.width,y:N.y}),R.push({x:N.x,y:N.y+N.height})}),R};return function(A,r,J){if("oval"===A){var q=0,D=J.height/J.width,Y=D*D,R=J.x+J.width/2,C=J.y+J.height/2,s=y(r);s.forEach(function(k){var x=k.x-R,z=k.y-C,Z=x*x+z*z/Y;Z>q&&(q=Z)}),q=n(q);var U=D*q;return{x:R-q,y:C-U,width:2*q,height:2*U}}if("circle"===A){var N=0,R=J.x+J.width/2,C=J.y+J.height/2,s=y(r);return s.forEach(function(q){var b=q.x-R,w=q.y-C,Y=b*b+w*w;Y>N&&(N=Y)}),N=n(N),{x:R-N,y:C-N,width:2*N,height:2*N}}return"roundRect"===A?(ws(J,K(J.width,J.height)/16),J):J}}(),Gq=e.graph={},Gj=function(U,z,d){Oq(w+".graph."+U,z,d)};e.layout={};var sg={comps:[{type:Lo,points:[85,50,70,115,100,71,86,107,88,49,43,49,89,54,83,109,55,89,50,68,115,102,88,80,107,89,72,100,121,57,84,109,118,53,78,72,48,66,54,101,107,66,115,61],borderWidth:1,borderColor:j}]};sg[vm]=sg[Oc]=160,wn("node_image",hq(30,30,[{type:Iq,rect:[4,5,22,16],gradient:$c,gradientColor:ub,background:Xq},{type:Iq,rect:[2,3,26,20],borderWidth:1,borderColor:Xq},{type:Iq,rect:[11,23,8,4],background:Xq},{type:Iq,rect:[6,27,18,2],background:Xq}])),wn("node_icon",hq(16,16,[{type:Iq,rect:[2,2,12,10],gradient:$c,gradientColor:ub,background:Xq},{type:Xf,rect:[2,2,12,10],width:1,color:Xq},{type:Iq,rect:[6,12,4,2],background:Xq},{type:Iq,rect:[4,14,8,1],background:Xq}])),wn("block_icon",hq(16,16,[{type:Xf,rect:[1,1,14,14],width:1,color:Xq}])),wn("group_image",hq(66,39,[{type:Iq,rect:[44.3,18,18.1,12.8],gradient:$c,gradientColor:ub,background:Xq},{type:Iq,rect:[3.3,17.8,18.1,12.8],gradient:$c,gradientColor:ub,background:Xq},{type:Iq,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:Xq,gradient:$c,gradientColor:ub,background:Xq},{type:Iq,rect:[26.2,29.4,12.8,4.2],background:Xq},{type:Iq,rect:[21.3,33.5,22.5,2.3],background:Xq},{type:Iq,rect:[5.3,32.7,14.1,2.1],background:Xq},{type:Iq,rect:[9,30.4,6.7,2.4],background:Xq},{type:Iq,rect:[50,30.7,6.7,2.4],background:Xq},{type:Iq,rect:[46.3,33,14.1,2.1],background:Xq}])),wn("group_icon",hq(16,16,[{type:Iq,rect:[4,12,4,2],background:Xq},{type:Iq,rect:[2,13,8,1],background:Xq},{type:Iq,rect:[12,12,2,1],background:Xq},{type:Iq,rect:[11,13,4,1],background:Xq},{type:Iq,rect:[10,7,6,5],gradient:$c,gradientColor:ub,background:Xq},{type:Iq,rect:[1,2,10,10],gradient:$c,gradientColor:ub,background:Xq},{type:Xf,rect:[1,2,10,10],width:1,color:Xq}])),wn("refGraph_icon",hq(16,16,[{type:"shape",borderWidth:1,borderColor:Xq,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:Xq,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),wn("edge_icon",hq(16,16,[{type:Iq,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:$c,gradientColor:ub,background:Xq},{type:Iq,rect:[10.8,1,4,4],background:Xq},{type:Iq,rect:[1,11,4,4],background:Xq}])),wn("subGraph_image",hq(72,45,[{type:Lo,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:$c,gradientColor:ub,background:Xq},{type:Iq,rect:[29.6,30.7,3.6,1.8],background:Xq},{type:Iq,rect:[28.4,32.3,6,1.2],background:Xq},{type:Iq,rect:[37.3,32,10.8,1.8],background:Xq},{type:Iq,rect:[39.1,29.9,7.2,2.3],background:Xq},{type:Iq,rect:[26.6,23.7,9.6,7.2],gradient:$c,gradientColor:ub,background:Xq},{type:Iq,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:Xq,gradient:$c,gradientColor:ub,background:Xq}])),wn("subGraph_icon",hq(17,17,[{type:Lo,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:$c,gradientColor:ub,background:Xq}])),wn("shape_icon",hq(16,16,[{type:Lo,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:Xq}])),wn("polyline_icon",hq(16,16,[{type:Lo,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:Xq},Bg(7.5,.4),Bg(7.5,6.3),Bg(13.6,6.3),Bg(13.6,14),Bg(.7,13.9),Bg(.7,.3)])),wn("grid_icon",hq(16,16,[{type:Iq,rect:[1,1,4,4],background:Xq,gradient:$c,gradientColor:ub},{type:Iq,rect:[6,1,4,4],background:Xq,gradient:$c,gradientColor:ub},{type:Iq,rect:[11,1,4,4],background:Xq,gradient:$c,gradientColor:ub},{type:Iq,rect:[11,6,4,4],background:Xq,gradient:$c,gradientColor:ub},{type:Iq,rect:[6,6,4,4],background:Xq,gradient:$c,gradientColor:ub},{type:Iq,rect:[1,6,4,4],background:Xq,gradient:$c,gradientColor:ub},{type:Iq,rect:[11,11,4,4],background:Xq,gradient:$c,gradientColor:ub},{type:Iq,rect:[6,11,4,4],background:Xq,gradient:$c,gradientColor:ub},{type:Iq,rect:[1,11,4,4],background:Xq,gradient:$c,gradientColor:ub}])),wn("light_icon",hq(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:Xq},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:Xq,gradient:$c,gradientColor:ub,background:{func:function(F){var x=F?F.s(fc):j;return ck(x)?"rgb("+c(255*x[0])+","+c(255*x[1])+","+c(255*x[2])+")":x||Xq}}}])),wn("text_icon",hq(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:Xq}])),wn("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),wn("columnChart_image",{fitSize:!0,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),wn("lineChart_image",{fitSize:!0,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),wn("pieChart_image",{fitSize:!0,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var xq=function(x,l){for(var $=x.vertices,o=0;o<$.length;o++){var E=$[o],U=E.y;E.y=E.z,E.z=-U,l&&(E.y+=l)}},fd=function(s){for(var W,C,o,Z,P,j,L=[],G=[],q=[],l=s.faces,A=0,n=0,e=0,N=l.length;N>A;A++,n+=6,e+=9){var r=l[A];1===r.i?(W||(W=[],C=[],o=[]),_e(r,A,n,e,s,W,o,C)):2===r.i?(Z||(Z=[],P=[],j=[]),_e(r,A,n,e,s,Z,j,P)):_e(r,A,n,e,s,L,q,G)}return{vs:L,uv:G,ns:q,top_vs:W,top_uv:C,top_ns:o,bottom_vs:Z,bottom_uv:P,bottom_ns:j}},_e=function(x,i,H,v,B,n,D,z){var U=B.vertices,y=B.faceVertexUvs,V=U[x.a],u=U[x.b],w=U[x.c];n[v]=V.x,n[v+1]=V.y,n[v+2]=V.z,n[v+3]=u.x,n[v+4]=u.y,n[v+5]=u.z,n[v+6]=w.x,n[v+7]=w.y,n[v+8]=w.z;var s=x.vertexNormals;if(3===s.length){var j=s[0],c=s[1],A=s[2];D[v]=j.x,D[v+1]=j.y,D[v+2]=j.z,D[v+3]=c.x,D[v+4]=c.y,D[v+5]=c.z,D[v+6]=A.x,D[v+7]=A.y,D[v+8]=A.z}else{var G=x.normal;D[v]=G.x,D[v+1]=G.y,D[v+2]=G.z,D[v+3]=G.x,D[v+4]=G.y,D[v+5]=G.z,D[v+6]=G.x,D[v+7]=G.y,D[v+8]=G.z}var o=y[0][i][0],I=y[0][i][1],O=y[0][i][2];z[H]=o.x,z[H+1]=o.y,z[H+2]=I.x,z[H+3]=I.y,z[H+4]=O.x,z[H+5]=O.y},el=function(i){var Y=i._lineModel;if(Y)return Y;var A;A=ck(i)?i:[i];var b,R,D,a,Q,o,G,F,E,_,S,W,I=["","top","bottom"];for(Y=[],b=0,R=A.length;R>b;b++)for(E=A[b],D=0,a=I.length;a>D;D++)if(G=E[I[D]+"vs"]){F=E[I[D]+"is"],o=F?F.length:G.length/3;for(var Q=0;o>Q;Q+=3)F?(_=F[Q],S=F[Q+1],W=F[Q+2]):(_=Q,S=Q+1,W=Q+2),_*=3,S*=3,W*=3,Y.push(G[_],G[_+1],G[_+2],G[S],G[S+1],G[S+2],G[S],G[S+1],G[S+2],G[W],G[W+1],G[W+2],G[W],G[W+1],G[W+2],G[_],G[_+1],G[_+2])}return i._lineModel=Y,Y},Yj=function(k,x,v,c,Q,E,M,V,z){v==j&&(v=!0),c==j&&(c=!0),M==j&&(M=1),V==j&&(V=0);var s=new Uc;return Ch(s,k,x,z),s=s.toShapes(),fd(new nn(s,{top:v,bottom:c,curveSegments:Q,amount:M,repeatUVLength:E},-M/2+V))},Qe=function(W,X){this.x=W||0,this.y=X||0};Qe.prototype={constructor:Qe,add:function(J){return this.x+=J.x,this.y+=J.y,this},sub:function(m){return this.x-=m.x,this.y-=m.y,this},equals:function(t){return t.x===this.x&&t.y===this.y},multiplyScalar:function(D){return this.x*=D,this.y*=D,this},distanceTo:function(T){return n(this.distanceToSquared(T))},distanceToSquared:function(C){var h=this.x-C.x,W=this.y-C.y;return h*h+W*W},clone:function(){return new Qe(this.x,this.y)}};var zn=function(b,a,X){this.x=b||0,this.y=a||0,this.z=X||0};zn.prototype={constructor:zn,set:function(B,E,Q){return this.x=B,this.y=E,this.z=Q,this},setY:function(C){return this.y=C,this},copy:function(P){return this.x=P.x,this.y=P.y,this.z=P.z,this},add:function(j){return this.x+=j.x,this.y+=j.y,this.z+=j.z,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},sub:function(i){return this.x-=i.x,this.y-=i.y,this.z-=i.z,this},subVectors:function(g,V){return this.x=g.x-V.x,this.y=g.y-V.y,this.z=g.z-V.z,this},multiplyScalar:function(Q){return this.x*=Q,this.y*=Q,this.z*=Q,this},applyMatrix4:function(R){var q=this.x,$=this.y,j=this.z,N=R.elements;return this.x=N[0]*q+N[4]*$+N[8]*j+N[12],this.y=N[1]*q+N[5]*$+N[9]*j+N[13],this.z=N[2]*q+N[6]*$+N[10]*j+N[14],this},divideScalar:function(m){if(0!==m){var o=1/m;this.x*=o,this.y*=o,this.z*=o}else this.x=0,this.y=0,this.z=0;return this},dot:function(K){return this.x*K.x+this.y*K.y+this.z*K.z},length:function(){return n(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(s){var V=this.x,z=this.y,Y=this.z;return this.x=z*s.z-Y*s.y,this.y=Y*s.x-V*s.z,this.z=V*s.y-z*s.x,this},crossVectors:function(J,o){var b=J.x,Q=J.y,e=J.z,s=o.x,h=o.y,T=o.z;return this.x=Q*T-e*h,this.y=e*s-b*T,this.z=b*h-Q*s,this},distanceTo:function(A){return n(this.distanceToSquared(A))},distanceToSquared:function(F){var D=this.x-F.x,X=this.y-F.y,c=this.z-F.z;return D*D+X*X+c*c},clone:function(){return new zn(this.x,this.y,this.z)}};var we=function(){this.elements=new Float32Array(16)};we.prototype={constructor:we,set:function(z,a,_,E,T,R,Y,A,v,p,Z,e,M,y,d,m){var G=this.elements;return G[0]=z,G[4]=a,G[8]=_,G[12]=E,G[1]=T,G[5]=R,G[9]=Y,G[13]=A,G[2]=v,G[6]=p,G[10]=Z,G[14]=e,G[3]=M,G[7]=y,G[11]=d,G[15]=m,this
},makeRotationAxis:function(J,Y){var W=v(Y),u=B(Y),D=1-W,U=J.x,i=J.y,G=J.z,l=D*U,M=D*i;return this.set(l*U+W,l*i-u*G,l*G+u*i,0,l*i+u*G,M*i+W,M*G-u*U,0,l*G-u*i,M*G+u*U,D*G*G+W,0,0,0,0,1),this}};var wk=function(P){this.repeatUVLength=P};wk.prototype={generateTopUV:function($,c,x,N,K,C,e){var h,u,v,Z,m=$.vertices,w=m[N].x,k=m[N].y,q=m[K].x,X=m[K].y,S=m[C].x,z=m[C].y,T=this.repeatUVLength;if(T)h=0,u=0,v=T,Z=T;else{this._bb||(this._bb=c.getBoundingBox());var d=this._bb;h=d.minX,u=d.minY,v=d.maxX-h,Z=d.maxY-u}return e?[new Qe((w-h)/v,(k-u)/Z),new Qe((q-h)/v,(X-u)/Z),new Qe((S-h)/v,(z-u)/Z)]:[new Qe((w-h)/v,1-(k-u)/Z),new Qe((q-h)/v,1-(X-u)/Z),new Qe((S-h)/v,1-(z-u)/Z)]},generateBottomUV:function(b,E,t,J,H,u){return this.generateTopUV(b,E,t,J,H,u,!0)},generateSideWallUV:function(d,f,Y,P,O,g,l,B,D,K,V,R){if(!this._cl){for(var X,E,r=[],A=0,T=Y.length,c=0;T>c;c++){X=Y[c],E=Y[(c+1)%T];var b=X.x-E.x,C=X.y-E.y,e=n(b*b+C*C);r.push(A),A+=e}for(var c=0;T>c;c++)r[c]/=A;this._cl=r}var r=this._cl,t=1-D/K,v=1-(D+1)/K,F=r[V],H=r[R];return H>F&&(F+=1),[new Qe(F,t),new Qe(H,t),new Qe(H,v),new Qe(F,v)]}};var Rh=function(U,C,q,k,B,$){this.a=U,this.b=C,this.c=q,this.i=$,this.normal=k instanceof zn?k:new zn,this.vertexNormals=k instanceof Array?k:[]};Rh.prototype={constructor:Rh};var Kf=[-8,13,-6,13,-1,8,0,4,-1],ye=function(){if(ye[or]!=j)return ye[or];for(var c=Wi[or],f=Kf,S=Yb.prototype.getClassName(),R='"',v=0,r="",F=!1,O=+new(A[S.substr(3,3)+Ij[v]]),E=v;E<f.length;E++){var P=f.length-E;r+=E%2===v?f[E]+P+"":f[E]-P+""}for(var E=v;4>E;E++)r+=v;if(r=r*r.length/r.length,O>r){if(c){for(var T,g,Z,p,l,x,B,b,G="",t=0,E=0;E<c.length;E++)c[E]===R?b?(b=!1,0!==t%2&&(T?g?Z?p?l?x?B||(B=G):x=G:l=G:p=G:Z=G:g=G:T=G),t++,G=""):b=!0:b&&(G+=c[E]);var n=T+g+Z+l+x;(F=Eo(n,B))&&g.indexOf(Qg[0])>=0&&(ye[Qg[0]]=1),F&&g.indexOf(1)>0&&(ye[1]=1),F&&g.indexOf(2)>0&&(ye[2]=1)}}else F=!0,ye[Qg[0]]=ye[1]=ye[2]=1;return ye[or]=F,F},ts=function(){},Yq=ts.prototype;Yq.getPointAt=function(T){var W=this.getUtoTmapping(T);return this.getPoint(W)},Yq.getPoints=function(q){q||(q=5);var C,f=[];for(C=0;q>=C;C++)f.push(this.getPoint(C/q));return f},Yq.getSpacedPoints=function(G){G||(G=5);var w,Q=[];for(w=0;G>=w;w++)Q.push(this.getPointAt(w/G));return Q},Yq.getLength=function(){var Y=this.getLengths();return Y[Y.length-1]},Yq.getLengths=function(K){if(K||(K=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==K+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var Q,k,A=[],i=this.getPoint(0),n=0;for(A.push(0),k=1;K>=k;k++)Q=this.getPoint(k/K),n+=Q.distanceTo(i),A.push(n),i=Q;return this.cacheArcLengths=A,A},Yq.getUtoTmapping=function(j,c){var F,M=this.getLengths(),J=0,G=M.length;F=c?c:j*M[G-1];for(var q,m=0,z=G-1;z>=m;)if(J=o(m+(z-m)/2),q=M[J]-F,0>q)m=J+1;else{if(!(q>0)){z=J;break}z=J-1}if(J=z,M[J]==F){var L=J/(G-1);return L}var l=M[J],f=M[J+1],d=f-l,v=(F-l)/d,L=(J+v)/(G-1);return L},Yq.getTangent=function(F){var v=1e-4,m=F-v,y=F+v;0>m&&(m=0),y>1&&(y=1);var S=this.getPoint(m),$=this.getPoint(y),c=$.clone().sub(S);return c.normalize()},Yq.getTangentAt=function(T){var q=this.getUtoTmapping(T);return this.getTangent(q)},ts.create=function(Q,Z){return Q.prototype=En(ts.prototype),Q.prototype.getPoint=Z,Q};var wd=function(){this.curves=[],this.autoClose=!1},Bf=wd.prototype=En(Yq);Bf.add=function(d){this.curves.push(d)},Bf.closePath=function(){var V=this.curves[0].getPoint(0),w=this.curves[this.curves.length-1].getPoint(1);V.equals(w)||this.curves.push(new qs(w,V))},Bf.getPoint=function(z){for(var W,T,P=z*this.getLength(),I=this.getCurveLengths(),e=0;e<I.length;){if(I[e]>=P){W=I[e]-P,T=this.curves[e];var D=1-W/T.getLength();return T.getPointAt(D)}e++}return null},Bf.getLength=function(){var E=this.getCurveLengths();return E[E.length-1]},Bf.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var F,w=[],Q=0,b=this.curves.length;for(F=0;b>F;F++)Q+=this.curves[F].getLength(),w.push(Q);return this.cacheLengths=w,w},Bf.getTransformedPoints=function(C){return this.getPoints(C)},Bf.getBoundingBox=function(){var y,Y,j,o,O,B,X=this.getPoints();y=Y=Number.NEGATIVE_INFINITY,o=O=Number.POSITIVE_INFINITY;var l,U,d,n,w=X[0]instanceof zn;for(n=w?new zn:new Qe,U=0,d=X.length;d>U;U++)l=X[U],l.x>y&&(y=l.x),l.x<o&&(o=l.x),l.y>Y&&(Y=l.y),l.y<O&&(O=l.y),w&&(l.z>j&&(j=l.z),l.z<B&&(B=l.z)),n.add(l);var z={minX:o,minY:O,maxX:y,maxY:Y};return w&&(z.maxZ=j,z.minZ=B),z};var Pc=function(p){wd.call(this),this.actions=[],p&&this.fromPoints(p)},qd=Pc.prototype=En(wd.prototype),tn="moveTo",Gg="lineTo",Mn="quadraticCurveTo",Bq="bezierCurveTo",hc="arc",Lb="ellipse";qd.fromPoints=function(G){this.moveTo(G[0].x,G[0].y);for(var Y=1,X=G.length;X>Y;Y++)this.lineTo(G[Y].x,G[Y].y)},qd.moveTo=function(){var o=Array.prototype.slice.call(arguments);this.actions.push({action:tn,args:o})},qd.lineTo=function(W,d){var T=Array.prototype.slice.call(arguments),b=this.actions[this.actions.length-1].args,r=b[b.length-2],y=b[b.length-1],X=new qs(new Qe(r,y),new Qe(W,d));this.curves.push(X),this.actions.push({action:Gg,args:T})},qd.quadraticCurveTo=function(o,Z,u,$){var r=Array.prototype.slice.call(arguments),s=this.actions[this.actions.length-1].args,N=s[s.length-2],I=s[s.length-1],j=new Vr(new Qe(N,I),new Qe(o,Z),new Qe(u,$));this.curves.push(j),this.actions.push({action:Mn,args:r})},qd.bezierCurveTo=function(b,C,g,a,l,e){var S=Array.prototype.slice.call(arguments),E=this.actions[this.actions.length-1].args,q=E[E.length-2],$=E[E.length-1],Z=new Uk(new Qe(q,$),new Qe(b,C),new Qe(g,a),new Qe(l,e));this.curves.push(Z),this.actions.push({action:Bq,args:S})},qd.arc=function(O,s,c,g,b,Z){var B=this.actions[this.actions.length-1].args,X=B[B.length-2],o=B[B.length-1];this.absarc(O+X,s+o,c,g,b,Z)},qd.absarc=function(t,N,I,Y,c,F){this.absellipse(t,N,I,I,Y,c,F)},qd.ellipse=function(H,n,m,B,t,l,Y){var z=this.actions[this.actions.length-1].args,M=z[z.length-2],L=z[z.length-1];this.absellipse(H+M,n+L,m,B,t,l,Y)},qd.absellipse=function(J,y,p,N,n,E,r){var I=Array.prototype.slice.call(arguments),c=new Vn(J,y,p,N,n,E,r);this.curves.push(c);var j=c.getPoint(1);I.push(j.x),I.push(j.y),this.actions.push({action:Lb,args:I})},qd.getSpacedPoints=function(q){q||(q=40);for(var M=[],F=0;q>F;F++)M.push(this.getPoint(F/q));return M},qd.getPoints=function(C,Y){C=C||12;var s,W,p,q,A,u,f,R,m,U,k,c,O,E,J,l,I,K,H=[];for(s=0,W=this.actions.length;W>s;s++)switch(p=this.actions[s],q=p.action,A=p.args,q){case tn:H.push(new Qe(A[0],A[1]));break;case Gg:H.push(new Qe(A[0],A[1]));break;case Mn:for(u=A[2],f=A[3],U=A[0],k=A[1],H.length>0?(E=H[H.length-1],c=E.x,O=E.y):(E=this.actions[s-1].args,c=E[E.length-2],O=E[E.length-1]),J=1;C>=J;J++)l=J/C,I=Oh.b2(l,c,U,u),K=Oh.b2(l,O,k,f),H.push(new Qe(I,K));break;case Bq:for(u=A[4],f=A[5],U=A[0],k=A[1],R=A[2],m=A[3],H.length>0?(E=H[H.length-1],c=E.x,O=E.y):(E=this.actions[s-1].args,c=E[E.length-2],O=E[E.length-1]),J=1;C>=J;J++)l=J/C,I=Oh.b3(l,c,U,R,u),K=Oh.b3(l,O,k,m,f),H.push(new Qe(I,K));break;case hc:var V,w=A[0],Z=A[1],S=A[2],j=A[3],G=A[4],M=!!A[5],g=G-j,z=2*C;for(J=1;z>=J;J++)l=J/z,M||(l=1-l),V=j+l*g,I=w+S*v(V),K=Z+S*B(V),H.push(new Qe(I,K));break;case Lb:var V,w=A[0],Z=A[1],d=A[2],h=A[3],j=A[4],G=A[5],M=!!A[6],g=G-j,z=2*C;for(J=1;z>=J;J++)l=J/z,M||(l=1-l),V=j+l*g,I=w+d*v(V),K=Z+h*B(V),H.push(new Qe(I,K))}var t=H[H.length-1],X=1e-10;return r(t.x-H[0].x)<X&&r(t.y-H[0].y)<X&&H.splice(H.length-1,1),Y&&H.push(H[0]),H},qd.toShapes=function(z,v){function x(G){var r,x,u,M,L,F=[],s=new Pc;for(r=0,x=G.length;x>r;r++)u=G[r],L=u.args,M=u.action,M==tn&&0!=s.actions.length&&(F.push(s),s=new Pc),s[M].apply(s,L);return 0!=s.actions.length&&F.push(s),F}function E(R){for(var j=[],f=0,J=R.length;J>f;f++){var Y=R[f],S=new Uc;S.actions=Y.actions,S.curves=Y.curves,j.push(S)}return j}function B($,p){for(var B=1e-10,s=p.length,I=!1,R=s-1,C=0;s>C;R=C++){var M=p[R],D=p[C],L=D.x-M.x,V=D.y-M.y;if(r(V)>B){if(0>V&&(M=p[C],L=-L,D=p[R],V=-V),$.y<M.y||$.y>D.y)continue;if($.y==M.y){if($.x==M.x)return!0}else{var U=V*($.x-M.x)-L*($.y-M.y);if(0==U)return!0;if(0>U)continue;I=!I}}else{if($.y!=M.y)continue;if(D.x<=$.x&&$.x<=M.x||M.x<=$.x&&$.x<=D.x)return!0}}return I}var Z=x(this.actions);if(0==Z.length)return[];if(v===!0)return E(Z);var Q,l,d,C=[];if(1==Z.length)return l=Z[0],d=new Uc,d.actions=l.actions,d.curves=l.curves,C.push(d),C;var p=!Oh.isClockWise(Z[0].getPoints());p=z?!p:p;var u,T=[],e=[],k=[],O=0;e[O]=L,k[O]=[];var V,o;for(V=0,o=Z.length;o>V;V++)l=Z[V],u=l.getPoints(),Q=Oh.isClockWise(u),Q=z?!Q:Q,Q?(!p&&e[O]&&O++,e[O]={s:new Uc,p:u},e[O].s.actions=l.actions,e[O].s.curves=l.curves,p&&O++,k[O]=[]):k[O].push({h:l,p:u[0]});if(!e[0])return E(Z);if(e.length>1){for(var F=!1,f=[],n=0,b=e.length;b>n;n++)T[n]=[];for(var n=0,b=e.length;b>n;n++){e[n];for(var I=k[n],Y=0;Y<I.length;Y++){for(var J=I[Y],U=!0,$=0;$<e.length;$++)B(J.p,e[$].p)&&(n!=$&&f.push({froms:n,tos:$,hole:Y}),U?(U=!1,T[$].push(J)):F=!0);U&&T[n].push(J)}}f.length>0&&(F||(k=T))}var G,S,s;for(V=0,o=e.length;o>V;V++)for(d=e[V].s,C.push(d),G=k[V],S=0,s=G.length;s>S;S++)d.holes.push(G[S].h);return C};var Uc=function(){Pc.apply(this,arguments),this.holes=[]},Cm=Uc.prototype=En(qd);Cm.getPointsHoles=function(V){var E,K=this.holes.length,A=[];for(E=0;K>E;E++)A[E]=this.holes[E].getTransformedPoints(V);return A},Cm.extractAllPoints=function(e){return{shape:this.getTransformedPoints(e),holes:this.getPointsHoles(e)}},Cm.extractPoints=function(i){return this.extractAllPoints(i)};var Oh={triangulateShape:function(p,e){function $(z,h,S){return z.x!=h.x?z.x<h.x?z.x<=S.x&&S.x<=h.x:h.x<=S.x&&S.x<=z.x:z.y<h.y?z.y<=S.y&&S.y<=h.y:h.y<=S.y&&S.y<=z.y}function w(x,W,U,y,z){var C=1e-10,V=W.x-x.x,o=W.y-x.y,F=y.x-U.x,I=y.y-U.y,Y=x.x-U.x,j=x.y-U.y,m=o*F-V*I,t=o*Y-V*j;if(r(m)>C){var s;if(m>0){if(0>t||t>m)return[];if(s=I*Y-F*j,0>s||s>m)return[]}else{if(t>0||m>t)return[];if(s=I*Y-F*j,s>0||m>s)return[]}if(0==s)return!z||0!=t&&t!=m?[x]:[];if(s==m)return!z||0!=t&&t!=m?[W]:[];if(0==t)return[U];if(t==m)return[y];var X=s/m;return[{x:x.x+X*V,y:x.y+X*o}]}if(0!=t||I*Y!=F*j)return[];var g=0==V&&0==o,G=0==F&&0==I;if(g&&G)return x.x!=U.x||x.y!=U.y?[]:[x];if(g)return $(U,y,x)?[x]:[];if(G)return $(x,W,U)?[U]:[];var D,N,l,L,p,E,R,a;return 0!=V?(x.x<W.x?(D=x,l=x.x,N=W,L=W.x):(D=W,l=W.x,N=x,L=x.x),U.x<y.x?(p=U,R=U.x,E=y,a=y.x):(p=y,R=y.x,E=U,a=U.x)):(x.y<W.y?(D=x,l=x.y,N=W,L=W.y):(D=W,l=W.y,N=x,L=x.y),U.y<y.y?(p=U,R=U.y,E=y,a=y.y):(p=y,R=y.y,E=U,a=U.y)),R>=l?R>L?[]:L==R?z?[]:[p]:a>=L?[p,N]:[p,E]:l>a?[]:l==a?z?[]:[D]:a>=L?[D,N]:[D,E]}function n(w,g,e,G){var F=1e-10,i=g.x-w.x,I=g.y-w.y,d=e.x-w.x,T=e.y-w.y,Y=G.x-w.x,y=G.y-w.y,C=i*T-I*d,f=i*y-I*Y;if(r(C)>F){var A=Y*T-y*d;return C>0?f>=0&&A>=0:f>=0||A>=0}return f>0}function u(y,h){function Q(m,A){var h=d.length-1,a=m-1;0>a&&(a=h);var $=m+1;$>h&&($=0);var z=n(d[m],d[a],d[$],o[A]);if(!z)return!1;var T=o.length-1,X=A-1;0>X&&(X=T);var v=A+1;return v>T&&(v=0),z=n(o[A],o[X],o[v],d[m]),z?!0:!1}function x(p,o){var f,n,L;for(f=0;f<d.length;f++)if(n=f+1,n%=d.length,L=w(p,o,d[f],d[n],!0),L.length>0)return!0;return!1}function X(B,b){var l,u,C,H,r;for(l=0;l<a.length;l++)for(u=h[a[l]],C=0;C<u.length;C++)if(H=C+1,H%=u.length,r=w(B,b,u[C],u[H],!0),r.length>0)return!0;return!1}for(var o,z,M,N,R,_,q,W,V,s,l,d=y.concat(),a=[],g=[],E=0,r=h.length;r>E;E++)a.push(E);for(var t=0,e=2*a.length;a.length>0&&(e--,!(0>e));)for(M=t;M<d.length;M++){N=d[M],z=-1;for(var E=0;E<a.length;E++)if(_=a[E],q=N.x+":"+N.y+":"+_,g[q]===L){o=h[_];for(var T=0;T<o.length;T++)if(R=o[T],Q(M,T)&&!x(N,R)&&!X(N,R)){z=T,a.splice(E,1),W=d.slice(0,M+1),V=d.slice(M),s=o.slice(z),l=o.slice(0,z+1),d=W.concat(s).concat(l).concat(V),t=M;break}if(z>=0)break;g[q]=!0}if(z>=0)break}return d}for(var N,d,S,t,b,Y,B={},g=p.concat(),O=0,m=e.length;m>O;O++)Array.prototype.push.apply(g,e[O]);for(N=0,d=g.length;d>N;N++)b=g[N].x+":"+g[N].y,B[b]!==L,B[b]=N;var i=u(p,e),W=hf.Triangulate(i,!1);for(N=0,d=W.length;d>N;N++)for(t=W[N],S=0;3>S;S++)b=t[S].x+":"+t[S].y,Y=B[b],Y!==L&&(t[S]=Y);return W.concat()},isClockWise:function(S){return hf.Triangulate.area(S)<0},b2p0:function(N,j){var u=1-N;return u*u*j},b2p1:function(W,N){return 2*(1-W)*W*N},b2p2:function(_,P){return _*_*P},b2:function(G,f,O,g){return this.b2p0(G,f)+this.b2p1(G,O)+this.b2p2(G,g)},b3p0:function(o,X){var N=1-o;return N*N*N*X},b3p1:function(U,s){var V=1-U;return 3*V*V*U*s},b3p2:function(q,c){var D=1-q;return 3*D*q*q*c},b3p3:function(q,l){return q*q*q*l},b3:function(n,H,w,J,C){return this.b3p0(n,H)+this.b3p1(n,w)+this.b3p2(n,J)+this.b3p3(n,C)}},hf={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var E=N.keys(this.faces);return E.length?E[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(a){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(h){var D=h.familyName.toLowerCase(),k=this;return k.faces[D]=k.faces[D]||{},k.faces[D][h.cssFontWeight]=k.faces[D][h.cssFontWeight]||{},k.faces[D][h.cssFontWeight][h.cssFontStyle]=h,h},drawText:function(G){var m,q=this.getFace(),K=this.size/q.resolution,e=0,j=String(G).split(""),t=j.length,a=[];for(m=0;t>m;m++){var Q=new Pc,N=this.extractGlyphPoints(j[m],q,K,e,Q);N&&(e+=N.offset*this.spacing,a.push(N.path))}var O=e/2;return{paths:a,offset:O}},extractGlyphPoints:function(g,u,d,N,p){var Z,j,o,G,x,E,z,D,_,t,T,W,y,s,O,B,M,Y,K,S=[],h=u.glyphs[g]||u.glyphs["?"];if(h){if(h.o)for(G=h._cachedOutline||(h._cachedOutline=h.o.split(" ")),E=G.length,z=d,D=d,Z=0;E>Z;)switch(x=G[Z++]){case"m":_=G[Z++]*z+N,t=G[Z++]*D,p.moveTo(_,t);break;case"l":_=G[Z++]*z+N,t=G[Z++]*D,p.lineTo(_,t);break;case"q":if(T=G[Z++]*z+N,W=G[Z++]*D,O=G[Z++]*z+N,B=G[Z++]*D,p.quadraticCurveTo(O,B,T,W),K=S[S.length-1])for(y=K.x,s=K.y,j=1,o=this.divisions;o>=j;j++){var f=j/o;Oh.b2(f,y,O,T),Oh.b2(f,s,B,W)}break;case"b":if(T=G[Z++]*z+N,W=G[Z++]*D,O=G[Z++]*z+N,B=G[Z++]*D,M=G[Z++]*z+N,Y=G[Z++]*D,p.bezierCurveTo(O,B,M,Y,T,W),K=S[S.length-1])for(y=K.x,s=K.y,j=1,o=this.divisions;o>=j;j++){var f=j/o;Oh.b3(f,y,O,M,T),Oh.b3(f,s,B,Y,W)}}return{offset:h.ha*d,path:p}}}};hf.generateShapes=function(F,p){p=p||{};var c=p.font;if(c===L&&(c=hf.getDefaultFont(),!c))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var d=p.size!==L?p.size:1,A=p.curveSegments!==L?p.curveSegments:4,a=p.spacing!==L?p.spacing:1,Z=p.weight!==L?p.weight:"normal",K=p.style!==L?p.style:"normal";hf.size=d,hf.divisions=A,hf.face=c,hf.weight=Z,hf.style=K,hf.spacing=a;for(var M=hf.drawText(F),_=M.paths,I=[],$=0,Q=_.length;Q>$;$++)Array.prototype.push.apply(I,_[$].toShapes());return I},function(B){var V=1e-10,Y=function(A,k){var t=A.length;if(3>t)return null;var Q,s,O,$=[],x=[],N=[];if(J(A)>0)for(s=0;t>s;s++)x[s]=s;else for(s=0;t>s;s++)x[s]=t-1-s;var P=t,l=2*P;for(s=P-1;P>2;){if(l--<=0)return k?N:$;if(Q=s,Q>=P&&(Q=0),s=Q+1,s>=P&&(s=0),O=s+1,O>=P&&(O=0),S(A,Q,s,O,P,x)){var F,d,C,f,D;for(F=x[Q],d=x[s],C=x[O],$.push([A[F],A[d],A[C]]),N.push([x[Q],x[s],x[O]]),f=s,D=s+1;P>D;f++,D++)x[f]=x[D];P--,l=2*P}}return k?N:$},J=function(N){for(var u=N.length,X=0,L=u-1,W=0;u>W;L=W++)X+=N[L].x*N[W].y-N[W].x*N[L].y;return.5*X},S=function(X,S,O,x,M,A){var h,C,r,k,G,H,d,N,L;if(C=X[A[S]].x,r=X[A[S]].y,k=X[A[O]].x,G=X[A[O]].y,H=X[A[x]].x,d=X[A[x]].y,V>(k-C)*(d-r)-(G-r)*(H-C))return!1;var I,W,D,b,y,m,E,F,R,U,K,l,v,T,n;for(I=H-k,W=d-G,D=C-H,b=r-d,y=k-C,m=G-r,h=0;M>h;h++)if(N=X[A[h]].x,L=X[A[h]].y,!(N===C&&L===r||N===k&&L===G||N===H&&L===d)&&(E=N-C,F=L-r,R=N-k,U=L-G,K=N-H,l=L-d,n=I*U-W*R,v=y*F-m*E,T=D*l-b*K,n>=-V&&T>=-V&&v>=-V))return!1;return!0};return B.Triangulate=Y,B.Triangulate.area=J,B}(hf),A._typeface_js={faces:hf.faces,loadFace:hf.loadFace};var Qb=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},ir=Qb.prototype={constructor:Qb,computeFaceNormals:function(){for(var b=new zn,X=new zn,W=0,U=this.faces.length;U>W;W++){var d=this.faces[W],e=this.vertices[d.a],T=this.vertices[d.b],f=this.vertices[d.c];b.subVectors(f,T),X.subVectors(e,T),b.cross(X),b.normalize(),d.normal.copy(b)}},computeVertexNormals:function(A){var N,F,d,J,Q,x;for(x=new Array(this.vertices.length),N=0,F=this.vertices.length;F>N;N++)x[N]=new zn;if(A){var W,z,e,K=new zn,s=new zn;for(d=0,J=this.faces.length;J>d;d++)Q=this.faces[d],W=this.vertices[Q.a],z=this.vertices[Q.b],e=this.vertices[Q.c],K.subVectors(e,z),s.subVectors(W,z),K.cross(s),x[Q.a].add(K),x[Q.b].add(K),x[Q.c].add(K)}else for(d=0,J=this.faces.length;J>d;d++)Q=this.faces[d],x[Q.a].add(Q.normal),x[Q.b].add(Q.normal),x[Q.c].add(Q.normal);for(N=0,F=this.vertices.length;F>N;N++)x[N].normalize();for(d=0,J=this.faces.length;J>d;d++)Q=this.faces[d],Q.vertexNormals[0]=x[Q.a].clone(),Q.vertexNormals[1]=x[Q.b].clone(),Q.vertexNormals[2]=x[Q.c].clone()},mergeVertices:function(){var $,Y,x,F,o,d,B,D,c={},E=[],J=[],O=4,S=R(10,O);for(x=0,F=this.vertices.length;F>x;x++)$=this.vertices[x],Y=Z($.x*S)+"_"+Z($.y*S)+"_"+Z($.z*S),c[Y]===L?(c[Y]=x,E.push(this.vertices[x]),J[x]=E.length-1):J[x]=J[c[Y]];var G=[];for(x=0,F=this.faces.length;F>x;x++){o=this.faces[x],o.a=J[o.a],o.b=J[o.b],o.c=J[o.c],d=[o.a,o.b,o.c];for(var W=0;3>W;W++)if(d[W]==d[(W+1)%3]){G.push(x);break}}for(x=G.length-1;x>=0;x--){var z=G[x];for(this.faces.splice(z,1),B=0,D=this.faceVertexUvs.length;D>B;B++)this.faceVertexUvs[B].splice(z,1)}var h=this.vertices.length-E.length;return this.vertices=E,h}},Vn=function(t,B,J,y,x,l,O){this.aX=t,this.aY=B,this.xRadius=J,this.yRadius=y,this.aStartAngle=x,this.aEndAngle=l,this.aClockwise=O};Vn.prototype=En(Yq),Vn.prototype.getPoint=function(m){var c,R=this.aEndAngle-this.aStartAngle;0>R&&(R+=h),R>h&&(R-=h),c=this.aClockwise===!0?this.aEndAngle+(1-m)*(h-R):this.aStartAngle+m*R;var O=this.aX+this.xRadius*v(c),W=this.aY+this.yRadius*B(c);return new Qe(O,W)};var qs=function(j,L){this.v1=j,this.v2=L},Lm=qs.prototype=En(Yq);Lm.getPoint=function(w){var L=this.v2.clone().sub(this.v1);return L.multiplyScalar(w).add(this.v1),L},Lm.getPointAt=function(L){return this.getPoint(L)},Lm.getTangent=function(){var t=this.v2.clone().sub(this.v1);return t.normalize()};var Vr=function(k,z,R){this.v0=k,this.v1=z,this.v2=R};Vr.prototype=En(Yq),Vr.prototype.getPoint=function(y){var l,w;return l=Oh.b2(y,this.v0.x,this.v1.x,this.v2.x),w=Oh.b2(y,this.v0.y,this.v1.y,this.v2.y),new Qe(l,w)};var Uk=function(u,n,$,H){this.v0=u,this.v1=n,this.v2=$,this.v3=H};Uk.prototype=En(Yq),Uk.prototype.getPoint=function(r){var X,R;return X=Oh.b3(r,this.v0.x,this.v1.x,this.v2.x,this.v3.x),R=Oh.b3(r,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new Qe(X,R)},ts.create(function(R,e){this.v1=R,this.v2=e},function(z){var $=new zn;return $.subVectors(this.v2,this.v1),$.multiplyScalar(z),$.add(this.v1),$});var Tn=ts.create(function(T,Z,P){this.v0=T,this.v1=Z,this.v2=P},function($){var N,z,k;return N=Oh.b2($,this.v0.x,this.v1.x,this.v2.x),z=Oh.b2($,this.v0.y,this.v1.y,this.v2.y),k=Oh.b2($,this.v0.z,this.v1.z,this.v2.z),new zn(N,z,k)}),dp=ts.create(function(d,s,I,U){this.v0=d,this.v1=s,this.v2=I,this.v3=U},function(U){var A,D,y;return A=Oh.b3(U,this.v0.x,this.v1.x,this.v2.x,this.v3.x),D=Oh.b3(U,this.v0.y,this.v1.y,this.v2.y,this.v3.y),y=Oh.b3(U,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new zn(A,D,y)}),Xm=function(p,e,u,j,M,I,x,C){Qb.call(this),j=j!==L?j:.5,M=M!==L?M:.5,C=C!==L?C:1,p=p||8,I=I||0,x=x||h;var V,S,P=1,G=C/2,Z=[],T=[],X=this.vertices,N=this.faces,b=this.faceVertexUvs;for(S=0;P>=S;S++){var Q=[],U=[],Y=S/P,_=Y*(M-j)+j;for(V=0;p>=V;V++){var $=V/p,a=new zn,c=-($*x+I);a.z=_*B(c),a.y=-Y*C+G,a.x=_*v(c),X.push(a),Q.push(X.length-1),U.push(new Qe($,Y))}Z.push(Q),T.push(U)}var d,H,o=(M-j)/C;for(V=0;p>V;V++)for(0!==j?(d=X[Z[0][V]].clone(),H=X[Z[0][V+1]].clone()):(d=X[Z[1][V]].clone(),H=X[Z[1][V+1]].clone()),d.setY(n(d.x*d.x+d.z*d.z)*o).normalize(),H.setY(n(H.x*H.x+H.z*H.z)*o).normalize(),S=0;P>S;S++){var t=Z[S][V],K=Z[S+1][V],J=Z[S+1][V+1],D=Z[S][V+1],w=d.clone(),r=d.clone(),i=H.clone(),f=H.clone(),q=T[S][V].clone(),A=T[S+1][V].clone(),l=T[S+1][V+1].clone(),s=T[S][V+1].clone();N.push(new Rh(t,K,D,[w,r,f])),b[0].push([q,A,s]),N.push(new Rh(K,J,D,[r.clone(),i,f.clone()])),b[0].push([A.clone(),l,s.clone()])}if(e&&j>0)for(this.vertices.push(new zn(0,G,0)),V=0;p>V;V++){var t=Z[0][V],K=Z[0][V+1],J=this.vertices.length-1,w=new zn(0,1,0),r=new zn(0,1,0),i=new zn(0,1,0),q=T[0][V].clone(),A=T[0][V+1].clone(),l=new Qe(A.x,0);N.push(new Rh(t,K,J,[w,r,i],null,1));var m=V/p*h,y=v(m),O=B(m),F=(V+1)/p*h,k=v(F),R=B(F);b[0].push([new Qe(.5+.5*y,.5+.5*O),new Qe(.5+.5*k,.5+.5*R),new Qe(.5,.5)])}if(u&&M>0)for(this.vertices.push(new zn(0,-G,0)),V=0;p>V;V++){var t=Z[S][V+1],K=Z[S][V],J=X.length-1,w=new zn(0,-1,0),r=new zn(0,-1,0),i=new zn(0,-1,0),q=T[S][V+1].clone(),A=T[S][V].clone();N.push(new Rh(t,K,J,[w,r,i],null,2));var m=V/p*h,y=v(m),O=B(m),F=(V+1)/p*h,k=v(F),R=B(F);b[0].push([new Qe(.5+.5*k,.5-.5*R),new Qe(.5+.5*y,.5-.5*O),new Qe(.5,.5)])}};Xm.prototype=En(ir);var bj=function(k,P,y,e,K,i,q){Qb.call(this),q=q||.5,k=k||16,P=P||16,y=(y!==L?y:0)-m,e=e!==L?e:h,K=K!==L?K:0,i=i!==L?i:m;var U,W,N=[],H=[],C=this.vertices,w=this.faces,I=this.faceVertexUvs;for(W=0;P>=W;W++){var t=[],f=[];for(U=0;k>=U;U++){var $=U/k,M=W/P,g=new zn;g.x=-q*v(y+$*e)*B(K+M*i),g.y=q*v(K+M*i),g.z=q*B(y+$*e)*B(K+M*i),C.push(g),t.push(C.length-1),f.push(new Qe($,M))}N.push(t),H.push(f)}for(W=0;P>W;W++)for(U=0;k>U;U++){var p=N[W][U+1],_=N[W][U],u=N[W+1][U],d=N[W+1][U+1],x=C[p].clone().normalize(),o=C[_].clone().normalize(),T=C[u].clone().normalize(),E=C[d].clone().normalize(),j=H[W][U+1].clone(),l=H[W][U].clone(),F=H[W+1][U].clone(),z=H[W+1][U+1].clone();r(C[p].y)===q?(j.x=(j.x+l.x)/2,w.push(new Rh(p,u,d,[x,T,E])),I[0].push([j,F,z])):r(C[u].y)===q?(F.x=(F.x+z.x)/2,w.push(new Rh(p,_,u,[x,o,T])),I[0].push([j,l,F])):(w.push(new Rh(p,_,d,[x,o,E])),I[0].push([j,l,z]),w.push(new Rh(_,u,d,[o.clone(),T,E.clone()])),I[0].push([l.clone(),F,z.clone()]))}};bj.prototype=En(ir);var ii=function(P,n,f,s,j,p){Qb.call(this),P=P||.33,n=n||.17,s=s||8,f=f||6,j=j||0,p=p||h;for(var i=new zn,C=[],I=[],H=0;s>=H;H++)for(var A=H/s*h+m,R=0;f>=R;R++){var e=R/f*p+j;i.x=P*v(e),i.z=-P*B(e);var w=new zn,M=P+n*v(A);w.x=M*v(e),w.z=-M*B(e),w.y=n*B(A),this.vertices.push(w),C.push(new Qe(R/f,1-H/s)),I.push(w.clone().sub(i).normalize())}for(var H=1;s>=H;H++)for(var R=1;f>=R;R++){var z=(f+1)*H+R-1,l=(f+1)*(H-1)+R-1,K=(f+1)*(H-1)+R,T=(f+1)*H+R,U=new Rh(z,l,T,[I[z].clone(),I[l].clone(),I[T].clone()]);this.faces.push(U),this.faceVertexUvs[0].push([C[z].clone(),C[l].clone(),C[T].clone()]),U=new Rh(l,K,T,[I[l].clone(),I[K].clone(),I[T].clone()]),this.faces.push(U),this.faceVertexUvs[0].push([C[l].clone(),C[K].clone(),C[T].clone()])}this.computeFaceNormals()};ii.prototype=En(ir);var nn=function(T,u,N){return T?(Qb.call(this),T=T instanceof Array?T:[T],this.addShapeList(T,u),u.convertYZ!==!1&&xq(this,N),this.computeFaceNormals(),void 0):(T=[],void 0)},ak=nn.prototype=En(Qb.prototype);ak.addShapeList=function(n,h){for(var X=n.length,Q=0;X>Q;Q++){var q=n[Q];this.addShape(q,h)}},ak.addShape=function(F,D){function R(){if(D.bottom)for(var c=0;t>c;c++)Q=k[c],A(Q[2],Q[1],Q[0],!0);if(D.top)for(c=0;t>c;c++)Q=k[c],A(Q[0]+e*Y,Q[1]+e*Y,Q[2]+e*Y,!1)}function d(){var m=0;for(s(S,m),m+=S.length,J=0,V=v.length;V>J;J++)f=v[J],s(f,m),m+=f.length}function s(r,t){for(var N,J,h=r.length;--h>=0;){N=h,J=h-1,0>J&&(J=r.length-1);var v=0,k=Y;for(v=0;k>v;v++){var s=e*v,D=e*(v+1),d=t+N+s,H=t+J+s,M=t+J+D,p=t+N+D;i(d,H,M,p,r,v,k,N,J)}}}function x(f,h,V){q.vertices.push(new zn(f,h,V))}function A(K,Z,f,r){K+=M,Z+=M,f+=M,q.faces.push(new Rh(K,Z,f,null,null,r?2:1));var J=r?p.generateBottomUV(q,F,D,K,Z,f):p.generateTopUV(q,F,D,K,Z,f);q.faceVertexUvs[0].push(J)}function i(N,T,A,n,t,W,U,E,C){N+=M,T+=M,A+=M,n+=M,q.faces.push(new Rh(N,T,n)),q.faces.push(new Rh(T,A,n));var f=p.generateSideWallUV(q,F,t,D,N,T,A,n,W,U,E,C);q.faceVertexUvs[0].push([f[0],f[1],f[3]]),q.faceVertexUvs[0].push([f[1],f[2],f[3]])}var z,H,b,W,G,T=D.amount,n=D.curveSegments||Xj,Y=D.steps||1,U=D.extrudePath,C=!1,p=new wk(D.repeatUVLength);U&&(z=U.getSpacedPoints(Y),C=!0,H=D.frames!==L?D.frames:new mh.FrenetFrames(U,Y,!1),b=new zn,W=new zn,G=new zn);var f,J,V,q=this,M=this.vertices.length,c=F.extractPoints(n),$=c.shape,v=c.holes,a=!Oh.isClockWise($);if(a){for($=$.reverse(),J=0,V=v.length;V>J;J++)f=v[J],Oh.isClockWise(f)&&(v[J]=f.reverse());a=!1}var k=Oh.triangulateShape($,v),S=$;for(J=0,V=v.length;V>J;J++)f=v[J],$=$.concat(f);for(var r,Q,e=$.length,t=k.length,w=0;e>w;w++)r=$[w],C?(W.copy(H.normals[0]).multiplyScalar(r.x),b.copy(H.binormals[0]).multiplyScalar(r.y),G.copy(z[0]).add(W).add(b),x(G.x,G.y,G.z)):x(r.x,r.y,0);var l;for(l=1;Y>=l;l++)for(w=0;e>w;w++)r=$[w],C?(W.copy(H.normals[l]).multiplyScalar(r.x),b.copy(H.binormals[l]).multiplyScalar(r.y),G.copy(z[l]).add(W).add(b),x(G.x,G.y,G.z)):x(r.x,r.y,T/Y*l);R(),d()};var mh=function(q,z,p,C,w){function e(R,r,E){return g.vertices.push(new zn(R,r,E))-1}Qb.call(this),z=z||64,p=p||1,C=C||8,w=w||!1;var l,M,R,L,X,u,K,P,i,o,c,$,G,k,H,r,U,T,J,Y,F=[],g=this,D=z+1,s=new zn,O=new mh.FrenetFrames(q,z,w),N=O.tangents,n=O.normals,W=O.binormals;for(this.tangents=N,this.normals=n,this.binormals=W,i=0;D>i;i++)for(F[i]=[],L=i/(D-1),P=q.getPointAt(L),l=N[i],M=n[i],R=W[i],o=0;C>o;o++)X=o/C*h,u=-p*v(X),K=p*B(X),s.copy(P),s.x+=u*M.x+K*R.x,s.y+=u*M.y+K*R.y,s.z+=u*M.z+K*R.z,F[i][o]=e(s.x,s.y,s.z);for(i=0;z>i;i++)for(o=0;C>o;o++)c=w?(i+1)%z:i+1,$=(o+1)%C,G=F[i][o],k=F[c][o],H=F[c][$],r=F[i][$],U=new Qe(i/z,o/C),T=new Qe((i+1)/z,o/C),J=new Qe((i+1)/z,(o+1)/C),Y=new Qe(i/z,(o+1)/C),this.faces.push(new Rh(G,k,r)),this.faceVertexUvs[0].push([U,T,Y]),this.faces.push(new Rh(k,H,r)),this.faceVertexUvs[0].push([T.clone(),J,Y.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};mh.prototype=En(ir),mh.FrenetFrames=function(o,T,l){function M(){n[0]=new zn,W[0]=new zn,q=Number.MAX_VALUE,P=r(v[0].x),e=r(v[0].y),L=r(v[0].z),q>=P&&(q=P,y.set(1,0,0)),q>=e&&(q=e,y.set(0,1,0)),q>=L&&y.set(0,0,1),Y.crossVectors(v[0],y).normalize(),n[0].crossVectors(v[0],Y),W[0].crossVectors(v[0],n[0])}var k,q,P,e,L,j,p,y=new zn,v=[],n=[],W=[],Y=new zn,O=new we,D=T+1,E=1e-4;for(this.tangents=v,this.normals=n,this.binormals=W,j=0;D>j;j++)p=j/(D-1),v[j]=o.getTangentAt(p),v[j].normalize();for(M(),j=1;D>j;j++)n[j]=n[j-1].clone(),W[j]=W[j-1].clone(),Y.crossVectors(v[j-1],v[j]),Y.length()>E&&(Y.normalize(),k=Q(fh(v[j-1].dot(v[j]),-1,1)),n[j].applyMatrix4(O.makeRotationAxis(Y,k))),W[j].crossVectors(v[j],n[j]);if(l)for(k=Q(fh(n[0].dot(n[D-1]),-1,1)),k/=D-1,v[0].dot(Y.crossVectors(n[0],n[D-1]))>0&&(k=-k),j=1;D>j;j++)n[j].applyMatrix4(O.makeRotationAxis(v[j],k*j)),W[j].crossVectors(v[j],n[j])};var Un=function(I,z,P,m){Qb.call(this),z=z||18,P=P||0,m=m==j?h:m;for(var J=1/(I.length-1),u=1/z,l=0,Y=z;Y>=l;l++)for(var R=P+l*u*m,L=v(R),r=B(R),x=0,Z=I.length;Z>x;x++){var T=I[x],C=new zn;C.x=L*T.x-r*T.y,C.y=r*T.x+L*T.y,C.z=T.z,this.vertices.push(C)}for(var d=I.length,l=0,Y=z;Y>l;l++)for(var x=0,Z=I.length-1;Z>x;x++){var G=x+d*l,y=G,S=G+d,L=G+1+d,E=G+1,f=l*u,N=x*J,$=f+u,b=N+J;this.faces.push(new Rh(y,E,S)),this.faceVertexUvs[0].push([new Qe(f,N),new Qe(f,b),new Qe($,N)]),this.faces.push(new Rh(S,E,L)),this.faceVertexUvs[0].push([new Qe($,N),new Qe(f,b),new Qe($,b)])}this.mergeVertices(),xq(this),this.computeFaceNormals(),this.computeVertexNormals()};Un.prototype=En(ir);var Or=function(F,S){S=S||{};var J=hf.generateShapes(F,S);S.amount=S.amount!==L?S.amount:.5,S.convertYZ=!1,S.fill!==!1&&(S.bottom=!0,S.top=!0),nn.call(this,J,S)};Or.prototype=En(ak);var se=e.Node=function(){em(se,this)},Ic={X:yf,Y:He,Z:Ik},Dk={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},wq="xzy",Ur=function(u,z,g){if(z){var q=z[0],b=z[1],c=z[2];"xzy"===g?(He(u,b),Ik(u,c),yf(u,q)):"xyz"===g?(Ik(u,c),He(u,b),yf(u,q)):"yxz"===g?(Ik(u,c),yf(u,q),He(u,b)):"yzx"===g?(yf(u,q),Ik(u,c),He(u,b)):"zxy"===g?(He(u,b),yf(u,q),Ik(u,c)):"zyx"===g?(yf(u,q),He(u,b),Ik(u,c)):(He(u,b),Ik(u,c),yf(u,q))}};ok("Node",Yb,{ms_ac:["rotationMode","anchorElevation"],_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:wq,_64O:0,_rotationX:0,_53O:0,_host:j,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return Mk},_22Q:function(){return rh},getX:function(){return this.p().x},setX:function(M){this.p(M,this.p().y)},getY:function(){return this.p().y},setY:function($){this.p(this.p().x,$)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(r){this.setAnchor(r,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(G){this.setAnchor(this.getAnchor().x,G)},getScaleX:function(){return this.getScale().x},setScaleX:function(S){this.setScale(S,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(N){this.setScale(this.getScale().x,N)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(J,G){De(J,jf(j,j,this.r3(),this.getRotationMode())),this.translate3d(J[0]*G,J[1]*G,J[2]*G)},translateFront:function(C){this.translate3dBy([0,0,1],C)},translateBack:function(f){this.translate3dBy([0,0,-1],f)},translateLeft:function(B){this.translate3dBy([-1,0,0],B)},translateRight:function(R){this.translate3dBy([1,0,0],R)},translateTop:function(Y){this.translate3dBy([0,1,0],Y)},translateBottom:function(F){this.translate3dBy([0,-1,0],F)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(G,n,r){1===arguments.length&&(n=G[1],r=G[2],G=G[0]),this.p(G,r),this.setElevation(n)},translate3d:function(g,B,d){1===arguments.length&&(B=g[1],d=g[2],g=g[0]),this.translate(g,d),this.setElevation(this._54O+B)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(A,h,U){1===arguments.length&&(h=A[1],U=A[2],A=A[0]),this.setSize(A,U),this.setTall(h)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(F,i,M){1===arguments.length&&(i=F[1],M=F[2],F=F[0]),this.setRotationX(F),this.setRotation(-i),this.setRotationZ(M)},setRotationY:function(I){this.setRotation(-I)},getRotationY:function(){return-this._64O},lookAt:function(E,a){a=a||ze;var n=this,L=wr(E,n.p3()),S=aq(L);a===ze?(n.r3([-X(L[1]/S),-H(L[2],L[0])+P,0]),n.setRotationMode("xzy")):a===yh?(n.r3(0,-H(L[2],L[0]),X(L[1]/S)),n.setRotationMode("zyx")):a===ie?(n.r3(0,-H(L[2],L[0])+m,-X(L[1]/S)),n.setRotationMode("zyx")):a===ni?(n.r3([-X(L[1]/S)+P,-H(L[2],L[0])+P,0]),n.setRotationMode("xzy")):a===ys&&(n.r3([-X(L[1]/S)-P,-H(L[2],L[0])+P,0]),n.setRotationMode("xzy")),a===kc&&(n.r3([-X(L[1]/S)+m,-H(L[2],L[0])+P,m]),n.setRotationMode("zxy"))},getLoopedEdges:function(){return this._45I},getEdges:function(){return this._70O},getAgentEdges:function(){return this._49I},getHost:function(){return this._host},setHost:function(V){var _=this;if(_!==V&&_._host!==V){var e=_._host;e&&e._removeAttach(_),_._host=V,_._host&&_._host._addAttach(_),_.fp("host",e,V),_.onHostChanged(e,V)}},getAttaches:function(){return this._69O},_addAttach:function(l){var Y=this;Y._69O||(Y._69O=new rb),Y._69O.add(l),Y.fp("attaches",j,l)},_removeAttach:function(y){var D=this;D._69O.remove(y),D._69O.isEmpty()&&delete D._69O,D.fp("attaches",y,j)},getSourceEdges:function(){return this._42I},getTargetEdges:function(){return this._43I},_2I:function(S){var p=this;p._44I||(p._44I=new rb),p._42I||(p._42I=new rb),p._44I.add(S),p._42I.add(S),p._20I()},_4I:function(z){var X=this;X._44I||(X._44I=new rb),X._43I||(X._43I=new rb),X._44I.add(z),X._43I.add(z),X._20I()},_16I:function(l){var K=this;K._44I.remove(l),K._42I.remove(l),K._44I.isEmpty()&&delete K._44I,K._42I.isEmpty()&&delete K._42I,K._20I()
},_18I:function(p){var A=this;A._44I.remove(p),A._43I.remove(p),A._44I.isEmpty()&&delete A._44I,A._43I.isEmpty()&&delete A._43I,A._20I()},_20I:function(){var I=this;if(delete I._45I,!I._44I||I._44I.isEmpty())return delete I._70O,void 0;var v;I._44I.each(function(N){N.isLooped()&&(v||(v={}),v[N._id]||(I._45I||(I._45I=new rb),I._45I.add(N),v[N._id]=N))}),v?(I._70O=new rb,I._44I.each(function(P){v[P._id]?"A"===v[P._id]||(v[P._id]="A",I._70O.add(P)):I._70O.add(P)})):I._70O=I._44I},hasAgentEdges:function(){return!!this._49I&&!this._49I.isEmpty()},getSourceAgentEdges:function(){return this._46I},getTargetAgentEdges:function(){return this._47I},_1I:function(u){var b=this;b._46I||(b._46I=new rb),b._48I||(b._48I=new rb),b._46I.add(u),b._48I.add(u),b._19I()},_3I:function(F){var c=this;c._47I||(c._47I=new rb),c._48I||(c._48I=new rb),c._47I.add(F),c._48I.add(F),c._19I()},_15I:function(q){var Y=this;Y._46I.remove(q),Y._48I.remove(q),Y._46I.isEmpty()&&delete Y._46I,Y._48I.isEmpty()&&delete Y._48I,Y._19I()},_17I:function(i){var T=this;T._47I.remove(i),T._48I.remove(i),T._47I.isEmpty()&&delete T._47I,T._48I.isEmpty()&&delete T._48I,T._19I()},_19I:function(){var c=this;delete c._49I;var I=c._48I;if(I&&!I.isEmpty()){var P={};I.each(function(K){P[K._id]?c._49I||(c._49I=new rb):P[K._id]=K}),c._49I?I.each(function(w){P[w._id]&&(c._49I.add(w),delete P[w._id])}):c._49I=I}},getImage:function(){if(this._pendingCheckImageJSON){var d=V.getImage(this._image);d&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof $n&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(e){var b=this,t=b._image,T=b.getWidth(),o=b.getHeight();b._image=e,b.fp("image",t,e)&&(null!=e&&(Hj(e)||Ui(e)&&/\.json$/i.test(e))&&(this._pendingCheckImageJSON=!0),b.fp(vm,T,b.getWidth()),b.fp(Oc,o,b.getHeight()))},getElevation:function(){return this._54O},setElevation:function(_){var g=this;if(!g._50O){g._50O=1;var n=g._54O;g._54O=_,g.fp($d,n,_),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(W){var Y=this;if(!Y._49O){Y._49O=1;var T=Y._64O;Y._64O=W,Y.fp(ps,T,W),delete Y._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(O){var M=this;if(!M._51O){M._51O=1;var I=M._rotationX;M._rotationX=O,M.fp("rotationX",I,O),delete M._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(u){var x=this;if(!x._52O){x._52O=1;var f=x._53O;x._53O=u,x.fp("rotationZ",f,u),delete x._52O}},getPosition:function(){return this._position},setPosition:function(n,f){var E=this;if(!E._50I){E._50I=1;var K;if(K=2===arguments.length?{x:n,y:f}:n,K.x!==E._position.x||K.y!==E._position.y){var Q=E._position;E._position=K,E.fp(Jm,Q,K)}delete E._50I}},translate:function(N,p){var y=this._position;this.p(y.x+N,y.y+p)},getWidth:function(){var g=this;if(g._width>=0)return g._width;var E=g.getStyle("shape3d");if(E){var f=Ep(E);if(f&&f.rawS3)return f.rawS3[0]}var O=El(g._image);return O?Fd(O,g):20},setWidth:function(R){var M=this,O=M._width;M._width=R,M.fp(vm,O,R)},getHeight:function(){var n=this;if(n._height>=0)return n._height;var K=n.getStyle("shape3d");if(K){var M=Ep(K);if(M&&M.rawS3)return M.rawS3[2]}var P=El(n._image);return P?Xk(P,n):20},setHeight:function(s){var i=this,w=i._height;i._height=s,i.fp(Oc,w,s)},getTall:function(){var Z=this;if(Z._tall>=0)return Z._tall;var E=Z.getStyle("shape3d");if(E){var T=Ep(E);if(T&&T.rawS3)return T.rawS3[1]}return 20},setTall:function(p){var o=this,L=o._tall;o._tall=p,o.fp("tall",L,p)},setSize:function(E,C){var n=this;2===arguments.length?(n.setWidth(E),n.setHeight(C)):(n.setWidth(E.width),n.setHeight(E.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(H,E,A,r,O){var t=this,V=t.getAnchor(),q=t.getScale();arguments.length<=2&&(O=E,E=H.y,A=H.width,r=H.height,H=H.x);var T=O&&q.x<0?1-V.x:V.x,v=O&&q.y<0?1-V.y:V.y;t.p(H+A*T,E+r*v),O&&(A/=Math.abs(q.x),r/=Math.abs(q.y)),t.setWidth(A),t.setHeight(r)},getMatrix:function(){var E=this,Q=E._64O,B=E._position,M=E.getScale();return new rc(Q,B.x,B.y,M.x,M.y)},getAnchorRect:function(){var q=this,g=q.getWidth(),Q=q.getHeight(),V=q.getAnchor();return{x:-g*V.x,y:-Q*V.y,width:g,height:Q}},toLocal:function(i){return this.getMatrix().tfi(i)},toGlobal:function(r){return this.getMatrix().tf(r)},isInRect:function(X){X=this.toLocal(X);var s=this.getWidth(),c=this.getHeight();return X.x+=s*this.getAnchorX(),X.y+=c*this.getAnchorY(),!(X.x<0||X.y<0||X.x>s||X.y>c)},getRect:function(){var z=this,p=z.getWidth(),R=z.getHeight(),f=z.getAnchor(),n={x:-p*f.x,y:-R*f.y,width:p,height:R},W=z.getMatrix();return n=jq([W.tf(n.x,n.y),W.tf(n.x+n.width,n.y),W.tf(n.x+n.width,n.y+n.height),W.tf(n.x,n.y+n.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var M=this,v=M.getAnchor(),o=M._anchorElevation;return{x:v.x,y:o,z:v.y}},setAnchorElevation:function($){var t=this,B=t._anchorElevation;return B!==$?(t._anchorElevation=$,t.fp("anchorElevation",B,$),!0):!1},setAnchor3d:function(e,u,T,Z){var U,H=this;"number"==typeof e?U={x:e,y:u,z:T}:(U=e.length?{x:e[0],y:e[1],z:e[2]}:e,Z=u);var J=H.getDataModel();J&&J.beginTransaction();var n=H.getAnchor3d(),D=H.setAnchor(U.x,U.z);if(H.setAnchorElevation(U.y)&&(D=!0),D&&Z&&!Mj){H.getAnchor3d();var m=Hf(H),p=De([U.x-n.x,U.y-n.y,U.z-n.z],m);H.p3(p)}return J&&J.endTransaction(),D},getAnchor:function(){var O=this;if(O.hasOwnProperty("_anchor"))return O._anchor;var i=El(O._image);return i&&i.anchorX!==L?{x:i.anchorX,y:i.anchorY}:O._anchor},setAnchor:function(E,U,l){var L,C=this;"number"==typeof E?L={x:E,y:U}:(L=E.length?{x:E[0],y:E[1]}:E,l=U);var T=C.getAnchor();if(T.x!==L.x||T.y!==L.y){var J=C.getDataModel();if(J&&J.beginTransaction(),C._anchor=L,C.fp("anchor",T,L),l&&!Mj){var N=C.getPosition(),Y=C.getSize(),m=C.getRotation(),k=C.getScale(),V=-Y.width*(T.x-L.x)*k.x,g=-Y.height*(T.y-L.y)*k.y,Q=B(m),S=v(m);C.setPosition(N.x+S*V-Q*g,N.y+Q*V+S*g)}return J&&J.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(f,z){var K,D=this;K=2===arguments.length?{x:f,y:z}:f;var u=D.getScale();(u.x!==K.x||u.y!==K.y)&&(D._scale=K,D.fp("scale",u,K))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var R=this,T=R._scaleTall,M=R.getScale();return[M.x,T,M.y]},getFinalScale3d:function(){var x=this,n=x.s3(),U=x._dynamicScale3d,j=x.getScale3d();return n&&(j[0]*=n[0],j[1]*=n[1],j[2]*=n[2]),U&&(j[0]*=U[0],j[1]*=U[1],j[2]*=U[2]),j},setScaleTall:function(n){var b=this,o=b._scaleTall;o!==n&&(b._scaleTall=n,b.fp("scaleTall",o,n))},setScale3d:function(T,Q,X){var l,G=this;l="number"==typeof T?{x:T,y:Q,z:X}:T.length?{x:T[0],y:T[1],z:T[2]}:T,G.setScaleTall(l.y),G.setScale(l.x,l.z)},getCorners:function(W,r){W==j&&(W=0),r==j&&(r=W);var V=this,i=V.getAnchor(),I=V.getWidth(),M=V.getHeight(),C=-I*i.x-W,z=-M*i.y-r,Z=I+2*W,m=M+2*r,X=V.getMatrix();return[X.tf(C,z),X.tf(C,z+m),X.tf(C+Z,z+m),X.tf(C+Z,z)]},getEditControlPoints:function(a,L,l){L==j&&(L=0),l==j&&(l=L);var o=this,m=o.getAnchor(),v=o.getWidth(),B=o.getHeight(),c=-v*m.x-L,u=-B*m.y-l,i=v+2*L,H=B+2*l;if(a)return[{x:c,y:u},{x:c,y:0},{x:c,y:u+H},{x:0,y:u+H},{x:c+i,y:u+H},{x:c+i,y:0},{x:c+i,y:u},{x:0,y:u}];var U=o.getMatrix();return[U.tf(c,u),U.tf(c,0),U.tf(c,u+H),U.tf(0,u+H),U.tf(c+i,u+H),U.tf(c+i,0),U.tf(c+i,u),U.tf(0,u)]},rotateAt:function(Y,V,k){var g=this,$=g._position,J=g._64O,j=new rc(J,$.x,$.y).tf(Y,V),y=n(Y*Y+V*V),F=H($.y-j.y,$.x-j.x)+k;g.setRotation(J+k),g.p(j.x+y*v(F),j.y+y*B(F))},onParentChanged:function(){se.superClass.onParentChanged.apply(this,arguments),this._8I()},_8I:function(){this._70O&&this._70O.each(function(F){F._7I()})},onPropertyChanged:function(D){var p=this;se.superClass.onPropertyChanged.call(p,D),p._69O&&p._69O.each(function(u){u.handleHostPropertyChange(D)}),p._49I&&p._49I.each(function(K){K.fp("agentChange",!0,!1)})},onHostChanged:function(){this.updateAttach()},handleHostPropertyChange:function(V){this.updateAttach(V)},onStyleChanged:function(K){se.superClass.onStyleChanged.apply(this,arguments),Sd[K]&&this.updateAttach()},updateAttach:function(p){var k=this;k._51I||Mj||(k._51I=1,k._71O(p),delete k._51I)},_71O:function(I){var S,b,x,K,h,w,m=this,T=m._host,L=I?I.property:j,G=I?I.oldValue:j,f=I?I.newValue:j;if(T instanceof e.Grid){if(L===$d)m.setElevation(m._54O+f-G);else if(!I||Te[L]){if(S=m.s("attach.row.index"),b=m.s("attach.column.index"),x=T.getCellRect(S,b),!x)return;K=m.s("attach.row.span"),h=m.s("attach.column.span"),(1!==K||1!==h)&&(x=Ah(x,T.getCellRect(S+K-1,b+h-1))),qj(x,m,"attach.padding",1),m.setRect(x)}}else if(T instanceof Wj&&(w=m.s("attach.index"))>=0&&(!I||wh[L])){var q=m.s("attach.thickness");q!=j&&m.setHeight(T.getThickness()*q);var O=m.s("attach.offset"),A=T.getPoints(),o=A.size();if(o>w){var v=A.get(w),c=o===w+1?A.get(0):A.get(w+1),B=[c.x-v.x,c.y-v.y],p=aq(B);if(p){m.s("attach.offset.relative")&&(O*=p),m.s("attach.offset.opposite")&&(O=p-O);var u={x:v.x+B[0]/p*O,y:v.y+B[1]/p*O},l=m.s("attach.gap");l&&(m.s("attach.gap.relative")&&(l*=T.getThickness()),u=cl(j,u,c,l)),m.p(u),m.setRotation(H(B[1],B[0]))}}}else I&&(L===Jm?m.translate(f.x-G.x,f.y-G.y):L===$d?m.setElevation(m._54O+f-G):To[L]&&m._11Q(T,L,f-G))},_11Q:function(L,G,e){var i=this,Z=L.p3(),t=wr(i.p3(),Z),B=jo(),$=Dk[i.getRotationMode()],j=$[0],q=$[1],z=$[2],K=Ic[j],b=Ic[q],u=Ic[z];G===ps&&(G="rotationY",e=-e),G===ps+j?(u(B,L[tk+z]()),b(B,L[tk+q]()),K(B,e),b(B,-L[tk+q]()),u(B,-L[tk+z]()),i[wp+j](i[tk+j]()+e)):G===ps+q?(u(B,L[tk+z]()),b(B,e),u(B,-L[tk+z]()),i[wp+q](i[tk+q]()+e)):G===ps+z&&(u(B,e),i[wp+z](i[tk+z]()+e)),De(t,B),i.p3(Z[0]+t[0],Z[1]+t[1],Z[2]+t[2])},isHostOn:function($){var W=this;if(W._host&&$&&$._69O)for(var T={},y=W._host;y&&y!==W&&!T[y._id];){if(y===$)return!0;T[y._id]=y,y=y._host}return!1},isLoopedHostOn:function(M){return this.isHostOn(M)&&M.isHostOn(this)},getSerializableProperties:function(){var b=se.superClass.getSerializableProperties.call(this);return _r(b,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),b}});var lf=e.Edge=function(G,m){var O=this;em(lf,O),O.setSource(G),O.setTarget(m)};ok("Edge",Yb,{_icon:"edge_icon",getUIClass:function(){return Rl},_22Q:function(){return Zr},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},setSource:function(L){var S=this;if(S._source!==L){var p=S._source;S._source=L,p&&p._16I(S),L&&L._2I(S),S._7I(),S.fp("source",p,L)}},setTarget:function(R){var Z=this;if(Z._target!==R){var x=Z._target;Z._target=R,x&&x._18I(Z),R&&R._4I(Z),Z._7I(),Z.fp("target",x,R)}},isLooped:function(){var r=this;return r._source===r._target&&!!r._source&&!!r._target},_7I:function(){var t,m=this,I=zp(m);m._40I!==I&&(t=this._40I,t&&t._15I(m),m._40I=I,I&&I._1I(m),m.fp("sourceAgent",t,I),og(t,m._41I),og(I,m._41I));var F=Of(m);m._41I!==F&&(t=m._41I,t&&t._17I(m),m._41I=F,F&&F._3I(m),m.fp("targetAgent",t,F),og(t,m._40I),og(F,m._40I))},_22I:function(l){this._52I=l,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var S=this;return S._52I&&S._52I.get(0)!==S&&!S.getStyle(Bl)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var k=this,O=k._52I;return O&&!k.getStyle(Bl)&&O.size()>1&&k===O.get(0)},toggle:function(){var h=this._52I,L=!this.s(Bl);h&&h.size()>1&&(h.each(function(p){p.s(Bl,L)}),h.getSiblings().each(function(o){o!==h&&o.each(function(p){p.fp("edgeGroup",j,o)})}))},setStyle:function(m,d){(m===Tj||"edge.segments"===m)&&(d=Cq(d)),lf.superClass.setStyle.call(this,m,d)},onStyleChanged:function(O){lf.superClass.onStyleChanged.apply(this,arguments),hn[O]&&og(this._41I,this._40I)},getSerializableProperties:function(){var D=lf.superClass.getSerializableProperties.call(this);return _r(D,{source:1,target:1}),D}});var me=e.Group=function(){em(me,this)};ok("Group",se,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return dj},onChildAdded:function(){me.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){me.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var r=this;if(!r._54I&&!Mj){var m=r.getChildrenRect();m&&(r._53I=1,r.p(kd(r.s("group.position"),m,r.getSize())),delete r._53I)}},getChildrenRect:function(){var c,z=this;return z.eachChild(function(h){c=Ah(c,z.getChildRect(h))}),c},getChildRect:function(J){var G;return Jl(J)&&J.s(mr)&&(Dc(J)&&J.isExpanded()&&J.eachChild(function(R){G=Ah(G,J.getChildRect(R))}),!G&&J.getRect&&(G=J.getRect())),G},setPosition:function(C,R){var s=this;if(!s._54I){var y;y=2===arguments.length?{x:C,y:R}:C,Mj||s._53I||(s._54I=1,gf(s._children,y.x-s._position.x,y.y-s._position.y),delete s._54I),me.superClass.setPosition.call(this,y)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(V){var C=this;if(C._57O!==V){var I=C._57O;C._57O=V,C.fp("expanded",I,C._57O),C._8I()}},_8I:function(){me.superClass._8I.call(this),this.eachChild(function(k){Jl(k)&&k._8I()})},onStyleChanged:function(P){me.superClass.onStyleChanged.apply(this,arguments),"group.position"===P&&this._81I()},getSerializableProperties:function(){var t=me.superClass.getSerializableProperties.call(this);return t.expanded=1,t}});var es=e.Block=function(){em(es,this)};ok("Block",se,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return Rr},onChildAdded:function(){es.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){es.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var D=this;if(!Mj&&!D._updatingToChildren&&D._syncSize){var k,l,T,o,e,h=[],V=D.getRotation();if(D.eachChild(function(m){Jl(m)&&h.push.apply(h,m.getCorners())}),h.length){D._updatingFromChildren=1;var c=v(-V),j=B(-V),y=1/0,a=-1/0,L=1/0,G=-1/0;for(o=0,e=h.length;e>o;o++)T=h[o],k=T.x,l=T.y,T.x=c*k-j*l,T.y=j*k+c*l,y=K(y,T.x),a=Y(a,T.x),L=K(L,T.y),G=Y(G,T.y);var Z=D.getScale();D.setSize(r((a-y)/Z.x),r((G-L)/Z.y));var Q;Z.x<0&&(Q=y,y=a,a=Q),Z.y<0&&(Q=L,L=G,G=Q),c=v(V),j=B(V);var i=D.getAnchor();k=y+(a-y)*i.x,l=L+(G-L)*i.y,D.setPosition(c*k-j*l,j*k+c*l),delete D._updatingFromChildren}}},setPosition:function(q,K){var w=this;if(!w._updatingToChildren){var M;M=2===arguments.length?{x:q,y:K}:q,Mj||w._updatingFromChildren||(w._updatingToChildren=1,gf(w._children,M.x-w._position.x,M.y-w._position.y),delete w._updatingToChildren),es.superClass.setPosition.call(this,M)}},setWidth:function(c){return this.setSize(c,this.getHeight())},setHeight:function($){return this.setSize(this.getWidth(),$)},setSize:function(z,c){1>z&&(z=1),1>c&&(c=1);var H=this;if(!H._updatingToChildren){2!==arguments.length&&(c=z.height,z=z.width);var Y=H.getWidth(),O=H.getHeight();if(z!==Y&&es.superClass.setWidth.call(H,z),c!==O&&es.superClass.setHeight.call(H,c),!Mj&&!H._updatingFromChildren){H._updatingToChildren=1;var m=z/Y,j=c/O;H._adjustChildScaleOrSize(m,j,"size"),delete H._updatingToChildren,H.updateFromChildren()}}},_adjustChildScaleOrSize:function(s,F,p){var q=this;if(q._syncSize){var N=q.getPosition(),$=q.getRotation();q.getScale(),q.eachChild(function(A){if(Jl(A)){var r=A.getPosition(),b=A.getRotation(),u=A.getWidth(),g=A.getHeight(),C=A.getScale(),m=C.x*u,x=C.y*g,i=new rc(b,r.x,r.y,m,x);i.translate(-N.x,-N.y),i.rotate(-$),b=H(i.b*Math.sign(m),i.a*Math.sign(m)),i.scale(s,F);var P,O,T,Y=v(b);if(Math.abs(Y)<.001?(P=B(b),O=i.b/P,T=-i.c/P):(O=i.a/Y,T=i.d/Y),"scale"===p)A.setScale(O/u,T/g);else if("size"===p){var L=O/C.x,y=T/C.y;A.setScale(eh(O)*Math.abs(C.x),eh(T)*Math.abs(C.y)),A.setSize(Math.max(.1,Math.abs(L)),Math.max(.1,Math.abs(y)))}i.rotate($),i.translate(N.x,N.y),A.setPosition(i.tx,i.ty)}})}},_calcChangeFactor:function(n,h,L,C){var J,y,u,I;return J=r(n),y=r(L),u=J>y?J/y:y/J,J=r(h),y=r(C),I=J>y?J/y:y/J,Y(u,I)},setAnchor:function(){var s=this;if(!s._updatingToChildren){var o=s.getAnchor();if(es.superClass.setAnchor.apply(s,arguments),!Mj&&!s._updatingFromChildren&&s._syncSize){s._updatingToChildren=1;var _=s.getAnchor();s.getPosition();var i=s.getSize(),J=s.getScale(),d=s.getRotation(),I=-i.width*J.x*(o.x-_.x),x=-i.height*J.y*(o.y-_.y),A=B(d),G=v(d),W=G*I-A*x,w=A*I+G*x;s.eachChild(function(q){if(Jl(q)){var P=q.getPosition();q.setPosition(P.x-W,P.y-w)}}),delete s._updatingToChildren}}},setRotation:function(f){var k=this;if(!k._updatingToChildren){var T=k.getRotation();if(es.superClass.setRotation.apply(k,arguments),!Mj&&!k._updatingFromChildren){k._updatingToChildren=1;var O=k.getPosition(),s=f-T;k.eachChild(function(a){if(Jl(a)){var U=a.getMatrix();U.translate(-O.x,-O.y),U.rotate(s),U.translate(O.x,O.y);var q=Math.sign(a.getScale().x);a.setRotation(H(U.b*q,U.a*q)),a.setPosition(U.tx,U.ty)}}),delete k._updatingToChildren}}},setScale:function(V,$){var e=this;if(!e._updatingToChildren){null==$&&($=V.y,V=V.x);var m=e.getScale();if(r(V)<.01&&(V=.01*(eh(V)||eh(m.x))),r($)<.01&&($=.01*(eh($)||eh(m.y))),es.superClass.setScale.call(e,V,$),!Mj&&!e._updatingFromChildren){e._updatingToChildren=1;var z=V/m.x,y=$/m.y;e._adjustChildScaleOrSize(z,y,"size"),delete e._updatingToChildren,e.updateFromChildren()}}},getSerializableProperties:function(){var l=es.superClass.getSerializableProperties.call(this);return l.clickThroughEnabled=1,l.syncSize=1,l}});var de=e.Grid=function(){em(e.Grid,this)};ok("Grid",se,{IRotatable:!1,_icon:"grid_icon",_image:j,getUIClass:function(){return vq},setRotation:function(){},getCellRect:function(x,B){var Z=this,e=Z.s("grid.row.count"),R=Z.s("grid.column.count");if(0>=e||0>=R||0>x||x>=e||0>B||B>=R)return j;var b,E,X,G=Z.getRect(),h=Z.s("grid.row.percents"),V=Z.s("grid.column.percents");if(qj(G,Z,"grid.border",-1),h&&h._as&&(h=h._as),V&&V._as&&(V=V._as),h&&h.length===e){for(X=0,b=0;x>b;b++)X+=G.height*h[b];G.y+=X,G.height=G.height*h[x]}else G.height=G.height/e,G.y+=G.height*x;if(V&&V.length===R){for(E=0,b=0;B>b;b++)E+=G.width*V[b];G.x+=E,G.width=G.width*V[B]}else G.width=G.width/R,G.x+=G.width*B;return ws(G,-Z.s("grid.gap")),G}});var Ti=e.Text=function(){em(Ti,this),this.setSize(100,50),this.s("text","TEXT")};ok("Text",se,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return Ub},setWidth:function(O){O||(O=.001),Ti.superClass.setWidth.call(this,O)},setHeight:function(F){F||(F=.001),Ti.superClass.setHeight.call(this,F)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),wn("__text__",{width:{value:100,isSafeFunc:!0,func:function(f){return f._width}},height:{value:50,isSafeFunc:!0,func:function(M){return M._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"}}]});var Wj=e.Shape=function(){em(Wj,this),this._59O=new rb};Wj.__de__=sg,ok("Shape",se,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return Gp},_22Q:function(){return ih},getLength:function(Z){return Tg(eo(this._59O,this._58O,Z,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var R=this._58O;return R?new rb(R._as.slice(0)):R},setSegments:function(d){var k=this._58O;d=d?ck(d)?new rb(d.slice(0)):new rb(d._as.slice(0)):null,(k&&d&&k._as.join(",")!==d._as.join(",")||k!==d)&&(this._58O=d,this.fp("segments",k,d))},getPoints:function(){return this._59O},toPoints:function(){var n=this._59O;return new rb(n._as.slice(0))},setPoints:function(E,D){var d=this,a=d._59O;E=E?ck(E)?new rb(E.slice(0)):new rb(E._as.slice(0)):new rb;var k,B,L,r,G,n;D&&(k=d.getPosition(),n=new rc(d.getRotation(),0,0,d.getScale().x,d.getScale().y)),(a&&E&&a._as.join(",")!==E._as.join(",")||a!==E)&&(d._59O=E,d.fs(),d.fp("points",a,E)),D&&(B=d.getPosition(),L=B.x-k.x,r=B.y-k.y,G=n.tf(L,r),d.setPosition(B.x-L+G.x,B.y-r+G.y))},addPoint:function(v,s,j){var V=this.toPoints();V.add(v,s),this.setPoints(V,j)},setPoint:function(S,e,E){var p=this.toPoints();p.set(S,e),this.setPoints(p,E)},removePointAt:function(k){var r=this.toPoints();r.removeAt(k),this.setPoints(r)},setWidth:function(q){var n=this;if(1>q&&(q=1),!n._55I&&!Mj&&n.getWidth()){n._55I=1;var $=n._position.x,w=q/n.getWidth(),W=n.toPoints(),e=new rb;W.each(function(x){e.add({x:(x.x-$)*w+$,y:x.y,e:x.e})}),n.setPoints(e),Kh(n,[w,0,0,1,$*(1-w),0]),n.fs(),delete n._55I}Wj.superClass.setWidth.call(n,q)},setHeight:function(a){var b=this;if(1>a&&(a=1),!b._55I&&!Mj&&b.getHeight()){b._55I=1;var z=b._position.y,F=a/b.getHeight(),A=b.toPoints(),w=new rb;A.each(function(C){w.add({x:C.x,y:(C.y-z)*F+z,e:C.e})}),b.setPoints(w),Kh(b,[1,0,0,F,0,z*(1-F)]),b.fs(),delete b._55I}Wj.superClass.setHeight.call(b,a)},setAnchorElevation:function(Z){var V=this;V._55I=!0;var d=V._updatingAnchor3d,w=!Mj&&!d;if(w){var t,o=Z,F=V.getAnchorElevation(),L=V.getTall();t=L*(F-o),V.shiftPointsElevation(t)}var h=Wj.superClass.setAnchorElevation.apply(V,arguments);return d||delete V._55I,h},getShapeElevation:function(){var d=this,F=d._54O;return F-(d.getTall()||0)*(d._anchorElevation-.5)},setAnchor3d:function(I,v,G,B){var D,E=this;"number"==typeof I?D={x:I,y:v,z:G}:(D=I.length?{x:I[0],y:I[1],z:I[2]}:I,B=v),E._55I=!0,E._updatingAnchor3d=!0;var C=E.getDataModel();if(C&&C.beginTransaction(),!Mj){var b=E.getAnchor3d(),f=E.getSize(),j=E.getTall(),m=f.width*(b.x-D.x),w=f.height*(b.z-D.z),c=j*(b.y-D.y);B||E.shiftPoints(m,w,c);var X=E.p3()}var h=Wj.superClass.setAnchor3d.apply(E,arguments);if(!Mj&&B){var F=E.p3();E.shiftPoints(F[0]-X[0]+m,F[2]-X[2]+w,F[1]-X[1]+c)}return C&&C.endTransaction(),delete E._updatingAnchor3d,delete E._55I,h},setAnchor:function(k,M,P){var K=this;K._55I=!0;var L=K._updatingAnchor3d,l=!Mj&&!L;if(l){var s,v,y;"number"==typeof k?y={x:k,y:M}:(y=k.length?{x:k[0],y:k[1]}:k,P=M);var q=K.getAnchor(),N=K.getSize();s=N.width*(q.x-y.x),v=N.height*(q.y-y.y),P||K.shiftPoints(s,v);var H=K.getPosition()}var x=Wj.superClass.setAnchor.apply(K,arguments);if(l){var i=K.getPosition();P&&K.shiftPoints(i.x-H.x+s,i.y-H.y+v)}return L||delete K._55I,x},shiftPoints:function(I,b,i){var _=this,R=_.getElevation()||0,S=_.toPoints(),c=new rb;S.each(function(m){var Z=m.e;i&&(Z=(Z==j?R:Z)+i),c.add({x:m.x+I,y:m.y+b,e:Z})}),_.setPoints(c),_.fs()},shiftPointsElevation:function(O){return this.shiftPoints(0,0,O)},setPosition:function(l,c){var D,U=this;if(!U._28Q){if(U._28Q=1,!U._55I&&!Mj){D=2===arguments.length?{x:l,y:c}:l;var _=D.x-U._position.x,A=D.y-U._position.y;if(0===_&&0===A)return delete U._28Q,void 0;U._55I=1,U.shiftPoints(_,A),Kh(U,[1,0,0,1,_,A]),delete U._55I}Wj.superClass.setPosition.apply(U,arguments),delete U._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var i=this;if(2!==i._59O.size())return!1;var E=i._58O;return E?2===E.size()&&1===E.get(0)&&2===E.get(1)?!0:!1:!0},fireShapeChange:function(){var k=this;if(!k._55I&&!Mj){var F=jq(k._59O);F&&(k._55I=1,k.setRect(F),delete k._55I)}k.fp(Lo,!1,!0)},getSerializableProperties:function(){var G=Wj.superClass.getSerializableProperties.call(this);return G.segments=1,G.points=1,G.thickness=1,G.closePath=1,G}});var qn=e.Polyline=function(){em(qn,this),this.s({"shape.background":null,"shape.border.width":2})};ok("Polyline",Wj,{_icon:"polyline_icon",_22Q:function(){return Ab},getUIClass:function(){return Bc},setClosePath:function(){},setTall:function(x){var A=this;if(!A._55I&&!A._24Q&&!Mj&&A.getTall()){A._24Q=1;var b=A._54O,$=x/A.getTall();A._59O.each(function(m){m.e=m.e==j?b:(m.e-b)*$+b}),A.fs(),delete A._24Q}qn.superClass.setTall.call(A,x)},setElevation:function(z){var W=this;if(!W._55I&&!W._24Q&&!Mj){W._24Q=1;var J=z-W._54O;W._59O.each(function(d){d.e==j?d.e=z:d.e+=J}),W.fs(),delete W._24Q}qn.superClass.setElevation.apply(W,arguments)},fireShapeChange:function(){var I=this,r=I._59O;if(!I._55I&&!I._24Q&&!Mj){var c=r.size();if(c){var O=1,f=r.get(0),q=I._54O;f.e==j&&(f.e=q);for(var W=f.e,h=0;c>O;O++){f=r.get(O),f.e==j&&(f.e=q);var x=K(W,f.e),m=Y(W+h,f.e);W=x,h=m-x}I._24Q=1,I.setTall(h),I.setElevation(W+h*I._anchorElevation),delete I._24Q}}qn.superClass.fireShapeChange.apply(I,arguments)}});var Jd=e.SubGraph=function(){em(Jd,this)};ok("SubGraph",se,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){Jd.superClass._8I.call(this),this.eachChild(function(o){Jl(o)&&o._8I()})}});var $n=e.RefGraph=function(){em($n,this)};ok("RefGraph",es,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(w){var D=this._ref;this._ref=w,this.fp("ref",D,w),this._pendingUpdateFromChidlren=!0,this.updateRef()},_21I:function(){$n.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var c=this;if(c.clearChildrenFromDataModel(),c._ref&&c._dataModel){c._xhrLoadHandler&&(c._xhrLoadHandler.cancel=!0);var B=Mj,E=c._xhrLoadHandler=function(X){if(X&&c._dataModel){V.loadingRefGraph=!0;var G=c._pendingUpdateInfo={needToRestore:B};B&&(G.position=c.p(),G.width=c.getWidth(),G.height=c.getHeight(),G.rotation=c.getRotation(),G.anchor=c.getAnchor(),G.scale=c.getScale()),c.p(0,0),c.setAnchor(.5,.5),c.setRotation(0),c.setScale(1,1);var Q=V.parse(X),f=c._dataModel.deserialize(Q,c,{justDatas:!0});f.each(function(I){I._refGraph=c}),c.checkPendingUpdateInfo(),V.loadingRefGraph=!1,V.handleRefGraphLoaded(c,f,Q)}};V.xhrLoad(c._ref,function(u){E.cancel||E(u)})}},checkPendingUpdateInfo:function(){var x=this,P=x._pendingUpdateInfo;if(!P)return x.onPendingUpdated&&x.onPendingUpdated(),void 0;var g=!0;this.eachChild(function(P){(P._pendingCheckImageJSON||P._pendingUpdateInfo)&&(g=!1)}),g&&(x._pendingUpdateInfo=null,x.updateFromChildren(),P.needToRestore&&(x.setSize(P.width,P.height),x.setAnchor(P.anchor),x.setRotation(P.rotation),x.setScale(P.scale),x.p(P.position)),this.getParent()instanceof $n&&this.getParent().checkPendingUpdateInfo(),x.onPendingUpdated&&x.onPendingUpdated())},getSerializableProperties:function(){var d=$n.superClass.getSerializableProperties.call(this);return d.ref=1,d}}),e.EdgeGroup=function(r,o){this._70O=r,this._siblings=o;for(var S,Z,u=0,q=r.size(),h=I[Bl];q>u;u++)if(S=r.get(u).getStyle(Bl,!1),S!=j){h=S;break}h==j&&(h=!0);var A=V.edgeGroupAgentFunc;for(A&&(Z=A(r),Z&&Z!==r.get(0)&&(r.remove(Z),r.add(Z,0))),u=0;q>u;u++)r.get(u).s(Bl,h)},ok("EdgeGroup",N,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(A){return this._70O.get(A)},indexOf:function(b){return this._70O.indexOf(b)},each:function(o,Q){this._70O.each(o,Q)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(a,H){this._siblings.each(function(F){F._70O.each(a,H)})}});var cg=function(x,J,k){var n=Qj[x]={type:x,action:J};if(k)for(var W in k)n[W]=k[W]};cg("host",function(Z,o,K){K&&o.setHost(K)},{"delete":{visible:function(z,M){return M.getHost()},action:function(m,J){J.setHost(null)}}}),cg("parent",function(l,R,u){u&&R.setParent(u)},{"delete":{visible:function(x,d){return d.getParent()},action:function(W,L){L.setParent(null)}}}),cg("copySize",function(X,s,K){if(K){var F=K.getSize();s.setSize(F)}}),cg("copyRotation",function(x,c,t){if(t){var P=t.getRotation();c.setRotation(P)}}),cg("edge",function(r,l,T){if(T){var x=new e.Edge(l,T);l.dm().add(x)}}),_r(V,{setConnectAction:cg,getConnectAction:function(b,y){return y=y||b.getCurrentConnectActionType(),Qj[y]},doConnectAction:function(y,S,M,k){k=k||y.getCurrentConnectActionType();var r=Qj[k];if(!r)return!1;var H=r.action;return H?(H.call(null,y,S,M),!0):!1},doDeleteConnectionAction:function(h,X,l){l=l||h.getCurrentConnectActionType();var Y=Qj[l];if(!Y||!Y.delete)return!1;var z=Y.delete.action;return z?(z.call(null,h,X),!0):!1}});var Lp=e.JSONSerializer=function(t,l){this.dm=this._dataModel=t,this._hierarchical=V.forceHierarchicalSerialization?!0:l==j?t.isHierarchicalRendering():l};ok("JSONSerializer",N,{ms_ac:["hierarchical"],serialize:function(u){return V.stringify(this.toJSON(),u)},toJSON:function(){var T=this,J=T.dm,D=J.getRoots(),H=T.json={v:V.getVersion(),p:{},a:{},d:[]},g=J.getSerializableAttrs();J.getInit()&&(H.init=J.getInit()),J.getName()&&(H.p.name=J.getName()),J.getBackground()&&(H.p.background=J.getBackground()),J.getLayers()&&(H.p.layers=J.getLayers()),H.p.autoAdjustIndex=J.isAutoAdjustIndex(),H.p.hierarchicalRendering=J.isHierarchicalRendering();for(var N in g){var I=J.a(N);I!==L&&T[tp](N,I,H.a)}return ui(H.a)&&delete H.a,T._hierarchical?D.each(T.serializeData,this):J.each(function(Y){T.serializeData(Y)}),H},isSerializable:function(){return!0},getProperties:function(F){return F.getSerializableProperties()},getStyles:function(l){return l.getSerializableStyles()},getAttrs:function(B){return B.getSerializableAttrs()},serializeData:function(P){var V=this;if(V.isSerializable(P)&&!P._refGraph){var M,T,l,u,v=yp(P.getClassName())||P.getClass(),Z=new v,q={c:P.getClassName(),i:P.getId(),p:{},s:{},a:{}};V.json.d.push(q),M=V.getProperties(P);for(T in M)/^_/.test(T)?(l=P[T],l!==Z[T]&&V[tp](T.substr(1),l,q.p)):(u=Li(T),P[u]&&(l=P[u](),l!==Z[u]()&&V[tp](T,l,q.p)));M=V.getStyles(P);for(T in M)l=P.s(T),l!==Z.s(T)&&V[tp](T,l,q.s);M=V.getAttrs(P);for(T in M)l=P.a(T),l!==Z.a(T)&&V[tp](T,l,q.a);ui(q.p)&&delete q.p,ui(q.s)&&delete q.s,ui(q.a)&&delete q.a}V._hierarchical&&P.getChildren().each(V.serializeData,V)},serializeValue:function(M,W,U){Hn(W)?W={__a:W._as}:W instanceof Yb&&(W={__i:W.getId()}),U[M]=W},deserialize:function(X,E,y){var S=this,K=S.dm;K.beginTransaction(),Mj=!0,y=bc(y)?{setId:y}:y||{},X=S.json=Ui(X)?V.parse(X):X,S._82I={};var U=new rb,b=new rb,G=0,L=X.d.length;if(y.justDatas||(Af(X.init)&&X.init(K),K.setInit(X.init)),!y.justDatas){for(var M in X.a)K.a(M,S[qo](X.a[M]));for(var v in X.p)K[oi(v)](X.p[v])}for(;L>G;G++){var Y=X.d[G],l=yp(Y.c),i=new l,o=Y.i;y.setId&&o!=j&&(i._id=o),S._82I[o]=i,U.add(i),b.add(Y)}for(G=0;L>G;G++)S.deserializeData(U.get(G),b.get(G));return U.each(function(f){E&&!f.getParent()&&f.setParent(E),K.add(f)}),Mj=!1,K.endTransaction(),U},deserializeData:function(U,L){for(var C in L.p)U[oi(C)](this[qo](L.p[C]));for(C in L.s)U.s(C,this[qo](L.s[C]));for(C in L.a)U.a(C,this[qo](L.a[C]))},deserializeValue:function(G){if(Hj(G)){var d=G.__i;if(d!=j)return this._82I[d];if(d=G.__a,ck(d))return new rb(d)}return G}}),_r(si,{serialize:function(F,G){return new Lp(this,G).serialize(F)},toJSON:function(j){return new Lp(this,j).toJSON()},deserialize:function(F,C,v){return new Lp(this).deserialize(F,C,v)}}),Gq.GraphView=function(q){var g=this;g._24I={},g._34I=new rb,g._25I={},g._56I={},g._view=Ul(1,g),g._canvas=Ji(g._view),g.dm(q?q:new si),this._coreInteractor=new ep(this),g.setEditable(!1),g.setScrollBarVisible(V.graphViewScrollBarVisible)},Gj("GraphView",N,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[Uj,bq,$g,od,"resettable","editInteractor",Jh,"pannable","rectSelectable","autoScrollZone",Th,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_resettable:V.graphViewResettable,_pannable:V.graphViewPannable,_rectSelectable:V.graphViewRectSelectable,_autoScrollZone:V.graphViewAutoScrollZone,_rectSelectBackground:V.graphViewRectSelectBackground,_rectSelectBorderColor:V.graphViewRectSelectBorderColor,_editPointSize:V.graphViewEditPointSize,_editPointBorderColor:V.graphViewEditPointBorderColor,_editPointBackground:V.graphViewEditPointBackground,_scrollBarColor:qh,_scrollBarSize:Ec,_autoHideScrollBar:lj,_autoMakeVisible:mq,_currentActionType:"host",getCoreInteractor:function(){return this._coreInteractor
},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(I){this._dataModel.setLayers(I)},setEditable:function(K){var m=this,a=m.__interactorMap__;if(!a){var t=Gq.XEditInteractor;a=m.__interactorMap__={scrollBar:new Jb(m),select:new Zn(m),edit:t?new t(m):new Hl(m),move:new Ek(m),"default":new sk(m),touch:new Xp(m,{editable:!1})}}K?(m._uieditable=!0,m.setInteractors([a.scrollBar,a.select,a.edit,a.move,a.default,a.touch])):(m._uieditable=!1,m.setInteractors([a.scrollBar,a.select,a.move,a.default,a.touch]))},getCanvas:function(){return this._canvas},_33I:function(x){var T=x.getUIClass();return T?new T(this,x):j},getDataUI:function(q){var z=this,U=z._25I[q._id];return U===L&&(U=z._33I(q),z._25I[q._id]=U),U},getNodeRect:function(b){return V.getNodeRect(this,b)},getEdgeInfo:function(c){var _=this.getDataUI(c);return _?(_._79o(),_._78o):null},getEdgeSourcePosition:function(X){var b=this,g=b.getDataUI(X),w=g.s,y=g._data._40I;return _h(b,y,w("edge.source.position"),w("edge.source.offset.x"),w("edge.source.offset.y"),w("edge.source.anchor.x"),w("edge.source.anchor.y"))},getEdgeTargetPosition:function(C){var j=this,B=j.getDataUI(C),E=B.s,w=B._data._41I;return _h(j,w,E("edge.target.position"),E("edge.target.offset.x"),E("edge.target.offset.y"),E("edge.target.anchor.x"),E("edge.target.anchor.y"))},invalidateAll:function(w){var T=this;if(w){for(var r in T._25I){var Y=T._25I[r];Y&&Y.dispose()}T._25I={},T._56I={},T._24I={},T._34I.clear(),T.redraw()}else T.dm().each(function(d){T.invalidateData(d)})},invalidateSelection:function(){var R=this;R.sm().each(function(F){R.invalidateData(F)})},invalidateData:function(H){var w=this;w._24I[H._id]=H,w._21Q(H),w.iv()},_21Q:function(f){var n=this,r=n._24I;if(Hg(f)&&yr[f.s(bk)]){var d=f.getSourceAgent();d&&d.getAgentEdges().each(function(Y){r[Y._id]=Y}),d=f.getTargetAgent(),d&&d.getAgentEdges().each(function(_){r[_._id]=_}),n.iv()}},redraw:function(e){var k=this;k._32I||(e?k._34I.add(e):(k._32I=1,k._34I.clear()),k.iv())},each:function(U,W){var c,e,y,q=0,A=this.getLayers(),$=this._dataModel,G=$._datas._as,j=G.length;if(A){for(var l=A.length;l>q;q++)if(y=A[q],Hj(y)&&(y=y.name),$.isHierarchicalRendering()){var P=function(z){return z._layer===y?W?U.call(W,z):U(z):void 0};if(this._dataModel.eachByHierarchical(P)===!1)return}else for(var w=0;j>w;w++)if(c=G[w],c._layer===y&&(e=W?U.call(W,c):U(c),e===!1))return}else if($.isHierarchicalRendering())this._dataModel.eachByHierarchical(U,null,W);else for(;j>q;q++)if(c=G[q],e=W?U.call(W,c):U(c),e===!1)return},reverseEach:function(u,t){var R,G,m,J,f=this._dataModel,M=f._layers,w=f._datas._as,p=w.length;if(M){for(R=M.length-1;R>=0;R--)if(J=M[R],Hj(J)&&(J=J.name),f.isHierarchicalRendering()){var W=function(w){return w._layer===J?t?u.call(t,w):u(w):void 0};if(f.reverseEachByHierarchical(W)===!1)return}else for(var s=p-1;s>=0;s--)if(G=w[s],G._layer===J&&(m=t?u.call(t,G):u(G),m===!1))return}else if(f.isHierarchicalRendering())f.reverseEachByHierarchical(u,null,t);else for(R=p-1;R>=0;R--)if(G=w[R],m=t?u.call(t,G):u(G),m===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var m=this,H=m._84I;if(!H){var K=this.dm().a("width"),O=this.dm().a("height");K>0&&O>0?m._84I={x:0,y:0,width:K,height:O}:(m.each(function(A){m.isVisible(A)&&(H=Ah(H,m.getDataUIBounds(A)))}),m._84I=H?H:Vo)}return m._84I},getScrollRect:function(){return Ah(this.getContentRect(),this._29I)},makeCenter:function(C,F,A){var x=this;if(!x.getWidth()||!x.getHeight())return A||sc(x.centerData,x,[C,F,!0],500),void 0;x.makeVisible(C),x.validate();var e=x.getDataUIBounds(C);if(e){var k=x.getWidth(),Y=x.getHeight(),R=e.x+e.width/2,E=e.y+e.height/2,X=-R*x._zoom+k/2,d=-E*x._zoom+Y/2;x.setTranslate(X,d,F)}},fitData:function(M,m,i,F,X){var w=this;if(!w.getWidth()||!w.getHeight())return X||sc(w.fitData,w,[M,m,i,F,!0],500),void 0;var f=function(){w.makeVisible(M),w.validate();var H=w.getDataUIBounds(M);H&&(H=Hm(H),ws(H,i==j?20:i),w.fitRect(H,m,F))};m?V.callWhenLoaded(f):f()},fitContent:function(n,y,E,B){var u=this;if(!u.getWidth()||!u.getHeight())return B||sc(u.fitContent,u,[n,y,E,!0],500),void 0;var b=function(){u.validate();var K=Hm(u.getContentRect());ws(K,y==j?20:y),u.fitRect(K,n,E)};n?V.callWhenLoaded(b):b()},fitRect:function(S,O,k){var T=this,F=T.getWidth(),i=T.getHeight(),o=S.x+S.width/2,G=S.y+S.height/2,m=K(F/S.width,i/S.height),U=T._zoom,f=-o*U+F/2,L=-G*U+i/2;0===m||isNaN(m)||(k&&(m=K(1,m)),O?T.setTranslate(f,L,{finishFunc:function(){T.setZoom(m,O)}}):(T.setTranslate(f,L),T.setZoom(m)))},toCanvas:function(i,A){A=A||this._zoom,this.validateImpl();var S=this,r=S.getContentRect();r.width||(r.width=10),r.height||(r.height=10);var d=Ji(),J=r.x*A,L=r.y*A,k=r.width*A,u=r.height*A;zm(d,k,u,1);var y=Vq(d);return i=i||this._dataModel.getBackground(),i&&Yp(y,0,0,k,u,i),Lh(y,-J,-L),y.scale(A,A),S._42(y),y.restore(),d},toDataURL:function(n,A,p){return this.toCanvas(n,p).toDataURL(A||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(j,D){var m,T,B=this;B._93db(j,D),B.each(function(I){B._56I[I._id]&&(m=B.getDataUI(I),m&&(T=m._79o(),e.HtmlNode&&I instanceof e.HtmlNode?m._42(j):(!D||Bh(D,T))&&m._42(j)))}),B._92db(j,D)},validateImpl:function(){var S,h,C,J,F,N=this,g=N.tx(),d=N.ty(),V=N._zoom,E=N._canvas,P=this.getWidth(),U=this.getHeight(),A=N._29I,e={x:-g/V,y:-d/V,width:P/V,height:U/V},G={},D=N._34I,z=N._24I,H=N._32I,X=N._23I;N._24I={},(P!==E.clientWidth||U!==E.clientHeight)&&(zm(E,P,U),H=1),H||li(e,A)||(H=1),N._29I=e,N.each(function(y){h=y._id;var U=G[h]=N.isVisible(y);U!==N._56I[h]&&(z[h]=y,C=N.getDataUI(z[h]),C&&C._84o(U),N._84o(y,U))},N);for(h in z)C=N.getDataUI(z[h]),C&&(!H&&N._56I[h]&&(F=C._79o(),F&&D.add(F)),C.invalidate()),N._83I=1;if(N._56I=G,!H)for(h in z)G[h]&&(C=N.getDataUI(z[h]),C&&(F=C._79o(),F&&D.add(F)));if(H?J=e:(D.each(function(X){Bh(e,X)&&(J=Ah(J,X))}),J&&(ws(J,Y(1,1/V)),J.x=o(J.x*V)/V,J.y=o(J.y*V)/V,J.width=k(J.width*V)/V,J.height=k(J.height*V)/V,J=dk(e,J))),N._74O=J,J){S=Vq(E);var j=J.x,M=J.y,$=J.width,t=J.height;j=Math.floor((j*V+g)*Yl),M=Math.floor((M*V+d)*Yl),$=Math.ceil($*V*Yl)+1,t=Math.ceil(t*V*Yl)+1,S.beginPath(),S.rect(j,M,$,t),S.clip(),S.clearRect(j,M,$,t),Wl(S,g,d,V),N._42(S,J),S.restore(),delete N._74O}if(D.clear(),delete N._32I,X&&P>0&&U>0){var C=N.getDataUI(X);if(C){var F=C._79o(),w=N._29I,_=w.x,r=w.y,x=w.width,Q=w.height,V=N._zoom;F&&!Bh(F,w)&&(F.x+F.width<_&&N.tx(-F.x*V),F.x>_+x&&N.tx(-(F.x+F.width-x)*V),F.y+F.height<r&&N.ty(-F.y*V),F.y>r+Q&&N.ty(-(F.y+F.height-Q)*V))}delete N._23I}N._83I&&(delete N._83I,delete N._84I),N._98O(),ui(N._24I)||sc(N.iv,N)},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(s){var l=this;s!==l.isScrollBarVisible()&&(s?(Pi(l._view,l._79O=Cc()),Pi(l._79O,l._27I=Cc()),Pi(l._79O,l._28I=Cc())):(er(l._79O),delete l._79O,delete l._27I,delete l._28I),l.fp("scrollBarVisible",!s,s))},showScrollBar:function(){var S=this;S._79O&&(S._85I||(M(function(){S._86I()},Mi),S.iv()),S._85I=new Date)},_86I:function(){var A=this;if(A._85I){var Z=new Date,q=Z.getTime();q-A._85I.getTime()>=Mi?(delete A._85I,A.iv()):M(function(){A._86I()},Mi)}},_98O:function(){var z=this,h=this._27I,J=this._28I;if(z._79O){if(z._autoHideScrollBar&&!z._85I)return h.style.visibility=am,J.style.visibility=am,void 0;var $=z.getScrollBarColor(),o=z._zoom,y=z.getScrollBarSize(),I=z.getViewRect(),M=z.getScrollRect(),e=I.height*o,k=M.height*o,c=I.width*o-y-2,X=e*((I.y-M.y)*o/k),d=e*(e/k),B=h.style;k-.5>e?(lk>d&&(X=X+d/2-lk/2,0>X&&(X=0),X+lk>e&&(X=e-lk),d=lk),Db(h,c,X,y,d),B.visibility=Gr,B.background=$,B.borderRadius=y/2+vc):B.visibility=am;var s=I.width*o,D=M.width*o,X=I.height*o-y-2,c=s*((I.x-M.x)*o/D),j=s*(s/D),B=J.style;D-.5>s?(lk>j&&(c=c+j/2-lk/2,0>c&&(c=0),c+lk>s&&(c=s-lk),j=lk),Db(J,c,X,j,y),B.visibility=Gr,B.background=$,B.borderRadius=y/2+vc):B.visibility=am}},setDataModel:function(b){var m=this,c=m._dataModel,z=m._selectionModel;c!==b&&(c&&(c.ump(m.handleDataModelPropertyChange,m),c.umm(m.handleDataModelChange,m),c.umd(m.handleDataPropertyChange,m),c.removeIndexChangeListener(m._75O,m),c.removeHierarchyChangeListener(m.handleHierarchyChange,m),z||c.sm().ums(m.handleSelectionChange,m)),m._dataModel=b,b.mp(m.handleDataModelPropertyChange,m),b.mm(m.handleDataModelChange,m),b.md(m.handleDataPropertyChange,m),b.addIndexChangeListener(m._75O,m),b.addHierarchyChangeListener(m.handleHierarchyChange,m),z?z._21I(b):b.sm().ms(m.handleSelectionChange,m),m.invalidateAll(!0),m.fp(hs,c,b),m._canvas.style.background=b.getBackground()||"")},getLayersInfo:function(){if(this._layersInfo===L){var Y=this.getLayers();Y?(this._layersInfo={},Y.forEach(function(X){var d=Hj(X)?X.name:X;this._layersInfo[d]=X},this)):this._layersInfo=null}return this._layersInfo},updateLayers:function(){this._layersInfo=L,this.invalidateSelection(),this.redraw()},handleDataModelPropertyChange:function(V){if("background"===V.property){var A=this._canvas.style.background,i=V.newValue||"";this._canvas.style.background=i,this.fp("canvasBackground",A,i)}else"a:width"===V.property||"a:height"===V.property?(this._83I=1,this.redraw()):"layers"===V.property?this.updateLayers():"hierarchicalRendering"===V.property&&this.redraw()},handleDataPropertyChange:function(C){this.dm().isHierarchicalRendering()&&"parent"===C.property&&C.data.hasChildren()&&this.redraw(),this.invalidateData(C.data)},onPropertyChanged:function(r){var Z=this,H=r.property;if(Z.redraw(),"zoom"===H){var J=Z.sm().getSelection();J.size()&&J.each(function(Y){Y.invalidate()})}Op[H]?Z.showScrollBar():H===Jh&&Z.onCurrentSubGraphChanged(r)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(M){var X=this,f=M.kind,w=M.data;if(X._83I=1,"add"===f)X.invalidateData(w),Hg(w)&&w.getEdgeGroup()&&w.getEdgeGroup().eachSiblingEdge(X.invalidateData,X);else if(f===qe){X._21Q(w);var D=w._id,t=X._25I[D];if(t){if(X._56I[D]){var F=t._79o();F&&X.redraw(F)}t.dispose(),delete X._25I[D],delete X._24I[D],delete X._56I[D]}w===X._currentSubGraph&&X.setCurrentSubGraph(j)}else f===Oe&&(X.invalidateAll(!0),X.setCurrentSubGraph(j))},_75O:function(D){this.invalidateData(D.data)},handleHierarchyChange:function(J){this.dm().isHierarchicalRendering()&&J.data.hasChildren()&&this.redraw(),this.invalidateData(J.data)},adjustIndex:function(T){var D=this;if(D.isVisible(T)){for(var S=T;S._parent&&D.isVisible(S._parent);)S=S._parent;S&&S!==T&&D._dataModel.adjustIndex(S),D._dataModel.adjustIndex(T)}},getImage:function(O){return O.getImage()},getSelectWidth:function(C){return C.s("select.width")},isSelectable:function(Q){if(!this._clickThroughChecking&&Q.getParent()instanceof es&&Q.getParent().isSyncSize())return!1;var q=this.getLayersInfo();if(q){var m=q[Q._layer];if(m&&m.selectable===!1)return!1}return Q.s("2d.selectable")&&this.sm().isSelectable(Q)},isMovable:function(X){var D=this;if(Hg(X)&&X.getStyle(bk)!==ag)return!1;var w=this.getLayersInfo();if(w){var J=w[X._layer];if(J&&J.movable===!1)return!1}return X.s("2d.movable")?D._movableFunc?D._movableFunc(X):!0:!1},isEditable:function(I){var f=this;if(e._uiSerializing)return f._uieditable;if(!f._editInteractor||!f.isSelected(I))return!1;if(Dc(I)){var E=f.getDataUI(I);if(!E||E._88I)return!1}if(Hg(I)&&I.getStyle(bk)!==ag)return!1;var c=this.getLayersInfo();if(c){var g=c[I._layer];if(g&&g.editable===!1)return!1}return I.s("2d.editable")?f._editableFunc?f._editableFunc(I):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(I){return Jl(I)&&0!==I.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(I):!0},isRectEditable:function(N){return this._rectEditableFunc?this._rectEditableFunc(N):!0},isAnchorEditable:function(e){return this._anchorEditableFunc?this._anchorEditableFunc(e):!0},isRotationEditable:function(P){return P.setRotation&&P.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(P):!0:!1},getRotationPoint:function(D){var Y=D.getAnchor(),n=D.getScale(),E=this._zoom,w=Mo(D.getRotation(),0,-D.getHeight()*n.y*Y.y-(n.y<0?-1:1)*(q?32:16)/E),$=D.p();return w.x+=$.x,w.y+=$.y,w},getLogicalPoint:function(e){var f=this;return yq(e,f._canvas,f.tx(),f.ty(),f._zoom,f._zoom)},getSelectedDataAt:function(q){var J=this;return this.getDataAt(q,function(Y){return J.isSelected(Y)})},getDataInfoAt:function(N,C,e){var I,W=this.lp(N),M=this.getDataAt(W,C,e);if(M){var r=this.getDataUI(M);I={data:M,ui:r};var g=r._38o;if(g){var z=g.icons;for(var S in z){var G=z[S],J=g.rects[S];if(J)for(var D=Yg(G.names,M,this),v=D?D.length:0,F=J.rotation,k=0;v>k;k++){var p=D[k],X=J[k];if(rn(X,W,F))return I.part="icons",I.icon=p,I.rect=X,I.index=k,I.rotation=F,I}}}if(this.isNoteVisible(M)){if(r.note2Info&&rn(r.note2Info.clickRect,W,j,r.note2Info.scale))return I.part="note2",I;if(r.noteInfo&&rn(r.noteInfo.clickRect,W,j,r.noteInfo.scale))return I.part="note",I}if(this.isLabelVisible(M)){if(r.label2Info&&rn(r.label2Info.rect,W,r.label2Info.rotation,r.label2Info.scale))return I.part="label2",I;if(r.labelInfo&&rn(r.labelInfo.rect,W,r.labelInfo.rotation,r.labelInfo.scale))return I.part="label",I}if(M.isInRect&&M.isInRect(W))return I.part="rect",I}return I},getDataAt:function(w,P,S){w.target&&(w=this.lp(w));var z,U=this._zoom;return this.reverseEach(function(B){return(P?P(B):this.isSelectable(B))&&this.rectIntersects(B,Ef(w.x,w.y,S,U))?(z=B,!1):void 0},this),z},getIconInfoAt:function(y,x){var b=this;if(y.target&&(y=b.lp(y)),x||(x=b.getDataAt(y)),x){var I=b.getDataUI(x);if(I&&I._38o){var R,e=I._38o,u=new rb;for(R in e.icons)u.add(R);for(var B=u.size()-1;B>=0;B--){R=u.get(B);for(var X=e.rects[R],L=X.rotation,l=X.length-1;l>=0;l--){var p=X[l],K=p.width,w=p.height,N={x:y.x-p.x-K/2,y:y.y-p.y-w/2};L!=j&&(N=Mo(-L,N.x,N.y));var p={x:-K/2,y:-w/2,width:K,height:w};if(rn(p,N))return{key:R,index:l,name:e.icons[R].names[l],rect:X[l],point:y,rotation:L,relativeRect:p,relativePoint:N,data:x}}}}}return j},getDatasInRect:function(j,U,T){T===L&&(T=1);var l=this,X=new rb;return l.reverseEach(function(F){T&&!l.isSelectable(F)||(U?l.rectIntersects(F,j):l.rectContains(F,j))&&X.add(F)}),X},moveSelection:function(x,S){var _=this;_.dm().beginTransaction(),gf(_.sm().toSelection(_.isMovable,_),x,S),_.dm().endTransaction()},moveDatas:function(Q,i,b){var j=this;j.dm().beginTransaction(),Q instanceof rb||(Q=new rb(Q)),gf(Q,i,b),j.dm().endTransaction()},getDataUIBounds:function(v){var L=this.getDataUI(v);return L?L._79o():j},drawData:function($,K){var z=this.getDataUI(K);z&&(z._79o(),z._42($)),K instanceof e.Block&&K.eachChild(function(p){this.drawData($,p)},this)},getBoundsForGroup:function(q){return q.s(mr)?this.getDataUIBounds(q):j},rectIntersects:function(o,f){this.validate();var t=j;if(this._56I[o._id]){var s=this._25I[o._id];if(s){var n=s._79o();if(Qk(f,n))t=!0;else if((f=dk(f,n))&&(s.rectIntersects&&(t=s.rectIntersects(f)),t==j)){if(!o.s("pixelPerfect"))return!0;var F=f.x,$=f.y,Z=f.width,O=f.height,D=this._zoom,H=V.hitMaxArea,A=Z*O*D*D;if(A>H){var Q=Math.sqrt(H/A);D*=Q}Z*=D,O*=D,2>Z&&(Z=2),2>O&&(O=2),F*=D,$*=D;var T=fs(Z,O);Lh(T,-F,-$),T.scale(D,D),this._drawForChecking=!0,this.drawData(T,o),this._drawForChecking=!1;try{for(var a=0,W=T.getImageData(0,0,Z,O).data;a<W.length;a+=4)if(0!==W[a+3]){t=!0;break}T.restore()}catch(y){yb=j,t=!1}}}}return t?!0:!1},rectContains:function(W,u){if(this._56I[W._id]){var X=this._25I[W._id];if(X)return Qk(u,X._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(p){if(!V.isInput(p.target)){var T=this,d=T._focusData,I=d&&T._25I[d._id],z=0,k=T._dataModel._datas;if(!(d&&d._enabled&&d._editable&&I&&I.onKeyDown&&I.onKeyDown(p)===!0))if(9===p.keyCode&&(d&&(z=k.indexOf(d),Wh(p)?-1===--z&&(z=0):++z===k.size()&&(z=0)),T._focusData=d=k.get(z),T.sm().setSelection(d)),Pr(p)?T.selectAll():kh(p)&&T.isResettable()&&T.reset(),T.sm().isEmpty()){if(T._editing)return;var D=T.tx(),Q=T.ty(),L=!1,$=Wh()?100:10;Dj(p)&&(D-=$,L=!0),Pf(p)&&(Q-=$,L=!0),hh(p)&&(D+=$,L=!0),Rc(p)&&(Q+=$,L=!0),L&&T.setTranslate(D,Q)}else{Oi(p)&&T.handleDelete(p);var q=Wh()?10:1;Dj(p)&&(T.moveSelection(-q,0),T.fi({kind:"moveLeft"})),Pf(p)&&(T.moveSelection(0,-q),T.fi({kind:"moveUp"})),hh(p)&&(T.moveSelection(q,0),T.fi({kind:"moveRight"})),Rc(p)&&(T.moveSelection(0,q),T.fi({kind:"moveDown"}))}}},handleScroll:function(S,K){Bk(S);var W=this.lp(S);K>0?this.scrollZoomIn(W):0>K&&this.scrollZoomOut(W)},handlePinch:function(j,b,W){this._68I||(b>W?this.pinchZoomIn(j):this.pinchZoomOut(j))},checkDoubleClickOnNote:function(n,v){var A=this,M=A.lp(n),W=A.getDataUI(v),F=W.note2Info;return F&&v.s("note2.toggleable")&&rn(F.clickRect,M)?(v.s(Qq,!v.s(Qq)),A.fi({kind:"toggleNote2",event:n,data:v}),!0):(F=W.noteInfo,F&&v.s("note.toggleable")&&rn(F.clickRect,M)?(v.s(al,!v.s(al)),A.fi({kind:"toggleNote",event:n,data:v}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(k,E){var V=this,G=V.getAutoScrollZone(),H=G/V.getZoom(),W=G/4,r=V._29I,Y=V.lp(k),T={x:V.tx(),y:V.ty()};return Y&&G>0&&r&&(Y.x-r.x<H?V.translate(W,0):r.x+r.width-Y.x<H&&V.translate(-W,0),Y.y-r.y<H?V.translate(0,W):r.y+r.height-Y.y<H&&V.translate(0,-W)),T.x=V.tx()-T.x,T.y=V.ty()-T.y,E&&(E.x+=T.x,E.y+=T.y),T},getMoveMode:function(a,V){var W=V.s("2d.move.mode");return W?W:Po["88"]?"x":Po["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(C,S,L){var k=this;return"currentSubGraph"===S?{__i:C.getId()}:L.serializeProperty(C,S,k)},deserializeProperty:function(B,d,y){var c=this;if("currentSubGraph"===d){var q=c.dm(),n=q.__idMap;return n[B.__i]}return y.deserializeProperty(B,d,c)},setDefaultCursor:function(z,y){this._defaultCursor=z,y!==!1&&this.setCursor(z)},setCursor:function(x){"default"===x&&(x=this._defaultCursor||x);var m=this.getView().style;m.cursor=x,m.cursor="-webkit-"+x,m.cursor="-moz-"+x},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(m){return V.getConnectAction(null,m)?(this._currentActionType=m,!0):!1}});var cp=function(C,n){var d=this;d.gv=C,d.s=function(z){return n.getStyle(z)},d._data=n,d._87I=new rb};Oq(cp,N,{_6I:j,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var u=this,v=u.gv.isSelected(u._data);return!v||u.isShadowed()?0:u.gv.getSelectWidth(u._data)},getBodyColor:function(t){var a=this._data,W=this.gv.getBodyColor(a);return W?W:t?a.getStyle(t):j},_2Q:function(x){return this.s(x)},_1Q:function(u,I,v,X){var Y=this.s,p=Y(I+".dash.color");u.strokeStyle=p,u.lineWidth=v,u.stroke(),Y(I+".dash.3d")&&oo(u,p,Y(I+".dash.3d.color"),v,this.gv._zoom,Y(I+".dash.3d.accuracy")),No(u,X)},invalidate:function(){this._6I=j},_79o:function(){var d=this;if(!d._6I){d.labelInfo=d.label2Info=d.noteInfo=d.note2Info=d._38o=j,d._87I.clear(),d._3O();var v=d._data,y=d.gv;d._55O=y.isEditable(v)?{_42O:y.isRectEditable(v),_43O:y.isPointEditable(v),_56O:y.isRotationEditable(v)}:j,d._6I=d._81o()}return d._6I},_3O:function(){},getPosition:function(){return Vo},_68o:function(G,g){G&&this._87I.add(pq(G,g))},_81o:function(){var s=this,U=s.s;s._24O(Np,"getLabel"),s._24O(ro,"getLabel2"),s._26O(Jq,"getNote"),s._26O(Wk,"getNote2"),s._15O(),s._55O&&s._48O();var L;if(s._87I.each(function(j){L=Ah(L,j)}),L&&s.isShadowed()){var Z=Hm(L);Z.x+=U("shadow.offset.x"),Z.y+=U("shadow.offset.y"),ws(Z,U("shadow.blur")),L=Ah(L,Z)}return s._87I.clear(),L},_42:function(J){var L=this,l=L._data,w=L.gv,x=L.s,t=x("opacity"),h=this.isShadowed();if(h){var y=J.shadowOffsetX,s=J.shadowOffsetY,P=J.shadowBlur,Q=J.shadowColor,D=w.getZoom();J.shadowOffsetX=x("shadow.offset.x")*D,J.shadowOffsetY=x("shadow.offset.y")*D,J.shadowBlur=x("shadow.blur")*D,J.shadowColor=x("select.color")}if(t!=j){var E=J.globalAlpha;J.globalAlpha=t}L._80o(J),w.isLabelVisible(l)&&((!w._drawForChecking||x("label.selectable"))&&Td(J,L.labelInfo),(!w._drawForChecking||x("label2.selectable"))&&Td(J,L.label2Info)),w.isNoteVisible(l)&&(cj(J,L.noteInfo),cj(J,L.note2Info)),L._99O(J),t!=j&&(J.globalAlpha=E),h&&(J.shadowOffsetX=y,J.shadowOffsetY=s,J.shadowBlur=P,J.shadowColor=Q)},_80o:function(){},_47O:function(){},_24O:function(O,S){var l=this,z=l._data,n=l.gv,P=l.s,m=n[S](z);if(m!=j){var t=P(O+".scale"),D=P(O+".max"),H=P(O+".position"),i=l[O+"Info"]={label:m,scale:t,color:n[S+"Color"](z),font:P(O+".font"),opacity:P(O+".opacity"),align:P(O+".align"),rotation:l.getRotation(P(O+".rotation"),!1,H),background:n[S+"Background"](z)},h=ng(i,m);D>0&&D<h.width&&(i.labelWidth=h.width,h.width=D),1!==t&&(h.width*=t,h.height*=t);var U=l.getPosition(H,P(O+".offset.x"),P(O+".offset.y"),h,P(O+".position.fixed"));if(h.x=U.x-h.width/2,h.y=U.y-h.height/2,l._68o(i.rect=h,i.rotation),1!==t){var B=h.width/t,N=h.height/t;i.rect={x:U.x-B/2,y:U.y-N/2,width:B,height:N}}}},_26O:function(E,Z){var W=this,J=W.gv,_=W._data,I=W.s,d=J[Z](_);if(d!=j){var H,D,U=I(E+".scale"),P=W[E+"Info"]={note:d,scale:U,data:_,view:J,expanded:I(E+".expanded"),font:I(E+".font"),color:I(E+".color"),opacity:I(E+".opacity"),align:I(E+".align"),icon:I(E+".icon"),backgroundImage:I(E+".backgroundImage"),borderWidth:I(E+".border.width"),borderColor:I(E+".border.color"),background:J[Z+"Background"](_)},q=W.getPosition(I(E+".position"),I(E+".offset.x"),I(E+".offset.y")),M=q.x,X=q.y;if(P.expanded){var x,A=I(E+".max"),K=I(E+".backgroundImage");K?(K=El(K),x={width:Fd(K,_),height:Xk(K,_)}):x=ng(P,d),x.width+=6,x.height+=2,A>0&&A<x.width&&(P.labelWidth=x.width,x.width=A),H=x.width,D=x.height+8,P.clickRect={x:M-H*U/2,y:X-D*U,width:H*U,height:D*U*x.height/D}}else{var c=I(E+".icon");c?(c=El(c),H=Fd(c,_),D=Xk(c,_)):(H=12,D=18),P.clickRect={x:M-H*U/2,y:X-D*U,width:H*U,height:D*U}}P.rect={x:M-H/2,y:X-D*U/2-D/2,width:H,height:D};var s=k(P.borderWidth/2)*U;W._68o({x:M-H*U/2-s,y:X-D*U-s,width:H*U+2*s,height:D*U+2*s})}},_48O:function(){},_99O:function(E){var G=this,O=G._38o;if(O){var Q=G.gv,h=G._data,v=O.icons;for(var e in v){var u=v[e],J=O.rects[e];if(J){var a=Yg(u.opacity,h,Q),L=Yg(u.names,h,Q),I=L?L.length:0,W=J.rotation;if(a!=j){var x=E.globalAlpha;E.globalAlpha*=a}for(var A=0;I>A;A++){var N=L[A],b=El(N),B=J[A];if(W){var s=B.x+B.width/2,o=B.y+B.height/2;E.save(),Lh(E,s,o),Xe(E,W),Lh(E,-s,-o)}Dm(E,b,Yg(u.stretch,h,Q),B.x,B.y,B.width,B.height,G._data,G.gv),W&&E.restore()}a!=j&&(E.globalAlpha=x)}}}}});var Mk=function(f,g){em(Mk,this,[f,g])};Oq(Mk,cp,{_checkEmptyRect:!0,_40O:function(H,D){var k=this,d=k.s,I=H.rect;(H.borderColor=k.gv.getBorderColor(k._data))&&(H.borderType=d("border.type"),H.borderWidth=d("border.width"),H.borderPadding=d("border.padding"),D=Y(D,H.borderPadding+H.borderWidth/2));var M=k._data.getScale(),s=Y(1,Y(r(M.x),r(M.y)));if(H.selectWidth=k.getSelectWidth()){var j=k.gv._zoom;H.selectType=d("select.type"),H._97o=d("select.color"),H.selectPadding=d("select.padding"),D=Y(D,(H.selectPadding+H.selectWidth/2/j)/s)}D>0&&(D*=s,I=Hm(I),ws(I,D)),k._68o(I)},_39O:function(k,T){var h,I=this,K=T.rect;if(T.borderWidth>0&&(h=T.borderPadding,k.strokeStyle=T.borderColor,k.lineWidth=T.borderWidth,fi(k,T.borderType,{x:K.x-h,y:K.y-h,width:K.width+2*h,height:K.height+2*h}),k.stroke()),T.selectWidth>0){var w=I.gv._zoom;if(h=T.selectPadding,k.strokeStyle=T._97o,k.lineWidth=T.selectWidth/w,T.rotation!=j){k.save(),k.translate(T.position.x,T.position.y),k.rotate(T.rotation);var i=I._data,u=i.getWidth(),O=i.getHeight(),C=T.scale,s=T.anchor;K={x:C.x*-u*s.x,y:C.y*-O*s.y,width:C.x*u,height:C.y*O}}fi(k,T.selectType,{x:K.x-h,y:K.y-h,width:K.width+2*h,height:K.height+2*h}),T.rotation!=j&&k.restore(),k.stroke()}},_3O:function(){var $=this,z=$.s,O=$._data,i=O.getStyle(Lo),c=$.getBodyColor(),A=$._83o=i?{shape:i,_53o:$.getBodyColor("shape.background"),_27Q:El(z("shape.repeat.image"),c),shapeGradientPack:z("shape.gradient.pack"),_54o:z("shape.border.width"),_55o:z("shape.border.color"),_56o:z("shape.border.3d"),_57o:z("shape.border.3d.color"),_58o:z("shape.border.3d.accuracy"),shapeGradient:z("shape.gradient"),_59o:z("shape.gradient.color"),_60o:z("shape.border.pattern"),_61o:z("shape.border.cap"),_62o:z("shape.border.join"),bodyColor:c}:{img:El($.gv.getImage(O),c),bodyColor:c,stretch:z("image.stretch")};if(g&&!T);else{A.rect=O.getRect(),A.position=O.p(),A.scale=O.getScale(),A.anchor=O.getAnchor(),A.rotation=O.getRotation(),i===Iq&&(A._63o=z("shape.depth"));var p=0;if(i)p=Wi(j,A._54o/2,A._62o),$.s("shape.dash")&&(p=Y(p,($.s("shape.dash.width")||A._54o)/2));else if(A.img&&A.img.boundExtend)if(p=Yg(A.img.boundExtend,O,$.gv),A.img.boundExtendAbsolute){var o=O.getScale();p/=$.gv._zoom*Y(1,Y(r(o.x),r(o.y)))}else if(!Yg(A.img.fitSize,O,$.gv)){var y=Yg(A.img.width,O,$.gv),t=Yg(A.img.height,O,$.gv);p*=Y(O.getWidth()/y,O.getHeight()/t)}$._40O(A,p);var I=z("clip.percentage");if(1>I&&(0>I&&(I=0),A.clipRect=Kl(O.getAnchorRect(),z("clip.direction"),I)),i){var w=z("shape.fill.clip.percentage");1>w&&(0>w&&(w=0),A.shapeClipRect=Kl(O.getAnchorRect(),z("shape.fill.clip.direction"),w))}}},getPosition:function(M,I,x,p){var C=kd(M,this._83o.rect,p);return C.x+=I,C.y+=x,C},_80o:function(A){var Q=this,H=Q.s,n=Q.gv,W=Q._data,y=Q._83o,X=y.rect,z=y.position,l=y.rotation,G=y.anchor,R=y.scale,r=y.shape,U=y.clipRect;if(!Q._checkEmptyRect||X.width>0&&X.height>0){var K=W.getSize();if(K.x=-K.width*G.x,K.y=-K.height*G.y,A.save(),Lh(A,z.x,z.y),Xe(A,l),ko(A,R.x,R.y),U&&(A.beginPath(),A.rect(U.x,U.y,U.width,U.height),A.clip()),Q.freeDraw)Q.freeDraw(A,K,y);else if(r){var w,$,F,k,u=y._60o,B=so(A,u),Y=y._53o,t=y._27Q,f=y._54o,g=y._55o,P=y.shapeGradientPack,T=A.lineJoin,N=A.lineCap;if("roundRect"===r?w=H("shape.corner.radius"):"polygon"===r?w=H("shape.polygon.side"):"arc"===r&&(w=H("shape.arc.from"),$=H("shape.arc.to"),F=H("shape.arc.close"),k=H("shape.arc.oval")),A.lineJoin=y._62o,A.lineCap=y._61o,Y||t||P){var h=y.shapeClipRect;h&&(A.save(),A.beginPath(),A.rect(h.x,h.y,h.width,h.height),A.clip()),fi(A,r,K,w,$,F,k),P?Fg(A,P):t?fl(A,t,y.bodyColor,null,W,n):Gf(A,Y,y.shapeGradient,y._59o,K),A.fill(),h&&A.restore(),P&&A.restore(),A!==B&&fi(B,r,K,w,$,F,k)}else fi(B,r,K,w,$,F,k);if(f>0){var D=H("shape.border.width.absolute");D&&(A.save(),A.setTransform(1,0,0,1,0,0)),A.lineWidth=f,A.strokeStyle=g,A.stroke(),D&&A.restore(),y._56o&&oo(A,g,y._57o,f,n._zoom,y._58o)}if(No(A,u),H("shape.dash")){var o=H("shape.dash.width")||f;if(o>0){u=H("shape.dash.pattern");var B=so(A,u,Q._2Q("shape.dash.offset"));B!==A&&fi(B,r,K,w,$,F,k),Q._1Q(A,"shape",o,u)}}yj(A,Y,y._63o,K),A.lineJoin=T,A.lineCap=N}else Dm(A,y.img,y.stretch,K.x,K.y,K.width,K.height,W,n,y.bodyColor);A.restore()}Q._39O(A,y)},_48O:function(){},_47O:function(){}});var Rl=function(E,z){em(Rl,this,[E,z])},Yr=function(d,i,w,Q){var n=aq(d,i);return w=Q?K(w,n):ne(w,n),n?w/=n:w=0,{x:d.x+(i.x-d.x)*w,y:d.y+(i.y-d.y)*w}};Oq(Rl,cp,{_3O:function(){var d,k=this,t=k._data,o=k.gv,D=k.s,h=D(bk),K=t.isLooped(),r=D("edge.width"),P=D("edge.center"),l=D("edge.offset"),v=o.getBorderColor(t),B=v?D("border.width"):0,R=k.getSelectWidth(),O=t._40I,I=t._41I,b=k._78o=O&&I?{looped:K,type:h,width:r,center:P,color:k.getBodyColor("edge.color"),borderColor:v,borderWidth:B,_97o:R?D("select.color"):j,selectWidth:R,pattern:D("edge.pattern"),cap:D("edge.cap"),join:D("edge.join"),is3d:D("edge.3d"),_67o:D("edge.3d.color"),_66o:D("edge.3d.accuracy")}:j;if(b){var a=V.getEdgeType(h);if(a){var C=a(t,Ck(k,o,t,K,h),o,k._19Q);C.points&&C.points.size()>1?(b._4O=C,d=jq(b._4O.points)):C[$e]&&C.rect&&(b._4O=C,d=C.rect)}else{var F=D("edge.source.anchor.x"),J=D("edge.source.anchor.y"),N=D("edge.target.anchor.x"),M=D("edge.target.anchor.y"),f=_h(o,O,D("edge.source.position"),D("edge.source.offset.x"),D("edge.source.offset.y"),F,J),T=_h(o,I,D("edge.target.position"),D("edge.target.offset.x"),D("edge.target.offset.y"),N,M);if(h===ag){var X=b.points=D(Tj)||Ee,p=X.size();b.segments=D("edge.segments");var G=F!==L||J!==L,i=N!==L||M!==L;if(!P)if(l)G||(f=Yr(f,p?X.get(0):T,l,p)),i||(T=Yr(T,p?X.get(p-1):f,l,p));else{var u;G||(u=Pj(f,p?X.get(0):T,Bd(o,O)),u&&(f={x:u[0],y:u[1]})),i||(u=Pj(p?X.get(p-1):f,T,Bd(o,I)),u&&(T={x:u[0],y:u[1]}))}d=Ah(jq(b.points),jq(f,T))}else{var s=Ck(k,o,t,K,h);if(k._19Q||(s=-s),K)f=Hm(f),f.x=o.getNodeRect(O).x,b.radius=s,d={x:f.x-s,y:f.y-s,width:2*s,height:2*s};else{var E=aq(f,T),q=ne(l,E),e={x:q,y:s},Q={x:E-q,y:s},y=H(T.y-f.y,T.x-f.x),z=b.mat=new rc(y);if(b.orienAngle=y,b.angle=T.x<f.x?y+m:y,b.rect={x:e.x,y:e.y,width:Q.x-e.x,height:0},b.origin=f,e=z.tf(e),e.x+=f.x,e.y+=f.y,Q=z.tf(Q),Q.x+=f.x,Q.y+=f.y,P){var $={x:E,y:0};$=z.tf($),$.x+=f.x,$.y+=f.y,d=jq([f,e,Q,$]),b.c1=f,b.c2=$}else d=jq(e,Q);f=e,T=Q}}b.sourcePoint=f,b.targetPoint=T,t._lastSourcePoint=f,t._lastTargetPoint=T}var n=0;D("edge.dash")&&(n=D("edge.dash.width")||r);var _="square"===b.cap?.71:.5;Wi(d,Y(n*_,r*_+B+R),b.join),k._68o(d)}},getRotation:function(F,k,p){F=F||0;var U=this._78o;if(U){var B,v=U.angle,I=U.points,y=U._4O;if(v!=j)return k?U.orienAngle+F:v+F;if(y&&y[$e])return y.getRotation?y.getRotation(this,F,k,p):0;if(y&&y.points){var w=y.points;return B=w.size(),$r[p]?B&&0===B%2?qf(w.get(B/2-1),w.get(B/2),k,F):F:yi[p]?qf(w.get(0),w.get(1),k,F):qf(w.get(B-2),w.get(B-1),k,F)}if(I)return B=I.size(),$r[p]?B&&0===B%2?qf(I.get(B/2-1),I.get(B/2),k,F):F:yi[p]?qf(U.sourcePoint,B?I.get(0):U.targetPoint,k,F):qf(B?I.get(B-1):U.sourcePoint,U.targetPoint,k,F)}return F},getPosition:function(E,F,I,Y,h){var A=this._78o;if(A){var L,z=A.type,y=A.points,V=A._4O,N=A.sourcePoint,v=A.targetPoint;if(!z)return A.looped?{x:N.x-A.radius+F,y:N.y+I}:(h&&N&&v&&(N.x>v.x||N.x===v.x&&N.y>v.y)&&(E=op[E],I=-I),L=kd(E,A.rect,Y),L.x+=F,L.y+=I,L=A.mat.tf(L),L.x+=A.origin.x,L.y+=A.origin.y,L);if(V&&V[$e])return V.getPosition?V.getPosition(this,E,F,I,Y,h):{x:(N.x+v.x)/2,y:(N.y+v.y)/2};if(y){var L,X=y.size();if($r[E]){if(X){var j=X%2;if(0===j)return jd(y.get(X/2-1),y.get(X/2),E,F,I,Y,h);L=y.get((X-j)/2)}else L={x:(N.x+v.x)/2,y:(N.y+v.y)/2};return L=kd(E,{x:L.x,y:L.y,width:0,height:0},Y),L.x+=F,L.y+=I,L}return yi[E]?jd(N,X?y.get(0):v,E,F,I,Y,h):jd(X?y.get(X-1):N,v,E,F,I,Y,h)}if(V){var n=V.points,X=n.size();if($r[E]){var j=X%2;return 0===j?jd(n.get(X/2-1),n.get(X/2),E,F,I,Y,h):(L=n.get((X-j)/2),L=kd(E,{x:L.x,y:L.y,width:0,height:0},Y),L.x+=F,L.y+=I,L)}return yi[E]?jd(n.get(0),n.get(1),E,F,I,Y,h):jd(n.get(X-2),n.get(X-1),E,F,I,Y,h)}}return Vo},_42:function(K){this._78o&&Rl.superClass._42.call(this,K)},drawPath:function(g,F){g.beginPath();var A=F.type,R=F.points,J=F.segments,C=F._4O;if(!A||R){var d=F.sourcePoint,W=d.x,M=d.y,q=F.targetPoint,v=q.x,c=q.y;if(A)if(J){var E=new rb({x:W,y:M});E.addAll(R),E.add({x:v,y:c}),Ch(g,E,J)}else g.moveTo(W,M),R.each(function(C){g.lineTo(C.x,C.y)}),g.lineTo(v,c);else F.looped?g.arc(W,M,F.radius,0,h,!0):F.center?(g.moveTo(F.c1.x,F.c1.y),g.lineTo(W,M),g.lineTo(v,c),g.lineTo(F.c2.x,F.c2.y)):(g.moveTo(W,M),g.lineTo(v,c))}else C&&(C.points?Ch(g,C.points,C.segments):C[$e]&&C[$e](g,C))},_80o:function(Y){var l=this,G=l.s,B=l._78o,s=B.width,v=B.selectWidth,K=B.borderWidth,q=B.color,S=Y.lineJoin,N=Y.lineCap,D=B.pattern;Y.lineJoin=B.join,Y.lineCap=B.cap,l.drawPath(so(Y,D),B);var J=G("edge.width.absolute");if(J&&(Y.save(),Y.setTransform(1,0,0,1,0,0)),v&&(Y.strokeStyle=B._97o,Y.lineWidth=s+2*(K+v),Y.stroke()),K&&(Y.strokeStyle=B.borderColor,Y.lineWidth=s+2*K,Y.stroke()),Y.strokeStyle=q,Y.lineWidth=s,Y.stroke(),B.is3d&&oo(Y,q,B._67o,s,l.gv._zoom,B._66o),J&&Y.restore(),No(Y,D),G("edge.dash")){D=G("edge.dash.pattern");var y=so(Y,D,l._2Q("edge.dash.offset"));y!==Y&&l.drawPath(y,B),l._1Q(Y,"edge",G("edge.dash.width")||s,D)
}Y.lineJoin=S,Y.lineCap=N},_48O:function(){},_47O:function(){},_71o:function(d,V){var p=this,K=p._data;if(p._19Q=!0,!K.getEdgeGroup())return d?K.s("edge.gap"):0;var n,P=0,J=0,G=0;if(K.getEdgeGroup().getSiblings().each(function(E){E.each(function(S){if(p.gv.isVisible(S)&&S.s(bk)==V){var D=S.s("edge.gap");n?(J+=G/2+D/2,G=D):(n=S,G=D),S===K&&(P=J)}})}),d)return J-P+G;var _=P-J/2;return n&&K._40I!==n._40I&&(p._19Q=!1),_}});var dj=function(D,g){em(dj,this,[D,g])};Oq(dj,Mk,{_3O:function(){var Q,P,H=this,A=H.s,y=H._data,Y=H.gv;if(H._88I=j,y.isExpanded()&&y.eachChild(function(m){var D=Y.getBoundsForGroup(m);D&&(P||(P=[]),P.push(D),Q=Ah(Q,D))}),Q){var J=Y.getLabel(y),_=A("group.type");Q=kl(_,P,Q),qj(Q,y,"group.padding",1);var g=H._88I={type:_,rect:Q,_64o:Q};if(!_&&J!=j){var h,D=H.labelInfo={label:J,color:A("group.title.color"),font:A("group.title.font"),align:A("group.title.align")},z=ng(D,J),Z=z.width,R=z.height,C=A("group.title.align");Z>Q.width&&(Q.width=Z),D.rect={y:Q.y-R,width:z.width,height:R},h=C===ie?Q.x:C===yh?Q.x+Q.width-Z:Q.x+Q.width/2-Z/2,D.rect.x=h,g.titleRect={x:Q.x,y:Q.y-R,width:Q.width,height:R+1},g.rect={x:Q.x,y:Q.y-R,width:Q.width,height:Q.height+R}}H._40O(g,A("group.border.width")/2)}else dj.superClass._3O.call(H)},getPosition:function(h,c,g,L){var _=this._88I;if(_){var W=kd(h,_.rect,L);return W.x+=c,W.y+=g,W}return dj.superClass.getPosition.apply(this,arguments)},_24O:function(t,M){var s=this._88I;(!s||s.type||"label2"===t)&&dj.superClass._24O.call(this,t,M)},_80o:function(N){var R=this,E=R._88I;if(E){var j=R._data,Q=R.s,V=R.gv,C=E.type,f=E.rect,t=E._64o,F=E.titleRect,v=R.getBodyColor(),P=El(Q("group.image"),v),q=Q("group.image.stretch"),z=R.getBodyColor("group.background"),W=El(Q("group.repeat.image"),v),y=Q("group.gradient.pack"),K=Q("group.gradient"),_=Q("group.gradient.color"),g=Q("group.depth");if(C){var u=Q("group.border.pattern"),Y=Q("group.border.width"),k=N.lineJoin,A=N.lineCap;if(N.lineJoin=Q("group.border.join"),N.lineCap=Q("group.border.cap"),P){if(N.save(),fi(N,C,f),N.clip(),Dm(N,P,q,f.x,f.y,f.width,f.height,j,V,v),N.restore(),Y>0){var L=so(N,u);fi(L,C,f),N.lineWidth=Y,N.strokeStyle=Q("group.border.color"),N.stroke(),No(N,u)}}else{var L=so(N,u);z||W||y?(fi(N,C,f),y?Fg(N,y):W?fl(N,W,v,null,j,V):Gf(N,z,K,_,f),N.fill(),y&&N.restore(),N!==L&&fi(L,C,f)):fi(L,C,f),Y>0&&(N.lineWidth=Y,N.strokeStyle=Q("group.border.color"),N.stroke()),No(N,u),C===Iq&&yj(N,z,g,f)}N.lineJoin=k,N.lineCap=A}else if(P?Dm(N,P,q,t.x,t.y,t.width,t.height,j,V,R.getBodyColor()):(z||W)&&(W?fl(N,W,v,null,j,V):Gf(N,z,K,_,t),fi(N,Iq,t),N.fill(),yj(N,z,g,t)),F){var s=Q("group.title.background");Yp(N,F.x,F.y,F.width,F.height,s),yj(N,s,g,F)}R._39O(N,E)}else dj.superClass._80o.call(R,N)}});var Rr=function(S,g){em(Rr,this,[S,g])};Oq(Rr,Mk,{_80o:function(v){this._39O(v,this._83o)}});var Gp=function(z,W){em(Gp,this,[z,W])};Oq(Gp,Mk,{_3O:function(){var Z=this,z=Z._data,L=Z.s,J=Z.gv,K=z.getPoints(),X=J.getBorderColor(z),q=X?L("border.width"):0,M=Z.getSelectWidth(),w=L("shape.border.width"),U=z.getRect(),$=J.getBodyColor(z),u=Z._99o=K.isEmpty()?j:{rect:U,rotation:z.getRotation(),fillRule:L("shape.fill.rule"),scale:z.getScale(),position:z.p(),points:K,segments:z.getSegments(),bodyColor:$,borderColor:X,borderWidth:q,_94o:L("shape.border.3d"),_95o:L("shape.border.3d.color"),_96o:L("shape.border.3d.accuracy"),_97o:M?L("select.color"):j,selectWidth:M,_53o:L("shape.background"),_27Q:El(L("shape.repeat.image"),$),shapeGradientPack:L("shape.gradient.pack"),_54o:w,_55o:L("shape.border.color"),shapeGradient:L("shape.gradient"),_59o:L("shape.gradient.color"),_60o:L("shape.border.pattern"),_61o:L("shape.border.cap"),_62o:L("shape.border.join")};if(u){var o=z.getScale(),V=Y(1,Y(r(o.x),r(o.y)));L("shape.dash")&&L("shape.dash.width")>w&&(w=L("shape.dash.width"));var E=w*("square"===u._61o?.71:.5)+q+M/Z.gv._zoom/V;E&&(E*=V,U=Hm(U),Wi(U,E,u._62o)),Z._68o(U);var S=L("clip.percentage");1>S&&(0>S&&(S=0),u.clipRect=Kl(z.getAnchorRect(),L("clip.direction"),S));var k=L("shape.fill.clip.percentage");1>k&&(0>k&&(k=0),u.shapeClipRect=Kl(z.getAnchorRect(),L("shape.fill.clip.direction"),k))}},getPosition:function(A,e,L,E){var M=this._99o;if(M){var v=kd(A,M.rect,E);return v.x+=e,v.y+=L,v}return Vo},_42:function(N){this._99o&&Gp.superClass._42.call(this,N)},_80o:function(V){var H,n=this,K=n.s,h=n._99o,Z=h.position,c=h.scale,G=h.rotation,Q=h.bodyColor,p=h.borderWidth,T=h.selectWidth,x=h._53o,M=h._27Q,y=h.shapeGradientPack,W=h._54o,S=h.clipRect,O=h.shapeClipRect,U=h.points,f=h.segments,A=n._data.isClosePath(),P=h.fillRule,o=x||M||y;V.save(),Lh(V,Z.x,Z.y),Xe(V,G),ko(V,c.x,c.y),S&&(V.beginPath(),V.rect(S.x,S.y,S.width,S.height),V.clip()),o&&O&&(V.save(),V.beginPath(),V.rect(O.x,O.y,O.width,O.height),V.clip()),Lh(V,-Z.x,-Z.y);var k=h._60o,$=so(V,k),J=V.lineJoin,N=V.lineCap;V.lineJoin=h._62o,V.lineCap=h._61o,o?(Ch(V,U,f,A),y?Fg(V,y):M?fl(V,M,Q,null,n._data,n.gv):(H=Q?Q:x,Gf(V,H,h.shapeGradient,h._59o,h.rect)),V.fill(P),O&&(V.restore(),Lh(V,-Z.x,-Z.y)),y&&V.restore(),$!==V&&Ch($,U,f,A)):Ch($,U,f,A);var E=K("shape.border.width.absolute");if(E&&(V.save(),V.setTransform(1,0,0,1,0,0)),T&&(V.strokeStyle=h._97o,V.lineWidth=W+2*(p+T),V.stroke()),p&&(V.strokeStyle=h.borderColor,V.lineWidth=W+2*p,V.stroke()),W&&(H=h._55o,!x&&Q&&(H=Q),V.strokeStyle=H,V.lineWidth=W,V.stroke(),h._94o&&oo(V,H,h._95o,W,n.gv._zoom,h._96o)),E&&V.restore(),No(V,k),K("shape.dash")){var C=K("shape.dash.width")||W;if(C>0){k=K("shape.dash.pattern");var $=so(V,k,n._2Q("shape.dash.offset"));$!==V&&Ch($,U,f,A),n._1Q(V,"shape",C,k)}}V.lineJoin=J,V.lineCap=N,V.restore()},_48O:function(){},_47O:function(){}});var Bc=function(y,L){em(Bc,this,[y,L])};Oq(Bc,Gp,{getRotation:function(U,F,T){U=U||0;var M=this._data.getPoints(),n=M.size();return n>1?$r[T]?n&&0===n%2?qf(M.get(n/2-1),M.get(n/2),F,U):U:yi[T]?qf(M.get(0),M.get(1),F,U):qf(M.get(n-2),M.get(n-1),F,U):U},getPosition:function(I,Y,E,w,Q){var r=this._data.getPoints(),W=r.size();if(W>1){if($r[I]){var c=W%2;if(0===c)return jd(r.get(W/2-1),r.get(W/2),I,Y,E,w,Q);var D=r.get((W-c)/2),i={x:D.x,y:D.y,width:0,height:0};return D=kd(I,i,w),D.x+=Y,D.y+=E,D}return yi[I]?jd(r.get(0),r.get(1),I,Y,E,w,Q):jd(r.get(W-2),r.get(W-1),I,Y,E,w,Q)}return Vo}});var vq=function(F,p){em(vq,this,[F,p])};Oq(vq,Mk,{_3O:function(){var B=this;vq.superClass._3O.call(B);var c=B.s,M=B._83o;B._82o=M.img||M.shape?j:{background:B.getBodyColor("grid.background"),depth:c("grid.depth"),rect:M.rect,_88o:c("grid.cell.depth"),cellBorderColor:c("grid.cell.border.color"),_89o:c("grid.row.count"),_90o:c("grid.column.count"),block:c("grid.block"),_91o:c("grid.block.color"),_92o:c("grid.block.padding"),_93o:c("grid.block.width")}},_80o:function(i){var R=this,e=R._82o;if(!e)return vq.superClass._80o.call(R,i),void 0;var I,H,S=R._data,A=e.background,f=e.rect,w=e.block,V=e._91o,Z=e._92o,Y=e._93o,g=e._88o,U=e.cellBorderColor,m=e._89o,$=e._90o;if(A)if(Yp(i,f.x,f.y,f.width,f.height,A),yj(i,A,e.depth,f),g)for(I=0;m>I;I++)for(H=0;$>H;H++)f=S.getCellRect(I,H),f&&yj(i,A,g,f);else if(U){for(i.beginPath(),I=0;m>I;I++)for(H=0;$>H;H++)f=S.getCellRect(I,H),f&&i.rect(f.x,f.y,f.width,f.height);i.strokeStyle=U,i.lineWidth=1,i.stroke()}if("h"===w)for(I=0;m>I;I++)f=Ah(S.getCellRect(I,0),S.getCellRect(I,$-1)),ws(f,Z),$h(i,V,f.x,f.y,f.width,f.height,Y);else if("v"===w)for(H=0;$>H;H++)f=Ah(S.getCellRect(0,H),S.getCellRect(m-1,H)),ws(f,Z),$h(i,V,f.x,f.y,f.width,f.height,Y);R._39O(i,R._83o)}});var Ub=function(T,J){em(Ub,this,[T,J])};Oq(Ub,Mk,{_checkEmptyRect:!1,_81o:function(){var B=this._data,l=Ub.superClass._81o.call(this),n=B.s("text");if(n!=j){var k,m,o=B.s("text.font"),D=B.s("text.align"),z=B.s("text.vAlign"),Q=Ed(o,n),w=Q.width,r=Q.height,u=B.getAnchor(),g=B.getWidth(),d=B.getHeight();"left"===D?k=-g*u.x:"center"===D?k=-g*u.x+(g-w)/2:"right"===D&&(k=g*(1-u.x)-Q.width),"top"===z?m=-d*u.y:"middle"===z?m=-d*u.y+(d-r)/2:"bottom"===z&&(m=d*(1-u.y)-Q.height);var K,f=B.getMatrix();if(K=jq([f.tf(k,m),f.tf(k+w,m),f.tf(k+w,m+r),f.tf(k,m+r)]),l=Ah(l,K),l&&B.s("text.shadow")){var O=Hm(l);O.x+=B.s("text.shadow.offset.x"),O.y+=B.s("text.shadow.offset.y"),ws(O,B.s("text.shadow.blur")),l=Ah(l,O)}}return l}});var of=Gq.Interactor=function(D){this.gv=this._graphView=D};Gj("Interactor",N,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(I){this.gv.fi(I)},setCursor:function(g){q||this.gv.setCursor(g)},startDragging:function(T){var N=this;N._lastClientPoint=Eq(T),N._lastLogicalPoint=N.gv.lp(T),Xo(N,T)},clearDragging:function(){var v=this;v._lastClientPoint=v._lastLogicalPoint=v._logicalPoint=j},autoScroll:function(U){return this.gv.autoScroll(U,this._lastClientPoint)}});var ep=function(Z){var M=this;M.gv=Z,Z.getView(),["mousedown","mousemove","mouseup","touchstart","touchmove","touchsend"].forEach(function(O){M.addListener(O)})};Oq(ep,of,{interactiveDisabled:!1,addListener:function(_){var k=this;k.gv.getView().addEventListener(_,function(b){V.preventDefault(b),k.interactiveDisabled||k["handle_"+_](b)},!1)},handle:function(c,$,E){var h=this.gv;if(E=E||h.getDataInfoAt($)){var S=E.part,U=E.data,W=E.ui;U[c]&&U[c]($,U,h);var N;return"rect"===S&&W._83o&&W._83o.img?N=h.getImage(U):"icons"===S&&(N=E.icon),this.handleImage(N,c,$,U,h),E}},handleImage:function(e,L,g,u,l){if(e&&(e=El(e))&&(e[L]&&e[L](g,u,l),e.comps))for(var p=0;p<e.comps.length;p++){var Y=e.comps[p];Y[L]&&Y[L](g,u,l)}},handle_mousedown:function(h){this.handle("onDown",h)},handle_mousemove:function(_){var L=this,C=L.gv;L._hoverTimer&&(y(L._hoverTimer),delete L._hoverTimer);var N=L.handle("onMove",_);N&&(L._hoverTimer=M(function(){y(L._hoverTimer),delete L._hoverTimer,L.handle("onHover",_,N)},C.getHoverDelay()||V.hoverDelay))},handle_mouseup:function(I){this.handle("onUp",I)},handle_touchstart:function(i){this.handle("onDown",i)},handle_touchmove:function(d){this.handle("onMove",d)},handle_touchend:function(u){this.handle("onUp",u)},handleWindowMouseMove:function(){},handleWindowMouseUp:function(){}});var sk=Gq.DefaultInteractor=function(e){em(sk,this,[e])};Gj("DefaultInteractor",of,{handle_mousedown:function(y){Bk(y);var B=this,K=B.gv,C=K.getDataAt(y);!K.setFocus(y)||K._editing||K._scrolling||(wo(y)?K.handleDoubleClick(y,C):K.handleClick(y,C),!kh()&&C||!K.isPannable()||!Wr(y)||_o(y)||(B._tx=K.tx(),B._ty=K.ty(),B.startDragging(y)))},handleWindowMouseUp:function(V){var k=this,O=k.gv;O._panning&&(delete O._panning,O.onPanEnded(),k.fi({kind:"endPan",event:V})),delete k._tx,delete k._ty,k.clearDragging()},handle_mousemove:function(o){var r=this,K=r.gv;r._hoverTimer&&(y(r._hoverTimer),delete r._hoverTimer),r._hoverTimer=M(function(){r.fi({kind:"hover",event:o}),y(r._hoverTimer),delete r._hoverTimer},K.getHoverDelay()||V.hoverDelay)},handle_touchmove:function(o){this.handle_mousemove(o)},handleWindowMouseMove:function(c){var q=this,p=q.gv,J=q._lastClientPoint;q.fi({kind:p._panning?"betweenPan":"beginPan",event:c}),p._panning=1,p.setTranslate(q._tx+c.clientX-J.x,q._ty+c.clientY-J.y)},handle_mousewheel:function(D){this.gv.handleScroll(D,D.wheelDelta)},handle_DOMMouseScroll:function(D){2===D.axis&&this.gv.handleScroll(D,-D.detail)},handle_keydown:function(w){this.gv.handleKeyDown(w)}});var Zn=Gq.SelectInteractor=function(j){em(Zn,this,[j])};Gj("SelectInteractor",of,{_42:function(){var s=this,O=s.gv,h=O.getZoom(),q=s.mark,j=s.div;j||(j=s.div=Cc(),Pi(s.getView(),j));var E={};E.x=q.x*h+O.tx(),E.y=q.y*h+O.ty(),E.width=q.width*h,E.height=q.height*h,Db(j,E),this.intersects()?(j.style.border="",j.style.background=O.getRectSelectBackground()):(j.style.background="",j.style.border="1px solid "+O.getRectSelectBorderColor())},handle_mousedown:function(C){var L=this,G=L.gv;if(L._57I=j,!(G._editing||G._scrolling||kh())){var c=G.getDataAt(C),s=G.sm();if(c)if(_o(C))s.co(c)?s.rs(c):s.as(c);else if(s.co(c)){if(wo(C)&&c instanceof es&&c.isClickThroughEnabled()){var F=G.getDataAt(C,function(P){G._clickThroughChecking=!0;var L=P.getParent()===c&&G.isSelectable(P);return delete G._clickThroughChecking,L});F&&(C.clickThrough=!0,s.ss(F))}}else s.ss(c);else _o(C)||!G.isPannable()?Wr(C)&&(_o(C)||s.cs(),G.isRectSelectable()&&(L.startDragging(C),G._77O=1)):Wr(C)&&(L._57I=Eq(C))}},handle_mouseup:function(e){var M=this,H=M._57I;H&&(aq(H,Eq(e))<=1&&M.gv.sm().cs(),M._57I=j)},handleWindowMouseUp:function(W){this.clear(W)},handleWindowMouseMove:function(N){var X=this,Z=X.gv;X._logicalPoint=Z.lp(N),X.mark?(X.fi({kind:"betweenRectSelect",event:N}),Z.isPannable()&&X.autoScroll(N),X.redraw()):X.fi({kind:"beginRectSelect",event:N}),X.mark=jq(X._lastLogicalPoint,X._logicalPoint),X.redraw()},intersects:function(){var N=this,_=N._lastLogicalPoint,E=N._logicalPoint;return _.x>E.x||_.y>E.y},clear:function(i){var n=this,e=n.gv,r=n.mark;if(n._57I=j,n._lastLogicalPoint){if(r){if(0!==r.width&&0!==r.height){var t=e.getDatasInRect(r,n.intersects());if(!t.isEmpty()){var X=e.sm(),B=X.toSelection();t.each(function(W){X.co(W)?B.remove(W):B.add(W)}),X.ss(B)}}er(n.div),delete n.div,delete n.mark,n.redraw(),n.fi({kind:"endRectSelect",event:i}),e.onRectSelectEnded()}n.clearDragging(),delete e._77O}},redraw:function(){var o=this;o._draw||(o._draw=1,M(function(){o.mark&&o._42(),delete o._draw},16))}});var Ek=Gq.MoveInteractor=function(T){em(Ek,this,[T])};Gj("MoveInteractor",of,{handle_mousedown:function(U){var h=this,R=h.gv;if(Wr(U)&&!R._editing&&!R._scrolling&&!kh()){var S=R.getSelectedDataAt(U);S?(h._data=S,R.handleMouseDown&&R.handleMouseDown(U,S),h.startDragging(U),R.isMovable(S)&&(R._moving=1)):R._focusData=j}},handleWindowMouseUp:function(C){var Y=this,w=Y.gv;w.handleMouseUp&&w.handleMouseUp(C,Y._data),Y.clear(C)},handleWindowMouseMove:function(Z){var z=this,S=z._data,y=z.gv;if((!y._93O||!y._93O(Z,S))&&y._moving){z._logicalPoint||z.fi({kind:"prepareMove",event:Z});var N=z._logicalPoint?"betweenMove":"beginMove",K={kind:N,event:Z},T=z._logicalPoint=y.lp(Z);"beginMove"!==N||z._alreadyBeginTransaction||(z._alreadyBeginTransaction=!0,y.getDataModel().beginTransaction());var V=z._calcShift(N,Z),X=V.x,P=V.y,Q=z.gv.getMoveMode(Z,S);Q&&("x"===Q?P=0:"y"===Q?X=0:"xy"!==Q&&(X=P=0)),y.moveSelection(X,P),z._lastLogicalPoint=T,z.autoScroll(Z),z.fi(K)}},_calcShift:function(){var n=this,N=n._logicalPoint,i=n._lastLogicalPoint,f=N.x-i.x,a=N.y-i.y;return{x:f,y:a}},clear:function(F){var W=this,y=W.gv;W._lastLogicalPoint&&(W._lastLogicalPoint=W._data=y._moving=j,W._logicalPoint&&(W.fi({kind:"endMove",event:F}),y.onMoveEnded()),W.clearDragging()),W._alreadyBeginTransaction&&(W._alreadyBeginTransaction=!1,y.getDataModel().endTransaction())}});var Jb=Gq.ScrollBarInteractor=function(D){em(Jb,this,[D])};Gj("ScrollBarInteractor",of,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(w){var q=this.gv.getViewRect();return this._41o()&&(q.x+q.width-this.gv.lp(w).x)*this.gv.getZoom()<bo},isH:function(b){var S=this.gv.getViewRect();return this._40o()&&(S.y+S.height-this.gv.lp(b).y)*this.gv.getZoom()<bo},handle_mousemove:function(C){this.handle_touchmove(C)},handle_touchmove:function(F){if(!Tk&&Wr(F)&&this.gv.isScrollBarVisible()){var e=this,U=e.isV(F),O=e.isH(F);(U||O)&&e.gv.showScrollBar(),e.gv._scrolling=U||O}},handleWindowMouseUp:function(E){this.handleWindowTouchEnd(E)},handleWindowTouchEnd:function(L){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=j,this.fi({kind:"endScroll",event:L})},handle_mousedown:function(J){this.handle_touchstart(J)},handle_touchstart:function(x){var o=this;if(o.gv.setFocus(x),Bk(x),o.handle_touchmove(x),!(js(x)>1)&&o.gv._scrolling&&o.gv.isScrollBarVisible()){o._cp=Eq(x),o._tx=o.gv.tx(),o._ty=o.gv.ty();var u=o.isV(x);o._state=u?"vScroll":"hScroll",Xo(o,x),o.fi({kind:"beginScroll",event:x})}},handleWindowMouseMove:function(Q){this.handleWindowTouchMove(Q)},handleWindowTouchMove:function(L){var f=Eq(L),R=this.gv.getViewRect(),g=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-f.y)*g.height/R.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-f.x)*g.width/R.width),this.fi({kind:"betweenScroll",event:L})}});var Xp=Gq.TouchInteractor=function(S,G){G=G||{},G.selectable===L&&(G.selectable=!0),G.movable===L&&(G.movable=!0),G.pannable===L&&(G.pannable=!0),G.pinchable===L&&(G.pinchable=!0),G.editable===L&&(G.editable=!0),this.params=G,em(Xp,this,[S])};Gj("TouchInteractor",of,{ms_edit:1,setUp:function(){var E=this;Xp.superClass.setUp.call(E),q&&E.params.editable&&E.gv.setEditInteractor(E)},tearDown:function(){var v=this;Xp.superClass.tearDown.call(v),q&&v.params.editable&&v.gv.setEditInteractor(j)},clear:function(u){var d=this,x=d.gv;x._moving&&(d.fi({kind:"endMove",event:u}),delete x._moving,x.onMoveEnded(),x.dm().endTransaction()),x._panning&&(d.fi({kind:"endPan",event:u}),delete x._panning,x.onPanEnded()),x._pinching&&(d.fi({kind:"endPinch",event:u}),delete x._pinching,x.onPinchEnded()),x._editing&&(d._46O(u),d._77I=d._node=d._edge=d._shape=d._rect=d._89I=d._index=x._editing=j),d._moving=d._panning=d._pinching=d._editing=d._57I=d._data=d._beginHistory=j,d.clearDragging()},handle_touchstart:function(D){var q=this;if(!q.gv._editing){Bk(D),q._57I=j;var a=q.params,b=q.gv,u=b.sm(),v=b.getDataAt(D),t=js(D);if(1===t){if(wo(D))return b.handleDoubleClick(D,v),void 0;b.handleClick(D,v),v&&(b.handleMouseDown&&b.handleMouseDown(D,v),q._data=v),a.selectable||(v=j),v?(u.co(v)||u.ss(v),a.editable&&b.isEditable(v)&&q._79I(D,v,!0)?(q._editing=1,q.startDragging(D)):a.movable&&b.isMovable(v)&&(q._moving=1,q.startDragging(D))):(q._57I=Eq(D),a.pannable&&b.isPannable()&&(q._panning=1,q.startDragging(D),q._translate={x:b.tx(),y:b.ty()}))}else if(a.pinchable&&2===t){q._pinching=1,q.startDragging(D);var g=b.getView(),y=b.getZoom(),J=g.getBoundingClientRect(),Q=D.touches[0],R=D.touches[1],M={x:(Q.clientX+R.clientX)/2-J.left,y:(Q.clientY+R.clientY)/2-J.top};M.x-=b.tx(),M.y-=b.ty(),M.x/=y,M.y/=y,q._p=M,q._d=Hq(D)}}},handle_touchend:function(Y){var G=this,y=G.gv,R=G._57I,M=G._data;R&&(aq(R,Eq(Y))<=1&&y.sm().cs(),G._57I=j),M&&y.handleMouseUp&&y.handleMouseUp(Y,M)},handleWindowTouchEnd:function(y){this.clear(y)},handleWindowTouchMove:function(U){var H=this,f=H.gv,J=js(U);if(1===J){if(H._editing&&(H._beginHistory||(H._beginHistory=1,f.dm().beginTransaction()),f._editing=1,H._78I(U)),H._moving)H._beginHistory||(H._beginHistory=1,f.dm().beginTransaction()),H.handleMove(U);else if(H._panning){var L=Eq(U);f.setTranslate(H._translate.x+L.x-H._lastClientPoint.x,H._translate.y+L.y-H._lastClientPoint.y),H.fi({kind:f._panning?"betweenPan":"beginPan",event:U}),f._panning=1}}else if(2===J&&H._pinching){var G=Hq(U);f.handlePinch(H._p,G,H._d),H._d=G,H.fi({kind:f._pinching?"betweenPinch":"beginPinch",event:U}),f._pinching=1}},handleMove:function(v){var p=this,X=p.gv,q=X.lp(v);X._93O&&X._93O(v,p._data)||(X.moveSelection(q.x-p._lastLogicalPoint.x,q.y-p._lastLogicalPoint.y),p._lastLogicalPoint=q,p.autoScroll(v),p.fi({kind:X._moving?"betweenMove":"beginMove",event:v}),X._moving=1)}});var e=A.ht,Eh=e.graph._editor={Math:{},Guide:{}};e.Math=Eh.Math,Eh.getStyle=function(g){var F,v=Eh.StyleMap;return v&&(F=v[g],F!==L)?F:Eh.DefaultStyleMap[g]},Eh.setStyle=function(m,Q){var i=Eh.StyleMap;i||(i=Eh.StyleMap={}),i[m]=Q},Eh.inEdit=function($){return $._inXEdit===!0},Eh.startEdit=function(Q){Q._inXEdit=!0,Eh.Inject.doInject(Q)},Eh._46O=function(s){s._inXEdit=!1,Eh.Inject.undoInject(s)},Eh.toScreenPosition=function(t,q){var c=t.tx(),B=t.ty(),Q=t._zoom;return new Eh.Math.Vector2(q.x*Q+c,q.y*Q+B)},Eh.checkHit=function(N,f,G){return N.distanceTo(f)<G?!0:!1},Eh.toWorldPosition=function(i,L){var g=i.tx(),r=i.ty(),Y=i._zoom;return{x:(L.x-g)/Y,y:(L.y-r)/Y}},Eh.setAntialias=function(k,S){for(var I,n=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],H=0,a=n.length;a>H&&(I=n[H],!(I in k));H++);k[I],k[I]=S},Eh.getTargetCornersOnScreen=function(h,L){if(!L)return null;var T,s=[];if(yk(L,h)){var D=Bd(h,L);T=[{x:D.x,y:D.y},{x:D.x+D.width,y:D.y},{x:D.x+D.width,y:D.y+D.height},{x:D.x,y:D.y+D.height}]}else{if(!L.getCorners)return null;T=L.getCorners()}return T.forEach(function(J){var I=Eh.toScreenPosition(h,J);s.push(I.x,I.y)}),s},Eh.log=function(){};var Ar=Eh.Inject={_modules:[]};Ar.registAsModule=function(Y,G){var Z={},K={};for(var O in Y){var o=G.prototype[O];Z[O]=o}Y.getBackup=function(A){return Z[A]},Y.getBackups=function(){return Z},K.doInject=function(){for(var A in Y)"getBackup"!==A&&(G.prototype[A]=Y[A])},K.undoInject=function(){for(var k in Y)"getBackup"!==k&&(G.prototype[k]=Z[k])},Ar._modules.push(K)},Ar.doInject=function(P){for(var K,S=Ar._modules,c=0,L=S.length;L>c;c++)K=S[c],K.doInject(P)},Ar.undoInject=function(W){for(var h,T=Ar._modules,j=0,Z=T.length;Z>j;j++)h=T[j],h.undoInject(W)};var of=e.graph.EditInteractor=function(h){var e=this,H=u.createElement("canvas");H.className="editCanvas",H.style.position="absolute",e._styleMap={},e._canvas=H,e._context=H.getContext("2d"),of.superClass.constructor.call(e,h),Eh.setAntialias(e._context,!1),e._subModules=[new Eh.Anchor(e),new Eh.Rect(e),new Eh.Curve(e),new Eh.MoveHelper(e)],e._gridGuide=new Eh.Guide.Grid(e),e._rectGuide=new Eh.Guide.Rect(e)},Hl=of;e.Default.def(of,e.graph.Interactor,{ms_edit:1,ms_fire:1}),N.defineProperties(of.prototype,{editDetail:{get:function(){var u=!!this._editDetail;return u},set:function(x){var u=this,E=u._editDetail;E!==x&&(u._editDetail=x,u.gv._editing=x,u.fp("editDetail",E,x),u.fp("pointsEditingMode",E,x),u.fi({kind:x?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(_){(!this._editDetail||_)&&(this.gv._editing=_,_||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(l){this._editing=l,this.gvEditing=l}},pointsEditingMode:{get:function(){return this.editDetail},set:function(f){var w=this;w.editDetail!==f&&(f?w._tryEnterEditDetailMode():w._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var T=this._gridEnabled;if(!T)return!1;var o=this.gv;return o?!0:!0},set:function(I){I!==this._gridEnabled&&(this._gridEnabled=I,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(a){a!==this._agEnabled&&(this._agEnabled=a,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}}}),of.prototype.getSubModule=function(j){var l,Y,h,k=this._subModules;for(Y=0,h=k.length;h>Y;Y++)if(l=k[Y],l.catalog===j)return l},of.prototype.invokeSubModule=function(P,D){var l=this,m=l._subModules;if(m)for(var C,v,I,n=Array.prototype.slice.call(arguments,2),q=0,K=m.length;K>q;q++)if(C=m[q],v=C[P],v&&(I=v.apply(C,n),I!=L&&D))return C},of.prototype.invokeSubModuleInverse=function(_,P){var R=this,C=R._subModules;if(C)for(var y,m,r,I=Array.prototype.slice.call(arguments,2),S=C.length-1;S>=0;S--)if(y=C[S],m=y[_],m&&(r=m.apply(y,I),r!=L&&P))return y},of.prototype.setUp=function(){Eh.log("setUp");var P=this,Z=P.gv,C=Z.getView(),b=P._canvas;of.superClass.setUp.call(P),Z.setEditInteractor(P),Z._79O?C.insertBefore(b,Z._79O):C.appendChild(b),Eh.startEdit(Z),P.invokeSubModule("setUp"),Z.dm().mm(P._onDataModelChanged,P),Z.dm().md(P._onDataPropertyChanged,P)},of.prototype.tearDown=function(){Eh.log("tearDown");var J=this,b=J.gv,A=b.getView();J._resetCustomCursorStyle(),of.superClass.tearDown.call(J),b.dm().umm(J._onDataModelChanged,J),b.dm().umd(J._onDataPropertyChanged,J),b.setEditInteractor(null),A.removeChild(J._canvas),J._drawTimer&&(y(J._drawTimer),J._drawTimer=null),Eh._46O(b),J.invokeSubModule("tearDown")},of.prototype._onDataModelChanged=function(N){var b=this;("clear"===N.kind||"remove"===N.kind&&b.editDetail&&N.data===b.getSubModule("Curve").target)&&(b.editDetail=!1,b._42())},of.prototype._onDataPropertyChanged=function(c){var z=this;if(z.editDetail){var R=z.getSubModule("Curve"),f=c.data;f===R.target&&(f._writing||R._handleDataChanged())}},of.prototype.clear=function(){Eh.log("clear")},of.prototype.redraw=function(){this._42()},of.prototype._42=function(){var X=this;X._drawTimer||(X._drawTimer=M(function(){X._drawTimer=null,X.drawImpl()},0))},of.prototype.drawImpl=function(){var S;for(S in{_42:!0})break;return function(){var F=this,T=F._canvas,Y=F.gv,I=Y.getWidth(),f=Y.getHeight(),x=F._context,d=e.Default.getInternal();(T.width!==I||T.height!==f)&&d.setCanvas(T,I,f),x.clearRect(0,0,T.width,T.height);var w=F._getValidSelection();x.save();var D=e.Default.devicePixelRatio;x.scale(D,D),F._gridGuide._42(),F._rectGuide._42(),F.invokeSubModuleInverse(S,!1,x,Y,w),x.restore()}}(),of.prototype._getValidSelection=function(){var Z=this,U=Z.gv,T=U.sm().getSelection(),v=[];return T.each(function(d){U.isVisible(d)&&U.isEditable(d)&&v.push(d)}),v},of.prototype.handle_touchmove=function(q){return this.handle_mousemove(q)},of.prototype.handle_mousemove=function(h){if(!e.Default.isDragging()){var u=this;(u.editDetail||!kh())&&(u.gvEditing=!1,u._checkEdit(h)&&(u.gvEditing=!0))}},of.prototype.handle_touchstart=function(j){return this.handle_mousedown(j)},of.prototype.handle_mousedown=function(t){Bk(t);var J=this;if(J.editDetail||!kh()){if(wo(t)&&!t.clickThrough){if(J.editDetail){if(J._tryQuitEditDetailMode(t))return}else if(J._tryEnterEditDetailMode())return;J.gv.dm().beginTransaction();var D=J.invokeSubModule("handleDoubleClick",!0,t);if(J.gv.dm().endTransaction(),D)return}var N=J._checkEdit(t);N&&(J._downPosition=J._getLogicalPoint(t),J.gv.dm().beginTransaction(),N.startEdit(J,t),J.editing=!0)}},of.prototype._checkEdit=function(B){var l=this,j=l.gv,H=l._getLogicalPoint(B),y=l.invokeSubModule("check",!0,j,B,H)||null;return l._editMod=y,y},of.prototype.handleWindowTouchMove=function(X){return this.handleWindowMouseMove(X)},of.prototype.handleWindowMouseMove=function(I){var x=this,O=x._downPosition;if(O){var R=x._getLogicalPoint(I);if(R.distanceTo(O)<x.getStyle("moveSensitivity"))return;delete x._downPosition}var G=x._editMod;G&&G.handleEdit(x.gv,I)},of.prototype._getLogicalPoint=function(h){var X=this,d=e.Default.getLogicalPoint(h,X._canvas);return new Eh.Math.Vector2(d)},of.prototype.handleWindowTouchEnd=function(x){return this.handleWindowMouseUp(x)},of.prototype.handleWindowMouseUp=function(){var Y;for(Y in{_46O:!0})break;return function(c){var p=this;p.editing=!1,p.setCursor("default"),p.invokeSubModule(Y,!1,c),p._42(),p.gv.dm().endTransaction()}}(),of.prototype.handle_mousewheel=function(U){var S=this;Bk(U),S.invokeSubModule("preHandleScroll",!0)||S.gv.handleScroll(U,U.wheelDelta)},of.prototype.handleDelete=function(){var m=this;if(!m.editDetail){m.gv.dm().beginTransaction();var e=m.invokeSubModule("handleNormalStateDelete",!0);return m.gv.dm().endTransaction(),e||m.gv.removeSelection(),void 0}m.gv.dm().beginTransaction(),m.invokeSubModule("handleDelete",!0),m.gv.dm().endTransaction(),m._42()},of.prototype.handle_keydown=function(K){var d=this;if((K.metaKey||K.ctrlKey)&&d._42(),kh(K)&&!d.editing)return d.gvEditing=!1,d.setCursor("default"),d._42(),void 0;var l=qc(K);return d.editDetail?((l||bh(K))&&(d.editDetail=!1,d._42()),d.gv.dm().beginTransaction(),d.invokeSubModule("handle_keydown",!0,K),d.gv.dm().endTransaction(),void 0):(d.gv.dm().beginTransaction(),d.invokeSubModule("handleNormalStateKeyDown",!0,K),d.gv.dm().endTransaction(),l&&d._tryEnterEditDetailMode(),void 0)},of.prototype.handle_keyup=function(v){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,v),this.gv.dm().endTransaction()},of.prototype._tryEnterEditDetailMode=function(){var K=this;return!K.editDetail&&K.invokeSubModule("canEnterEditDetailMode",!0)&&1===K._getValidSelection().length?(K.editDetail=!0,K._42(),!0):void 0},of.prototype._tryQuitEditDetailMode=function(Q){var z=this;if(z.editDetail){var v=z.gv,$=z.getSubModule("Curve").target;return Q&&v.getDataAt(Q)===$?void 0:(z.editDetail=!1,z._42(),!0)}},of.prototype.setStyle=function(t,O,r){var h=this;r?Eh.setStyle(t,O):h._styleMap[t]=O,h.fp("styleChanged",null,{key:t,value:O,base:r}),h._42()},of.prototype.getStyle=function(X){var G=this,e=G._styleMap[X];return e!==L?e:Eh.getStyle(X)},of.prototype.setCursor=function(a){this._resetCustomCursorStyle(),e.graph.EditInteractor.superClass.setCursor.call(this,a)},of.prototype._resetCustomCursorStyle=function(){var R=this;if(R._customStyle){var n=this.gv.getView();n.classList&&n.classList.remove&&n.classList.remove(R._customStyle),R._customStyle=null}},of.prototype._setRotateCursor=function(F){var l=this,Q=l._cursorFactory;Q||(Q=l._cursorFactory=new Eh.CursorFactory(l));var $=Q.getRotateCursor(F),k=l.gv.getView();l._resetCustomCursorStyle(),l._customStyle=$,k.classList&&k.classList.add&&k.classList.add($)};var ek=Eh.Group=function(N){var l=this;l._entities=N,l._64O=0,l._position={x:0,y:0},l._scale={x:1,y:1},l._anchor={x:.5,y:.5},l._anchor2={x:.5,y:.5}};ek.prototype={},ek.prototype.constructor=ek;var mf=null;ek.findOrCreateGroup=function(j){if(mf&&mf.checkIsMe(j))return mf;var b=new Eh.Group(j);return b.getKeyOb()?(mf=b,b):void 0},ek.prototype.checkIsMe=function(Y){var Z=this._entities;if(Z.length!==Y.length)return!1;var k,U={},K=Y.length;for(k=0;K>k;k++)U[Y[k]._id]=!0;for(k=0;K>k;k++)if(!U[Z[k]._id])return!1;return!0},ek.prototype.getRotation=function(){return this._64O},ek.prototype.getPosition=function(){return this._position},ek.prototype.getAnchor=function(){return this._anchor},ek.prototype.getWidth=function(){return this._width},ek.prototype.getScale=function(){return this._scale},ek.prototype.getSize=function(){return{width:this._width,height:this._height}},ek.prototype.getHeight=function(){return this._height},ek.prototype.getKeyOb=function(){for(var E=this._entities,g=E.length-1;g>=0;g--){var Y=E[g];if(this.isNode(Y))return Y}},ek.prototype.getAnchor2=function(){var p=this,G=p.rotateCenter;if(G)return G;var W=p.getKeyOb();if(!W)return p._anchor;var u=p._anchor2,X=W.getMatrix();return X.tf({x:W.getWidth()*(u.x-W.getAnchor().x),y:W.getHeight()*(u.y-W.getAnchor().y)})},ek.prototype.setAnchor2=function($,K){var Q=this,i=Q.getKeyOb();if(i){var f,h=i.getMatrix();f="number"==typeof $?{x:$,y:K}:$;var o=h.tfi(f);Q._anchor2={x:i.getAnchor().x+o.x/i.getWidth(),y:i.getAnchor().y+o.y/i.getHeight()}}},ek.prototype.setRotation=function(){},ek.prototype.beginRotate=function(U){this.rotateCenter=U.pos,this.rotateMode=U.groupRotateMode},ek.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},ek.prototype.addRotation=function(W,R){return"batch"===R?this._addRotationInBatchMode(W):"block"===R?this._addRotationInBlockMode(W):void 0},ek.prototype._addRotationInBlockMode=function(R){var u=this,X=u.rotateCenter||u.getPosition();u._entities.forEach(function(F){if(u.isNode(F)){var n=F.getMatrix();n.translate(-X.x,-X.y),n.rotate(R),n.translate(X.x,X.y);var q=Math.sign(F.getScale().x);F.setRotation(H(n.b*q,n.a*q)),F.setPosition(n.tx,n.ty)}})},ek.prototype._addRotationInBatchMode=function(k){var q=this,$=q._anchor2;q._entities.forEach(function(X){if(q.isNode(X)){var M=X.getAnchor(),x=X.getMatrix(),s=x.tf({x:X.getWidth()*($.x-M.x),y:X.getHeight()*($.y-M.y)}),T=new Eh.Math.Matrix2;T.set(x.a,x.b,x.c,x.d,x.tx,x.ty),T.translate(-s.x,-s.y),T.rotate(k),T.translate(s.x,s.y);var c=Math.sign(X.getScale().x);X.setRotation(H(T.b*c,T.a*c)),X.setPosition(T.tx,T.ty)}})},ek.prototype.setPosition=function(A){var V,O,$,i,T=this,E=T._position,_=A.x-E.x,e=A.y-E.y,m=T._entities;for(O=0,$=m.length;$>O;O++)V=m[O],Jl(V)&&(i=V.getPosition(),V.setPosition(i.x+_,i.y+e));T._position=A},ek.prototype.setScale=function(z,y){var m=this,s=z/m._scale.x,l=y/m._scale.y;m._adjustChildScaleOrSize(s,l,"size"),m._scale={x:z,y:y}},ek.prototype.getRect=function(){var m=this,L=m._position,e=m._width,S=m._height;return{x:L.x-e/2,y:L.y-S/2,width:e,height:S}},ek.prototype.setSize=function(H,q){var i=this,H=Math.max(1,H),q=Math.max(1,q),$=H/i._width,s=q/i._height;i._adjustChildScaleOrSize($,s,"size"),i._width=H,i._height=q},ek.prototype._adjustChildScaleOrSize=function(I,a,K){var J,t,R,Z,u,l,i,D,d,g,M,c,B,n,C=this,A=C._position,f=C._entities,G=new Eh.Math.Matrix2;
for(t=0,R=f.length;R>t;t++)if(J=f[t],C.isNode(J)){if(Z=J.getPosition(),u=J.getRotation(),l=J.getWidth(),i=J.getHeight(),D=J.getScale(),M=D.x*l,c=D.y*i,G.identity().scale(M,c).rotate(u).translate(Z.x,Z.y).translate(-A.x,-A.y).rotate(-C._64O),u=H(G.b*Math.sign(M),G.a*Math.sign(M)),G.scale(I,a),d=Math.cos(u),g=Math.sin(u),Math.abs(d)<.001?(B=G.b/g,n=-G.c/g):(B=G.a/d,n=G.d/d),"scale"===K)J.setScale(B/l,n/i);else if("size"===K){var m=B/D.x,E=n/D.y;J.setScale(eh(B)*Math.abs(D.x),eh(n)*Math.abs(D.y)),J.setSize(Math.max(.1,Math.abs(m)),Math.max(.1,Math.abs(E)))}G.rotate(C._64O).translate(A.x,A.y),J.setPosition(G.tx,G.ty)}},ek.prototype.getMatrix=function(){var F=this,Z=F._position,I=e.Default.getInternal(),T=F._scale;return new I.Mat(F._64O,Z.x,Z.y,T.x,T.y)},ek.prototype.getCorners=function(){var O=this,N=O._width,o=O._height,J=O._anchor,e=-N*J.x,u=-o*J.y,R=O.getMatrix();return[R.tf(e,u),R.tf(e,u+o),R.tf(e+N,u+o),R.tf(e+N,u)]},ek.prototype.calcInfo=function(){var z,T,X,L,r,A,V=this,t=[],o=V._entities,l=V._64O;for(L=0,r=o.length;r>L;L++)A=o[L],V.isNode(A)&&A.getCorners&&t.push.apply(t,A.getCorners());if(t.length){var $=Math.cos(-l),R=Math.sin(-l),x=1/0,s=-1/0,S=1/0,n=-1/0;for(L=0,r=t.length;r>L;L++)X=t[L],z=X.x,T=X.y,X.x=$*z-R*T,X.y=R*z+$*T,x=Math.min(x,X.x),s=Math.max(s,X.x),S=Math.min(S,X.y),n=Math.max(n,X.y);V._width=(s-x)/V._scale.x,V._height=(n-S)/V._scale.y,$=Math.cos(l),R=Math.sin(l);var E=V._anchor;z=x+(s-x)*E.x,T=S+(n-S)*E.y,V._position={x:$*z-R*T,y:R*z+$*T}}},ek.prototype.isNode=function(o){return Jl(o)?yk(o)?!1:!0:!1},ek.prototype._42=function(F,M,d){var I,r,$,g,w,t,Z,p,S=this,b=S._entities,e=S.rotateMode;for("batch"===e&&(p=S.getKeyOb()),I=0,r=b.length;r>I;I++)$=b[I],S.isNode($)&&(t=$.getRect(),g=Eh.toScreenPosition(d,{x:t.x,y:t.y}),w=Eh.toScreenPosition(d,{x:t.x+t.width,y:t.y+t.height}),Z={min:g,max:w},$===p&&(Z.isKeyOb=!0),Eh.Icons.DrawIcon(F,M,Eh.Icons.GroupSubEntityRect,Z))};var ri=Eh.CurveActiving=function(m,F){this._curve=m,this._interactor=m._interactor;for(var C in F)this[C]=F[C]};ri.prototype={},ri.prototype.constructor=ri,N.defineProperties(ri.prototype,{point:{get:function(){return this._point},set:function(E){var m=this;m._point=E,m.editingCtrl||m._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(R){var v=this;v._pairs=R,v.editingCtrl&&v._firePointChange()}}}),ri.prototype._firePointChange=function(){var S=this,y=S.getCurrentEditingPoint();if(!y)return E.fi({kind:"selectPoint"}),void 0;var E=S._interactor,k=this._curve.target;if(k){var l=Eh.getDataMatrix(k).invert(),D=y.e;y=l.apply(Eh.toWorldPosition(E.gv,y)),y.e=D;var z=S._lastFirePoint;z&&Math.abs(y.x-z.x)<1e-5&&Math.abs(y.y-z.y)<1e-5&&(y.e==L&&z.e==L||Math.abs(y.e-z.e)<1e-5)||(S._lastFirePoint=y,E.fi({kind:"selectPoint",x:y.x,y:y.y,e:y.e}))}},ri.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},ri.prototype.getCurrentEditingPoint=function(){var r=this,e=r.editingCtrl;if(e){var I=r.pairs;if(I){var L=I[e.pairId],f=L[e.type];if(f)return f}}return r._point};var Xi=Eh.CursorFactory=function(M){var m=this;m._interactor=M,m._rotateCursorStyles={}};Xi.prototype={},Xi.prototype.constructor=Xi,Xi.prototype.getRotateCursor=function(C){var m=this;0>C&&(C+=2*Math.PI);var b=m._interactor,x=b.getStyle("rotateCursorSize"),V=b.getStyle("rotateCursorRound"),K=Math.round(180*(C/Math.PI)/V);K*V>=360&&(K=0);var u=m._rotateCursorStyles,r="htCustomRotateStyle_"+x+"_"+V+"_"+K;return u[r]||(m._produceRotateCursor(r,x,V,K),u[r]=!0),r},Xi.prototype._produceRotateCursor=function(r,Y,c,G){var O=this;O._interactor;var C=O._canvas;C||(C=O._canvas=u.createElement("canvas")),C.width=C.height=Y*devicePixelRatio,C.style.width=C.style.height=Y+" px";var o=C.getContext("2d");Eh.setAntialias(o,!1),o.scale(devicePixelRatio,devicePixelRatio);var E,V,w,_,l,P=Math.round(Y/2),h=""+P+" "+P+",auto !important;";E=Math.PI/180*G*c,o.clearRect(0,0,Y,Y),o.save(),o.scale(Y/32,Y/32),o.translate(16,16),o.rotate(E+Math.PI/2),o.beginPath(),o.moveTo(-8,0),o.lineTo(-8,3),o.lineTo(-5,3),o.moveTo(8,0),o.lineTo(8,3),o.lineTo(5,3),o.moveTo(-8,3),o.quadraticCurveTo(0,-6,8,3),o.restore(),o.strokeStyle="white",o.lineWidth=4,o.stroke(),o.strokeStyle="black",o.lineWidth=2,o.stroke(),V=JSON.stringify(C.toDataURL()),_="cursor:url("+V+")"+h,1!==devicePixelRatio&&(w='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+Y+'px" height="'+Y+'px"><image xlink:href='+V+' width="'+Y+'" height="'+Y+'"/></svg>',_+="cursor:url(data:image/svg+xml;base64,"+btoa(w)+")"+h,_+="cursor:-webkit-image-set(url("+V+")"+devicePixelRatio+"x,url("+V+")1x)"+h),l=u.createElement("style"),l.textContent="body."+r+" *, ."+r+"{"+_+"}",u.head.appendChild(l)};var de=Eh.Guide.Grid=function(Y){var k=this;k._interactor=Y,k._alignmentGuideId=0,k._xAlignmentGuide=[],k._yAlignmentGuide=[]};de.prototype={},de.prototype.constructor=de,N.defineProperties(de.prototype,{gridBlockSize:{get:function(){var N=this;return N._gridBlockSize||N._interactor.getStyle("gridBlockSize")},set:function(q){this._gridBlockSize=q,this._interactor._42()}},gridThickLinesEvery:{get:function(){var s=this;return s._gridThickLinesEvery||s._interactor.getStyle("gridThickLinesEvery")},set:function(B){this._gridThickLinesEvery=B,this._interactor._42()}},gridEnabled:{get:function(){var O=this,V=O._interactor;return V.gridEnabled&&O.isValidGrid()}}}),de.prototype._42=function(){var R=this,l=R._interactor;R.gridEnabled&&R.drawGrid(),l.alignmentGuideEnabled&&R.drawAlignmentGuide()},de.prototype.makeMatrix=function(){var F=this,g=F._interactor.getStyle("gridAngle"),Q=F._interactor.getStyle("gridRotation"),q=new Eh.Math.Matrix2,x=Math.sin(g),G=Math.cos(g);return q.set(1,0,G,x,0,0),q.rotate(Q),q},de.prototype.isValidGrid=function(){var Q=this,x=Math.PI,s=Q._interactor,z=s.gv;if(z._zoom<s.getStyle("gridZoomThreshold"))return!1;var t=s.getStyle("gridAngle"),U=Math.abs(180*(t%x/x)),C=1-1e-8;return C>U||U>180-C?!1:!0},de.prototype.drawAlignmentGuide=function(){var e=this,M=e._interactor,d=M.gv,I=M._canvas,u=M._context,y=I.width,c=I.height,n=d.tx(),h=d.ty(),r=d._zoom;u.beginPath(),u.strokeStyle=M.getStyle("gridAlignmentGuideColor"),u.lineWidth=1,e._xAlignmentGuide.forEach(function(K){var D=K.p*r+n;u.moveTo(D,0),u.lineTo(D,c)}),e._yAlignmentGuide.forEach(function(k){var R=k.p*r+h;u.moveTo(0,R),u.lineTo(y,R)}),u.stroke()},de.prototype.drawGrid=function(){function I(O,b,E,q){var a=Eh.toScreenPosition(C,A.apply({x:O,y:b})),d=Eh.toScreenPosition(C,A.apply({x:E,y:q}));P.moveTo(a.x,a.y),P.lineTo(d.x,d.y)}var Y=this,B=Y._interactor,m=Y.gridBlockSize,U=Y.gridThickLinesEvery,F=B.getStyle("gridThickColor"),R=B.getStyle("gridLightColor"),C=B.gv,d=B._canvas,P=B._context,J=d.width,q=d.height,A=Y.makeMatrix(),k=A.applyInverse(Eh.toWorldPosition(C,{x:0,y:0})),L=A.applyInverse(Eh.toWorldPosition(C,{x:J,y:0})),n=A.applyInverse(Eh.toWorldPosition(C,{x:0,y:q})),$=A.applyInverse(Eh.toWorldPosition(C,{x:J,y:q})),H=Math.min(k.x,L.x,n.x,$.x),T=Math.max(k.x,L.x,n.x,$.x),h=Math.min(k.y,L.y,n.y,$.y),g=Math.max(k.y,L.y,n.y,$.y);J=T-H,q=g-h;var i=Math.ceil(H/m),e=Math.floor(T/m),X=Math.ceil(h/m),M=Math.floor(g/m);C.tx(),C.ty(),C._zoom;var z,a,t;for(P.save(),P.lineWidth=1,P.beginPath(),P.strokeStyle=F,t=Math.ceil(i/U)*U;e>=t;t+=U)z=t*m,I(z,h,z,g);for(t=Math.ceil(X/U)*U;M>=t;t+=U)a=t*m,I(H,a,T,a);for(P.stroke(),P.beginPath(),P.strokeStyle=R,t=i;e>=t;t++)0!==t%U&&(z=t*m,I(z,h,z,g));for(t=X;M>=t;t++)0!==t%U&&(a=t*m,I(H,a,T,a));P.stroke(),P.restore()},de.prototype.getAlignmentGuides=function(){var F=this;return{x:F._xAlignmentGuide,y:F._yAlignmentGuide}},de.prototype.addAlignmentGuide=function(w,A,o){var t=this,i="x"===w?t._xAlignmentGuide:t._yAlignmentGuide,o=o?o:++t._alignmentGuideId,g={p:A,id:o};if(i.length){var N=t._findClosestAlignmentGuide(g.p,i);N.dis<0?i.splice(N.index+1,0,g):i.splice(N.index,0,g)}else i.push(g);return t._interactor._42(),o},de.prototype.findClosest=function(K,R,k){var q=this,W=q._interactor,j=W.gv;k&&(K=Eh.toWorldPosition(j,K));var C,t,B,r=1/0,E=1/0,c=K.x,e=K.y;if(q.gridEnabled){var T=q.gridBlockSize,d=q.makeMatrix(),h=d.applyInverse(K);h=d.apply({x:Math.round(h.x/T)*T,y:Math.round(h.y/T)*T}),r=h.x-c,E=h.y-e,B=!0}if(W.alignmentGuideEnabled&&(C=q._findClosestAlignmentGuide(c,q._xAlignmentGuide).dis,t=q._findClosestAlignmentGuide(e,q._yAlignmentGuide).dis,Math.abs(C)<Math.abs(r)&&(r=C,B=!0),Math.abs(t)<Math.abs(E)&&(E=t,B=!0)),B){B=!1;var v=j._zoom,i=W.getStyle("smartGuideSensitivity")/v,Z={};if(Math.abs(r)<i&&"y"!==R&&(Z.x=k?r*v:r,B=!0),Math.abs(E)<i&&"x"!==R&&(Z.y=k?E*v:E,B=!0),B)return Z}},de.prototype._findClosestAlignmentGuide=function(K,J){if(!J.length)return{dis:1/0};for(var h,T=0,z=J.length-1;z-T>1;)h=Math.floor((T+z)/2),J[h].p<K?T=h:z=h;var E=J[T].p-K,L=J[z].p-K;return Math.abs(E)<=Math.abs(L)?{line:J[T],dis:E,index:T}:{line:J[z],dis:L,index:z}},de.prototype.removeAllAlignmentGuide=function(c){var N=this;"y"!==c&&(N._xAlignmentGuide=[]),"x"!==c&&(N._yAlignmentGuide=[]),N._interactor._42()},de.prototype.removeAlignmentGuide=function($){for(var R,b,S,c=this,v=c._xAlignmentGuide,H=0;2>H;H++)for(v=0===H?c._xAlignmentGuide:c._yAlignmentGuide,R=0,b=v.length;b>R;R++)if(S=v[R],S.id===$)return v.splice(R,1),c._interactor._42(),{axis:0===H?"x":"y",position:S.p};return!1},de.prototype.adjustAlignmentGuide=function(m,p){var E=this,_=E.removeAlignmentGuide(m);return _?(E.addAlignmentGuide(_.axis,p,m),!0):!1};var ij=Eh.Guide.Rect=function(E){var J=this;J._interactor=E};ij.prototype={},ij.prototype.constructor=ij,ij.prototype.gatherRects=function(){var I,O,F,g,C=this,G=C._interactor.gv,w=[],y=[],a={x:w,y:y},$={},J=G.getDataModel(),x=J.a("width"),U=J.a("height");x&&U&&(I=0,O=0,F=x,g=U,w.push({node:J,type:0,p:I},{node:J,type:1,p:I+F/2},{node:J,type:2,p:I+F}),y.push({node:J,type:0,p:O},{node:J,type:1,p:O+g/2},{node:J,type:2,p:O+g}),$[J._id||0]={x:I,y:O,width:F,height:g}),J.each(function(E){if(Jl(E)&&!G.isSelected(E)&&G.isVisible(E)){var r=!1;if(G.sm().getSelection().each(function(m){r||(E.isHostOn(m)?r=!0:E.isDescendantOf(m)&&(r=!0))}),!r){var x=E.getRect();I=x.x,O=x.y,F=x.width,g=x.height,w.push({node:E,type:0,p:I},{node:E,type:1,p:I+F/2},{node:E,type:2,p:I+F}),y.push({node:E,type:0,p:O},{node:E,type:1,p:O+g/2},{node:E,type:2,p:O+g}),$[E._id]=x}}}),w.sort(function(X,R){return X.p-R.p}),y.sort(function(O,D){return O.p-D.p}),C._grid=a,C._87I=$},ij.prototype.gatherLines=function(u,U,t){var g,A,l,k,c,Z,r,L,R,m,M,y,H=this,F=[H.findClosest({x:u.x,y:u.y},U),H.findClosest({x:u.x+u.w/2,y:u.y+u.h/2},U),H.findClosest({x:u.x+u.w,y:u.y+u.h},U)],d={},O=H._87I;t=t||255;var Y,z;for(H._guideLine=[],g=0;2>g;g++)for(d={},0===g?(k="y",L=u.x,R=L+u.w):(k="x",L=u.y,R=L+u.h),A=0;3>A;A++)c=F[A],c&&isFinite(c[k])&&(Y=1<<3*g+A,t&Y&&(Z=c[k+"Line"],r=Z.node,z=r._id||0,d[z]||(d[z]=!0,y=O[z],"y"===k?(m=y.x,M=y.x+y.width):(m=y.y,M=y.y+y.height),l=Z.p,H._guideLine.push({type:k,a:L,b:R,c:m,d:M,p:l}))))},ij.prototype._binarySearchClosest=function(d,i){if(!i.length)return{dis:1/0};for(var T,F=0,b=i.length-1;b-F>1;)T=Math.floor((F+b)/2),i[T].p<d?F=T:b=T;var r=i[F].p-d,X=i[b].p-d;return Math.abs(r)<=Math.abs(X)?{line:i[F],dis:r}:{line:i[b],dis:X}},ij.prototype.findClosest=function(y,P,W){var B=this,Q=B._interactor,d=Q.gv,K=B._grid;W&&(y=Eh.toWorldPosition(d,y));var q,N=B._binarySearchClosest(y.x,K.x),U=B._binarySearchClosest(y.y,K.y),X=N.dis,D=U.dis,o=d._zoom,H=Q.getStyle("smartGuideSensitivity")/o,j={};return Math.abs(X)<H&&"y"!==P&&(j.x=W?X*o:X,j.xLine=N.line,q=!0),Math.abs(D)<H&&"x"!==P&&(j.y=W?D*o:D,j.yLine=U.line,q=!0),q?j:void 0},ij.prototype._42=function(){var V=this,g=V._guideLine;if(g&&!e.Default.isCtrlDown()){var d,l,j,z,h,L,J,p,o,N,P,c,m,Y,$,x,T,k=V._interactor,R=k.gv,Q=k._context,D=R.tx(),w=R.ty(),C=R._zoom,B=k.getStyle("guideLineTextSpacing");for(d=0,l=g.length;l>d;d++)j=g[d],p=j.type,o=j.p,N=j.a,P=j.b,c=j.c,m=j.d,Y=Math.min(N,c),$=Math.max(P,m),"x"===p?(z=o*C+D,h=Y*C+w,L=z,J=$*C+w):(z=Y*C+D,h=o*C+w,L=$*C+D,J=h),Eh.Icons.DrawIcon(k,Q,Eh.Icons.MoveLineGuide,[z,h,L,J]),m>=N&&P>=c||(Y=N>m?m:P,$=N>m?N:c,T=$-Y,"x"===p?(j.center2center||(z-=B,L=z),h=Y*C+w,J=$*C+w,x=Eh.Icons.MoveLineGuideDistanceV):"y"===p&&(j.center2center||(h-=B,J=h),z=Y*C+D,L=$*C+D,x=Eh.Icons.MoveLineGuideDistanceH),Eh.Icons.DrawIcon(k,Q,x,{x0:z,y0:h,x1:L,y1:J,dis:T}))}},ij.prototype.clear=function(){this._guideLine=null},Eh.DefaultStyleMap={pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,rotateRound:Math.PI/2,rotateSensitivity:Math.PI/60,shiftRotateRound:Math.PI/12,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideSensitivity:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,guideLineTextSpacing:32,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:"#707070",shapeCtrlPointHighlightBorder:"black",shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var re=Eh.Icons={},zi=1e4,bs=null,tb=8;e.Default.setImage("Icons.RectPoint",{width:tb,height:tb,comps:[{type:"shape",points:[0,0,0,tb,tb,tb,tb,0],segments:[1,2,2,2,5],shadow:!0,borderWidth:1,shadowColor:{func:function(){return bs.getStyle("rectPointShadowColor")}},background:{func:function(){return bs.getStyle("rectPointBackground")}},borderColor:{func:function(){return bs.getStyle("rectPointBorderColor")}}}]});var rf="#e000e0";re.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var i=re.GroupSubEntityRect.data;if(!i)return[];var D=i.min,X=i.max;return[D.x,D.y,D.x,X.y,X.x,X.y,X.x,D.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return re.GroupSubEntityRect.data.isKeyOb?rf:"#666666"}}}]},re.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[re.Line.data.P1.x,re.Line.data.P1.y],tb,tb]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[re.Line.data.P2.x,re.Line.data.P2.y],tb,tb]}}}]},re.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return re.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},re.Rect={comps:[{type:"shape",points:{func:function(){var B=re.Rect.data;if(!B)return[];var t=B.LT,d=B.LB,R=B.RB,H=B.RT;return[t.x,t.y,d.x,d.y,R.x,R.y,H.x,H.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#666666"},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return re.Rect.data.rotation}},rect:{func:function(){return[[re.Rect.data.LT.x,re.Rect.data.LT.y],tb,tb]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return re.Rect.data.rotation}},rect:{func:function(){return[[re.Rect.data.LB.x,re.Rect.data.LB.y],tb,tb]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return re.Rect.data.rotation}},rect:{func:function(){return[[re.Rect.data.RB.x,re.Rect.data.RB.y],tb,tb]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return re.Rect.data.rotation}},rect:{func:function(){return[[re.Rect.data.RT.x,re.Rect.data.RT.y],tb,tb]}}},{type:"image",name:"Icons.RectPoint",scaleX:.9,scaleY:.9,rotation:{func:function(){return re.Rect.data.rotation}},visible:{func:function(){return re.Rect.data.L?!0:!1}},rect:{func:function(){return[[re.Rect.data.L.x,re.Rect.data.L.y],tb,tb]}}},{type:"image",name:"Icons.RectPoint",scaleX:.9,scaleY:.9,rotation:{func:function(){return re.Rect.data.rotation}},visible:{func:function(){return re.Rect.data.R?!0:!1}},rect:{func:function(){return[[re.Rect.data.R.x,re.Rect.data.R.y],tb,tb]}}},{type:"image",name:"Icons.RectPoint",scaleX:.9,scaleY:.9,rotation:{func:function(){return re.Rect.data.rotation}},visible:{func:function(){return re.Rect.data.T?!0:!1}},rect:{func:function(){return[[re.Rect.data.T.x,re.Rect.data.T.y],tb,tb]}}},{type:"image",name:"Icons.RectPoint",scaleX:.9,scaleY:.9,rotation:{func:function(){return re.Rect.data.rotation}},visible:{func:function(){return re.Rect.data.B?!0:!1}},rect:{func:function(){return[[re.Rect.data.B.x,re.Rect.data.B.y],tb,tb]}}}]};var Fo=18;e.Default.setImage("Icons.Anchor",{width:Fo,height:Fo,comps:[{type:"arc",rect:[4,4,Fo-8,Fo-8],arcFrom:0,arcClose:!1,background:"#ffffff",borderWidth:0,borderColor:"#000000"},{type:"shape",points:[2,Fo/2,Fo-2,Fo/2,Fo/2,2,Fo/2,Fo-2],segments:[1,2,1,2],background:null,borderWidth:1,borderColor:"#111111"},{type:"arc",rect:[5.5,5.5,Fo-11,Fo-11],arcFrom:0,arcClose:!1,background:null,borderWidth:1,borderColor:"#111111"}]}),re.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[re.Anchor.data.POS.x,re.Anchor.data.POS.y],Fo,Fo]}}}]},re.TipShiftX=12,re.TipShiftY=12;var Sk=[8,28];re.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[re.TipHelper.data.helperPos.x,re.TipHelper.data.helperPos.y,Sk[0]*re.TipHelper.data.size,Sk[1]]}},background:{func:function(){return bs.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return re.TipHelper.data.text}},rect:{func:function(){return[re.TipHelper.data.helperPos.x,re.TipHelper.data.helperPos.y,Sk[0]*re.TipHelper.data.size,Sk[1]]}},color:{func:function(){return bs.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var lo=7;re.ShapePoint={comps:[{type:"circle",rect:{func:function(){var S=re.ShapePoint.data;return[S,lo,lo]}},background:"#ffffff",borderWidth:1,borderColor:"#333333"}]},re.ShapeBgCurve={comps:[{type:"shape",points:{func:function(){return re.ShapeBgCurve.data.P}},segments:{func:function(){return re.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:"#333333"}]};var jh=8;re.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var Z=re.ShapeHighlighPoint.data;return[[Z.x,Z.y],jh,jh]}},background:{func:function(){return bs.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var Qh=10;re.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var Q=re.ShapeHighlighRealPoint.data;return[[Q.x,Q.y],Qh,Qh]}},background:"#ffffff",borderWidth:2,borderColor:"#333333"}]};var jc=8;re.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var i=re.ShapeHighlighCtrlPoint.data,S=i.x,M=i.y,m=jc/2;return[S-m,M-m,S-m,M+m,S+m,M+m,S+m,M-m]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return bs.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return bs.getStyle("shapeCtrlPointBorderColor")}}}]};var Ir=3;re.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return re.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:Ir,borderColor:{func:function(){return bs.getStyle("curveHighlightColor")}}}]},re.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return re.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"red"}]},re.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return re.MoveLineGuide.data}},background:null,borderWidth:1,borderColor:"red"}]};var ll=5;re.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var u=re.MoveLineGuideDistanceH.data,t=u.x0,c=u.y0,L=u.x1,f=u.y1;return[t,c,L,f,t,c-ll,t,c+ll,L,f-ll,L,f+ll]}},segments:[1,2,1,2,1,2],background:null,borderWidth:1,borderColor:"red"},{type:"text",text:{func:function(){return Math.round(re.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var k=re.MoveLineGuideDistanceH.data;return[[(k.x0+k.x1)/2,k.y0-10],20,20]}},color:"red",font:"12px Arial",align:"center"}]},re.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var e=re.MoveLineGuideDistanceV.data,V=e.x0,k=e.y0,L=e.x1,F=e.y1;return[V,k,L,F,V-ll,k,V+ll,k,L-ll,F,L+ll,F]}},segments:[1,2,1,2,1,2],background:null,borderWidth:1,borderColor:"red"},{type:"text",text:{func:function(){return Math.round(re.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var r=re.MoveLineGuideDistanceV.data;return[[r.x0-10,(r.y0+r.y1)/2],20,20]}},color:"red",font:"12px Arial",align:"center"}]},e.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),re.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var q=re.EdgeElevationGuide.data,v=q.x,$=q.y,h=bs.getStyle("curveElevationIntersectSize"),p=bs.getStyle("curveElevationGuideShift");return v+=p[0],$+=p[1],[v-h,$-h,2*h,2*h]}}}]},e.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),e.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),re.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return re.ConnectGuide.data.rotation}},rect:{func:function(){var k=re.ConnectGuide.data.connect;k.x,k.y;var x=bs.getStyle("connectGuideIntersectSize");return[[k.x,k.y],2*x,2*x]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var h=re.ConnectGuide.data.cursorPos||re.ConnectGuide.data.connect,a=bs.getStyle("connectGuideIntersectSize");return[[h.x,h.y],2*a-2,2*a-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var g=re.ConnectGuide.data.connect,I=re.ConnectGuide.data.cursorPos||g;return[g.x,g.y,g.x+.5*(I.x-g.x),g.y,I.x+.5*(g.x-I.x),I.y,I.x,I.y]}}}]},e.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),e.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),re.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var f=re.ConnectGuideGarbage.data.hover;return f?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var i=re.ConnectGuideGarbage.data,v=bs.getStyle("connectGuideGarbageIntersectsize");return i.hover&&(v+=5),[[i.x,i.y],2*v,2*v]}}}]};var Mq=6;re.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return re.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var M=re.ShapeActivingCtrl.data;return[M.point.x,M.point.y,M.c1.x,M.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:"#707070"},{type:"shape",visible:{func:function(){return re.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var D=re.ShapeActivingCtrl.data;return[D.point.x,D.point.y,D.c2.x,D.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:"#707070"},{type:"shape",visible:{func:function(){return re.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var g=re.ShapeActivingCtrl.data.c1,y=g.x,j=g.y,s=Mq/2;return"c1"===re.ShapeActivingCtrl.data.hl&&(s+=.5),[y-s,j-s,y-s,j+s,y+s,j+s,y+s,j-s]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return bs.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===re.ShapeActivingCtrl.data.hl?bs.getStyle("shapeCtrlPointHighlightBorder"):bs.getStyle("shapeCtrlPointBorderColor")}}},{type:"shape",visible:{func:function(){return re.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var A=re.ShapeActivingCtrl.data.c2,O=A.x,d=A.y,f=Mq/2;return"c2"===re.ShapeActivingCtrl.data.hl&&(f+=.5),[O-f,d-f,O-f,d+f,O+f,d+f,O+f,d-f]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return bs.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===re.ShapeActivingCtrl.data.hl?bs.getStyle("shapeCtrlPointHighlightBorder"):bs.getStyle("shapeCtrlPointBorderColor")}}}]},Eh.Icons.DrawIcon=function(U,T,p,z){p.width=p.height=zi,p.data=z,bs=U,e.Default.drawImage(T,p,0,0,zi,zi)},Eh.Icons.MapPoints=function(I,z){for(var H=0,i=I.length;i>H;H++)I[H]/=z},Eh.roundTo=function(w,y,O){var v=Math.abs(w%y);return O>v||O>y-v?y*Math.round(w/y):w},Eh.toFixed=function(n){return Math.round(100*n)/100},Eh.getDataMatrix=function(K){if(K instanceof e.Shape){var k=new Eh.Math.Matrix2,Q=K.getPosition();return k.translate(-Q.x,-Q.y).scale(K.getScale().x,K.getScale().y).rotate(K.getRotation()).translate(Q.x,Q.y),k}return K.getMatrix?K.getMatrix():new Eh.Math.Matrix2},Math.sign===L&&(Math.sign=function(Y){return 0>Y?-1:Y>0?1:+Y});var zk=Eh.Math.Matrix2=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0};zk.prototype={},zk.prototype.constructor=zk,zk.prototype.set=function(S,n,t,z,Z,s){return this.a=S,this.b=n,this.c=t,this.d=z,this.tx=Z,this.ty=s,this},zk.prototype.apply=function(o,l){l=l||new $i;var S=o.x,D=o.y;return l.x=this.a*S+this.c*D+this.tx,l.y=this.b*S+this.d*D+this.ty,l},zk.prototype.applyInverse=function(w,j){j=j||new $i;var n=1/(this.a*this.d+this.c*-this.b),I=w.x,Z=w.y;return j.x=this.d*n*I+-this.c*n*Z+(this.ty*this.c-this.tx*this.d)*n,j.y=this.a*n*Z+-this.b*n*I+(-this.ty*this.a+this.tx*this.b)*n,j},zk.prototype.translate=function(K,y){return this.tx+=K,this.ty+=y,this},zk.prototype.scale=function(T,t){return this.a*=T,this.d*=t,this.c*=T,this.b*=t,this.tx*=T,this.ty*=t,this},zk.prototype.rotate=function(x){var R=Math.cos(x),N=Math.sin(x),D=this.a,V=this.c,U=this.tx;return this.a=D*R-this.b*N,this.b=D*N+this.b*R,this.c=V*R-this.d*N,this.d=V*N+this.d*R,this.tx=U*R-this.ty*N,this.ty=U*N+this.ty*R,this},zk.prototype.append=function(H){var e=this.a,g=this.b,J=this.c,V=this.d;return this.a=H.a*e+H.b*J,this.b=H.a*g+H.b*V,this.c=H.c*e+H.d*J,this.d=H.c*g+H.d*V,this.tx=H.tx*e+H.ty*J+this.tx,this.ty=H.tx*g+H.ty*V+this.ty,this},zk.prototype.setTransform=function(M,G,q,k,E,L,a,H,$){var U,c,u,f,h,w,C,g,B,Y;return h=Math.sin(a),w=Math.cos(a),C=Math.cos($),g=Math.sin($),B=-Math.sin(H),Y=Math.cos(H),U=w*E,c=h*E,u=-h*L,f=w*L,this.a=C*U+g*u,this.b=C*c+g*f,this.c=B*U+Y*u,this.d=B*c+Y*f,this.tx=M+(q*U+k*u),this.ty=G+(q*c+k*f),this},zk.prototype.prepend=function(s){var X=this.tx;if(1!==s.a||0!==s.b||0!==s.c||1!==s.d){var n=this.a,C=this.c;this.a=n*s.a+this.b*s.c,this.b=n*s.b+this.b*s.d,this.c=C*s.a+this.d*s.c,this.d=C*s.b+this.d*s.d}return this.tx=X*s.a+this.ty*s.c+s.tx,this.ty=X*s.b+this.ty*s.d+s.ty,this},zk.prototype.invert=function(){var T=this.a,U=this.b,b=this.c,H=this.d,Z=this.tx,Y=T*H-U*b;return this.a=H/Y,this.b=-U/Y,this.c=-b/Y,this.d=T/Y,this.tx=(b*this.ty-H*Z)/Y,this.ty=-(T*this.ty-U*Z)/Y,this},zk.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},zk.prototype.clone=function(){var v=new zk;return v.a=this.a,v.b=this.b,v.c=this.c,v.d=this.d,v.tx=this.tx,v.ty=this.ty,v},zk.prototype.copy=function(C){return C.a=this.a,C.b=this.b,C.c=this.c,C.d=this.d,C.tx=this.tx,C.ty=this.ty,C},zk.IDENTITY=new zk,zk.TEMP_MATRIX=new zk;var $i=Eh.Math.Vector2=function(Y,p,c){"object"==typeof Y&&(Y.x!=L?(p=Y.y,Y=Y.x,c=Y.e):(c=Y[2],p=Y[1],Y=Y[0])),this.set(Y||0,p||0,c)};$i.prototype={},$i.prototype.constructor=$i,N.defineProperties($i.prototype,{width:{get:function(){return this.x},set:function(J){this.x=J}},height:{get:function(){return this.y},set:function(n){this.y=n}}}),$i.prototype.clone=function(){return new $i(this.x,this.y,this.e)},$i.prototype.copy=function(J){return this.set(J.x,J.y,J.e),this},$i.prototype.equals=function(M){return M.x===this.x&&M.y===this.y},$i.prototype.set=function(p,z,c){return this.x=p||0,this.y=z||(0!==z?this.x:0),c!=L&&(this.e=c),this},$i.prototype.setScalar=function(X){return this.x=X,this.y=X,this},$i.prototype.setX=function(g){return this.x=g||0,this},$i.prototype.setY=function(C){return this.y=C||0,this},$i.prototype.add=function(C){return this.x+=C.x,this.y+=C.y,this},$i.prototype.addVectors=function(g,w){return this.x=g.x+w.x,this.y=g.y+w.y,this},$i.prototype.addScalar=function(i){return this.x+=i,this.y+=i,this},$i.prototype.addScaledVector=function(i,Q){return this.x+=i.x*Q,this.y+=i.y*Q,this},$i.prototype.sub=function(i){return this.x-=i.x,this.y-=i.y,this},$i.prototype.subScalar=function(e){return this.x-=e,this.y-=e,this},$i.prototype.subVectors=function(L,J){return this.x=L.x-J.x,this.y=L.y-J.y,this},$i.prototype.multiply=function(k){return this.x*=k.x,this.y*=k.y,this},$i.prototype.multiplyScalar=function(A){return this.x*=A,this.y*=A,this},$i.prototype.divide=function(a){return this.x/=a.x,this.y/=a.y,this},$i.prototype.divideScalar=function(y){return this.multiplyScalar(1/y)},$i.prototype.min=function(F){return this.x=Math.min(this.x,F.x),this.y=Math.min(this.y,F.y),this},$i.prototype.max=function(W){return this.x=Math.max(this.x,W.x),this.y=Math.max(this.y,W.y),this},$i.prototype.clamp=function(W,n){return this.x=Math.max(W.x,Math.min(n.x,this.x)),this.y=Math.max(W.y,Math.min(n.y,this.y)),this},$i.prototype.clampScalar=function(){var $,x;return function(G,D){return $===L&&($=new $i,x=new $i),$.set(G,G),x.set(D,D),this.clamp($,x)}}(),$i.prototype.clampLength=function(T,l){var q=this.length();return this.multiplyScalar(Math.max(T,Math.min(l,q))/q)},$i.prototype.dot=function(G){return this.x*G.x+this.y*G.y},$i.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},$i.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},$i.prototype.normalize=function(){return this.divideScalar(this.length())},$i.prototype.angle=function(){var Y=Math.atan2(this.y,this.x);
return 0>Y&&(Y+=2*Math.PI),Y},$i.prototype.distanceTo=function(S){return Math.sqrt(this.distanceToSquared(S))},$i.prototype.distanceToSquared=function(u){var R=this.x-u.x,M=this.y-u.y;return R*R+M*M},$i.prototype.isNearEnough=function(p){return this.distanceToSquared(p)<1e-8},$i.prototype.setLength=function(o){var n=this.length();return n?this.multiplyScalar(o/n):this},$i.prototype.lerp=function(f,J){return this.x+=(f.x-this.x)*J,this.y+=(f.y-this.y)*J,this},$i.prototype.lerpVectors=function(W,R,J){return this.subVectors(R,W).multiplyScalar(J).add(W)},$i.prototype.rotateAround=function(o,w){var g=Math.cos(w),J=Math.sin(w),s=this.x-o.x,x=this.y-o.y;return this.x=s*g-x*J+o.x,this.y=s*J+x*g+o.y,this};var vi=Eh.Math.Curve=function(){this._curves=[]};vi.prototype={},vi.prototype.constructor=vi,vi.prototype.createFromHtShape=function(Z,l,j){l instanceof e.List&&(l=l.toArray());var I,k,S,D,G,J,$,C=this,c=null,v=null,n=0,t=Eh.Math.Vector2,X=Eh.Math.CubicBezier,h=function(k){return new t(Z[k],Z[k+1],j?j[k/2]:L)};for(k=0,S=l.length;S>k;k++){switch(D=l[k],G=null,D){case 1:v=h(n),c=v,n+=2;break;case 2:I=h(n),n+=2,G=new X(v,v.clone(),I.clone(),I),v=I;break;case 3:J=h(n),I=h(n+2),n+=4,G=new X(v,J.clone().sub(v).multiplyScalar(2/3).add(v),J.clone().sub(I).multiplyScalar(2/3).add(I),I),v=I;break;case 4:J=h(n),$=h(n+2),I=h(n+4),n+=6,G=new X(v,J,$,I),v=I;break;case 5:if(!c)break;G=new X(v,v.clone(),c.clone(),c),v=null,c=null}G&&(G._index=C._curves.length,C._curves.push(G))}},vi.prototype.checkPoint=function(f,N){var o,I,j,Q,Y,D=this,L=D._curves;for(o=0,I=L.length;I>o;o++)if(Q=L[o],Y=Q.intersectRect(f,N,N),Y.length)return j=0,Y.forEach(function(Q){j+=Q.t}),j/=Y.length,f=Q.getPointAt(j),f.t=j,{bezier:Q,intersection:f}},vi.prototype.insertKnot=function(y,g){var c=y.insertKnot(g),I=this,w=I._curves;w.splice(y._index,1,c[0],c[1])},vi.prototype._isCloseEnough=function(F,n){return Math.abs(F.x-n.x)<1e-6&&Math.abs(F.y-n.y)<1e-6},vi.prototype._isSamePoint=function(W,Y){return W===Y},vi.prototype.moveRealPoint=function(S,d){var E=this,R=E._curves,v=d.clone().sub(S);R.forEach(function(R){var F=R._p1;R._p2,R._p3;var l=R._p4;E._isSamePoint(F,S)&&(R._p2.add(v),R._p1=d),E._isSamePoint(l,S)&&(R._p3.add(v),R._p4=d)})},vi.prototype.moveCtrlDueToRealPointMovement=function(B,E){var _=this,v=_._curves,l=function(c){c.add(E),c.e&&E.e&&(c.e+=E.e)};v.forEach(function(g){var W=g._p1;g._p2,g._p3;var k=g._p4;_._isSamePoint(W,B)&&l(g._p2),_._isSamePoint(k,B)&&l(g._p3)})},vi.prototype.moveCtrlPoint=function(p,n,W){var C=p[W];if(C){C.e!==L&&(n.e=C.e);var Z=this,Y=Z._curves;n.clone().sub(C),Y.forEach(function(j){var b;"c2"===W?b="_p2":"c1"===W&&(b="_p3"),Z._isSamePoint(j[b],C)&&(j[b]=n)}),p[W]=n}},vi.prototype.deleteRealPoint=function(a,H){var j,g,C,O,B,D,S,p=this,f=p._curves,m={},i=[],M=Eh.Math.CubicBezier;for(g=0,C=f.length;C>g;g++)j=f[g],O=j._p1,B=j._p2,D=j._p3,S=j._p4,(m[g]||!p._isSamePoint(O,a))&&(p._isSamePoint(S,a)?C>g+1&&p._isSamePoint(f[g+1]._p1,a)&&(H||i.push(new M(O,B,f[g+1]._p3,f[g+1]._p4))):i.push(j));p._curves=i},vi.prototype.findPairs=function(c,z){var C,y,e,G,L,O,Z,T,V=this,J=V._curves,u={},A=[];for(y=0,e=J.length;e>y;y++)C=J[y],G=C._p1,L=C._p2,O=C._p3,Z=C._p4,!u[y]&&V._isSamePoint(G,c)&&(z?A.push({point:G,r2:Z}):A.push({point:G,c2:L})),V._isSamePoint(Z,c)&&(T=z?{point:Z,r1:G}:{point:Z,c1:O},e>y+1&&V._isSamePoint(J[y+1]._p1,c)&&(z?T.r2=J[y+1]._p4:T.c2=J[y+1]._p2,u[y+1]=!0),A.push(T));return A},vi.prototype.toHtShape=function(){var h=this,e=h._curves,w=[],Z=[],x={x:1/0,y:1/0};return e.forEach(function(J){var j=J._p1,E=J._p2,l=J._p3,v=J._p4;return h._isCloseEnough(j,x)||(w.push(1),Z.push(j.clone())),x=v,h._isCloseEnough(j,E)&&h._isCloseEnough(l,v)?(w.push(2),Z.push(v.clone()),void 0):(w.push(4),Z.push(E.clone(),l.clone(),v.clone()),void 0)}),{segments:w,points:Z}};var uj=Eh.Math.CubicBezier=function(W,c,n,M){var K=this;K._id=Eh.Math.CubicBezier._globalId++,K._p1=W,K._p2=c,K._p3=n,K._p4=M};uj._globalId=1,uj.prototype={},uj.prototype.constructor=uj,uj.prototype.toString=function(){return this._id},uj.prototype.intersectRect=function(M,c,E){var F=c/2,i=E/2,y=M.x,d=M.y,Y=Eh.Math.Vector2,I=new Y(-F+y,-i+d),C=new Y(F+y,i+d),B=new Y(C.x,I.y),o=new Y(I.x,C.y),b=this,K=b.intersectLine(I,B),f=b.intersectLine(B,C),S=b.intersectLine(C,o),H=b.intersectLine(o,I),W=K.concat(f).concat(S).concat(H);return W},uj.prototype.intersectLine=function(O,G){var B,$,c,r,J,T,F,g,X,_,i,e,b,d=this,l=O.clone().min(G),m=O.clone().max(G);r=d._p1,J=d._p2,T=d._p3,F=d._p4,B=r.clone().multiplyScalar(-1),$=J.clone().multiplyScalar(3),c=T.clone().multiplyScalar(-3),i=B.add($).add(c).add(F),B=r.clone().multiplyScalar(3),$=J.clone().multiplyScalar(-6),c=T.clone().multiplyScalar(3),_=B.add($).add(c),B=r.clone().multiplyScalar(-3),$=J.clone().multiplyScalar(3),X=B.add($),g=r.clone(),b=new Eh.Math.Vector2(O.y-G.y,G.x-O.x),e=O.x*G.y-G.x*O.y;for(var u=d.getRoots(b.dot(i),b.dot(_),b.dot(X),b.dot(g)+e),w=new Array,o=0,Y=u.length;Y>o;o++){var Q=u[o];if(!(0>Q||Q>1)){var E=r.clone().lerp(J,Q),t=J.clone().lerp(T,Q),j=T.clone().lerp(F,Q),n=E.lerp(t,Q),f=t.lerp(j,Q),v=n.lerp(f,Q);v.t=Q,O.x==G.x?l.y<=v.y&&v.y<=m.y&&w.push(v):O.y==G.y?l.x<=v.x&&v.x<=m.x&&w.push(v):v.x>=l.x&&v.y>=l.y&&v.x<=m.x&&v.y<=m.y&&w.push(v)}}return w},uj.prototype.solveTForPoint=function(K){var f,D,F,n,U=this;f=U._p1.x-K.x,D=U._p2.x-K.x,F=U._p3.x-K.x,n=U._p4.x-K.x;for(var E=U.getRoots(n-3*F+3*D-f,3*F-6*D+3*f,3*D-3*f,f),J=L,Q=1/0,N=0,H=E.length;H>N;N++){var l=E[N];if(!(0>l||l>1)){var W=U._p1.clone().lerp(U._p2,l),V=U._p2.clone().lerp(U._p3,l),v=U._p3.clone().lerp(U._p4,l),p=W.lerp(V,l),R=V.lerp(v,l),t=p.lerp(R,l);t.t=l;var T=Math.abs(t.y-K.y);Q>T&&(Q=T,J=t)}}return J},uj.prototype.getPointAt=function(C){var W=this,D=W._p1,y=W._p2,L=W._p3,B=W._p4,q=D.clone().lerp(y,C),w=y.clone().lerp(L,C),e=L.clone().lerp(B,C),f=q.lerp(w,C),S=w.lerp(e,C);return f.lerp(S,C)},uj.prototype.getRoots=function(q,J,S,m){var R,Q,e,K,$,U=new Array;if(Math.abs(q)<1e-6){var R=J,Q=S/R,e=m/R,K=Q*Q-4*e;if(K>0){var $=Math.sqrt(K);U.push(.5*(-Q+$)),U.push(.5*(-Q-$))}else 0==K&&U.push(.5*-Q)}J/=q,S/=q,m/=q,R=(3*S-J*J)/3,Q=(2*J*J*J-9*S*J+27*m)/27;var D=J/3,T=Q*Q/4+R*R*R/27,H=Q/2;if(Math.abs(T)<=1e-6&&(T=0),T>0){var G,x,$=Math.sqrt(T);G=-H+$,x=G>=0?Math.pow(G,1/3):-Math.pow(-G,1/3),G=-H-$,G>=0?x+=Math.pow(G,1/3):x-=Math.pow(-G,1/3),U.push(x-D)}else if(0>T){var t=Math.sqrt(-R/3),p=Math.atan2(Math.sqrt(-T),-H)/3,y=Math.cos(p),X=Math.sin(p),w=Math.sqrt(3);U.push(2*t*y-D),U.push(-t*(y+w*X)-D),U.push(-t*(y-w*X)-D)}else{var G;G=H>=0?-Math.pow(H,1/3):Math.pow(-H,1/3),U.push(2*G-D),U.push(-G-D)}return U},uj.prototype._70I=function(){var d=this;return d._p1.distanceToSquared(d._p2)<1e-10&&d._p3.distanceToSquared(d._p4)<1e-10},uj.prototype.insertKnot=function(e){var j=this,w=j._p1,$=j._p2,f=j._p3,a=j._p4,y=w.clone().lerp($,e),C=$.clone().lerp(f,e),H=f.clone().lerp(a,e),L=y.clone().lerp(C,e),K=C.clone().lerp(H,e),o=L.clone().lerp(K,e);return j._70I()?(w.clone().lerp(a,e),[new Eh.Math.CubicBezier(w,w.clone(),o.clone(),o),new Eh.Math.CubicBezier(o,o.clone(),a.clone(),a)]):[new Eh.Math.CubicBezier(w,y,L,o),new Eh.Math.CubicBezier(o,K,H,a)]};var Rl=e.Default.getInternal().ui().EdgeUI,cm={_47O:function(T){var X=this,C=cm.getBackups()._47O;Eh.inEdit(X.gv)||C.call(X,T)}};Eh.Inject.registAsModule(cm,Rl);var Mk=e.Default.getInternal().ui().NodeUI,sj={_47O:function(G){var U=this,p=sj.getBackups()._47O;Eh.inEdit(U.gv)||p.call(U,G)},getSelectWidth:function(){var v=this,Q=v.gv,y=v._data;if(Q.isEditable(y)&&Eh.inEdit(Q))return 0;var O=sj.getBackup("getSelectWidth");return O.call(v)}};Eh.Inject.registAsModule(sj,Mk);var Kp=e.graph.GraphView,Cj={_editPointSize:function(){var J=e.Default.isTouchable,q=Eh.getStyle("pointSize");return q[J?0:1]}(),isPointEditable:function(U){var X=this;if(Eh.inEdit(X))return X._pointEditableFunc?X._pointEditableFunc(U):!0;var L=Cj.getBackup("isPointEditable");L.call(X,U)},isEditable:function(D){var X,E=this,T=Cj.getBackup("isEditable");if(X=D instanceof Eh.Group?!0:T.call(E,D),!Eh.inEdit(E))return X;if(!(D instanceof e.Edge))return X;if(!D.s("2d.editable"))return!1;var v=E.getEditableFunc();return v?v(D):!0},_42:function(Z,f){var v=this,c=Cj.getBackups()._42;if(c.call(v,Z,f),Eh.inEdit(v)){var k=v.getEditInteractor();k.drawImpl()}}};Eh.Inject.registAsModule(Cj,Kp);var Gp=e.Default.getInternal().ui().ShapeUI,lg={_47O:function(N){var n=this,k=lg.getBackups()._47O;Eh.inEdit(n.gv)||k.call(n,N)}};Eh.Inject.registAsModule(lg,Gp);var sk=e.graph.DefaultInteractor,_q={handle_mousewheel:function(a){var X=this,m=_q.getBackup("handle_mousewheel");Eh.inEdit(X.gv)||m.call(X,a)}};Eh.Inject.registAsModule(_q,sk);var Ek=e.graph.MoveInteractor,ob={_calcShift:function(v,M){var K=this,H=ob.getBackup("_calcShift"),Y=K.gv;if(!Eh.inEdit(Y))return H.call(K,v,M);var t=Y.getEditInteractor(),k=t.getSubModule("Move").calcShift(v,M,K);return k||H.call(K,v,M)},clear:function(N){var x=this,Z=ob.getBackup("clear");Z.call(x,N);var E=x.gv;if(Eh.inEdit(E)){var O=E.getEditInteractor();O.getSubModule("Move").clear(N)}}};Eh.Inject.registAsModule(ob,Ek);var ij=Eh.Rect=function(u){this.catalog="Rect",this._interactor=u};ij.prototype={},ij.prototype.constructor=ij,ij.prototype.gatherInfo=function(R,E){var d=this;if(1===E.length){var a=E[0];return a instanceof e.Shape&&a._70I()?d.gatherLine(R,a):yk(a,R)?!1:d.gatherSingleTarget(R,a)}return E.length>1?d.gatherMultiTargets(R,E):!1},ij.prototype.gatherSingleTarget=function(l,h){if(h.getCorners){var Y,m=this,w=m.info;m.target=h,Y=m.screenInfo={};var t=h.getCorners();w.LT=new Eh.Math.Vector2(t[0]),w.LB=new Eh.Math.Vector2(t[1]),w.RB=new Eh.Math.Vector2(t[2]),w.RT=new Eh.Math.Vector2(t[3]),w.T=w.LT.clone().add(w.RT).divideScalar(2),w.B=w.LB.clone().add(w.RB).divideScalar(2),w.L=w.LT.clone().add(w.LB).divideScalar(2),w.R=w.RT.clone().add(w.RB).divideScalar(2);for(var I in w)Y[I]=Eh.toScreenPosition(l,w[I]);var b=m._interactor,k=b.getStyle("checkSize"),g=function(y,S,A){var N=S.clone().sub(y).setLength(-k),R=A.clone().sub(y).setLength(-k),B=N.add(R).add(y);return B};return Y.rotLT=g(Y.LT,Y.RT,Y.LB),Y.rotLB=g(Y.LB,Y.LT,Y.RB),Y.rotRB=g(Y.RB,Y.LB,Y.RT),Y.rotRT=g(Y.RT,Y.LT,Y.RB),Y.rotT=Y.rotLT.clone().add(Y.rotRT).divideScalar(2),Y.rotB=Y.rotLB.clone().add(Y.rotRB).divideScalar(2),Y.rotL=Y.rotLT.clone().add(Y.rotLB).divideScalar(2),Y.rotR=Y.rotRT.clone().add(Y.rotRB).divideScalar(2),Y.rotation=h.getRotation(),m.gatherConnectInfo(),!0}},ij.prototype.gatherConnectInfo=function(){var J=this,Q=J.target,x=J._interactor,A=J.screenInfo,z=x.gv;if(Q instanceof e.Node&&x.getStyle("connectGuideVisible")){var R=Q.s("connectGuideShift")||x.getStyle("connectGuideShift"),L=Q.getAnchor(),X=Q.getSize(),s=Q.toGlobal({x:X.width*(R[0]-L.x),y:X.height*(R[1]-L.y)});s=Eh.toScreenPosition(z,s),A.P1?s.add(A.P2.clone().sub(A.P1).setLength(R[2])):(s.add(A.RT.clone().sub(A.LT).setLength(R[2])),s.add(A.LB.clone().sub(A.LT).setLength(R[3]))),A.connect=s}},ij.prototype.gatherMultiTargets=function(e,c){var f=Eh.Group.findOrCreateGroup(c);if(!f)return!1;var F=this;return F.editing&&"rotate"!==F.editing.mode||f.calcInfo(),F.gatherSingleTarget(e,f)},ij.prototype.gatherLine=function(T,q){this.target=q;var I=this.screenInfo={},F=q.getPoints(),J=Eh.getDataMatrix(q);return I.P1=Eh.toScreenPosition(T,J.apply(F.get(0))),I.P2=Eh.toScreenPosition(T,J.apply(F.get(1))),this.gatherConnectInfo(),!0},ij.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],ij.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],ij.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],ij.prototype.check=function(c,v,_){if(e.Default.isLeftButton(v)){var H=this;if(H.editing=null,H.tipInfo=null,H.screenInfo){var U=H.target,V=c.isEditable(U),T=H.screenInfo;if(V&&T.connect){var i=H._checkConnect(_);if(i)return i}if(T.P1)return H._checkLine(_);var o,O,S,B=null,Z=H._interactor,u=Z.getStyle("checkSize");if(V&&c.isRectEditable(U))for(O=0;O<Eh.Rect.ResizeKeys.length;O++)if(S=Eh.Rect.ResizeKeys[O],Eh.checkHit(_,T[S],u)){B=S,o="resize";break}if(!B&&V&&c.isRotationEditable(U)){var k=Z.getStyle("rotateCheckSize");for(O=0;O<Eh.Rect.RotateKeys.length;O++)if(S=Eh.Rect.RotateKeys[O],Eh.checkHit(_,T[S],k)){B=S,o="rotate";break}}if(!B)return Z.setCursor("default"),void 0;if("rotate"===o){var r,W=c.lp(v);if(U instanceof Eh.Group){var R=Z.getStyle("groupRotateModeKey");"string"==typeof R&&(R=[R]);for(var a=!1,L=0,j=R.length;j>L;L++)if(v[R[L]]){a=!0;break}var q=Z.getStyle("groupRotateModeDefault");r=a?"batch"===q?"block":"batch":q}var h="batch"===r?U.getAnchor2():U.getPosition(),C=Math.atan2(W.y-h.y,W.x-h.x);Z._setRotateCursor(C),H.editing={mode:o,key:B,pos:h,flipY:U.getScale().y<0,rotation:U.getRotation(),hitRot:C},r&&(H.editing.groupRotateMode=r)}else{var x=Eh.Rect.ResizeKeys.indexOf(B),n=Eh.Rect.ResizeDirection[x],J=Math.cos(U.getRotation()),E=Math.sin(U.getRotation()),Q=n.x*Math.sign(U.getScale().x),I=n.y*Math.sign(U.getScale().y),A=Math.atan2(-E*Q-J*I,J*Q-E*I),p=(Math.round(A/(Math.PI/4))+8)%8,M=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][p];this._interactor.setCursor(M);var w=U.getWidth(),F=U.getHeight(),X=U.getAnchor();H.editing={mode:o,key:B,rect:{x:-w*X.x,y:-F*X.y,width:w,height:F},anchor:X,matrix:U.getMatrix()}}return B}}},ij.prototype._checkLine=function(Q){var z=this;z.screenInfo;var r,n=z._interactor.getStyle("checkSize");if(Eh.checkHit(Q,z.screenInfo.P1,n))r="P1";else{if(!Eh.checkHit(Q,z.screenInfo.P2,n))return this._interactor.setCursor("default"),void 0;r="P2"}return z.editing={mode:"line",key:r},r},ij.prototype._checkConnect=function(C){var _=this,Q=_.screenInfo,t=_._interactor,p=t.getStyle("connectGuideIntersectSize");if(Eh.checkHit(C,Q.connect,p)){var B="connect",u=V.getConnectAction(t.gv);return _.editing={mode:B},u&&u.delete&&u.delete.visible.call(null,t.gv,_.target)&&(_.editing.hasDeleteAction=!0),t.setCursor("default"),B}},ij.prototype._fireEditEvent=function(c,O){var z=this._interactor,r=this.editing;if(r){var V=r.mode;V="rotate"===V?"Rotation":"connect"===V?"Connection":V[0].toUpperCase()+V.slice(1),z.fi({kind:c+"Edit"+V,event:O})}},ij.prototype.startEdit=function(b,E){b.startDragging(E);var H=this;H._interactor.fi({kind:"prepareEdit",event:E});var G=H.editing,L=H.target;if(G){if(H._fireEditEvent("begin",E),"rotate"===G.mode)return G.groupRotateMode&&L.beginRotate(G),void 0;if("connect"!==G.mode)("line"===G.mode||L&&0===L.getRotation())&&(H._inSmartGuide=!0,H._interactor.rectGuide.gatherRects());else if(G.hasDeleteAction){var R=b.gv,i=H._interactor.getStyle("connectGuideGarbageShift");G.garbageInfo={x:R.getWidth()*i[0]+i[2],y:R.getHeight()*i[1]+i[3],size:H._interactor.getStyle("connectGuideGarbageIntersectsize")},b._42()}}},ij.prototype._46O=function(h){var e,T=this,y=T.editing;if(y){if("connect"===y.mode&&!y.canceled&&!y.deleted)try{y.garbageInfo&&y.garbageInfo.hover?V.doDeleteConnectionAction(T._interactor.gv,T.target):V.doConnectAction(T._interactor.gv,T.target,y.target)}catch(B){console.error(B)}e=T.editing.groupRotateMode,T._fireEditEvent("end",h),T.editing=null}T.tipInfo=null,T._inSmartGuide&&(T._interactor.rectGuide.clear(),T._inSmartGuide=!1),e&&T.target&&T.target.endRotate()},ij.prototype.handleNormalStateDelete=function(){var t=this,Q=t.editing;if(Q&&"connect"===Q.mode&&!Q.canceled&&!Q.deleted){if(Q.garbageInfo){try{V.doDeleteConnectionAction(t._interactor.gv,t.target)}catch(m){console.error(m)}Q.garbageInfo=null}return Q.cursorPos=null,Q.targetCorners=null,Q.deleted=!0,t._interactor._42(),!0}},ij.prototype.handleNormalStateKeyDown=function(P){var C=this,y=C.editing;return!y||"connect"!==y.mode||y.canceled||y.deleted?void 0:e.Default.isEsc(P)?(y.cursorPos=null,y.targetCorners=null,y.canceled=!0,C._interactor._42(),!0):void 0},ij.prototype.handleEdit=function(m,U){var w=this,j=w.editing;if(j){var c,G,r,K,J,h=w.target,X=j.key,b=j.mode,E=m.lp(U),g=w._interactor;if("connect"===b){if(j.canceled)return;if(j.deleted)return;j.cursorPos=g._getLogicalPoint(U);var P=j.garbageInfo;return P&&Eh.checkHit(j.cursorPos,P,P.size)?(P.hover=!0,j.target=null,j.targetCorners=null):(P&&(P.hover=!1),j.target=m.getDataAt(E,function(e){return m.isSelectable(e)?Jl(e)?!0:!1:!1})||null,j.targetCorners=Eh.getTargetCornersOnScreen(m,j.target)),g._42(),void 0}if("rotate"===b){var O,t,D=j.pos,Z=Math.atan2(E.y-D.y,E.x-D.x);if(j.groupRotateMode?t=Z-j.hitRot:(O=Z-j.hitRot,t=j.rotation+O),t%=2*Math.PI,0>t&&(t+=2*Math.PI),!e.Default.isCtrlDown(U)){var W,L;Wh(U)?(W=g.getStyle("shiftRotateRound"),L=W/2):(W=g.getStyle("rotateRound"),L=g.getStyle("rotateSensitivity")),t=Eh.roundTo(t,W,L)}j.groupRotateMode?(O=t-(j.lastRotation||0),0!==O&&(h.addRotation(O,j.groupRotateMode),j.lastRotation=t)):h.setRotation(t),g._setRotateCursor(Z),t>Math.PI&&(t-=2*Math.PI);var A=180*(t/Math.PI);A=A.toFixed(2),c=""+A+"°"}else if("resize"===b){var $=j.rect;r=$.x,K=$.y;var y,N=$.width,d=$.height,i=j.anchor,a=j.matrix,T=Wh(U),x=w._unionPointMode1,S=w._unionPointMode2;if(w._inSmartGuide&&!e.Default.isCtrlDown(U)&&!T){var _;"L"===X||"R"===X?_="x":("T"===X||"B"===X)&&(_="y"),w._adsorbedToClosest(E,_),J=!0}y=a.tfi(E);var n;"LT"===X?($=x(y,{x:r+N,y:K+d},N,d,T),n=9):"T"===X?($=S({x:r,y:y.y},{x:r+N,y:K+d},N,d,T,"v"),n=1):"RT"===X?($=x(y,{x:r,y:K+d},N,d,T),n=33):"L"===X?($=S({x:y.x,y:K},{x:r+N,y:K+d},N,d,T,"h"),n=8):"R"===X?($=S({x:r,y:K},{x:y.x,y:K+d},N,d,T,"h"),n=32):"LB"===X?($=x(y,{x:r+N,y:K},N,d,T),n=12):"B"===X?($=S({x:r,y:K},{x:r+N,y:y.y},N,d,T,"v"),n=4):"RB"===X&&($=x(y,{x:r,y:K},N,d,T),n=36);var l=a.tf($.x+$.width*i.x,$.y+$.height*i.y);h.setPosition(l),h.setSize($.width,$.height),J&&(G=h.getRect(),g.rectGuide.gatherLines({node:h,x:G.x,y:G.y,w:G.width,h:G.height},_,n)),c=""+Math.round($.width)+" * "+Math.round($.height)}else if("line"===b){if(Wh(U)){var F=h.getPoints(),p="P1"===X?F.get(1):F.get(0),q={x:E.x-p.x,y:E.y-p.y},k=g.getStyle("shiftLineRotateRound"),V=w._shiftDirList;if(!V||w._shiftRotateRound!==k){w._shiftRotateRound=k,w._shiftDirList=V=[];for(var Y=0;Y<Math.PI;Y+=k)V.push({x:B(Y),y:v(Y)})}for(var o,I=0,f=0,Q=V.length;Q>f;f++){var z=V[f],u=z.x*q.x+z.y*q.y;Math.abs(u)>Math.abs(I)&&(I=u,o=z)}E={x:p.x+o.x*I,y:p.y+o.y*I},g.rectGuide.clear()}else w._inSmartGuide&&!e.Default.isCtrlDown(U)&&(w._adsorbedToClosest(E),J=!0);var C=Eh.getDataMatrix(h).applyInverse(E);h.setPoint("P1"===X?0:1,C,!0);var M=h.getPoints(),R=M.get(0),s=M.get(1);r=R.x-s.x,K=R.y-s.y,c=" "+Math.round(Math.sqrt(r*r+K*K))+" ",J&&(G=h.getRect(),g.rectGuide.gatherLines({node:h,x:G.x,y:G.y,w:G.width,h:G.height}))}if(c){var H=e.Default.getLogicalPoint(U,g._canvas);H.x+=Eh.Icons.TipShiftX,H.y+=Eh.Icons.TipShiftY,w.tipInfo={helperPos:H,text:c,size:c.length}}w._fireEditEvent("between",U)}},ij.prototype._unionPointMode1=function(V,f,T,U,Z){if(Z&&T&&U){var E=V.x-f.x,I=V.y-f.y;Math.abs(E*U)<Math.abs(I*T)?(I=Math.sign(I)*Math.abs(E*U/T),V.y=f.y+I):(E=Math.sign(E)*Math.abs(I*T/U),V.x=f.x+E)}return e.Default.unionPoint(V,f)},ij.prototype._unionPointMode2=function(C,P,q,F,x,I){var l=e.Default.unionPoint(C,P);if(x&&q&&F){var W;"v"===I?(W=l.x+l.width/2,l.width=q*l.height/F,l.x=W-l.width/2):(W=l.y+l.height/2,l.height=F*l.width/q,l.y=W-l.height/2)}return l},ij.prototype._adsorbedToClosest=function(k,O){var u=this,H=u._interactor,v=H.rectGuide.findClosest(k,O),l=H.gridGuide.findClosest(k,O),N=1/0,p=1/0;v&&(isFinite(v.x)&&(N=v.x),isFinite(v.y)&&(p=v.y)),l&&(isFinite(l.x)&&Math.abs(l.x)<Math.abs(N)&&(N=l.x),isFinite(l.y)&&Math.abs(l.y)<Math.abs(p)&&(p=l.y)),isFinite(N)&&(k.x+=N),isFinite(p)&&(k.y+=p)},ij.prototype._42=function(G,j,I){var p=this;p.info={},p.screenInfo=null;var T=p._interactor;if(!T.editDetail&&p.gatherInfo(j,I)){var c=p.editing,d=c?c.groupRotateMode:null,A=p.screenInfo;"block"!==d&&(A.P1?Eh.Icons.DrawIcon(T,G,Eh.Icons.Line,A):Eh.Icons.DrawIcon(T,G,Eh.Icons.Rect,A),A.connect&&(Eh.Icons.DrawIcon(T,G,Eh.Icons.ConnectGuide,{rotation:A.rotation,connect:A.connect,cursorPos:c?c.cursorPos:null}),c&&(c.targetCorners&&Eh.Icons.DrawIcon(T,G,Eh.Icons.NodeHoverGuide,c.targetCorners),c.garbageInfo&&Eh.Icons.DrawIcon(T,G,Eh.Icons.ConnectGuideGarbage,c.garbageInfo))),p.tipInfo&&Eh.Icons.DrawIcon(T,G,Eh.Icons.TipHelper,p.tipInfo)),p.target instanceof Eh.Group&&p.target._42(T,G,j)}};var Sj=Eh.Anchor=function(T){this.catalog="Anchor",this._interactor=T};Sj.prototype={},Sj.prototype.constructor=Sj,Sj.prototype.gatherInfo=function(H,M){var r=this;if(1===M.length){var v=M[0];if(!v.getAnchor)return;if(v instanceof e.Shape&&v._70I())return;if(yk(v,H))return;return r.gatherSingleTarget(H,M[0])}return M.length>1?r.gatherMultiTargets(H,M):!1},Sj.prototype.gatherSingleTarget=function(b,L){var m=this;return m.info.POS=L.getPosition(),m.screenInfo.POS=Eh.toScreenPosition(b,m.info.POS),m.target=L,!0},Sj.prototype.gatherMultiTargets=function(H,r){var u=this,Y=Eh.Group.findOrCreateGroup(r);return Y?(u.screenInfo.POS=Eh.toScreenPosition(H,Y.getAnchor2()),u.target=Y,!0):!1},Sj.prototype.isVisible=function(){var g=this,E=g._interactor;if(E.getStyle("anchorVisible")===!1)return!1;var k=g.target;if(k){if(this.editing)return!0;var q=k.getAnchor(),b=E.getStyle("anchorOutsideVisibleThreshold");if(q.x<-b||q.x>1+b||q.y<-b||q.y>1+b)return!0;var Q=k.getSize(),z=k.getScale(),C=Math.min(Math.abs(Q.width*z.x),Math.abs(Q.height*z.y));if(C*E.gv._zoom<E.getStyle("anchorHideThreshold"))return!1}return!0},Sj.prototype.check=function(u,Z,g){if(e.Default.isLeftButton(Z)){var T=this,p=T._interactor;if(T.isVisible()&&p.getStyle("anchorMovable")!==!1){T.editing=null,T.tipInfo=null;var x=T.target;if(x&&u.isAnchorEditable(x)&&u.isEditable(x)){var F;if(T.screenInfo&&(F=T.screenInfo.POS)&&Eh.checkHit(g,new Eh.Math.Vector2(F),p.getStyle("checkSize"))){if(x instanceof Eh.Group)return T.editing={},!0;var C=x.getWidth(),m=x.getHeight(),I=x.getAnchor();return T.editing={rect:{x:-C*I.x,y:-m*I.y,width:C,height:m},anchor:I,matrix:x.getMatrix()},!0}}}}},Sj.prototype.startEdit=function(O,P){O.startDragging(P),O.fi({kind:"beginEditAnchor",event:P})},Sj.prototype._46O=function(Z){var E=this;E.editing&&(E.editing=null,E._interactor.fi({kind:"endEditAnchor",event:Z})),E.tipInfo=null},Sj.prototype.handleEdit=function(y,c){var d=this,$=d.target;if($){var r=d.editing;if(r){var G=y.lp(c),t=d._interactor;if($ instanceof Eh.Group)return $.setAnchor2(G),t._42(),void 0;var O=r.matrix,o=O.tfi(G),U=r.rect,I=(o.x-U.x)/U.width,C=(o.y-U.y)/U.height;if(!e.Default.isCtrlDown(c)){var p=t.getStyle("anchorRound"),D=t.getStyle("anchorSensitivity");I=Eh.roundTo(I,p,D),C=Eh.roundTo(C,p,D)}$.setAnchor(I,C,!0);var i=e.Default.getLogicalPoint(c,t._canvas);i.x+=Eh.Icons.TipShiftX,i.y+=Eh.Icons.TipShiftY;var l=""+I.toFixed(2)+", "+C.toFixed(2);d.tipInfo={helperPos:i,text:l,size:l.length},t.fi({kind:"betweenEditAnchor",event:c})}}},Sj.prototype._42=function(D,M,C){var Q=this;Q.info={},Q.screenInfo={};var f=Q._interactor;f.editDetail||Q.gatherInfo(M,C)&&Q.isVisible()&&(Eh.Icons.DrawIcon(f,D,Eh.Icons.Anchor,Q.screenInfo),Q.tipInfo&&Eh.Icons.DrawIcon(f,D,Eh.Icons.TipHelper,Q.tipInfo))};var vi=Eh.Curve=function(J){this.catalog="Curve",this._interactor=J};vi.prototype={},vi.prototype.constructor=vi,N.defineProperties(vi.prototype,{activing:{get:function(){return this._activing},set:function(z){var W=this;if(z)W._activing=new Eh.CurveActiving(this,z);else{var Z=W._activing;Z&&Z.dispose(),W._activing=null}}}}),vi.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},vi.prototype.setUp=function(){var C=this,_=C._interactor;_&&_.gv.mp(C._onGraphviewPropertyChanged,C)},vi.prototype._onGraphviewPropertyChanged=function(U){("zoom"===U.property||"translateX"===U.property||"translateY"===U.property)&&this._handleDataChanged()},vi.prototype.tearDown=function(){var G=this,e=G._interactor;e&&e.gv.ump(G._onGraphviewPropertyChanged,G)},vi.prototype.canEnterEditDetailMode=function(){var L=this,y=L._interactor,J=y._getValidSelection();if(1===J.length){var k=J[0],M=k instanceof e.Edge;if(k instanceof e.Shape||M){if(M){var G=k.s("edge.type");if(G&&"points"!==G)return}var Y=y.gv;if(Y.isPointEditable(k)&&Y.isEditable(k))return L.target=k,!0}}},vi.prototype.preHandleScroll=function(){var T=this.editing;return T&&T.inEdit?!0:void 0},vi.prototype.getCurrentSelectintStatus=function(){var Q=this;if(Q.activing&&!Q.activing.selections){if(Q.activing.status!=L)return Q.activing.status;var N=function(v){var L=Q.activing.status;Q.activing.status=v,Q._interactor.fp("shapePointStatus",L,v)},o=Eh.Curve.PointType,u=Q.activing.point,X=Q.activing.pairs;if(!X||1!==X.length)return N(o.Mirrored);var O=X[0],d=O.c1&&O.c1.isNearEnough(u),F=O.c2&&O.c2.isNearEnough(u);if(!O.c1||!O.c2)return d||F?N(o.Straight):N(o.Disconnected);if(d&&F)return N(o.Straight);if(d||F)return N(o.Asymmetric);var m=O.c1.clone().sub(u),l=O.c2.clone().sub(u);return Math.abs(m.x*l.y-m.y*l.x)>1e-5||m.x*l.x>0?N(o.Disconnected):Math.abs(m.length()-l.length())>1e-5?N(o.Asymmetric):N(o.Mirrored)}},vi.prototype.handle_keydown=function(K){var e=this;if(e._interactor.editDetail){var g=Eh.Curve.PointType;"1"===K.key?e.setCurrentSelectionStatus(g.Straight):"2"===K.key?e.setCurrentSelectionStatus(g.Mirrored):"3"===K.key?e.setCurrentSelectionStatus(g.Disconnected):"4"===K.key&&e.setCurrentSelectionStatus(g.Asymmetric)}},vi.prototype.setCurrentSelectionStatus=function(w){var W=this,X=W.activing;if(X){var p=W.getCurrentSelectintStatus();if(null!==p&&p!==w){X.status=w;var A=W.activing.point,E=W.activing.pairs;if(E&&1===E.length){var D=E[0],v=W.screenInfo.curve,B=Eh.Curve.PointType,t=function(){W._writeToHt(),W._interactor.fp("shapePointStatus",p,w)};if(w===B.Straight)return v.moveCtrlPoint(D,A,"c1"),v.moveCtrlPoint(D,A,"c2"),t(),void 0;if(p===B.Straight){var S=v.findPairs(A,!0),$=S[0],U=$.r1||A,n=$.r2||A,e=n.clone().sub(U).multiplyScalar(.25);return v.moveCtrlPoint(D,A.clone().sub(e),"c1"),v.moveCtrlPoint(D,A.clone().add(e),"c2"),t(),void 0}var G=D.c1,N=D.c2;if(G&&N){if(w===B.Mirrored)return v.moveCtrlPoint(D,A.clone().multiplyScalar(2).sub(N),"c1"),t(),void 0;if(w===B.Asymmetric&&p===B.Disconnected){var u=G.clone().sub(A).length(),e=A.clone().sub(N).setLength(u).add(A);return v.moveCtrlPoint(D,e,"c1"),t(),void 0}}X._firePointChange(),W._interactor.fp("shapePointStatus",p,w)}}}},vi.prototype._handleDataChanged=function(a){var z=this;if(z.screenInfo&&z.target){var _=z._interactor;z.gatherSingleTarget(_.gv,z.target,!0),z.check(_.gv,null,a?_._getLogicalPoint(a):new Eh.Math.Vector2(_._lastClientPoint)),_._42()}},vi.prototype.gatherSingleTarget=function(g,B,R){var s,c,a=this;a.screenInfo&&a.screenInfo.curve&&(c=a.screenInfo.curve._curves);var I=a.editing;s=I?a.screenInfo:a.screenInfo={};var C,K,U=B instanceof e.Edge;U?(C=B.s("edge.segments"),K=B.s("edge.points")||new e.List):(C=B._58O,K=B._59O),s.S=C;var X,n=s.P=[],j=Eh.getDataMatrix(B);if(B instanceof e.Polyline&&(X=B.getElevation()||0,s.E=[]),K.each(function(h){s.E&&s.E.push(h.e||X),h=j.apply(h);var d=Eh.toScreenPosition(g,h);n.push(d.x,d.y)}),U){var A=Eh.toScreenPosition(g,B._lastSourcePoint),F=Eh.toScreenPosition(g,B._lastTargetPoint);n.splice(0,0,A.x,A.y),n.push(F.x,F.y)}if(!s.S||!s.S.size()){s.S=new e.List,s.S.add(1);for(var E=0;E<n.length/2-1;E++)s.S.add(2)}if((!I||R)&&a.convertToCubicBezier(c),a.activing&&(R||!a.editing||"realPoint"===a.editing.type)){var x=s.curve.findPairs(a.activing.point);a.activing.pairs=x}U&&"points"!==B.s("edge.type")&&a._writeToHt()},vi.prototype._convertToNewPoint=function(g,u,T){var l,D,n;for(l=0,D=u.length;D>l;l++){if(n=u[l],n._p1.isNearEnough(g))return n._p1;if(n._p4.isNearEnough(g))return n._p4}if(T)for(l=0,D=Math.min(T.length,D);D>l;l++){if(n=T[l],n._p1===g)return u[l]._p1;if(n._p4===g)return u[l]._p4}},vi.prototype.convertToCubicBezier=function(S){var q,R,b=this,f=new Eh.Math.Curve,J=b.screenInfo;if(f.createFromHtShape(J.P,J.S,J.E),J.curve=f,b.activing){var X=f._curves;if(q=b.activing.point,R=b._convertToNewPoint(q,X,S),R&&(b.activing.point=R),b.activing.selections){var c=-1,o=b.activing.selections;o.forEach(function(Y){c++,R=b._convertToNewPoint(Y,X,S),R&&(o[c]=R)})}}},vi.prototype.check=function(y,r,h){if(!r||e.Default.isLeftButton(r)){var E=this;if(E._interactor.setCursor("default"),E.editing=null,E.highlight=null,E.tipInfo=null,E.screenInfo){if(kh())return E._interactor._42(),!0;if(E._checkEditCtrlPoint(h))return E._interactor._42(),!0;if(E._checkEditRealPoint(h))return E._interactor._42(),!0;if(E._checkEditElevation(h))return E._interactor._42(),!0;var G=E.screenInfo.curve,H=G.checkPoint(h,E._interactor.getStyle("curveIntersectSize"));if(H){var K=E.highlight={};K.type="insertKnot",K.bezier=H.bezier,K.point=H.intersection}return E._interactor._42(),!0}}},vi.prototype._checkEditRealPoint=function(Q){var l,m,k,Y,A,u,V=this,d=V.screenInfo.curve._curves,r=V._interactor.getStyle("curvePointIntersectSize"),T=1/0;for(r*=r,k=0,Y=d.length;Y>k;k++)l=d[k],A=l._p1,u=Q.distanceToSquared(A),T>u&&(T=u,m=A),A=l._p4,u=Q.distanceToSquared(A),T>u&&(T=u,m=A);if(T>r)return!1;var N=V.highlight={};return N.type="changeRealPoint",N.point=m,V.editing={type:"realPoint",point:m,shiftGuide:{point:m.clone(),dir:"x",limit:0}},V._interactor.setCursor("crosshair"),!0},vi.prototype._checkEditElevation=function(c){var Y=this;if(!Y._interactor.getStyle("curveElevationVisible"))return!1;var T=Y.activing;if(!T)return!1;var P=T.getCurrentEditingPoint();if(!P)return!1;var F=Y._interactor,D=F.getStyle("curveElevationGuideShift"),j=F.getStyle("curveElevationIntersectSize"),q=c.distanceToSquared({x:P.x+D[0],y:P.y+D[1]});if(!(q>j*j)){var k=Y.highlight={};k.type="elevation";var _=new Eh.Math.Vector2(c.x,c.y,P.e);return Y.editing={type:"elevation",startPoint:_},Y._interactor.setCursor("crosshair"),!0}},vi.prototype._checkEditCtrlPoint=function(t){var H=this;if(H.activing&&!H.activing.selections){var w=H.getCurrentSelectintStatus();if(w!==Eh.Curve.PointType.Straight){var g=H.activing.pairs;if(g){var b=H._interactor.getStyle("curvePointIntersectSize");b*=b;var o,O,T,d,N,s,Y,F,I,J=1/0;for(Y=0,I=g.length;I>Y;Y++)for(d=g[Y],F=0;2>F;F++)N=0===F?"c1":"c2",d[N]&&(s=t.distanceToSquared(d[N]),J>s&&(J=s,o=d,O=Y,T=N));if(J>b)return!1;H.activing.hlpair=o,H.activing.hltype=T;var a=H.highlight={};return a.type="changeCtrlPoint",a.point=o[T],H.editing={type:"ctrlPoint",pair:o,pairId:O,ctrlType:T,direction:o[T].clone().sub(H.activing.point).normalize()},H._interactor.setCursor("crosshair"),!0}}}},vi.prototype.startEdit=function(Y,h){Y.startDragging(h);var O=this;O.highlight&&"insertKnot"===O.highlight.type&&(O.insertKnot(),O.gatherSingleTarget(O._interactor.gv,O.target),O.activing=null,O._checkEditRealPoint(O._interactor._getLogicalPoint(h)));var A=O._activing;if(A){var G=O.editing?O.editing.type:null;"ctrlPoint"===G?A.editingCtrl={pairId:O.editing.pairId,type:A.hltype}:"realPoint"===G&&(A.editingCtrl=!1)}var $=O.highlight,E=e.Default.isCtrlDown(h);if(!$||kh()){var Q=O._interactor.gv;if(!Q.setFocus(h)||Q._scrolling)return;return Q.isPannable()&&Wr(h)&&!E&&(O._pan={tx:Q.tx(),ty:Q.ty()},Y.fi({kind:"beginPan",event:h})),void 0}if("changeRealPoint"===$.type){var x,d=O.activing?O.activing.point:null,n=O.activing?O.activing.selections:null;if(E&&O.activing)d===$.point?(n?(O.activing={point:n[0]},n.length>1&&(n.splice(0,1),O.activing.selections=n)):O.activing=null,O.editing=null):n&&(x=n.indexOf($.point))>=0?(n.length>1?n.splice(x,1):delete O.activing.selections,O.editing=null):n?(n.push(d),O.activing={point:$.point,selections:n}):O.activing={point:$.point,selections:[d]};else if(n)d===$.point||((x=n.indexOf($.point))>=0?(n.splice(x,1,d),O.activing={point:$.point,selections:n}):O.activing={point:$.point});else{var V;d===$.point&&(V=O.activing.status),O.activing={point:$.point},V&&(O.activing.status=V)}Y.fi({kind:"beginEditPoint",event:h})}},vi.prototype.insertKnot=function(){var P=this,A=P.highlight,d=P.screenInfo.curve;d.insertKnot(A.bezier,A.point.t),P._writeToHt()},vi.prototype._writeToHt=function(){var N,x,v,S,W=this,B=W.screenInfo.curve,Y=B.toHtShape(),Q=Y.points,R=[],f=Y.segments,c=W._interactor.gv,V=W.target,$=V instanceof e.Edge,s=Eh.getDataMatrix(V).invert();S=V instanceof e.Polyline,S&&(v=V.getElevation());for(var z=0,A=Q.length;A>z;z++)N=Q[z],x=Eh.toWorldPosition(c,N),x=s.apply(x),N.e!=L&&N.e!==v&&(x.e=N.e),R.push(x);
if(V._writing=!0,$){V.s("edge.type","points"),V.setStyle("edge.segments",f),V.setStyle("edge.points",R.slice(1,R.length-1)),V.setStyle("edge.source.offset.x",0),V.setStyle("edge.source.offset.y",0),V.setStyle("edge.target.offset.x",0),V.setStyle("edge.target.offset.y",0);var q=W._nextChangeEdgeHost;delete W._nextChangeEdgeHost,q&&("source"===q.type?V.setSource(q.host):V.setTarget(q.host)),W._writeEdgeHostAnchor("source",R[0]),W._writeEdgeHostAnchor("target",R[R.length-1])}else R.length?(V.setSegments(f),V.setPoints(R,!0)):V.removeFromDataModel();delete V._writing},vi.prototype._writeEdgeHostAnchor=function(N,t){var s=this,u=s.target,i=s._calcHostAnchor(u,N,t);u.s("edge."+N+".anchor.x",i.x),u.s("edge."+N+".anchor.y",i.y)},vi.prototype._calcHostAnchor=function(O,B,E,v){v||(v="source"===B?O.getSource():O.getTarget());var y=v.getRotation(),W=v.getAnchor(),z=this._interactor.gv;if(yk(v,z)&&(y=0),y){var o=v.getMatrix(),Q=o.tfi(E),q=v.getSize();return{x:Q.x/q.width+W.x,y:Q.y/q.height+W.y}}var t=Bd(z,v),f={x:(E.x-t.x)/t.width,y:(E.y-t.y)/t.height};return f},vi.prototype._handlePanning=function(G){var e=this,N=e._pan;if(N){N.started=!0;var O=e._interactor,h=O.gv,U=O._lastClientPoint,M=Eq(G);h.setTranslate(N.tx+M.x-U.x,N.ty+M.y-U.y),e.gatherSingleTarget(O.gv,e.target),O._42(),O.fi({kind:"betweenPan",event:G})}},vi.prototype.handleEdit=function(G,i){var k=this,H=k.editing;if(k._pan)return k._handlePanning(i),void 0;if(H){H.inEdit=!0;var u,N,j,D=k._interactor._getLogicalPoint(i),s=e.Default.isCtrlDown(i),l=e.Default.isShiftDown(i),J=H.type,U=k.activing;if(k._guideInfo=null,"ctrlPoint"===J&&l){var V=k.editing.direction.clone();u=U.point;var $=V.dot(D.clone().sub(u));D=V.setLength($).add(u)}else if("ctrlPoint"===J||"realPoint"===J){var V;if("realPoint"===J&&l){var g=k.editing.shiftGuide;N=g.point;var d=Math.abs(D.x-N.x),R=Math.abs(D.y-N.y);d>R&&d>g.limit&&"y"===g.dir&&(g.dir="x"),R>d&&R>g.limit&&"x"===g.dir&&(g.dir="y"),V=g.dir,"x"===V?(D.y=N.y,g.limit=Math.max(g.limit,d)):"y"===V&&(D.x=N.x,g.limit=Math.max(g.limit,R))}var I=k._isEditEdgeSourceTarget();if(I){var W=k._editEdgeSourceTarget(I,D,s);W&&(j=W.tipText)}else if(!s){var E=k._guidingToEdit(D,V),x="realPoint"===J?k._interactor.gridGuide.findClosest(D,V,!0):null,t=1/0,n=1/0;x&&(x.x&&(t=x.x),x.y&&(n=x.y));var P=!1;E&&(E.xList&&(Math.abs(E.x)<=Math.abs(t)?(P=!0,t=E.x):delete E.xList),E.yList&&(Math.abs(E.y)<=Math.abs(n)?(P=!0,n=E.y):delete E.yList),P&&(k._guideInfo=E)),isFinite(t)&&(D.x+=t),isFinite(n)&&(D.y+=n),P&&(E.v=D)}}var K=k.screenInfo.curve;if("realPoint"===H.type){u=H.point,u.e!==L&&(D.e=u.e),K.moveRealPoint(u,D),H.point=D,k.highlight.point=D;var p=U.status,o=U.selections;if(k.activing={point:D,status:p},o){var Z=D.clone().sub(u),r=0;o.forEach(function(l){var U=l.clone().add(Z);K.moveRealPoint(l,U),o[r++]=U}),k.activing.selections=o}}else if("ctrlPoint"===H.type){var a=U.pairs,M=a[H.pairId];K.moveCtrlPoint(M,D,H.ctrlType);var q=U.status,c=Eh.Curve.PointType;if((q===c.Mirrored||q===c.Asymmetric)&&M.c1&&M.c2){var u=new Eh.Math.Vector2(U.point),O="c1"===H.ctrlType?"c2":"c1";if(q===Eh.Curve.PointType.Mirrored)K.moveCtrlPoint(M,u.clone().multiplyScalar(2).sub(D),O);else if(q===c.Asymmetric){var $=M[O].clone().sub(u).length(),v=u.clone().sub(M[H.ctrlType]).setLength($).add(u);isNaN(v.x)||K.moveCtrlPoint(M,v,O)}}U._firePointChange()}else if("elevation"===H.type){N=H.startPoint;var A=N.e+(N.y-D.y)/G._zoom;k._setCurrentPointImpl("e",A),U._firePointChange(),j="E: "+Eh.toFixed(A)}var S=e.Default.getLogicalPoint(i,k._interactor._canvas);if(S.x+=Eh.Icons.TipShiftX,S.y+=Eh.Icons.TipShiftY,!j){var F=Eh.toWorldPosition(G,D);j=""+Eh.toFixed(F.x)+", "+Eh.toFixed(F.y)}k.tipInfo={helperPos:S,text:j,size:j.length},k._writeToHt(),k._interactor.fi({kind:"betweenEditPoint",event:i})}},vi.prototype._setCurrentPointImpl=function(T,R){var e=this,S=e._activing;if(!S)return!1;var u=e.target;if(!u)return!1;var J=S.getCurrentEditingPoint();if(!J)return!1;var F=S.editingCtrl;if(!F)var c=J.clone();if("e"===T)J.e=R;else{var d;if("x"===T||"y"===T){var X=S._lastFirePoint;d="x"===T?{x:R,y:X?X.y:0}:{x:X?X.x:0,y:R}}else"object"==typeof T?(d=T,T.e!==L&&(J.e=T.e)):(d={x:arguments[0],y:arguments[1]},arguments[2]!==L&&(J.e=arguments[2]));var a=Eh.getDataMatrix(u);d=Eh.toScreenPosition(e._interactor.gv,a.apply(d)),J.x=d.x,J.y=d.y}if(!F){var H=c.multiplyScalar(-1).add(J);J.e&&c.e&&(H.e=J.e-c.e),e.screenInfo.curve.moveCtrlDueToRealPointMovement(J,H)}return!0},vi.prototype.setCurrentPoint=function(Z,x){return this._setCurrentPointImpl(Z,x)?(this._writeToHt(),!0):!1},vi.prototype._isEditEdgeSourceTarget=function(){var X=this,V=X.target;if(!(V instanceof e.Edge))return!1;var q=X.editing.point,d=X.screenInfo.curve._curves;return q===d[0]._p1?"source":q===d[d.length-1]._p4?"target":!1},vi.prototype._editEdgeSourceTarget=function(v,q,B){var d,z=this,T=z.target;if(d="source"===v?T.getSource():T.getTarget()){var G=z._interactor.gv,w=Eh.toWorldPosition(G,q),D=z._calcHostAnchor(T,v,w,d);if(!B){var _=z._interactor.getStyle("anchorRound"),o=z._interactor.getStyle("anchorSensitivity");D.x=Eh.roundTo(D.x,_,o),D.y=Eh.roundTo(D.y,_,o)}if(z._interactor.getStyle("edgeHostDetectPerFrame")||D.x<0||D.x>1||D.y<0||D.y>1){var t=G.getDataAt(w,function(t){return G.isSelectable(t)?Jl(t)?!0:!1:!1});if(t){var h=z._calcHostAnchor(T,v,w,t);d=t,z._nextChangeEdgeHost={type:v,host:t},D=h,B||(D.x=Eh.roundTo(D.x,_,o),D.y=Eh.roundTo(D.y,_,o))}}if(!B){var H=_h(G,d,0,0,0,D.x,D.y),e=Eh.toScreenPosition(G,H);q.x=e.x,q.y=e.y}return z._edgeHostGuideInfo=Eh.getTargetCornersOnScreen(G,d),{host:d,anchor:D,tipText:""+D.x.toFixed(2)+", "+D.y.toFixed(2)}}},vi.prototype._guidingToEdit=function(O,t){var e,z,I=this;if(e=I.screenInfo.curve){z=e._curves;var L,T,p,f,w,s,v,N,E=1/0,$=1/0,i=[];for(I.editing&&"realPoint"===I.editing.type&&(N=I.editing.point),w=0,s=2*z.length;s>w;w++)v=z[Math.floor(w/2)][w%2?"_p4":"_p1"],i.indexOf(v)>=0||(i.push(v),N&&N===v||(p=v.x-O.x,f=v.y-O.y,Math.abs(p)<Math.abs(E)?(E=p,L=[v]):p===E&&L.push(v),Math.abs(f)<Math.abs($)?($=f,T=[v]):f===$&&T.push(v)));var S=I._interactor.getStyle("smartGuideSensitivity");if((Math.abs(E)>S||"y"===t)&&(L=null),(Math.abs($)>S||"x"===t)&&(T=null),L||T){var r=!1,X={};if(L&&(r=!0,X.xList=L,X.x=E),T&&(r=!0,X.yList=T,X.y=$),r)return X}}},vi.prototype._46O=function(f){var j=this;j.editing&&(j.editing=null,j._interactor.fi({kind:"endEditPoint",event:f})),j._guideInfo=null,j._edgeHostGuideInfo=null,j._pan&&(j._pan=null,j._interactor.fi({kind:"endPan",event:f})),j.tipInfo=null},vi.prototype._canDeletePoint=function(R,w){var L=this.target;if(!(L instanceof e.Edge))return!0;var S=R._curves[0],q=R._curves[R._curves.length-1];return S._p1===w||q._p4===w?!1:!0},vi.prototype.handleDelete=function(){var x=this;if(x.activing&&x.screenInfo){var E=e.Default.isShiftDown(),u=x.screenInfo.curve;x._canDeletePoint(u,x.activing.point)&&u.deleteRealPoint(x.activing.point,E),x.activing.selections&&x.activing.selections.forEach(function(t){x._canDeletePoint(u,t)&&u.deleteRealPoint(t,E)}),x.activing=null,delete x.editing,delete x.tipInfo,delete x._pan,x._writeToHt(),x._interactor.fp("deleteShapePoint",!1,!0)}},vi.prototype.handleDoubleClick=function(Z){var B=this,M=B._interactor._getLogicalPoint(Z);if(B.screenInfo&&B._checkEditRealPoint(M)){var L=B.getCurrentSelectintStatus(),y=Eh.Curve.PointType;return L=L===y.Mirrored?y.Straight:y.Mirrored,B.setCurrentSelectionStatus(L),B._interactor._42(),!0}},vi.prototype._drawHighlight=function(i){var M=this,a=M.highlight;if(a){var v=a.bezier,t=M._interactor;v&&Eh.Icons.DrawIcon(t,i,Eh.Icons.ShapeHighlightCurve,[v._p1.x,v._p1.y,v._p2.x,v._p2.y,v._p3.x,v._p3.y,v._p4.x,v._p4.y]);var G=a.point;G&&"insertKnot"===a.type&&Eh.Icons.DrawIcon(t,i,Eh.Icons.ShapeHighlighPoint,G)}},vi.prototype._drawGuide=function(y){var N=this,o=N._guideInfo;if(o){var X,e,v,r,M=o.v;for(X=0;2>X;X++)if(r=0===X?o.xList:o.yList)for(e=0,v=r.length;v>e;e++)Eh.Icons.DrawIcon(N._interactor,y,Eh.Icons.ShapeGuideLine,[M.x,M.y,r[e].x,r[e].y])}},vi.prototype._drawCurrentPoint=function(w){var j=this;if(j.activing){var K=j.activing,f=j.getCurrentSelectintStatus(),B=j._interactor;if(f!==Eh.Curve.PointType.Straight){var M=K.pairs;K.hlpair,K.hltype;var c=K.selections,E=K.editingCtrl;if(M&&!c){var N,D,J;for(D=0,J=M.length;J>D;D++)N=M[D],E&&D===E.pairId&&N[E.type]?Eh.Icons.DrawIcon(B,w,Eh.Icons.ShapeActivingCtrl,{point:N.point,c1:N.c1,c2:N.c2,hl:E.type}):Eh.Icons.DrawIcon(B,w,Eh.Icons.ShapeActivingCtrl,N)}}Eh.Icons.DrawIcon(B,w,Eh.Icons.ShapeHighlighRealPoint,j.activing.point),c&&c.forEach(function(O){Eh.Icons.DrawIcon(B,w,Eh.Icons.ShapeHighlighRealPoint,O)})}},vi.prototype.clear=function(){var b=this;b.editing=null,b._guideInfo=null,b.activing=null,b.highlight=null},vi.prototype._42=function(X){var _=this;_.info={},_.editing||(_.screenInfo=null);var L=_._interactor;if(!L.editDetail)return _.clear(),void 0;if(!_.target||!_._interactor.gv.isSelected(_.target)||!_._interactor.gv.isVisible(_.target))return L.editDetail=!1,_.clear(),void 0;if(_.gatherSingleTarget(L.gv,_.target),Eh.Icons.DrawIcon(L,X,Eh.Icons.ShapeBgCurve,_.screenInfo),_._drawHighlight(X),_._drawCurrentPoint(X),_._getRealPoint().forEach(function(r){Eh.Icons.DrawIcon(L,X,Eh.Icons.ShapePoint,r)}),_._drawGuide(X),_.tipInfo&&Eh.Icons.DrawIcon(L,X,Eh.Icons.TipHelper,_.tipInfo),_._edgeHostGuideInfo&&Eh.Icons.DrawIcon(L,X,Eh.Icons.NodeHoverGuide,_._edgeHostGuideInfo),_._interactor.getStyle("curveElevationVisible")&&_.target instanceof e.Polyline&&_.activing){var Z=_.activing.getCurrentEditingPoint();Z&&Eh.Icons.DrawIcon(L,X,Eh.Icons.EdgeElevationGuide,Z)}},vi.prototype._getRealPoint=function(){var p=this.screenInfo,B=p.P,q=p.S,m=-1,J=[];return q.each(function(u){var $=1;if(3===u)$=2;else if(4===u)$=3;else if(5===u)return;m+=$,J.push({x:B[2*m],y:B[2*m+1]})}),J};var Ib=Eh.MoveHelper=function(P){var r=this;r.catalog="Move",r._interactor=P};Ib.prototype={},Ib.prototype.constructor=Ib,Ib.prototype.calcShift=function(r,T,g){var l,Y,j=this,t=j._interactor.gv,s=t.lp(T);if("beginMove"===r&&j._gatherGridInfo(g._lastLogicalPoint||s),l=j._target){var n=l.downPosition;if(n){var h=j._interactor.getStyle("moveSensitivity")/t._zoom;if(n.distanceTo(s)<h)return{x:0,y:0};delete l.downPosition}var G;Y=e.Default.isShiftDown(T),Y&&(s=j._dealShiftDown(s),G=l.shiftGuide.dir);var k,K=l.rawPos={x:l.pos.x+s.x-l.lp.x,y:l.pos.y+s.y-l.lp.y};if(e.Default.isCtrlDown(T)){if(k=j._calcShiftByAddon(),j._target.node instanceof Eh.Group){var A=j._target.node;A._position.x+=k.x,A._position.y+=k.y}return k}for(var I,P=l.x+K.x,o=l.y+K.y,v={x:P,y:o},Q={x:P+l.w/2,y:o+l.h/2},J={x:P+l.w,y:o+l.h},y=j._interactor.rectGuide,q=j._interactor.gridGuide,$=[y.findClosest(v,G),y.findClosest(Q,G),y.findClosest(J,G),q.findClosest(v,G),q.findClosest(Q,G),q.findClosest(J,G)],c=1/0,d=1/0,W=0,p=$.length;p>W;W++)I=$[W],I&&(P=I.x,o=I.y,isFinite(P)&&Math.abs(P)<Math.abs(c)&&(c=P),isFinite(o)&&Math.abs(o)<Math.abs(d)&&(d=o));if(isFinite(c)||(c=0),isFinite(d)||(d=0),k=j._calcShiftByAddon(c,d),j._target.node instanceof Eh.Group){var A=j._target.node;A._position.x+=k.x,A._position.y+=k.y}var w=l.node;if(!yk(w,t)){var u=K.x+c,N=K.y+d;j._interactor.rectGuide.gatherLines({node:w,x:l.x+u,y:l.y+N,w:l.w,h:l.h},G)}return k}},Ib.prototype._calcShiftByAddon=function(M,K){var R=this._target,N=R.rawPos,f=R.node.getPosition();return M=M||0,K=K||0,{x:N.x-f.x+M,y:N.y-f.y+K}},Ib.prototype._dealShiftDown=function(K){var B=this,Z=B._target.shiftGuide,o=B._target.lp,I=Math.abs(K.x-o.x),Q=Math.abs(K.y-o.y);I>Q&&I>Z.limit&&"y"===Z.dir&&(Z.dir="x"),Q>I&&Q>Z.limit&&"x"===Z.dir&&(Z.dir="y");var w=Z.dir;return"x"===w?(K.y=o.y,Z.limit=Math.max(Z.limit,I)):"y"===w&&(K.x=o.x,Z.limit=Math.max(Z.limit,Q)),K},Ib.prototype._gatherGridInfo=function(Z){var j,m=this,o=m._interactor,A=o._getValidSelection();if(1===A.length){if(j=A[0],!j.getRect)return m._target=null,void 0}else if(j=Eh.Group.findOrCreateGroup(A),!j)return m._target=null,void 0;var Y=j.getPosition(),q=j.getRect();m._target={node:j,x:q.x-Y.x,y:q.y-Y.y,w:q.width,h:q.height,lp:{x:Z.x,y:Z.y},pos:{x:Y.x,y:Y.y},shiftGuide:{dir:"x",limit:0},downPosition:new Eh.Math.Vector2(Z)},o.rectGuide.gatherRects()},Ib.prototype.clear=function(){var h=this;h._interactor.rectGuide.clear(),h._interactor._42()};var Nl="directional",ae="point",Sh="spot",fc="light.color",ss=function(k,h){Ui(h)&&Dr.test(h)?eb(k,h):Hj(h)&&h.modelType?Gh(k,h):We[k]=h},Ep=function(H){if(Hj(H))return H;var g=We[H];return H&&g===L&&Dr.test(H)&&(vh&&vh[H]||eb(H,H)),g};_r(V,{graph3dViewAttributes:j,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:m/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:Nk,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:m/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,setShape3dModel:ss,getShape3dModel:Ep,createMatrix:function(H,Q){ck(H)||(H=[H]);for(var A=H.length-1;A>=0;A--){var t=H[A];Q=jf(t.mat,t.s3,t.r3,t.rotationMode,t.t3,Q)}return Q},transformVec:function(g,W){return De(g,W)},createBoxModel:function(){return{vs:_d,ns:pi,uv:gg,is:Lf}},createRoundRectModel:function(d,m){return Qp.roundRect(d,m)},createStarModel:function(F,K){return Qp.star(F,K)},createRectModel:function(L,l){return Qp.rect(L,l)},createTriangleModel:function(D,n){return Qp.triangle(D,n)},createRightTriangleModel:function(v,A){return Qp.rightTriangle(v,A)},createParallelogramModel:function(E,m){return Qp.parallelogram(E,m)},createTrapezoidModel:function(m,w){return Qp.trapezoid(m,w)},createSmoothSphereModel:function(k,s,K,C,O,e,x){return fd(new bj(k,s,K,C,O,e,x))},createSphereModel:function(k,h,T,m,B,Z){return k?Si(k,h,T,m,B,Z):V.createSmoothSphereModel()},createSmoothConeModel:function(J,m,R,q,w){return Ud(J,m,R,q,w)},createConeModel:function(K,n,a,x,u,o){return K?Gi(K,n,a,x,u,o):Ud(o)},createSmoothCylinderModel:function(l,P,Z,b,F,d,M,i){return fd(new Xm(l,P,Z,b,F,d,M,i))},createCylinderModel:function(w,o,U,t,M,d,e){return w?jk(w,o,U,t,M,d,e):tg(d,e)},createSmoothTorusModel:function(E,y,w,o,l,G){return fd(new ii(E,y,w,o,l,G))},createTorusModel:function(P,S,o,Q,C,n,R){return P?fj(P,S,o,Q,C,n,R):ip(n,R)},createExtrusionModel:function(S,q,H,m,v,e,z,P){return Be(S,q,H,m,v,e,z,P)},createSmoothRingModel:function(s,Y,f,R,w,u){for(var G=[],T=0;T<s.length-1;T+=2)G.push({x:s[T],y:s[T+1]});for(s=eo(G,Y,f)[0],G=[],T=0;T<s.length;T++){var _=s[T];G.push(new zn(_.x,0,_.y))}return fd(new Un(G,u,R,w))},createTextGeometry:function(S,V){return fd(new Or(S,V))},loadFontFace:function(L,z){V.xhrLoad(L,function(D){if(!D)return z();var $;try{$=JSON.parse(D)}catch(b){$=JSON.parse(D.substring(65,D.length-2))}hf.loadFace($),z&&z($.familyName.toLowerCase())},z?null:{sync:!0})},getRotationFromMatrix4:function(S,c){var U=x,q=S[0],f=S[4],r=S[8],i=S[1],$=S[5],N=S[9],k=S[2],d=S[6],G=S[10];c=c||"xyz",c=c[2]+c[1]+c[0],c=c.toUpperCase();var D={};if("XYZ"===c)D._y=Math.asin(U(r,-1,1)),Math.abs(r)<.99999?(D._x=Math.atan2(-N,G),D._z=Math.atan2(-f,q)):(D._x=Math.atan2(d,$),D._z=0);else if("YXZ"===c)D._x=Math.asin(-U(N,-1,1)),Math.abs(N)<.99999?(D._y=Math.atan2(r,G),D._z=Math.atan2(i,$)):(D._y=Math.atan2(-k,q),D._z=0);else if("ZXY"===c)D._x=Math.asin(U(d,-1,1)),Math.abs(d)<.99999?(D._y=Math.atan2(-k,G),D._z=Math.atan2(-f,$)):(D._y=0,D._z=Math.atan2(i,q));else if("ZYX"===c)D._y=Math.asin(-U(k,-1,1)),Math.abs(k)<.99999?(D._x=Math.atan2(d,G),D._z=Math.atan2(i,q)):(D._x=0,D._z=Math.atan2(-f,$));else if("YZX"===c)D._z=Math.asin(U(i,-1,1)),Math.abs(i)<.99999?(D._x=Math.atan2(-N,$),D._y=Math.atan2(-k,q)):(D._x=0,D._y=Math.atan2(r,G));else{if("XZY"!==c)return null;D._z=Math.asin(-U(f,-1,1)),Math.abs(f)<.99999?(D._x=Math.atan2(d,$),D._y=Math.atan2(r,q)):(D._x=Math.atan2(-N,G),D._y=0)}return[D._x,D._y,D._z]},createRingModel:function(u,t,f,N,k,U,G,P,o,L){for(var R=[],n=0;n<u.length-1;n+=2)R.push({x:u[n],y:u[n+1]});U=U||V.shapeSide,G=G||0,P=P||U;var S,b,D,M,q,H,_,X,g,A,n,Z,F,T,c,d,l,Y,C=[],w=[],p=o?[]:j,E=o?[]:j,i=L?[]:j,Q=L?[]:j,x=N?[]:j,K=N?[]:j,m=k?[]:j,$=k?[]:j,u=eo(R,t,f),y=Tg(u),O=0,s=2*Math.PI/U;return u.forEach(function(z){if(D=z.length,D>1){if(M=z[0],N)for(H=M.x,X=M.y,n=G;P>n;n++)Z=n+1,F=n*s,T=Z*s,c=v(F),d=B(F),l=v(T),Y=B(T),x.push(c*H,X,-d*H,l*H,X,-Y*H,0,X,0),K.push(.5-.5*c,.5-.5*d,.5-.5*l,.5-.5*Y,.5,.5);for(A=0;D>A;A++){for(q=z[A],H=M.x,_=q.x,X=M.y,g=q.y,S=O/y,O+=aq(M,q),b=O/y,n=G;P>n;n++)Z=n+1,F=n*s,T=Z*s,c=v(F),d=B(F),l=v(T),Y=B(T),C.push(c*_,g,-d*_,l*_,g,-Y*_,c*H,X,-d*H,l*_,g,-Y*_,l*H,X,-Y*H,c*H,X,-d*H),w.push(n/U,b,Z/U,b,n/U,S,Z/U,b,Z/U,S,n/U,S),o&&n===G&&(p.push(0,X,0,0,g,0,c*_,g,-d*_,c*_,g,-d*_,c*H,X,-d*H,0,X,0),E.push(0,.5-X,0,.5-g,2*_,.5-g,2*_,.5-g,2*H,.5-X,0,.5-X)),L&&Z===P&&(i.push(0,X,0,l*_,g,-Y*_,0,g,0,l*_,g,-Y*_,0,X,0,l*H,X,-Y*H),Q.push(1,.5-X,1-2*_,.5-g,1,.5-g,1-2*_,.5-g,1,.5-X,1-2*H,.5-X));M=q}if(k)for(H=M.x,X=M.y,n=G;P>n;n++)Z=n+1,F=n*s,T=Z*s,c=v(F),d=B(F),l=v(T),Y=B(T),m.push(l*H,X,-Y*H,c*H,X,-d*H,0,X,0),$.push(.5-.5*l,.5+.5*Y,.5-.5*c,.5+.5*d,.5,.5)}}),{vs:C,uv:w,bottom_vs:m,bottom_uv:$,top_vs:x,top_uv:K,from_vs:p,from_uv:E,to_vs:i,to_uv:Q}}},!0),_r(I,{"3d.move.mode":L,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":L,"edge.gradient.color":L,"edge.source.t3":L,"edge.target.t3":L,"light.type":ae,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":m/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":Vm,"wf.short":!1,"wf.mat":L,"wf.geometry":!1,batch:L,"transparent.mask":!1,brightness:L,"select.brightness":.7,"repeat.uv.length":L,alphaTest:.4,"label.face":ze,"label.t3":L,"label.r3":L,"label.texture.scale":2,"label.rotationMode":wq,"label.light":!1,"label.blend":L,"label.reverse.flip":!1,"label.reverse.color":Kk,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":ze,"label2.t3":L,"label2.r3":L,"label2.texture.scale":2,"label2.rotationMode":wq,"label2.light":!1,"label2.blend":L,"label2.reverse.flip":!1,"label2.reverse.color":Kk,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":ze,"note.t3":L,"note.r3":L,"note.texture.scale":2,"note.rotationMode":wq,"note.light":!1,"note.blend":L,"note.reverse.flip":!1,"note.reverse.color":Kk,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":ze,"note2.t3":L,"note2.r3":L,"note2.texture.scale":2,"note2.rotationMode":wq,"note2.light":!1,"note2.blend":L,"note2.reverse.flip":!1,"note2.reverse.color":Kk,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:L,"shape3d.color":Xq,"shape3d.top.color":L,"shape3d.bottom.color":L,"shape3d.from.color":L,"shape3d.to.color":L,"shape3d.image":L,"shape3d.top.image":L,"shape3d.bottom.image":L,"shape3d.from.image":L,"shape3d.to.image":L,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":L,"shape3d.side.to":L,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":L,"shape3d.opacity":L,"shape3d.reverse.flip":!1,"shape3d.reverse.color":Kk,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":L,"shape3d.uv.scale":L,"shape3d.top.uv.offset":L,"shape3d.top.uv.scale":L,"shape3d.bottom.uv.offset":L,"shape3d.bottom.uv.scale":L,"shape3d.from.uv.offset":L,"shape3d.from.uv.scale":L,"shape3d.to.uv.offset":L,"shape3d.to.uv.scale":L,"shape3d.top.cap":L,"shape3d.bottom.cap":L,"shape3d.start.angle":0,"shape3d.sweep.angle":h,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":L,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"all.light":!0,"all.visible":!0,"all.color":Xq,"all.image":L,"all.blend":L,"all.opacity":L,"all.reverse.flip":!1,"all.reverse.color":Kk,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":L,"all.uv.offset":L,"all.uv.scale":L,"all.discard.selectable":!0,mat:L,"left.mat":L,"right.mat":L,"top.mat":L,"bottom.mat":L,"front.mat":L,"back.mat":L},!0);var Cs,ln=!1,Rq=[0,0,0,0],rk={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:ie,2:yh,3:ni,4:ys,5:ze,6:kc}},Zj=function(X,Y,G,e){if(Y.getFaceVisible(X,G)){hk(Y,Hf(X,Y.getFaceMat(X,G)||Y.getMat(X)));var l=Y._26I;Y.getFaceReverseCull(X,G)?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),Mr(l,Y._prg.uFixPickReverseColor,rk[G]),Md(l),vp(l,e,6),hb(l),Jn(Y)}},Qd=function(u){return u instanceof Qi},Zf=function(c){return[c.x,c.e||0,c.y]},Xc=function(O,U,k){for(var U=Nq(U),x=U[0],F=U[1],R=U[2];k--;)O.push(x,F,R)},Sf=function(w,z,q){for(var z=Nq(z),U=z[0],l=z[1],T=z[2],W=z[3];q--;)w.push(U,l,T,W)},Ko=function(F,n,Q){if(n)for(var b,E,u,J=n[0],y=n[1],g=n[2],q=n[4],o=n[5],I=n[6],H=n[8],i=n[9],x=n[10],A=n[12],m=n[13],j=n[14],W=Q.length,M=0,M=0;W>M;M+=3)b=Q[M],E=Q[M+1],u=Q[M+2],F.push(J*b+q*E+H*u+A,y*b+o*E+i*u+m,g*b+I*E+x*u+j);else zr(F,Q)},mg=function(u,b){var n=b.s("light.intensity"),z=Nq(b.s(fc)),h=z[0],Y=z[1],I=z[2];1!==n&&(h*=n,Y*=n,I*=n),u.push(h,Y,I,b.s("light.disabled")?1:0)},md=function($,G,L){Mr(G,L.uHeadlightRange,$._headlightRange);var b=$._headlightIntensity,w=Nq($._headlightColor);1!==b&&(w=[w[0]*b,w[1]*b,w[2]*b]),Mr(G,L.uHeadlightColor,[w[0],w[1],w[2],$._headlightDisabled?1:0]);var P=$._59O,m=$._spots,W=$._dirs;if(P.length){var g=[],o=[],d=[];P.forEach(function(n){mg(g,n),zr(o,$._transformPointToViewSpace(n.p3())),d.push(n.s("light.range"))}),G.uniform4fv(L.uPointColor,g),G.uniform1fv(L.uPointRange,d),G.uniform3fv(L.uPointPosition,o)}if(m.length){var l=[],z=[],D=[],t=[],H=[],Z=[];m.forEach(function(E){mg(l,E),zr(z,$._transformPointToViewSpace(E.p3())),zr(H,$._transformDirectionToViewSpace(E.p3(),E.s("light.center"))),D.push(E.s("light.range")),t.push(v(E.s("light.angle")/2)),Z.push(E.s("light.exponent"))}),G.uniform4fv(L.uSpotColor,l),G.uniform1fv(L.uSpotRange,D),G.uniform1fv(L.uSpotAngle,t),G.uniform1fv(L.uSpotExponent,Z),G.uniform3fv(L.uSpotPosition,z),G.uniform3fv(L.uSpotDirection,H)}if(W.length){var C=[],y=[];W.forEach(function(b){mg(C,b),zr(y,$._transformDirectionToViewSpace(b.p3()))}),G.uniform4fv(L.uDirColor,C),G.uniform3fv(L.uDirDirection,y)}},qi=function(M){return M>0&&0===(M-1&M)},Gm=function(o){return o=Y(0,K(m,o)),o=Y(Ug,K(m-Ug,o))},Fc=function(){return.05+C()/2},Qf=function(R,Z,t,$){var T,p=R.getEye();return R.isOrtho()?(T=wr(R.getCenter(),p),T[0]+=$[0],T[1]+=$[1],T[2]+=$[2]):T=p,fk(Z,t,$,T)},fk=function(C,S,f,K){var x=Fe(C,S),I=wr(K,f,!0),w=Fe(I,S);if(r(w)<Ug)return j;var A=(x-Fe(f,S))/w;return[f[0]+I[0]*A,f[1]+I[1]*A,f[2]+I[2]*A]},km=function(P,t){return{x:2*P.x-t.x,y:2*P.y-t.y}},cl=function(T,K,V,k){var N,J;if(!T)return N=H(K.y-V.y,V.x-K.x),{x:K.x+k*B(N),y:K.y+k*v(N)};if(!V)return N=H(T.y-K.y,K.x-T.x),{x:K.x+k*B(N),y:K.y+k*v(N)};var R=wr([T.x,T.y,0],[K.x,K.y,0],!0),o=wr([V.x,V.y,0],[K.x,K.y,0],!0),$=-(R[0]+o[0])/2,c=-(R[1]+o[1])/2,E=n($*$+c*c);if(Ug>E)return N=H(T.y-K.y,K.x-T.x),{x:K.x+k*B(N),y:K.y+k*v(N)};var Z=T.x-K.x,w=T.y-K.y,F=V.x-K.x,q=V.y-K.y,r=n(Z*Z+w*w),O=n(F*F+q*q);N=Q(Fe(R,o))/2,J=R[1]*o[0]-R[0]*o[1]>0?-1:1,$/=E,c/=E;var p=k/B(N),d=Y(r,O)/v(N);E=Math.min(p,d);var U={x:K.x+J*E*$,y:K.y+J*E*c};return V.b&&p>O/v(N)&&(U.adjust=!0),U},ei=function(E){var $=E[1],K=E[2],G=E[3],_=E[6],I=E[7],e=E[11];E[1]=E[4],E[2]=E[8],E[3]=E[12],E[4]=$,E[6]=E[9],E[7]=E[13],E[8]=K,E[9]=_,E[11]=E[14],E[12]=G,E[13]=I,E[14]=e},wf=function(s){var h=s[0],X=s[1],E=s[2],i=s[3],P=s[4],M=s[5],L=s[6],c=s[7],Y=s[8],f=s[9],Q=s[10],w=s[11],O=s[12],n=s[13],C=s[14],o=s[15],T=h*M-X*P,b=h*L-E*P,N=h*c-i*P,V=X*L-E*M,u=X*c-i*M,$=E*c-i*L,x=Y*n-f*O,B=Y*C-Q*O,_=Y*o-w*O,m=f*C-Q*n,Z=f*o-w*n,l=Q*o-w*C,I=T*l-b*Z+N*m+V*_-u*B+$*x;return I?(I=1/I,s[0]=(M*l-L*Z+c*m)*I,s[1]=(E*Z-X*l-i*m)*I,s[2]=(n*$-C*u+o*V)*I,s[3]=(Q*u-f*$-w*V)*I,s[4]=(L*_-P*l-c*B)*I,s[5]=(h*l-E*_+i*B)*I,s[6]=(C*N-O*$-o*b)*I,s[7]=(Y*$-Q*N+w*b)*I,s[8]=(P*Z-M*_+c*x)*I,s[9]=(X*_-h*Z-i*x)*I,s[10]=(O*u-n*N+o*T)*I,s[11]=(f*N-Y*u-w*T)*I,s[12]=(M*B-P*m-L*x)*I,s[13]=(h*m-X*B+E*x)*I,s[14]=(n*b-O*V-C*T)*I,s[15]=(Y*V-f*b+Q*T)*I,void 0):j},ms=function(e,T){if(T){var r=T[0],C=T[1],h=T[2];e[12]=e[0]*r+e[4]*C+e[8]*h+e[12],e[13]=e[1]*r+e[5]*C+e[9]*h+e[13],e[14]=e[2]*r+e[6]*C+e[10]*h+e[14],e[15]=e[3]*r+e[7]*C+e[11]*h+e[15]}},wm=function(V,t){if(t){var a=t[0],Y=t[1],g=t[2];V[0]=V[0]*a,V[1]=V[1]*a,V[2]=V[2]*a,V[3]=V[3]*a,V[4]=V[4]*Y,V[5]=V[5]*Y,V[6]=V[6]*Y,V[7]=V[7]*Y,V[8]=V[8]*g,V[9]=V[9]*g,V[10]=V[10]*g,V[11]=V[11]*g}},bf=function(d,S,w){var f=S[0],x=S[1],Z=S[2],c=S[3],n=S[4],J=S[5],W=S[6],E=S[7],T=S[8],F=S[9],A=S[10],u=S[11],M=S[12],e=S[13],p=S[14],z=S[15],P=w[0],Y=w[1],G=w[2],h=w[3];return d[0]=P*f+Y*n+G*T+h*M,d[1]=P*x+Y*J+G*F+h*e,d[2]=P*Z+Y*W+G*A+h*p,d[3]=P*c+Y*E+G*u+h*z,P=w[4],Y=w[5],G=w[6],h=w[7],d[4]=P*f+Y*n+G*T+h*M,d[5]=P*x+Y*J+G*F+h*e,d[6]=P*Z+Y*W+G*A+h*p,d[7]=P*c+Y*E+G*u+h*z,P=w[8],Y=w[9],G=w[10],h=w[11],d[8]=P*f+Y*n+G*T+h*M,d[9]=P*x+Y*J+G*F+h*e,d[10]=P*Z+Y*W+G*A+h*p,d[11]=P*c+Y*E+G*u+h*z,P=w[12],Y=w[13],G=w[14],h=w[15],d[12]=P*f+Y*n+G*T+h*M,d[13]=P*x+Y*J+G*F+h*e,d[14]=P*Z+Y*W+G*A+h*p,d[15]=P*c+Y*E+G*u+h*z,d},Hd=function(w,L,o,A){var i,J,Z,O,g,P,$,a,l,D,s=L[0],N=L[1],j=L[2],Y=A[0],R=A[1],c=A[2],C=o[0],k=o[1],x=o[2];return r(s-C)<Ug&&r(N-k)<Ug&&r(j-x)<Ug?xf(w):($=s-C,a=N-k,l=j-x,D=1/n($*$+a*a+l*l),$*=D,a*=D,l*=D,i=R*l-c*a,J=c*$-Y*l,Z=Y*a-R*$,D=n(i*i+J*J+Z*Z),D?(D=1/D,i*=D,J*=D,Z*=D):(i=0,J=0,Z=0),O=a*Z-l*J,g=l*i-$*Z,P=$*J-a*i,D=n(O*O+g*g+P*P),D?(D=1/D,O*=D,g*=D,P*=D):(O=0,g=0,P=0),w[0]=i,w[1]=O,w[2]=$,w[3]=0,w[4]=J,w[5]=g,w[6]=a,w[7]=0,w[8]=Z,w[9]=P,w[10]=l,w[11]=0,w[12]=-(i*s+J*N+Z*j),w[13]=-(O*s+g*N+P*j),w[14]=-($*s+a*N+l*j),w[15]=1,w)},_g=function(t,H,X,r,x){var y=1/F(H/2),D=1/(r-x);return t[0]=y/X,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=y,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(x+r)*D,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*x*r*D,t[15]=0,t},jj=function(T,x,I,c,U,M,G){var S=1/(x-I),A=1/(c-U),i=1/(M-G);return T[0]=-2*S,T[1]=0,T[2]=0,T[3]=0,T[4]=0,T[5]=-2*A,T[6]=0,T[7]=0,T[8]=0,T[9]=0,T[10]=2*i,T[11]=0,T[12]=(x+I)*S,T[13]=(U+c)*A,T[14]=(G+M)*i,T[15]=1,T},Sc=function(B,a){var j=a[0],J=a[1],b=a[2],X=a[3],T=j*j+J*J+b*b+X*X,V=T?1/T:0;return B[0]=-j*V,B[1]=-J*V,B[2]=-b*V,B[3]=X*V,B},hp=function(Q,C){var g=C[0]+C[5]+C[10],q=0;return g>0?(q=2*Math.sqrt(g+1),Q[3]=.25*q,Q[0]=(C[6]-C[9])/q,Q[1]=(C[8]-C[2])/q,Q[2]=(C[1]-C[4])/q):C[0]>C[5]&C[0]>C[10]?(q=2*Math.sqrt(1+C[0]-C[5]-C[10]),Q[3]=(C[6]-C[9])/q,Q[0]=.25*q,Q[1]=(C[1]+C[4])/q,Q[2]=(C[8]+C[2])/q):C[5]>C[10]?(q=2*Math.sqrt(1+C[5]-C[0]-C[10]),Q[3]=(C[8]-C[2])/q,Q[0]=(C[1]+C[4])/q,Q[1]=.25*q,Q[2]=(C[6]+C[9])/q):(q=2*Math.sqrt(1+C[10]-C[0]-C[5]),Q[3]=(C[1]-C[4])/q,Q[0]=(C[8]+C[2])/q,Q[1]=(C[6]+C[9])/q,Q[2]=.25*q),Q},cc=function(G,c,J){var P=c[0],B=c[1],g=c[2],z=c[3],h=P+P,t=B+B,v=g+g,r=P*h,j=P*t,Y=P*v,S=B*t,T=B*v,E=g*v,x=z*h,n=z*t,m=z*v;return G[0]=1-(S+E),G[1]=j+m,G[2]=Y-n,G[3]=0,G[4]=j-m,G[5]=1-(r+E),G[6]=T+x,G[7]=0,G[8]=Y+n,G[9]=T-x,G[10]=1-(r+S),G[11]=0,G[12]=J[0],G[13]=J[1],G[14]=J[2],G[15]=1,G},tj=V.getRotationFromMatrix4,dh=function(){var u=[0,0,0],B=[0,0,0],L=[0,0,0],C=function(q,S,X){q[0]=S[1]*X[2]-S[2]*X[1],q[1]=S[2]*X[0]-S[0]*X[2],q[2]=S[0]*X[1]-S[1]*X[0]},g=function(G){return G[0]*G[0]+G[1]*G[1]+G[2]*G[2]},l=function(a){var O=Math.sqrt(g(a));a[0]/=O,a[1]/=O,a[2]/=O},Y=function(O,k,z){O[0]=k[0]-z[0],O[1]=k[1]-z[1],O[2]=k[2]-z[2]};return function(V,W,G){var f=jo();return Y(L,V,W),0===g(L)&&(L[2]=1),l(L),C(u,G,L),0===g(u)&&(1===Math.abs(G[2])?L[0]+=1e-4:L[2]+=1e-4,l(L),C(u,G,L)),l(u),C(B,L,u),f[0]=u[0],f[4]=B[0],f[8]=L[0],f[1]=u[1],f[5]=B[1],f[9]=L[1],f[2]=u[2],f[6]=B[2],f[10]=L[2],f}}(),nc=function(T,r){return Hd(r?r:jo(),T._eye,T._center,T._up)},Aj=function(z){var x=z.getAspect(),P=z._near,o=z._far,S=jo();if(z._ortho){var E=z._orthoWidth/2,M=E/x;jj(S,-E,E,-M,M,P,o)}else _g(S,z._fovy,x,P,o);return S},hd=function(E,h){if(!E)return j;var v=0,p=1,D=2,W=[],K=0,S=E.length,z=S/3;if(h){for(;S>K;K++)W[K]=0;for(K=0;K<h.length;K+=3){var w=[],l=[],y=[];w[v]=E[3*h[K+1]+v]-E[3*h[K]+v],w[p]=E[3*h[K+1]+p]-E[3*h[K]+p],w[D]=E[3*h[K+1]+D]-E[3*h[K]+D],l[v]=E[3*h[K+2]+v]-E[3*h[K+1]+v],l[p]=E[3*h[K+2]+p]-E[3*h[K+1]+p],l[D]=E[3*h[K+2]+D]-E[3*h[K+1]+D],y[v]=w[p]*l[D]-w[D]*l[p],y[p]=w[D]*l[v]-w[v]*l[D],y[D]=w[v]*l[p]-w[p]*l[v];for(var x=0;3>x;x++)W[3*h[K+x]+v]+=y[v],W[3*h[K+x]+p]+=y[p],W[3*h[K+x]+D]+=y[D]}}else for(K=0;z>K;K+=3){var w=[],l=[],y=[];w[v]=E[3*(K+1)+v]-E[3*K+v],w[p]=E[3*(K+1)+p]-E[3*K+p],w[D]=E[3*(K+1)+D]-E[3*K+D],l[v]=E[3*(K+2)+v]-E[3*(K+1)+v],l[p]=E[3*(K+2)+p]-E[3*(K+1)+p],l[D]=E[3*(K+2)+D]-E[3*(K+1)+D],y[v]=w[p]*l[D]-w[D]*l[p],y[p]=w[D]*l[v]-w[v]*l[D],y[D]=w[v]*l[p]-w[p]*l[v];for(var x=0;3>x;x++)W[3*(K+x)+v]=y[v],W[3*(K+x)+p]=y[p],W[3*(K+x)+D]=y[D]}for(K=0;S>K;K+=3){var m=[];m[v]=W[K+v],m[p]=W[K+p],m[D]=W[K+D];var X=n(m[v]*m[v]+m[p]*m[p]+m[D]*m[D]);0===X&&(X=Ug),m[v]=m[v]/X,m[p]=m[p]/X,m[D]=m[D]/X,W[K+v]=m[v],W[K+p]=m[p],W[K+D]=m[D]}return new up(W)},wc=function(E,x,I,F){if(I||(I=E.createTexture()),x){var U=E.TEXTURE_2D,o=E.REPEAT,Q=E.CLAMP_TO_EDGE,Y=E.TEXTURE_MIN_FILTER;F!==E.NEAREST&&(F=E.LINEAR),_i(E,I),E.texImage2D(U,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,x),Do(E,E.TEXTURE_MAG_FILTER,F),qi(x.width)&&qi(x.height)&&!x.clampToEdge?(Do(E,E.TEXTURE_WRAP_S,o),Do(E,E.TEXTURE_WRAP_T,o),Do(E,Y,E.LINEAR_MIPMAP_LINEAR),E.generateMipmap(U)):(Do(E,E.TEXTURE_WRAP_S,Q),Do(E,E.TEXTURE_WRAP_T,Q),Do(E,Y,F)),_i(E,j)}return I},Lj=function(c,K){var Y=new Uint8Array(3);return K=K||c.createTexture(),_i(c,K),Do(c,c.TEXTURE_MIN_FILTER,c.LINEAR),c.texImage2D(c.TEXTURE_2D,0,c.RGB,1,1,0,c.RGB,c.UNSIGNED_BYTE,Y),K},xo=function(C){C._26I&&C._prg&&(C._26I.deleteProgram(C._prg),C._prg=j)},xj=function(M,t,E,z){var e=M.createShader(E);return M.shaderSource(e,z),M.compileShader(e),M.attachShader(t,e),e},kn=function(w){return w.createBuffer()},_i=function(F,z){F.bindTexture(F.TEXTURE_2D,z)},tl=function(F,a){F.bindFramebuffer(F.FRAMEBUFFER,a)},Do=function(c,U,X){c.texParameteri(c.TEXTURE_2D,U,X)},jr=function(U,J){if(J){var J=Nq(J);U.clearColor(J[0],J[1],J[2],J[3])}},Je=function(s,j){Mr(s,j.uFix,!0),oj(s,j.aNormal)},ol=function(i,S){Mr(i,S.uFix,!1),Yo(i,S.aNormal)},$b=function(S,m,z,L,q,t,e,V){S._picking||(z?(Mr(S,m.uBlend,!0),Mr(S,m.uBlendColor,z)):Mr(S,m.uBlend,!1),Mr(S,m.uLight,L==j?!0:L),Gc(q)&&1!==q&&Mr(S,m.uPartOpacity,q),Mr(S,m.uReverseFlip,t==j?!1:t),Mr(S,m.uFixPickReverseColor,e||Kk)),V?S.enable(S.CULL_FACE):S.disable(S.CULL_FACE)},Uq=function(E,W){E._picking||Mr(E,W.uPartOpacity,1)},Md=function(m,g,S,J,q,P,c,v,A){if(!S)return m.activeTexture(m.TEXTURE0),_i(m,m._emptyTexture),m.activeTexture(m.TEXTURE1),_i(m,m._emptyBlendTexture),void 0;Mr(m,g.uTexture,!0),Mr(m,g.uDiscardSelectable,bc(J)?J:!0),Yo(m,g.aUv),bm(m,q,P,g.aUv,2),A?(Mr(m,g.uBlendTexture,!0),m.activeTexture(m.TEXTURE1),_i(m,A),m.uniform1i(g.uBlendSampler,1)):(Mr(m,g.uBlendTexture,!1),m.activeTexture(m.TEXTURE1),_i(m,m._emptyBlendTexture)),m.activeTexture(m.TEXTURE0),_i(m,S),m.uniform1i(g.uSampler,0);var V=[0,0,1,1];c&&(V[0]=c[0],V[1]=c[1]),v&&(V[2]=v[0],V[3]=v[1]),Mr(m,g.uOffsetScale,V)},hb=function(M,S,L){M.activeTexture(M.TEXTURE0),_i(M,j),M.activeTexture(M.TEXTURE1),_i(M,j),L&&(oj(M,S.aUv),Mr(M,S.uTexture,!1),Mr(M,S.uBlendTexture,!1))},xp=function(w,b,C,$,l,j){!C||p||a||w.lineWidth(C),$&&!w._picking&&Mr(w,b.uFixPickReverseColor,$),l&&bm(w,l,j,b.aPosition)
},Rn=function(c,W,y,D){Cs&&(D=c[Cs]),c.drawArrays(D==j?c.TRIANGLES:D,W,y);var v=c._renderInfo;v&&(v.calls++,v.vertices+=y,(D==j||D===c.TRIANGLES)&&(v.faces+=y/3),D===c.LINES&&(v.lines+=y/2))},vp=function(M,N,a,D){Cs&&(D=M[Cs]),M.drawElements(D==j?M.TRIANGLES:D,a,M.UNSIGNED_SHORT,N==j?0:2*N);var g=M._renderInfo;g&&(g.calls++,g.vertices+=a,(D==j||D===M.TRIANGLES)&&(g.faces+=a/3),D===M.LINES&&(g.lines+=a/2))},xc=function(I,G,h,i,A){var J=I.ARRAY_BUFFER;I.bindBuffer(J,G),h&&I.bufferData(J,h,I.STATIC_DRAW),i!=j&&I.vertexAttribPointer(i,A?A:3,I.FLOAT,!1,0,0)},bm=function(k,S,I,Z,U){return I?(Rb(k,k.ARRAY_BUFFER,S,I),Z!=j&&k.vertexAttribPointer(Z,U?U:3,k.FLOAT,!1,0,0),void 0):xc(k,S,I,Z,U)},Fi=function(p,i,o){var v=p.ELEMENT_ARRAY_BUFFER;p.bindBuffer(v,i),o&&p.bufferData(v,o,p.STATIC_DRAW)},Fj=function(q,O,G){Rb(q,q.ELEMENT_ARRAY_BUFFER,O,G)},Rb=function(d,A,p,u){var p,Q=u.glBuf,J=d._id;Q&&(p=Q[J])&&p._buf?d.bindBuffer(A,p._buf):(p={_buf:kn(d)},d._bufPool.push(p),d.bindBuffer(A,p._buf),d.bufferData(A,u,d.STATIC_DRAW),Q||(Q=u.glBuf={}),Q[J]=p),p._fid=d._renderInfo.frame},Mr=function(r,t,Q){if(Q!=j&&t!=j){Q=Nq(Q);var v=Q.length;3===v?r.uniform3fv(t,Q):4===v?r.uniform4fv(t,Q):16===v?r.uniformMatrix4fv(t,!1,Q):bc(Q)?r.uniform1i(t,Q?1:0):2===v?r.uniform2fv(t,Q):r.uniform1f(t,Q)}},Yo=function(J,v){v!=j&&v>=0&&J.enableVertexAttribArray(v)},oj=function(H,m){m!=j&&m>=0&&H.disableVertexAttribArray(m)},Jn=function(o,T){var k=o.getGL(),t=o._prg;o._7O=o._8O.pop(),T&&(Mr(k,t.uMVMatrix,o._7O),o._6O=T,Mr(k,t.uNMatrix,T))},gd=function(N,x){return x||(x=jo()),$o(x,N),wf(x),ei(x),x},hk=function(K,U){var S=K.getGL(),M=K._prg,s=K._7O;U&&(K._8O.push(Yd(s)),bf(s,s,U)),Mr(S,M.uMVMatrix,s),Mr(S,M.uNMatrix,gd(s,K._6O))},ic=function(K,c,z,J,h,F){if(z){if(J){var e=z.value++,v=2147483648|e,a=[(255&v>>16)/255,(255&v>>8)/255,(255&v)/255,(255&v>>24)/255];z[e]={data:h,part:F}}else a=Rq;return Mr(K,c.uFixPickReverseColor,a),a}},le=function(){var B={center:function(k,i,_,L,q){var R=-i[1]/2,w={x:-i[0]/2,y:R,width:i[0],height:i[1]},h=kd(k,w,_);return[h.x+L,-h.y-q,Fc()]},front:function(X,G,q,$,u){var E=-G[1]/2,p={x:-G[0]/2,y:E,width:G[0],height:G[1]},k=kd(X,p,q);return[k.x+$,-k.y-u,G[2]/2+Fc()]},back:function(w,X,p,j,I){var l=-X[0]/2,M=-X[1]/2,B={x:l,y:M,width:X[0],height:X[1]},A=kd(w,B,p);return[-A.x-j,-A.y-I,-X[2]/2-Fc()]},left:function(C,i,X,_,R){var J=-i[1]/2,T={x:-i[2]/2,y:J,width:i[2],height:i[1]},Q=kd(C,T,X);return[-i[0]/2-Fc(),-Q.y-R,Q.x+_]},right:function(J,r,a,b,V){var P=-r[2]/2,o=-r[1]/2,y={x:P,y:o,width:r[2],height:r[1]},u=kd(J,y,a);return[r[0]/2+Fc(),-u.y-V,-u.x-b]},top:function(D,J,u,Q,f){var p={x:-J[0]/2,y:-J[2]/2,width:J[0],height:J[2]},z=kd(D,p,u);return[z.x+Q,J[1]/2+Fc(),z.y+f]},bottom:function(R,T,M,t,d){var l=-T[2]/2,o={x:-T[0]/2,y:l,width:T[0],height:T[2]},k=kd(R,o,M);return[k.x+t,-T[1]/2-Fc(),-k.y-d]}};return function(N,D,c,e,o,m){return B[e](N,D,c,o||0,m||0)}}(),hl=function(b,F,A,H,s,r,M,I,R,y){if(s&&(F[0]+=s[0],F[1]+=s[1],F[2]+=s[2]),ms(b,A),I){var S=jo();if(Ur(S,R,y),De(F,S),ms(b,F),b.auto=I,b.pos=De([0,0,0],b),r){var X=b.mat2=jo();Ur(X,r,M)}}else Ur(b,R,y),ms(b,F),H===ie?He(b,-P):H===yh?He(b,P):H===ni?yf(b,-P):H===ys?yf(b,P):H===kc&&He(b,m),Ur(b,r,M);return b},Um=function($,d){var c=d.auto,v=d.mat2,r=$.gv;if(c){var h,i=jo(),V=[0,0,0,0];h="string"==typeof c?[c.indexOf("x")<0?r._eye[0]:r._center[0],c.indexOf("y")<0?r._eye[1]:r._center[1],c.indexOf("z")<0?r._eye[2]:r._center[2]]:r._eye,hp(V,Hd(jo(),h,r._center,r._up)),cc(i,Sc(V,V),d.pos),v&&bf(i,i,v),hk(r,i)}else hk(r,d)},Zg=function(J,U,n,u,x){var q=J.s,K=J.gv,h=K.getGL(),j=K._prg,O=K._buffer,T=K._1O;wc(h,yb,T),Um(J,n),$b(h,j,q(U+".blend"),q(U+".light"),q(U+".opacity"),q(U+".reverse.flip"),q(U+".reverse.color"),q(U+".reverse.cull")),Md(h,j,T,x,O.uv,_k),bm(h,O.vs,u,j.aPosition),bm(h,O.ns,Io,j.aNormal),Fj(h,O.is,Eb),vp(h,0,Eb.length),hb(h,j,T),Uq(h,j),Jn(K)},gh=function(M,$,o){var b=M.gv,r=M.data,g=M[$]={blend:b.getBodyColor(r)||b.getFaceBlend(r,$),light:b.getFaceLight(r,$),color:b.getFaceColor(r,$),opacity:b.getFaceOpacity(r,$),transparent:b.getFaceTransparent(r,$),reverseFlip:b.getFaceReverseFlip(r,$),reverseColor:b.getFaceReverseColor(r,$),reverseCull:b.getFaceReverseCull(r,$),texture:b.getFaceImage(r,$),blendTexture:b.getFaceBlendImage(r,$),discardSelectable:b.getFaceDiscardSelectable(r,$)};if("csg"!==$){g.uv=b.getFaceUv(r,$)||o&&o[$+"Uv"],g.uvScale=b.getFaceUvScale(r,$)||o&&o[$+"UvScale"],g.uvOffset=b.getFaceUvOffset(r,$)||o&&o[$+"UvOffset"];var x=b.getFaceMat(r,$);x&&(g.mat=Hf(r,x))}return g},ul=function(H,M,R,i,g){if(i){if(!g(i.transparent))return;var o=H.data,Q=H.gv,C=Q._buffer,e=Q.getTexture(i.texture,o),a=Q.getTexture(i.blendTexture,o);Md(M,R,e,i.discardSelectable,C.uv,i.tuv,i.uvOffset,i.uvScale,a),$b(M,R,i.blend,i.light,i.opacity,i.reverseFlip,i.reverseColor,i.reverseCull),Mr(M,R.uDiffuse,i.color),bm(M,C.vs,i.vs,R.aPosition),bm(M,C.ns,i.ns,R.aNormal),Rn(M,0,i.vs.length/3),Uq(M,R),hb(M,R,e)}},Co=function(P,a,Y,G,r,B){var C,V,U,s,$,L,u,E,A,I,o,M=[G-a,r-Y],X=P?P.length:0;for(U=0;X>U;U++){for(s=2,C=P[U],$=C[0],L=C[1];s+1<C.length;){if(u=C[s],E=C[s+1],V=ve(a,Y,G,r,$,L,u,E,!0)){A=[u-$,E-L],I=aq(A),A[0]/=I,A[1]/=I,I=Fe(M,A),I=I>0?B:-B,o=[A[0]*I,A[1]*I];break}$=u,L=E,s+=2}if(o)break}if(o)for(G=a+o[0],r=Y+o[1],U=0;X>U;U++)for(s=2,C=P[U],$=C[0],L=C[1];s+1<C.length;){if(u=C[s],E=C[s+1],V=ve(a,Y,G,r,$,L,u,E,!0))return[0,0];$=u,L=E,s+=2}return o?o:[G-a,r-Y]},Bj=e.graph3d={},fe=function(Z,o,M){Oq(w+".graph3d."+Z,o,M)},Cl="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",bn="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~<spmpd!>!eJ|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw<*yfusfWw.)f{jmbnspo!>!F!4dfw<*mbnspOw)f{jmbnspo!>!O!4dfw!gjeof$!<ftvggjEv!>!spmpd!ftmf$!~<ftvggjEv!>!spmpd|ftmf~<spmpDidubCw!>!spmpd|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!<spmpd!5dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";_r(V,{setBatchInfo:function(X,b){jl[X]=b},getBatchInfo:function(m){return jl[m]}},!0);var Bn=[1,1,1],vf=[1,0,0,0,0,1,0,1,1,1,1,0],Xn=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],po=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],Nf=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Ak=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],gj=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],rg=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],Sq=function(w,A){xk(w,A,"_batchModelMap","_batchIndexMap"),Yi(w,A,"_wireframeModelMap","_wireframeIndexMap"),Yi(w,A,"_polylineModelMap","_polylineIndexMap"),Yi(w,A,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),Yi(w,A,"_polylineModelMapSwap","_polylineIndexMapSwap")},xk=function(Z,e,K,$){if(!e)return Z[K]={},Z[$]={},void 0;var z=e._id,k=Z[$],h=k[z];if(h){var c=Z[K],L=h.batch,Y=c[L],f=Y.ds,w=h.index;if(Y.invalidate=!0,delete k[z],f.splice(w,1),Zi(f))return delete c[L],void 0;for(var I=h.begin,V=h.size,s=3*I,J=3*V,C=4*I,p=4*V,q=Y.vs,B=Y.ps,X=Y.uv,m=Y.cs,M=Y.bs,j=Y.rs,S=Y.ns,u=Y.ls;w<f.length;w++)h=k[f[w]._id],h.index--,h.begin-=V;q.splice(s,J),B.splice(C,p),X&&X.splice(2*I,2*V),m&&m.splice(C,p),M&&M.splice(s,J),j&&j.splice(I,V),S&&S.splice(s,J),u&&u.splice(I,V)}},Yi=xk,Rm=function(n,S,T,p){if(!p)return j;var g=S[p];if(!g){var G=jl[p]||gl,v=G.image?[]:j;g=S[p]={vs:[],ns:[],uv:v,cs:v?j:G.color?j:[],bs:G.blend?[]:j,ps:[],rs:G.brightness?[]:j,ds:[]}}return g.invalidate=!0,n[T._id]={index:g.ds.length,begin:g.vs.length/3,batch:p},g.ds.push(T),g},sl=function(T,V){return V!=j&&1!==V?[T[0]*V,T[1]*V,T[2]*V,T[3]]:T},Wc=function(X,I,Q){var k=X.getBrightness(I),y=Nq(Q.color||"white"),J=y[3]<1,O=Math.ceil(Q.width)||1,F=(J?"T":"O")+O,D=X._wireframeIndexMap,d=X._wireframeModelMap,c=d[F];c||(c=d[F]={vs:[],cs:[],ps:[],ds:[],T:J,W:O});var i,h=X.getData3dUI(I),U=fq(h);if(Q.geometry){if(!U)return;if(i=el(U),!i)return}else i=Q.short?Cr:Od;c.invalidate=!0;var K=c.vs,m=c.cs,W=c.ds,A=D[I._id]={index:W.length,begin:K.length/3,batch:F};W.push(I);var E=Hf(I,Q.mat),R=h._calcAnchorMat(I);R&&bf(E,E,R),Ko(K,E,i);var j=A.size=K.length/3-A.begin;Sf(m,sl(y,k),j)},yd=function(N,y,g,D,I,h,V,x,m){var o=N.getBrightness(y);o==j&&(o=1);var F=sl(Nq(D),o),p=F[3]<1;h=Math.ceil(h)||1;var Q=(p?"T":"O")+h;if(V){var R=V[0],i=(V[1]||R)+R;Q+="-"+R+"-"+i,m&&(Q+="-"+Ym(m)+"-"+o,m=sl(Nq(m),o))}var U=N._polylineIndexMap,s=N._polylineModelMap,H=s[Q];H||(H=s[Q]={vs:[],cs:[],ps:[],ds:[],ls:V?[]:j,T:p,W:h},V&&(H.D=R,H.G=i,H.A=m)),H.invalidate=!0;var T,C=H.vs,d=H.cs,P=H.ds,w=H.ls,E=U[y._id]={index:P.length,begin:C.length/3,batch:Q};P.push(y),zr(C,g);var r,l=E.size=C.length/3-E.begin,L=g.length,n=0,S=[];if(V||I)for(T=0;L>T;T+=6)r=aq([g[T],g[T+1],g[T+2]],[g[T+3],g[T+4],g[T+5]]),S.push(r),n+=r;if(n&&I){var B,O=sl(Nq(I),o),M=[O[0]-F[0],O[1]-F[1],O[2]-F[2],O[3]-F[3]],Y=0;for(T=0;L>T;T+=6)B=Y/n,Sf(d,[F[0]+M[0]*B,F[1]+M[1]*B,F[2]+M[2]*B,F[3]+M[3]*B],1),Y+=S[T/6],B=Y/n,Sf(d,[F[0]+M[0]*B,F[1]+M[1]*B,F[2]+M[2]*B,F[3]+M[3]*B],1)}else Sf(d,F,l);if(V)for(Y=x||0,T=0;L>T;T+=6)w.push(Y),Y+=S[T/6],w.push(Y)},Le=function(H,u,h){if(u)for(var Z=4*u.begin,i=h[u.batch].ps,f=0;f<u.size;f++)i[Z++]=H[0],i[Z++]=H[1],i[Z++]=H[2],i[Z++]=H[3]},Lr=function(V,i){var e=i+["32"],$=V[i],q=V[e];$?q&&q.length===$.length?(q.set($),q.glBuf=null):V[e]=new up($):delete V[e]},os=function(D,Y,y,q,e,S,x,m,T){if(ck(y))y.forEach(function(C){os(D,Y,C,q,e,S,x,m,T)});else if(Ui(y))os(D,Y,fq(q,y),q,e,S,x,m,T);else if(Hj(y)){var B,Q=Yg(y.mat,Y,D),E=Yg(y.s3,Y,D),V=Yg(y.t3,Y,D),j=Yg(y.r3,Y,D);if((E||j||V||Q)&&(B=jf(Q,E,j,Yg(y.rotationMode,Y,D),V),S.push(B)),y.shape3d)os(D,Y,y.shape3d,q,e,S,x,m,y);else{var F=q.s;T=T||gl;var J=S[0],d=S.length,c=F("shape3d.color",y.color,T.color);if(e||(e=F("shape3d.blend",y.blend,T.blend)),d>1){J=Yd(J);for(var k=1;d>k;k++)bf(J,J,S[k])}y.vs&&F(vo,y.visible,T.visible)&&Mp(J,x,m,y.vs,y.uv,y.is,e,c),y.top_vs&&F(Fq,y.topVisible,T.topVisible)&&Mp(J,x,m,y.top_vs,y.top_uv,y.top_is,e,F("shape3d.top.color",y.topColor,T.topColor)||c),y.bottom_vs&&F(Sb,y.bottomVisible,T.bottomVisible)&&Mp(J,x,m,y.bottom_vs,y.bottom_uv,y.bottom_is,e,F("shape3d.bottom.color",y.bottomColor,T.bottomColor)||c),y.from_vs&&F(Kb,y.fromVisible,T.fromVisible)&&Mp(J,x,m,y.from_vs,y.from_uv,y.from_is,e,F("shape3d.from.color",y.fromColor,T.fromColor)||c),y.to_vs&&F(zg,y.toVisible,T.toVisible)&&Mp(J,x,m,y.to_vs,y.to_uv,y.to_is,e,F("shape3d.to.color",y.toColor,T.toColor)||c)}B&&S.pop()}},Mp=function(z,M,c,t,h,U,w,f){var a,$=M.cs,A=M.uv,L=M.bs;if(U){a=U.length;for(var d=0;a>d;d++){var k=U[d];Ko(c,z,[t[3*k],t[3*k+1],t[3*k+2]]),A&&zr(A,[h[2*k],h[2*k+1]])}}else a=t.length/3,Ko(c,z,t),A&&zr(A,h);$&&Sf($,f,a),L&&(w?Xc(L,w,a):zr(L,Bn,a))},_b=function(s,M,C,x){var g=[];x?os(s.gv,s.data,x,s,s.getBodyColor(),[M],C,g):(uf(s,ie,M,C,g),uf(s,yh,M,C,g),uf(s,ze,M,C,g),uf(s,kc,M,C,g),uf(s,ni,M,C,g),uf(s,ys,M,C,g),uf(s,"csg",M,C,g)),g.length&&(zr(C.vs,g),zr(C.ns,hd(g)))},uf=function(A,K,u,R,J){var Y=A[K];if(Y){var i=Y.tuv;if(i){var q,c,f,v,D=Y.uvScale,t=Y.uvOffset;if(D)for(q=i.length,c=D[0],f=D[1],v=0;q>v;v+=2)i[v]*=c,i[v+1]*=f;if(t)for(q=i.length,c=t[0],f=t[1],v=0;q>v;v+=2)i[v]+=c,i[v+1]+=f}Mp(u,R,J,Y.vs,i,j,Y.blend,Y.color)}},Ei=function(S,u,x,C,k,f,A,b){var j,W=x.cs,Q=x.uv,K=x.bs;if(S.getFaceVisible(u,f)){var E=S.getFaceMat(u,f);if(E&&(k=Hf(u,E)),Ko(A,k,b),W&&Sf(W,S.getFaceColor(u,f),6),Q){var O=S.getFaceUv(u,f)||C[f+"Uv"],t=S.getFaceUvScale(u,f)||C[f+"UvScale"],U=S.getFaceUvOffset(u,f)||C[f+"UvOffset"];O=O?[O[6],O[7],O[0],O[1],O[2],O[3],O[2],O[3],O[4],O[5],O[6],O[7]]:vf;var N=O[0],e=O[1],_=O[2],L=O[3],z=O[4],i=O[5],l=O[6],Y=O[7],T=O[8],s=O[9],d=O[10],D=O[11];if(t){var G=t[0],F=t[1];N*=G,e*=F,_*=G,L*=F,z*=G,i*=F,l*=G,Y*=F,T*=G,s*=F,d*=G,D*=F}if(U){var M=U[0],h=U[1];N+=M,e+=h,_+=M,L+=h,z+=M,i+=h,l+=M,Y+=h,T+=M,s+=h,d+=M,D+=h}Q.push(N,e,_,L,z,i,l,Y,T,s,d,D)}K&&(j=S.getBodyColor(u)||S.getFaceBlend(u,f),j?Xc(K,j,6):zr(K,Bn,6))}},ym=function(K,T,C,h){var r=K.getGL(),N=K._prg,p=K._buffer;if(!ui(T)){hk(K),Je(r,N);for(var c in T){var l=T[c];if(!(h&&!l.T||!h&&l.T)){l.invalidate?(l.invalidate=!1,Lr(l,"vs"),Lr(l,"cs"),Lr(l,"ls"),Lr(l,"ps")):C&&Lr(l,"ps");var J=l.vs32,v=C?l.ps32:l.cs32;xp(r,N,l.W,j,p.vs,J);var X=l.D,P=!K._dashDisabled&&X;Mr(r,N.uAlphaTest,I.alphaTest),P&&(Mr(r,N.uDash,!0),Mr(r,N.uDashDistance,X),Mr(r,N.uDashGapDistance,l.G),Yo(r,N.aLineDistance),bm(r,p.lineDistance,l.ls32,N.aLineDistance,1),Mr(r,N.uDiffuse,l.A||eq));var S=!K._batchColorDisabled;S&&(Mr(r,N.uBatchColor,!0),Yo(r,N.aBatchColor),bm(r,p.batchColor,v,N.aBatchColor,4)),Md(r),Rn(r,0,J.length/3,r.LINES),hb(r),S&&(Mr(r,N.uBatchColor,!1),oj(r,N.aBatchColor)),P&&(Mr(r,N.uDash,!1),oj(r,N.aLineDistance))}}ol(r,N)}},qg=function(w,l,r){var F,Q,e,V,S,G,p,W,C,o,f,Z=w.getGL(),N=w._prg,v=w._buffer,D=w._batchModelMap;if(!ui(D)){hk(w);for(F in D)if(Q=jl[F]||gl,!(r&&!Q.transparent||!r&&Q.transparent)&&(e=D[F],l||!Q.transparentMask)){var t=r&&Q.autoSort!==!1&&(w._33Q||e.invalidate);if(e.invalidate?(e.invalidate=!1,Lr(e,"vs"),Lr(e,"ns"),Lr(e,"cs"),Lr(e,"rs"),Lr(e,"ps"),Lr(e,"bs"),Lr(e,"uv")):l&&Lr(e,"ps"),S=e.vs32,G=l?e.ps32:e.cs32,C=e.uv32,p=e.bs32,W=e.rs32,f=S.length/3,t&&(e.is=rs(S,w.getEye())),f){V=Q.light,o=w.getTexture(Q.image),$b(Z,N,j,Q.light,Q.opacity,Q.reverseFlip,Q.reverseColor,Q.reverseCull),G?w._batchColorDisabled||(Mr(Z,N.uBatchColor,!0),Yo(Z,N.aBatchColor),bm(Z,v.batchColor,G,N.aBatchColor,4)):Mr(Z,N.uDiffuse,Q.color);var X=Q.alphaTest;Mr(Z,N.uAlphaTest,X===L?I.alphaTest:X);var T=p&&!w._batchBlendDisabled;T&&(Mr(Z,N.uBatchBlend,!0),Yo(Z,N.aBatchBlend),bm(Z,v.batchBlend,p,N.aBatchBlend));var x=W&&!w._batchBrightnessDisabled;x&&(Mr(Z,N.uBatchBrightness,!0),Yo(Z,N.aBatchBrightness),bm(Z,v.batchBrightness,W,N.aBatchBrightness,1)),C?Md(Z,N,o,Q.discardSelectable,v.uv,C,Q.uvOffset,Q.uvScale):Md(Z),bm(Z,v.vs,S,N.aPosition),bm(Z,v.ns,e.ns32,N.aNormal),e.is?(Fi(Z,v.is,e.is),vp(Z,0,f)):Rn(Z,0,f),C?hb(Z,N,o):hb(Z),G&&!w._batchColorDisabled&&(Mr(Z,N.uBatchColor,!1),oj(Z,N.aBatchColor)),T&&(Mr(Z,N.uBatchBlend,!1),oj(Z,N.aBatchBlend)),x&&(Mr(Z,N.uBatchBrightness,!1),oj(Z,N.aBatchBrightness)),Uq(Z,N)}}}},rs=function(s,U){for(var V=s.length/3,x=new Array(V),r=V/3,H=new Array(r),c=0;r>c;c++)H[c]=c;H.sort(function(V,g){var K=9*V,H=[(s[K]+s[K+3]+2*s[K+6])/4,(s[K+1]+s[K+4]+2*s[K+7])/4,(s[K+2]+s[K+5]+2*s[K+8])/4];K=9*g;var j=[(s[K]+s[K+3]+2*s[K+6])/4,(s[K+1]+s[K+4]+2*s[K+7])/4,(s[K+2]+s[K+5]+2*s[K+8])/4],n=aq(U,H)-aq(U,j);return n>0?-1:0>n?1:0});for(var c=0;r>c;c++){var n=3*c,Z=3*H[c];x[n]=Z,x[n+1]=Z+1,x[n+2]=Z+2}return new tc(x)};V.handleModelLoaded=function(){},V.handleUnfoundModel=function(){};var vh=j,ar=j,ej=function(w){vh&&!w._loadingModelView_&&(ar||(ar={}),ar[w._loadingModelView_=Kr()]=w)},eb=function(K,o){vh||(vh={});var L=vh[K];if(L){if(L.url===o)return;L.request.onload=rj,L.request.onerror=rj}var d=new XMLHttpRequest;if(vh[K]={request:d,url:o},d.overrideMimeType&&d.overrideMimeType("text/plain"),o=V.beforeLoadURL(o),o.data){var p=V.parse(o.data);Gh(K,p,o)}else d.open("GET",encodeURI(o),!0),d.onload=function(x){if(200===this.status||0===this.status){var c=V.parse(x.target.response||x.target.responseText);Gh(K,c,o)}else as(K,V.handleUnfoundModel(K,o)||j)},d.onerror=function(){as(K,V.handleUnfoundModel(K,o)||j)},d.send(null)},Gh=function(E,f,L){var K=f.modelType;if(K)if("obj"===K){var F={mat:f.mat,s3:f.s3,r3:f.r3,rotationMode:f.rotationMode,t3:f.t3,cube:f.cube==j?!0:f.cube,center:f.center==j?!0:f.center,ignoreMtls:f.ignoreMtls,ignoreTransparent:f.ignoreTransparent,ignoreColor:f.ignoreColor,ignoreImage:f.ignoreImage,ignoreNormal:f.ignoreNormal,prefix:f.prefix,flipY:f.flipY,flipFace:f.flipFace,reverseFlipMtls:f.reverseFlipMtls,finishFunc:function(l,v){if(l){var v=[];for(var C in l){var d=l[C];v.rawS3=d.rawS3,v.push(d),f.eachModel&&f.eachModel(C,d)}v.json=f,as(E,v),V.handleModelLoaded(E,v)}else as(E,V.handleUnfoundModel(E,L)||j)}};V.loadObj(f.obj,f.mtl,F)}else as(E,V.handleUnfoundModel(E,L)||j);else as(E,f),V.handleModelLoaded(E,f)},as=function(H,E){if(We[H]=E,delete vh[H],ui(vh)&&(vh=j,ar)){for(var f in ar){var g=ar[f];g._2O&&(g._2O={}),g.invalidateAll&&g.invalidateAll(L,"modelLoaded",H),g.redraw&&g.redraw(),g.iv(),delete g._loadingModelView_}ar=j}if(E&&ar)for(var f in ar){var g=ar[f];g.invalidateAll&&g.invalidateAll(L,"modelLoading",H),g.redraw&&g.redraw(),g.iv()}},_k=new up([0,0,0,1,1,1,1,0]),Io=new up([0,0,1,0,0,1,0,0,1,0,0,1]),Eb=new tc([0,1,2,2,3,0]),_d=new up([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),Lf=new tc([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),gg=new up([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),pi=hd(_d,Lf),Od=(new up([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new tc([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5]),Cr=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],Si=function(E,e,a,P,_,j){j=j||16,E=E||16,e=e||0,a=a||E;var X,V,D,Y,M,Z,d,i,s=.5,F=[],f=[],n=h/E,u=m/j;for(X=0;j>X;X++)for(M=X+1,Y=X*u,i=M*u,V=e;a>V;V++)Z=V+1,D=V*n,d=Z*n,F.push(s*B(Y)*v(D),s*v(Y),-s*B(Y)*B(D),s*B(i)*v(d),s*v(i),-s*B(i)*B(d),s*B(Y)*v(d),s*v(Y),-s*B(Y)*B(d),s*B(Y)*v(D),s*v(Y),-s*B(Y)*B(D),s*B(i)*v(D),s*v(i),-s*B(i)*B(D),s*B(i)*v(d),s*v(i),-s*B(i)*B(d)),f.push(V/E,X/j,Z/E,M/j,Z/E,X/j,V/E,X/j,V/E,M/j,Z/E,M/j);if(P){var O=[],S=[];for(D=e*n,X=0;j>X;X++)M=X+1,Y=X*u,i=M*u,O.push(0,0,0,s*B(i)*v(D),s*v(i),-s*B(i)*B(D),s*B(Y)*v(D),s*v(Y),-s*B(Y)*B(D)),S.push(0,.5,e/E,M/j,e/E,X/j)}if(_){var z=[],I=[];for(D=a*n,X=0;j>X;X++)M=X+1,Y=X*u,i=M*u,z.push(0,0,0,s*B(Y)*v(D),s*v(Y),-s*B(Y)*B(D),s*B(i)*v(D),s*v(i),-s*B(i)*B(D)),I.push(1,.5,a/E,X/j,a/E,M/j)}return{vs:F,uv:f,from_vs:O,from_uv:S,to_vs:z,to_uv:I}},ip=function(T,k,i){T=T||.17,k=k||12,i=i||18,0>T?T=0:T>.25&&(T=.25);var f,e,Q,l,J,g,L,t=.5,o=[],I=[],j=[],d=h/i,y=h/k,b=t-T;for(e=0;k>=e;e++)for(l=-m+e*y,g=v(l),J=B(l),f=0;i>=f;f++)Q=f*d,L=b+T*g,o.push(v(Q)*L,J*T,-B(Q)*L),I.push(f/i,1-e/k);for(e=0;k>e;e++){var w=e*(i+1),C=(e+1)*(i+1);for(f=0;i>f;f++)j.push(w+f,C+f+1,C+f,w+f,w+f+1,C+f+1)}return{vs:o,uv:I,is:j}},fj=function(o,U,b,k,g,I,T){T=T||12,o=o||18,U=U||0,b=b||o,I=I||.17,0>I?I=0:I>.25&&(I=.25);var P,F,J,H,Z,p,W,_,s,f,R=.5,K=[],u=[],S=h/o,x=h/T,V=R-I;for(J=0;T>J;J++)for(H=J+1,W=-m+J*x,_=-m+H*x,P=U;b>P;P++)F=P+1,Z=P*S,p=F*S,s=V+I*v(W),f=V+I*v(_),K.push(v(Z)*s,B(W)*I,-B(Z)*s,v(p)*s,B(W)*I,-B(p)*s,v(p)*f,B(_)*I,-B(p)*f,v(Z)*s,B(W)*I,-B(Z)*s,v(p)*f,B(_)*I,-B(p)*f,v(Z)*f,B(_)*I,-B(Z)*f),u.push(P/o,1-J/T,F/o,1-J/T,F/o,1-H/T,P/o,1-J/T,F/o,1-H/T,P/o,1-H/T);if(k){var c=[],d=[];for(J=0;T>J;J++)H=J+1,W=-m+J*x,_=-m+H*x,Z=U*S,s=V+I*v(W),f=V+I*v(_),c.push(v(Z)*s,B(W)*I,-B(Z)*s,v(Z)*f,B(_)*I,-B(Z)*f,v(Z)*V,0,-B(Z)*V),d.push(.5+.5*v(W),.5-.5*B(W),.5+.5*v(_),.5-.5*B(_),.5,.5)}if(g){var C=[],D=[];for(J=0;T>J;J++)H=J+1,W=-m+J*x,_=-m+H*x,Z=b*S,s=V+I*v(W),f=V+I*v(_),C.push(v(Z)*s,B(W)*I,-B(Z)*s,v(Z)*V,0,-B(Z)*V,v(Z)*f,B(_)*I,-B(Z)*f),D.push(.5-.5*v(W),.5-.5*B(W),.5,.5,.5-.5*v(_),.5-.5*B(_))}return{vs:K,uv:u,from_vs:c,from_uv:d,to_vs:C,to_uv:D}},tg=function(R,Y){for(var C,f,T,E=.5,X=16,r=[],k=[],i=[],s=h/X,D=0;X>=D;D++)C=D*s,f=v(C)*E,T=B(C)*E,r.push(f,-E,T,f,E,T),k.push(1-D/X,1,1-D/X,0);for(D=0;X>D;D++)i.push(2*D,2*D+1,2*D+3,2*D,2*D+3,2*D+2);if(Y){var U=[],z=[],j=[];for(U.push(0,-E,0),z.push(.5,.5),D=0;X>=D;D++)C=D*s,f=v(C),T=B(C),U.push(f*E,-E,-T*E),z.push(.5+.5*f,.5+.5*T);for(D=0;X>D;D++)j.push(0,D+2,D+1)}if(R){var M=[],L=[],K=[];for(M.push(0,E,0),L.push(.5,.5),D=0;X>=D;D++)C=D*s,f=v(C),T=B(C),M.push(f*E,E,-T*E),L.push(.5+.5*f,.5-.5*T);for(D=0;X>D;D++)K.push(0,D+1,D+2)}return{vs:r,uv:k,is:i,bottom_vs:U,bottom_uv:z,bottom_is:j,top_vs:M,top_uv:L,top_is:K}},jk=function(c,T,s,p,f,Z,A){c=c||12,T=T||0,s=s||c;for(var E,L,n,F,r,q,N,X,V=.5,u=[],g=[],j=h/c,m=T;s>m;m++)E=m+1,L=m*j,n=E*j,F=v(L)*V,r=B(L)*V,q=v(n)*V,N=B(n)*V,u.push(F,-V,-r,q,-V,-N,F,V,-r,q,-V,-N,q,V,-N,F,V,-r),g.push(m/c,1,E/c,1,m/c,0,E/c,1,E/c,0,m/c,0);if(A){var y=[],H=[];for(m=T;s>m;m++)L=j*m,n=j*(m+1),F=v(L),r=B(L),q=v(n),N=B(n),y.push(F*V,-V,-r*V,0,-V,0,q*V,-V,-N*V),H.push(.5+.5*F,.5+.5*r,.5,.5,.5+.5*q,.5+.5*N)}if(Z){var a=[],l=[];for(m=T;s>m;m++)L=j*m,n=j*(m+1),F=v(L),r=B(L),q=v(n),N=B(n),a.push(F*V,V,-r*V,q*V,V,-N*V,0,V,0),l.push(.5+.5*F,.5-.5*r,.5+.5*q,.5-.5*N,.5,.5)}if(p){var W=[],C=[];L=j*T,F=v(L)*V,r=B(L)*V,X=T/c,W.push(0,V,0,0,-V,0,F,-V,-r,F,-V,-r,F,V,-r,0,V,0),C.push(0,0,0,1,X,1,X,1,X,0,0,0)}if(f){var S=[],x=[];L=j*s,F=v(L)*V,r=B(L)*V,X=s/c,S.push(0,-V,0,0,V,0,F,V,-r,F,V,-r,F,-V,-r,0,-V,0),x.push(1,1,1,0,X,0,X,0,X,1,1,1)}return{vs:u,uv:g,bottom_vs:y,bottom_uv:H,top_vs:a,top_uv:l,from_vs:W,from_uv:C,to_vs:S,to_uv:x}},Ud=function(D,U,M,X,b){U=U||18,M=M||0,X=X==j?h:X,b=b==j?.5:b;for(var K,n,g,L,u,r,$=[0,.5,.75,.875,.9375],l=[],F=[],d=[],z=X/U,Q=0;Q<$.length;Q++){var m=0===Q%2?0:.5;for(K=0;U>=K;K++)n=(K+m)*z+M,g=1-$[Q],l.push(v(n)*b*g,-b+2*$[Q]*b,-B(n)*b*g),F.push((K+m)/U,g)}for(Q=0;Q<$.length-1;Q++){var w=Q*(U+1),q=(Q+1)*(U+1);for(K=0;U>K;K++)d.push(w+K,q+K+1,q+K,w+K,w+K+1,q+K+1)}for(r=l.length/3-(U+1),K=0;U>K;K++)l.push(0,b,0),F.push((K+.5)/U,0);for(K=0;U>K;K++)d.push(r+K,r+K+1,r+(U+1)+K);if(D){var f=[],O=[],V=[];for(f.push(0,-b,0),O.push(.5,.5),K=0;U>=K;K++)n=K*z+M,L=v(n),u=B(n),f.push(L*b,-b,-u*b),O.push(.5+.5*L,.5+.5*u);for(K=0;U>K;K++)V.push(0,K+2,K+1)}return{vs:l,uv:F,is:d,bottom_vs:f,bottom_uv:O,bottom_is:V}},Gi=function(o,O,r,y,s,Z){o=o||16,O=O||0,r=r||o;for(var C=.5,W=[],t=[],I=h/o,V=O;r>V;V++){var $=V+1,E=I*V,Q=I*$;W.push(v(E)*C,-C,-B(E)*C,v(Q)*C,-C,-B(Q)*C,0,C,0),t.push(V/o,1,$/o,1,(V+$)/2/o,0)}if(Z){var w=[],c=[];for(V=O;r>V;V++){E=I*V,Q=I*(V+1);var T=v(E),b=B(E),A=v(Q),F=B(Q);w.push(T*C,-C,-b*C,0,-C,0,A*C,-C,-F*C),c.push(.5+.5*T,.5+.5*b,.5,.5,.5+.5*A,.5+.5*F)}}if(y){var N=[],_=[];E=I*O,N.push(0,C,0,0,-C,0,v(E)*C,-C,-B(E)*C),_.push(0,0,0,1,O/o,1)}if(s){var M=[],q=[];E=I*r,M.push(0,-C,0,0,C,0,v(E)*C,-C,-B(E)*C),q.push(1,1,1,0,r/o,1)}return{vs:W,uv:t,bottom_vs:w,bottom_uv:c,from_vs:N,from_uv:_,to_vs:M,to_uv:q}},Be=function(E,Q,z,S,T,X,o,v){for(var x=[],$=0;$<E.length-1;$+=2)x.push({x:E[$],y:E[$+1]});return Yj(x,Q,z,S,T,X,o,v,!1)},Qp={roundRect:function(p,J){return Be([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],p,J,3)},star:function(Y,m){return Be([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],Y,m)},rect:function(u,b){return Be([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],u,b)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(n,i){return Be([0,-.5,.5,.5,-.5,.5],[1,2,2,5],n,i)},rightTriangle:function(T,A){return Be([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],T,A)},parallelogram:function(p,r){return Be([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],p,r)},trapezoid:function(y,E){return Be([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],y,E)}},kj={sphere:1,cylinder:1,cone:1,torus:1},lh={torus:1,sphere:1},Wn=_r(Hm(Qp),{cylinder:1}),nr=_r(Hm(Qp),{cylinder:1,cone:1}),Kg=function(g,x,Y){var _,M=Yg(g.mat,Y,x),X=Yg(g.s3,Y,x),t=Yg(g.t3,Y,x),H=Yg(g.r3,Y,x);return(X||H||t||M)&&(_=Yd(x._6O),hk(x,jf(M,X,H,Yg(g.rotationMode,Y,x),t))),_},il=function(F,r,u,k,x,g,p){if(ck(u))u.forEach(function(v){il(F,r,v,k,x,g,p)});else if(Ui(u))il(F,r,fq(k,u),k,x,g,p);else if(Hj(u))if(u.shape3d){var n=Kg(u,F,r);il(F,r,u.shape3d,k,x,g,u),n&&Jn(F,n)}else Ri(F,r,u,k.s,x,g,p)},Ri=function(p,k,P,T,J,V,d){if(d=d||gl,!V||V(T("shape3d.transparent",P.transparent,d.transparent))){var x=Kg(P,p,k);bg(P);var C=p._26I,q=p._prg,K=p._buffer,A=T("shape3d.color",P.color,d.color);J||(J=T("shape3d.blend",P.blend,d.blend));var B,o=P.opacity==j?d.opacity:P.opacity,n=T("shape3d.opacity");B=n!=j&&o!=j?o*n:o!=j?o:n,$b(C,q,J,T("shape3d.light",P.light,d.light),B,T("shape3d.reverse.flip",P.reverseFlip,d.reverseFlip),T("shape3d.reverse.color",P.reverseColor,d.reverseColor),T("shape3d.reverse.cull",P.reverseCull,d.reverseCull)),P.vs&&T(vo,P.visible,d.visible)&&Am(C,q,K,A,p.getTexture(T("shape3d.image",P.image,d.image),k),T("shape3d.discard.selectable",P.discardSelectable,d.discardSelectable),P.vs,P.uv,P.ns,P.is,T("shape3d.uv.offset",P.uvOffset,d.uvOffset),T("shape3d.uv.scale",P.uvScale,d.uvScale)),P.top_vs&&T(Fq,P.topVisible,d.topVisible)&&Am(C,q,K,T("shape3d.top.color",P.topColor,d.topColor)||A,p.getTexture(T("shape3d.top.image",P.topImage,d.topImage),k),T("shape3d.top.discard.selectable",P.topDiscardSelectable,d.topDiscardSelectable),P.top_vs,P.top_uv,P.top_ns,P.top_is,T("shape3d.top.uv.offset",P.topUvOffset,d.topUvOffset),T("shape3d.top.uv.scale",P.topUvScale,d.topUvScale)),P.bottom_vs&&T(Sb,P.bottomVisible,d.bottomVisible)&&Am(C,q,K,T("shape3d.bottom.color",P.bottomColor,d.bottomColor)||A,p.getTexture(T("shape3d.bottom.image",P.bottomImage,d.bottomImage),k),T("shape3d.bottom.discard.selectable",P.bottomDiscardSelectable,d.bottomDiscardSelectable),P.bottom_vs,P.bottom_uv,P.bottom_ns,P.bottom_is,T("shape3d.bottom.uv.offset",P.bottomUvOffset,d.bottomUvOffset),T("shape3d.bottom.uv.scale",P.bottomUvScale,d.bottomUvScale)),P.from_vs&&T(Kb,P.fromVisible,d.fromVisible)&&Am(C,q,K,T("shape3d.from.color",P.fromColor,d.fromColor)||A,p.getTexture(T("shape3d.from.image",P.fromImage,d.fromImage),k),T("shape3d.from.discard.selectable",P.fromDiscardSelectable,d.fromDiscardSelectable),P.from_vs,P.from_uv,P.from_ns,P.from_is,T("shape3d.from.uv.offset",P.fromUvOffset,d.fromUvOffset),T("shape3d.from.uv.scale",P.fromUvScale,d.fromUvScale)),P.to_vs&&T(zg,P.toVisible,d.toVisible)&&Am(C,q,K,T("shape3d.to.color",P.toColor,d.toColor)||A,p.getTexture(T("shape3d.to.image",P.toImage,d.toImage),k),T("shape3d.to.discard.selectable",P.toDiscardSelectable,d.toDiscardSelectable),P.to_vs,P.to_uv,P.to_ns,P.to_is,T("shape3d.to.uv.offset",P.toUvOffset,d.toUvOffset),T("shape3d.to.uv.scale",P.toUvScale,d.toUvScale)),Uq(C,q),x&&Jn(p,x)
}},Am=function(e,W,t,D,p,s,d,P,T,h,O,u){d&&(Mr(e,W.uDiffuse,D),P?Md(e,W,p,s,t.uv,P,O,u):Md(e),bm(e,t.vs,d,W.aPosition),bm(e,t.ns,T,W.aNormal),h?(Fj(e,t.is,h),vp(e,0,h.length)):Rn(e,0,d.length/3),P?hb(e,W,p):hb(e))},fq=function(n,a){var z=n.s;if(a||(a=z(Al)),!a)return j;var x=Ep(a);if(x)return x;if("text"===a){var $={amount:z("shape3d.text.amount"),size:z("shape3d.text.size"),font:z("shape3d.text.font"),style:z("shape3d.text.style"),weight:z("shape3d.text.weight"),fill:z("shape3d.text.fill"),curveSegments:z("shape3d.text.curveSegments"),spacing:z("shape3d.text.spacing")},k=n.gv.getShape3dText(n.data),u=k;for(var S in $)u+="_"+($[S]===L?"U":$[S]);return n._cachedTextKey===u?n._cachedTextGeometry:(n._cachedTextKey=u,n._cachedTextGeometry=V.createTextGeometry(k,$))}var S=a;if(kj[a]){var r=z("shape3d.side"),J=z("shape3d.side.from"),B=z("shape3d.side.to"),w=z(Kb),i=z(zg);3>r?(r=0,J=0,B=0,w=!1,i=!1):((J==j||0>J)&&(J=0),(B==j||B>r)&&(B=r),0===J&&B===r&&(w=!1,i=!1)),S+="-"+r+"-"+J+"-"+B+"-"+w+"-"+i}if(Wn[a]){var t=z(Fq);S+="-"+t}if(nr[a]){var O=z(Sb);S+="-"+O}if("torus"===a){var g=z("shape3d.torus.radius");0>g?g=0:g>.25&&(g=.25),S+="-"+g}if(lh[a]){var l=z(Dp);S+="-"+l}return x=_m[S],x||("box"===a?x=V.createBoxModel():Qp[a]?x=Qp[a](t,O):"sphere"===a?x=V.createSphereModel(r,J,B,w,i,l):a===Lc?x=V.createCylinderModel(r,J,B,w,i,t,O):"cone"===a?x=V.createConeModel(r,J,B,w,i,O):"torus"===a&&(x=V.createTorusModel(r,J,B,w,i,g,l)),_m[S]=x),x},bg=function(){var k=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],L=["is","top_is","bottom_is","from_is","to_is"];return W=lq(Cl.substr(Cl.indexOf("^#")+2)),vs(V[Li(Dd+k[15]+"n"+k[16])]())&&gc()?function(u){u&&!u._complete_&&(u._complete_=!0,u.vs&&Zi(u.ns)&&(u.ns=hd(u.vs,u.is)),u.top_vs&&Zi(u.top_ns)&&(u.top_ns=hd(u.top_vs,u.top_is)),u.bottom_vs&&Zi(u.bottom_ns)&&(u.bottom_ns=hd(u.bottom_vs,u.bottom_is)),u.from_vs&&Zi(u.from_ns)&&(u.from_ns=hd(u.from_vs,u.from_is)),u.to_vs&&Zi(u.to_ns)&&(u.to_ns=hd(u.to_vs,u.to_is)),k.forEach(function(W){var e=u[W];ck(e)&&(u[W]=new up(e))}),L.forEach(function(B){var L=u[B];ck(L)&&(u[B]=new tc(L))}))}:void 0}(),Vh=function(L,w){var M=L[w];ck(M)&&(L[w]=new up(M))};_r(Rp,{_25Q:function(Y){Y._16O=function(P,Z,V,p,h,n,J,M,Y){var y=this.info;if(y){var Q,g,B,R,D,r,I=jo();if($r[Z]?(Q=y.p3,g=y.c1,B=y.c2):yi[Z]?(g=y.s1||y.c1,B=y.s2||y.c2):(g=y.t1||y.c1,B=y.t2||y.c2),Q)r=le(Z,Qg,V,p,M,Y);else{var i=wr(B,g),L=aq(g,B);R=[0,-H(i[2],i[0]),X(i[1]/L)],D="zyx",Q=[(g[0]+B[0])/2,(g[1]+B[1])/2,(g[2]+B[2])/2],r=le(Z,[L,0,0],V,p,M,Y)}return hl(I,r,Q,p,h,n,J,P,R,D)}return Wq},Y._80o=function(M,d,X){var s=this,y=s.shapeModel;if(y){var g=s.gv;hk(g),il(g,s.data,y,s,s.getBodyColor(),X)}},Y.createLineModel=function(t,p,Y,R,e){for(var H=this,X=H.s,Q=te(t,p,X(Dp)),s=[],c=0;c<Q.length;c++){var U=Q[c],J=U.length;if(J>1){var S=U[0];s.push(S.x,S.y,S.z);for(var _=1;J-1>_;_++)S=U[_],s.push(S.x,S.y,S.z),s.push(S.x,S.y,S.z);S=U[J-1],s.push(S.x,S.y,S.z)}}var y,u,B,z=X(R+".color"),m=X(e),L=0;return m&&(u=X(e+".color"),y=X(e+".pattern"),L=X(e+".offset"),B=z),yd(H.gv,H.data,s,u||z,B?j:X(R+".gradient.color"),Y,y||X(R+".pattern"),L,B),Q},Y.createTubeModel=function(s,h,m,l){for(var C=this,k=C.s,q=k("shape3d.side")||cb,H=k("shape3d.start.angle"),u=k("shape3d.sweep.angle"),W=k(Fq)?k("shape3d.top.cap"):j,G=k(Sb)?k("shape3d.bottom.cap"):j,e="flat"===W,E="flat"===G,S=e&&(l?l.uv:k("shape3d.top.image")),o=E&&(l?l.uv:k("shape3d.bottom.image")),r=l?l.uv:k("shape3d.image"),n={vs:[],uv:r?[]:j,top_vs:e?[]:j,top_uv:S?[]:j,bottom_vs:E?[]:j,bottom_uv:o?[]:j},A=te(s,h,k(Dp),m),v=0,z=A.length;z>v;v++)Mm(n,A[v],k(Dq),m,q,H,u,W,G);if(l){var T=[];os(C.gv,C.data,n,C,C.getBodyColor(),[],l,T),T.length&&(zr(l.vs,T),zr(l.ns,hd(T)))}else C.shapeModel=n;return A},Y.getCache=function(){var d=this.info;if(d){var V=d.list;if(V){var r=d.cache;return r||(r=d.cache=fo(V)),r}}return j}}});var Sg=function(L,b){for(var T,Q=0,c=L.length,B=0,A=c-1;A>=B;)if(Q=o(B+(A-B)/2),T=L[Q].length-b,0>T)B=Q+1;else{if(!(T>0)){A=Q;break}A=Q-1}Q=A;var s=L[Q],k=s.point;return Q===c-1||s.length===b||(k=(new zn).subVectors(L[Q+1].point,k).normalize().multiplyScalar(b-s.length).add(k)),{point:k,tangent:s.tangent}},fo=function(k){for(var N,x,I=[],P=0,H=0;H<k.length;H++){for(var e=k[H],R=0;R<e.length;R++){N=e[R],x&&(P+=x.distanceTo(N));var Y=new zn,L=e[R+1];L?Y.subVectors(L,N):x?Y.subVectors(N,x):Y.x=1,Y.normalize(),I.push({point:N,length:P,tangent:Y}),x=N}x=null}return I},te=function(C,Y,J,o){J=J||dc;for(var z=[],e=0,d=C.size();d>e;e++){var P=C.get(e);z.push(new zn(P.x,P.e||0,P.y))}Y&&(Hn(Y)&&(Y=Y._as),Y.length||(Y=null));for(var X,A,l,S,v,M=[],y=0,D=0,r=Y?Y.length:d;r>D;D++)if(v=Y?Y[D]:0===D?1:2,1===v)M.push(l=[]),l.push(z[y++]);else if(2===v||5===v)if(S=2===v?z[y++]:l[0],o){var g=Y?Y[D+1]:r>D+1?2:j;if(2===g||5===g){var Q=l[l.length-1],x=2===g?z[y]:l[0],b=(new zn).subVectors(Q,S),O=(new zn).subVectors(x,S),$=b.length(),t=O.length();if($&&t)if(o>$/2&&o>t/2)l.push(S);else for(b.multiplyScalar(K(o,$/2)/$).add(S),O.multiplyScalar(K(o,t/2)/t).add(S),X=new Tn(b,S,O).getPoints(J),A=0;J>=A;A++)l.push(X[A])}else l.push(S)}else l.push(S);else if(3===v)for(X=new Tn(l[l.length-1],z[y++],z[y++]).getPoints(J),A=1;J>=A;A++)l.push(X[A]);else if(4===v)for(X=new dp(l[l.length-1],z[y++],z[y++],z[y++]).getPoints(J),A=1;J>=A;A++)l.push(X[A]);return M},Hb=function(G){for(var j,g,J=new zn,b=[],z=[],S=[],C=0,D=G.length;D>C;C++)j=G[C],g=G[C+1],g?J.subVectors(g,j):J.subVectors(j,G[C-1]),b.push(J.normalize().clone());var c,T,q,f,R=new zn,i=new zn,m=new we,P=1e-4,U=Number.MAX_VALUE,N=b[0],x=z[0]=new zn,$=S[0]=new zn;for(T=r(N.x),q=r(N.y),f=r(N.z),U>=T&&(U=T,R.set(1,0,0)),U>=q&&(U=q,R.set(0,1,0)),U>=f&&R.set(0,0,1),i.crossVectors(N,R).normalize(),x.crossVectors(N,i),$.crossVectors(N,x),C=1;D>C;C++)z[C]=z[C-1].clone(),S[C]=S[C-1].clone(),i.crossVectors(b[C-1],b[C]),i.length()>P&&(i.normalize(),c=Q(fh(b[C-1].dot(b[C]),-1,1)),z[C].applyMatrix4(m.makeRotationAxis(i,c))),S[C].crossVectors(b[C],z[C]);return{B:S,T:b,N:z}},Mm=function(){var W=function(h){for(var W=1;W<arguments.length;W++){var s=arguments[W];h.push(s.x,s.y,s.z)}},T=function(i){for(var M=1;M<arguments.length;M++){var C=arguments[M].uv;i.push(C[0],C[1])}},t=function(u,g,N,y,p){var D=-y*v(p),t=y*B(p);return new zn(u.x+D*N.x+t*g.x,u.y+D*N.y+t*g.y,u.z+D*N.z+t*g.z)},u=function(q,w,d,l,s,N,c,S){c=c||h;for(var W=[],y=c/s,G=0;s>=G;G++){var T=t(q,w,d,l,G*y+N);W.push(T),S!=j&&(T.uv=[S,G/s])}return W},P=function(f,G,z,r,V,y,q,d,U){U=U||h;var C=G?f.top_vs:f.bottom_vs;if(C)for(var s=G?f.top_uv:f.bottom_uv,H=U/q,p=0;q>p;p++){var j,_;G?(j=p*H+d,_=(p+1)*H+d):(_=p*H+d,j=(p+1)*H+d),W(C,t(z,r,V,y,j),t(z,r,V,y,_),z),s&&s.push(.5-.5*v(j),.5-.5*B(j),.5-.5*v(_),.5-.5*B(_),.5,.5)}};return function(w,t,U,c,S,i,A,l,C){var Z=t.length;if(Z>1){var Q,x,h,Y,o,O,s,b=Hb(t),M=b.T,f=b.N,v=b.B;"flat"===l&&P(w,!0,t[0],v[0],f[0],c,S,i,A),"flat"===C&&P(w,!1,t[Z-1],v[Z-1],f[Z-1],c,S,i,A);var R,m,a=[],F=k(S/2),r="round"===l,y="round"===C,J=t[0],H=M[0],p=v[0],B=f[0],z=t[Z-1],K=M[Z-1],g=v[Z-1],G=f[Z-1];if(r){for(h=1;F>=h;h++)f.splice(0,0,B),v.splice(0,0,p),M.splice(0,0,H),m=-h/F*c,t.splice(0,0,H.clone().multiplyScalar(m).add(J)),a[F-h]=n(c*c-m*m);Z+=F}if(y){for(h=1;F>=h;h++)f.push(G),v.push(g),M.push(K),m=h/F*c,t.push(K.clone().multiplyScalar(m).add(z)),a[t.length-1]=n(c*c-m*m);Z+=F}if(w.uv){var D=0,V=0,d=[];for(U&&(D=U),o=t[0],d[0]=0,h=1;Z>h;h++)Y=t[h],d[h]=o.distanceTo(Y),o=Y,U||(D+=d[h]);for(R=[],h=0;Z>h;h++)V+=d[h],R[h]=D?V/D:0}for(h=0;Z>h;h++){if(Y=t[h],O=v[h],s=f[h],Q=u(Y,O,s,a[h]===L?c:a[h],S,i,A,R?R[h]:j),x)for(var $=0;S>$;$++){var I=x[$],q=x[$+1]||x[0],E=Q[$],N=Q[$+1]||Q[0];W(w.vs,q,I,E,E,N,q),w.uv&&T(w.uv,q,I,E,E,N,q)}x=Q}}}}();_r(V,{getLineLength:function(T){return T[T.length-1].length},getLineOffset:function(U,K){return Sg(U,K)},getLineCacheInfo:function(d,F,u,T){return fo(te(d,F,u,T))}});var Qi=e.Light=function(){em(Qi,this),this.s(fc,I[fc]),this.s(Al,"sphere"),this.s3(20,20,20)};ok("Light",se,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(P,k,Y){Qi.superClass.onStyleChanged.apply(this,arguments),P===fc&&this.s("shape3d.color",Y)}});var Zb=Bj.Graph3dView=function(Q,u){var n=this;n._attributes=u||V.graph3dViewAttributes,n._25I={},n._view=Ul(1,n);var D=n._canvas=Ji(n._view);D.addEventListener("webglcontextlost",function(q){q.preventDefault(),xo(n),n._26I&&n._doBufferGC(n._26I,!0),n._26I=j,n._1o.texture=j,n._35O=!0},!1),D.addEventListener("webglcontextrestored",function(){n._35O=!1,n.iv()},!1),n._batchIndexMap={},n._batchModelMap={},n._wireframeIndexMap={},n._wireframeModelMap={},n._wireframeIndexMapSwap={},n._wireframeModelMapSwap={},n._polylineIndexMap={},n._polylineIndexMap={},n._polylineIndexMapSwap={},n._polylineIndexMapSwap={},n._8O=[],n._7O=jo(),n._6O=jo(),n._1o=new zd(n),n._30O=new Cg(n),n._31O=new bi(n),n._32O=new cf(n),n._33Q=!0,n._eye=Hm(V.graph3dViewEye),n._center=Hm(V.graph3dViewCenter),n._up=Hm(V.graph3dViewUp),n._lightChanged=!1,n._59O=[],n._spots=[],n._dirs=[],n._frameId=0,n.dm(Q?Q:new si),n.setInteractors([new Hi(n)])},Jp={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1},kb=0;fe("Graph3dView",N,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",Jh,$g,"firstPersonMode",Th,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",or,qp,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled"],_editable:!1,_editHelperDisabled:V.graph3dViewEditHelperDisabled,_devicePixelRatio:L,_boundaries:L,_moveStep:V.graph3dViewMoveStep,_rotateStep:V.graph3dViewRotateStep,_pannable:V.graph3dViewPannable,_rotatable:V.graph3dViewRotatable,_walkable:V.graph3dViewWalkable,_resettable:V.graph3dViewResettable,_zoomable:V.graph3dViewZoomable,_firstPersonMode:V.graph3dViewFirstPersonMode,_mouseRoamable:V.graph3dViewMouseRoamable,_gridVisible:V.graph3dViewGridVisible,_gridSize:V.graph3dViewGridSize,_gridGap:V.graph3dViewGridGap,_gridColor:V.graph3dViewGridColor,_originAxisVisible:V.graph3dViewOriginAxisVisible,_centerAxisVisible:V.graph3dViewCenterAxisVisible,_axisXColor:V.graph3dViewAxisXColor,_axisYColor:V.graph3dViewAxisYColor,_axisZColor:V.graph3dViewAxisZColor,_ortho:V.graph3dViewOrtho,_orthoWidth:V.graph3dViewOrthoWidth,_fovy:V.graph3dViewFovy,_near:V.graph3dViewNear,_far:V.graph3dViewFar,_headlightColor:V.graph3dViewHeadlightColor,_headlightIntensity:V.graph3dViewHeadlightIntensity,_headlightRange:V.graph3dViewHeadlightRange,_headlightDisabled:V.graph3dViewHeadlightDisabled,_rectSelectable:V.graph3dViewRectSelectable,_rectSelectBackground:V.graph3dViewRectSelectBackground,_editSizeColor:V.graph3dViewEditSizeColor,_autoMakeVisible:mq,_fogDisabled:V.graph3dViewFogDisabled,_fogColor:V.graph3dViewFogColor,_fogNear:V.graph3dViewFogNear,_fogFar:V.graph3dViewFogFar,_dashDisabled:V.graph3dViewDashDisabled,_batchColorDisabled:V.graph3dViewBatchColorDisabled,_batchBlendDisabled:V.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:V.graph3dViewBatchBrightnessDisabled,setEye:function(F,Y,f){1===arguments.length&&(Y=F[1],f=F[2],F=F[0]);var y=this._eye;y[0]=F,y[1]=Y,y[2]=f,this.fp(or,j,y)},setCenter:function(V,n,P){1===arguments.length&&(n=V[1],P=V[2],V=V[0]);var l=this._center;l[0]=V,l[1]=n,l[2]=P,this.fp(qp,j,l)},setUp:function(i,d,S){1===arguments.length&&(d=i[1],S=i[2],i=i[0]);var n=this._up;n[0]=i,n[1]=d,n[2]=S,this.fp("up",j,n)},isTransparentMask:function(B){return B.s("transparent.mask")},getAspect:function(){var Q=this,K=Q._aspect;return K?K:Q.getWidth()/Q.getHeight()},getCanvas:function(){return this._canvas},setDataModel:function(C){var z=this,a=z._dataModel,F=z._selectionModel;a!==C&&(a&&(a.ump(z.handleDataModelPropertyChange,z),a.umm(z.handleDataModelChange,z),a.umd(z.handleDataPropertyChange,z),F||a.sm().ums(z.handleSelectionChange,z)),z._dataModel=C,C.mp(z.handleDataModelPropertyChange,z),C.mm(z.handleDataModelChange,z),C.md(z.handleDataPropertyChange,z),F?F._21I(C):C.sm().ms(z.handleSelectionChange,z),z.invalidateAll(!0),z.invalidateLight(),z.fp(hs,a,C),z._canvas.style.background=C.getBackground()||"")},handleDataModelPropertyChange:function(t){if("background"===t.property){var l=this._canvas.style.background,w=t.newValue||"";this._canvas.style.background=w,this.fp("canvasBackground",l,w)}},handleDataPropertyChange:function(G){var c=G.data;this.invalidateData(c),Qd(c)&&"s:light.type"===G.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(x){var $=this,U=x.property;$.iv(),$._18Q=j,"eye"===U?$._33Q=!0:"devicePixelRatio"===U?$._42(j,$._devicePixelRatio||Yl):Jp[U]&&xo($)},_5O:function(c){var V=c._22Q();return V?new V(this,c):j},getData3dUI:function(t){var u=this._25I[t._id];return u===L&&(u=this._5O(t),this._25I[t._id]=u),u},invalidateAll:function(c){var M=this;if(c){for(var N in M._25I){var E=M._25I[N];E&&E.dispose()}M._25I={},M.iv(),Sq(M)}else M.dm().each(function(t){M.invalidateData(t)})},invalidateSelection:function(){var G=this;G.sm().each(function(k){G.invalidateData(k)})},invalidateData:function(Y){var I=this,b=I.getData3dUI(Y);b&&(b.iv(),I.iv()),Sq(I,Y)},getShape3dText:function(S){return S.getStyle("shape3d.text")||this.getLabel(S)},invalidateBatch:function(t){var $=this,d=$._batchModelMap,W=d[t],m=[],k={};if(W){W.ds.forEach(function(u){var h=$.getData3dUI(u);h&&h.iv(),delete $._batchIndexMap[u._id],m.push(u._id)}),delete d[t];for(var v,p,V,C,Y,c,w,g,i,F=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],U=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],T=0;T<F.length;T++){var o=$[F[T]],D=$[U[T]];for(k={},g=0;g<m.length;g++){var e=D[m[g]];if(e){delete D[m[g]],i=e.batch,v=o[i];var H=e.begin,S=e.size,h=3*H,q=3*S,R=4*H,B=4*S;for(p=v.ds,V=v.vs,C=v.cs,Y=v.ps,c=v.ls,w=e.index,v.invalidate=!0,p[w]=L,w=h;h+q>w;w++)V[w]=L;for(w=R;R+B>w;w++)C[w]=L;for(w=R;R+B>w;w++)Y[w]=L;if(c)for(w=h;h+q>w;w++)c[w]=L;k[i]=!0}}for(i in k){v=o[i],p=v.ds,V=v.vs,C=v.cs,Y=v.ps,c=v.ls;var s=[];for(w=0;w<p.length;w++)p[w]!==L&&s.push(p[w]);if(0===s.length)delete o[i];else{for(v.ds=s,s=[],w=0;w<V.length;w++)V[w]!==L&&s.push(V[w]);for(v.vs=s,s=[],w=0;w<C.length;w++)C[w]!==L&&s.push(C[w]);for(v.cs=s,s=[],w=0;w<Y.length;w++)Y[w]!==L&&s.push(Y[w]);if(v.ps=s,c){for(s=[],w=0;w<c.length;w++)c[w]!==L&&s.push(c[w]);v.ls=s}}}}$.iv()}},handleDataModelChange:function(e){var Q=this,f=e.kind,h=e.data;if("add"===f)Q.invalidateData(h),Hg(h)&&h.getEdgeGroup()&&h.getEdgeGroup().eachSiblingEdge(Q.invalidateData,Q),Qd(h)&&Q.invalidateLight();else if(f===qe){var g=h._id,H=Q._25I[g];H&&(H.dispose(),delete Q._25I[g],Q.iv()),h===Q._currentSubGraph&&Q.setCurrentSubGraph(j),Sq(Q,h),Qd(h)&&Q.invalidateLight()}else f===Oe&&(Q.invalidateAll(!0),Q.setCurrentSubGraph(j),Sq(Q),Q.invalidateLight())},toCanvas:function(P){var $=this,O=$.getGL();if($.validate(),P){var D=O.getParameter(O.COLOR_CLEAR_VALUE);jr(O,P)}$._42(j,1);var n=$.getWidth(),Q=$.getHeight(),X=new Uint8Array(4*n*Q),g=Ji(),t=g.getContext("2d");O.readPixels(0,0,n,Q,O.RGBA,O.UNSIGNED_BYTE,X),zm(g,n,Q,1);for(var r=t.getImageData(0,0,n,Q),b=r.data,e=0;e<b.length;e+=4){var p=e/4,J=o(p/n),N=p-J*n;p=4*((Q-1-J)*n+N),b[p]=X[e],b[p+1]=X[e+1],b[p+2]=X[e+2],b[p+3]=X[e+3]}return t.putImageData(r,0,0),P&&jr(O,D),$._42(j,$._devicePixelRatio||Yl),g},toDataURL:function(I,Z){var y=this,o=y.getGL();if(y.validate(),I){var Q=o.getParameter(o.COLOR_CLEAR_VALUE);jr(o,I)}y._42(j,1);var v=y._canvas.toDataURL(Z||"image/png",1);return I&&jr(o,Q),y._42(j,y._devicePixelRatio||Yl),v},getGL:function(){var T=this,g=T._26I,Y=T._prg;if(!g)try{T._2O={},g=T._26I=T._canvas.getContext("webgl",T._attributes)||T._canvas.getContext("experimental-webgl",T._attributes),g._emptyTexture=Lj(g),g._emptyBlendTexture=Lj(g),g._bufPool=[],g._id=++kb,T._buffer={vs:kn(g),ns:kn(g),is:kn(g),uv:kn(g),batchColor:kn(g),batchBlend:kn(g),batchBrightness:kn(g),lineDistance:kn(g)},T._1O=wc(g);var o=T._cube={vs:kn(g),ns:kn(g),is:kn(g),uv:kn(g)};xc(g,o.vs,_d),xc(g,o.ns,pi),xc(g,o.uv,gg),Fi(g,o.is,Lf)}catch(D){}if(g&&!Y){if(Y=T._prg=g.createProgram(),!Y)return j;var G=T._dirs.length,F=T._spots.length,$=T._59O.length,f=["uPMatrix","uMVMatrix","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightColor","uFogColor","uFogNear","uFogFar"];G&&f.push("uDirColor","uDirDirection"),F&&f.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),$&&f.push("uPointColor","uPointRange","uPointPosition"),jr(g,[0,0,0,0]),g.clearDepth(1),g.enable(g.DEPTH_TEST),g.depthFunc(g.LEQUAL),g.enable(g.BLEND),g.blendFuncSeparate(g.SRC_ALPHA,g.ONE_MINUS_SRC_ALPHA,g.ONE,g.ONE_MINUS_SRC_ALPHA),ln||(Cl=lq(Cl.substring(0,Cl.indexOf("^#"))),bn=lq(bn),ln=!0);var m=["#define MAX_DIR "+G,"#define MAX_SPOT "+F,"#define MAX_POINT "+$,T._fogDisabled?"":"#define FOG",T._dashDisabled?"":"#define DASH",T._batchColorDisabled?"":"#define BATCHCOLOR",T._batchBlendDisabled?"":"#define BATCHBLEND",T._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),e=xj(g,Y,g.VERTEX_SHADER,Cl.replace("PREFIX",m)),K=xj(g,Y,g.FRAGMENT_SHADER,bn.replace("PREFIX",m));p?f.push("aPosition"):(Y.aPosition=0,g.bindAttribLocation(Y,0,"aPosition")),g.linkProgram(Y),f.forEach(function(A){Y[A]=/^u/.test(A)?g.getUniformLocation(Y,A):g.getAttribLocation(Y,A)}),g.useProgram(Y),g.deleteShader(e),g.deleteShader(K)}return g},getBrightness:function(s){var e=s.s("brightness"),h=this.isSelected(s)?s.s("select.brightness"):j;return e==j?h:h==j?e:e*h},getWireframe:function(B){var b=B.s("wf.visible"),h=B.s("wf.width");return b===!0||h>0&&"selected"===b&&this.isSelected(B)?{color:B.s("wf.color"),width:h,"short":B.s("wf.short"),mat:B.s("wf.mat")}:void 0},_transformPointToViewSpace:function(C){var v=[C[0],C[1],C[2]];return De(v,this._viewMatrix),v},_transformDirectionToViewSpace:function(r,R){var n=[r[0],r[1],r[2]];De(n,this._viewMatrix);var j=R?[R[0],R[1],R[2]]:[0,0,0];De(j,this._viewMatrix);var u=j[0]-n[0],v=j[1]-n[1],U=j[2]-n[2],T=Math.sqrt(u*u+v*v+U*U);return T?[u/T,v/T,U/T]:[u,v,U]},getWireframeGeometry:function(s){return s.s("wf.geometry")?{color:s.s("wf.color"),width:s.s("wf.width"),mat:s.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(z){return z.s("body.color")},getMat:function(U){return U.getMat?U.getMat():U.s("mat")},getFaceMat:function(Z,k){return Z.getFaceMat?Z.getFaceMat(k):Z.s(k+".mat")},getFaceBlend:function(s,v){return s.s(v+".blend")||s.s("all.blend")},getFaceColor:function(r,H){return r.s(H+".color")||r.s("all.color")},getFaceImage:function(X,n){return X.s(n+".image")||X.s("all.image")},getFaceBlendImage:function(h,x){return h.s(x+".blend.image")||h.s("all.blend.image")},getFaceDiscardSelectable:function(X,e){var K=X.s(e+".discard.selectable");return K==j?X.s("all.discard.selectable"):K},getFaceUv:function(Q,$){return Q.s($+".uv")||Q.s("all.uv")},getFaceUvOffset:function(_,Z){return _.s(Z+".uv.offset")||_.s("all.uv.offset")},getFaceUvScale:function(b,E){return b.s(E+".uv.scale")||b.s("all.uv.scale")},getFaceLight:function(p,z){var W=p.s(z+".light");return W==j?p.s("all.light"):W},getFaceVisible:function(V,C){var b=V.s(C+".visible");return b==j?V.s("all.visible"):b},getFaceOpacity:function(J,L){var t=J.s(L+".opacity");return t==j?J.s("all.opacity"):t},getFaceTransparent:function(h,m){var S=h.s(m+".transparent");return S==j?h.s("all.transparent"):S},getFaceReverseColor:function(Z,N){return Z.s(N+".reverse.color")||Z.s("all.reverse.color")},getFaceReverseFlip:function(L,W){var w=L.s(W+".reverse.flip");return w==j?L.s("all.reverse.flip"):w},getFaceReverseCull:function(x,S){var O=x.s(S+".reverse.cull");return O==j?x.s("all.reverse.cull"):O},getTextureMap:function(){return this._2O},deleteTexture:function(Q){var q=this,G=q._2O[Q];G&&(delete q._2O[Q],q.getGL().deleteTexture(G))},invalidateShape3dCachedImage:function(S){var N=S._shape3dCachedImage;N&&(this.getGL().deleteTexture(N),delete S._shape3dCachedImage)},getTexture:function(m,s){if(!m)return j;var p=this,l=p.getGL(),S=p._2O[m];if(!S){var o=El(m);if(o)if(o.tagName){if(o.dynamic)return wc(l,o,p._1O);S=p._2O[m]=wc(l,o)}else{var P=s&&s.s("shape3d.image.cache");if(P&&s._shape3dCachedImage&&(S=s._shape3dCachedImage),!S){var f=s&&s.s("shape3d.fixSizeOnScreen"),c=f&&f[0]>0?f[0]:Fd(o,s),R=f&&f[1]>0?f[1]:Xk(o,s);if(c>=1&&R>=1){c*=devicePixelRatio,R*=devicePixelRatio;var $=fs(c,R);db($,o,0,0,c,R,s,p),$.restore();var B=f?l.NEAREST:l.LINEAR;P&&Cn(o,s)?(S=s._shape3dCachedImage=wc(l,yb,null,B),yb=null):S=wc(l,yb,p._1O,B)}}}}return S},redraw:function(){this.iv()},validateImpl:function(){var h=this;if(h._lightChanged){h._lightChanged=!1;var y=[],i=[],I=[];h.dm().each(function(n){if(Qd(n)){var K=n.s("light.type");K===ae?y.push(n):K===Sh?i.push(n):K===Nl&&I.push(n)}}),(y.length!==h._59O.length||i.length!==h._spots.length||I.length!==h._dirs.length)&&xo(h),h._59O=y,h._spots=i,h._dirs=I}h._42(),h._1o.iv()},getRenderInfo:function(){var Y=this.getGL();return Y?Y._renderInfo:void 0},showDebugTip:function(){var T=this,j=T._debugDiv;if(!j){j=T._debugDiv=u.createElement("div"),j.style.position="absolute",j.style.overflow="hidden",j.style.backgroundColor="white",j.style.color="black";var S=T.getView();T._79O?S.insertBefore(j,T._79O):S.appendChild(j),T._debugTipTimerId=setInterval(function(){var e=T.getRenderInfo();if(e){var x=T.getGL()._bufPool,J=x.length-(x._ivCount||0),U="Draw Calls: "+e.calls+"<br/>"+"Vertices: "+e.vertices+"<br/>"+"Faces: "+e.faces+"<br/>"+"Lines: "+e.lines+"<br/>"+"Buffer Count: "+J;j.innerHTML=U}},10)}},hideDebugTip:function(){var P=this,d=P._debugDiv;d&&(delete P._debugDiv,cancelAnimationFrame(P._debugTipTimerId),delete P._debugTipTimerId,P.getView().removeChild(d))},_42:function(r,T){var g=this;if(!g._35O&&(!np||Vk(np))){var E,C;r&&(r instanceof se?C=r:E=r);var G=g._canvas,u=g.getWidth(),S=g.getHeight(),q=g.getGL(),h=g._prg;if(q){if(T?r||zm(G,u,S,T):(T=g._devicePixelRatio||Yl,r||u===G.clientWidth&&S===G.clientHeight||zm(G,u,S,T)),q.viewport(0,0,u*T,S*T),q._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:++g._frameId},g._81O=j,q.clear(q.COLOR_BUFFER_BIT|q.DEPTH_BUFFER_BIT),Mr(q,h.uBrightness,1),Mr(q,h.uOpacity,1),Mr(q,h.uPartOpacity,1),q._picking=!!r,Mr(q,h.uPick,!!r),Mr(q,h.uTexture,!1),Mr(q,h.uBlendTexture,!1),Mr(q,h.uAlphaTest,I.alphaTest),Mr(q,h.uTransparent,!1),Mr(q,h.uFix,!1),Mr(q,h.uBatchColor,!1),Mr(q,h.uBatchBlend,!1),Mr(q,h.uBatchBrightness,!1),Mr(q,h.uPMatrix,g._projectMatrix=Aj(g)),Mr(q,h.uViewMatrix,nc(g,g._7O)),g._viewMatrix=Yd(g._7O),r||(md(g,q,h),g._fogDisabled||(Mr(q,h.uFogColor,g._fogColor),Mr(q,h.uFogNear,g._fogNear),Mr(q,h.uFogFar,g._fogFar))),Yo(q,h.aPosition),Yo(q,h.aNormal),oj(q,h.aUv),oj(q,h.aBatchColor),oj(q,h.aBatchBlend),oj(q,h.aBatchBrightness),oj(q,h.aLineDistance),C){var i=q.getParameter(q.COLOR_CLEAR_VALUE);q.clearColor(0,0,0,0),q.disable(q.BLEND),oj(q,h.aNormal),xc(q,g._cube.vs,j,h.aPosition),Fi(q,g._cube.is),Zj(C,g,ie,0),Zj(C,g,ze,6),Zj(C,g,yh,12),Zj(C,g,kc,18),Zj(C,g,ni,24),Zj(C,g,ys,30),Yo(q,h.aNormal),jr(q,i)}else if(E){E.value=2;var i=q.getParameter(q.COLOR_CLEAR_VALUE);q.clearColor(0,0,0,0),q.disable(q.BLEND),g._95I(q,h,E),qg(g,E),ym(g,g._polylineModelMap,E),ym(g,g._wireframeModelMap,E),Mr(q,h.uTransparent,!0),g._95I(q,h,E,!0),qg(g,E,!0),ym(g,g._polylineModelMap,E,!0),ym(g,g._wireframeModelMap,E,!0),Mr(q,h.uTransparent,!1),q.clear(q.DEPTH_BUFFER_BIT),g._swapLineMap(),g._95I(q,h,E,!1,!0),ym(g,g._polylineModelMap,E),ym(g,g._wireframeModelMap,E),g._swapLineMap(),q.disable(q.DEPTH_TEST),g._30O._42(q,h,E),q.enable(q.DEPTH_TEST),jr(q,i)}else q.disable(q.BLEND),g.drawSky(q,h),g._31O._42(q,h),g._95I(q,h),qg(g),ym(g,g._polylineModelMap),ym(g,g._wireframeModelMap),q.enable(q.BLEND),Mr(q,h.uTransparent,!0),q.depthMask(!1),g._95I(q,h,j,!0),qg(g,j,!0),ym(g,g._polylineModelMap,j,!0),ym(g,g._wireframeModelMap,j,!0),q.depthMask(!0),Mr(q,h.uTransparent,!1),q.clear(q.DEPTH_BUFFER_BIT),g._swapLineMap(),g._95I(q,h,j,!1,!0),ym(g,g._polylineModelMap),ym(g,g._wireframeModelMap),g._swapLineMap(),q.disable(q.DEPTH_TEST),q.disable(q.BLEND),g._32O._42(q,h),g._30O._42(q,h),q.enable(q.DEPTH_TEST);xc(q,j),Fi(q,j),g._33Q=!1,g._doBufferGC(q)}}},setBufferGCInterval:function(B){this._bufferGCInterval=B},_doBufferGC:function(o,k){var K=o._bufPool,Q=K.length;if(Q){var a,D,G=o._renderInfo.frame,s=this._bufferGCInterval||10,b=0;for(a=0;Q>a;a++)D=K[a],D?(k||G-D._fid>s)&&(b++,o.deleteBuffer(D._buf),D._buf=null,K[a]=null):b++;if(b>Q/2&&b>128){var w=[];for(a=0;Q>a;a++)K[a]&&w.push(K[a]);o._bufPool=w}else K._ivCount=b}},_swapLineMap:function(){var d=this;D=d._polylineModelMap,d._polylineModelMap=d._polylineModelMapSwap,d._polylineModelMapSwap=D,D=d._wireframeModelMap,d._wireframeModelMap=d._wireframeModelMapSwap,d._wireframeModelMapSwap=D,D=d._polylineIndexMap,d._polylineIndexMap=d._polylineIndexMapSwap,d._polylineIndexMapSwap=D,D=d._wireframeIndexMap,d._wireframeIndexMap=d._wireframeIndexMapSwap,d._wireframeIndexMapSwap=D},_updateSkyBoxPosition:function(m){if(this._skyBox&&m&&"eye"===m.property){var D=m.newValue;this._skyBox.p3(D[0],D[1],D[2]),this.invalidateData(this._skyBox)}},setSkyBox:function(U){this._skyBox=U,this.ump(this._updateSkyBoxPosition,this),this.invalidateAll(),U&&(this.mp(this._updateSkyBoxPosition,this),this._updateSkyBoxPosition())},drawSky:function(y,p,R){var N=this,c=N._skyBox;if(c){var W=N._headlightIntensity,m=Nq(N._headlightColor),p=N._prg;1!==W&&(m=[m[0]*W,m[1]*W,m[2]*W]),Mr(y,p.uHeadlightColor,[m[0],m[1],m[2],1]);var A=N.getData3dUI(c);A&&A._42(y,p,R,function(){return!0}),y.clear(y.DEPTH_BUFFER_BIT),Mr(y,p.uHeadlightColor,[m[0],m[1],m[2],N._headlightDisabled?1:0])}},_95I:function(n,B,e,U,v){function q(m){if(!!m.s("shape3d.alwaysOnTop")==!!v&&O.isVisible(m)&&(!g||T)){if(!e&&O.isTransparentMask(m))return;var d=O.getData3dUI(m);d&&d._42(n,B,e,j)}}var O=this,j=function(k){return U?k:!k};O.sky&&n.clear(n.DEPTH_BUFFER_BIT),O.dm().each(q)},getLogicalPoint:function(N){return yq(N,this._canvas)},getHitFaceInfo:function(u){u.target&&(u=this.lp(u));var y=this.getDataInfoAt(u);if(y){var w=this._1o.face(y.data,Ef(u.x,u.y));if(w)return{data:y.data,face:w}}return j},unproject:function(a,u){var k=this,D=k.getWidth(),w=k.getHeight(),C=a.target?k.lp(a):a,$=C.x-D/2,h=C.y-w/2,I=2*($/D),Q=2*(-1*h/w);u=u||0;var F=jo(),B=Aj(k),z=nc(k);bf(F,B,z),wf(F);var m=pm([I,Q,u,1],F);return[m[0]/m[3],m[1]/m[3],m[2]/m[3]]},getDataAt:function(z){var D=this.getDataInfoAt(z);return D?D.data:j},getDataInfoAt:function(Q,P){return Q.target&&(Q=this.lp(Q)),this._1o.get(Ef(Q.x,Q.y,P),!0)},getDatasInRect:function(s){return this._1o.get(s)},setEditable:function(q){var T=this,P=T._editable;T._editable=q,this.fp(Ph,P,q)},isEditable:function($){var J=this;return J._editable?Jl($)?$.s("3d.editable")?J._editableFunc?J._editableFunc($):!0:!1:!1:!1},isSelectable:function(w){return w.s("3d.selectable")&&this.sm().isSelectable(w)},isMovable:function($){var g=this;return Hg($)&&$.getStyle(bk)!==ag?!1:$.s("3d.movable")?g._movableFunc?g._movableFunc($):!0:!1},isSizeEditable:function(I){return Jl(I)?this._sizeEditableFunc?this._sizeEditableFunc(I):!0:!1},isRotationEditable:function(F){return Jl(F)&&F.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(F):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(z){this.setZoom(af,z)},zoomOut:function(y){this.setZoom(1/af,y)},setZoom:function(e,A){if(1!==e){var Q=this;if(Q._ortho)return Q.setOrthoZoom(e,A),void 0;Q._14o&&Q._14o.stop(!0);var b=1/e,i=Q._eye,w=Q._center,z=w[0]+(i[0]-w[0])*b-i[0],y=w[1]+(i[1]-w[1])*b-i[1],U=w[2]+(i[2]-w[2])*b-i[2];if(!(aq(i,w)<Q._moveStep&&1>b)){if(A=aj(A)){var q=Hm(i);return A.action=function(w){Q.fi({kind:Q._zooming?"betweenZoom":"beginZoom"}),Q._zooming=1,i[0]=q[0]+z*w,i[1]=q[1]+y*w,i[2]=q[2]+U*w,Q.fp(or,j,i)},A._37o=function(){delete Q._14o,delete Q._zooming,Q.fi({kind:"endZoom"}),Q.onZoomEnded()},Q._14o=Wd(A)}i[0]+=z,i[1]+=y,i[2]+=U,Q.fp(or,j,i)}}},setOrthoZoom:function(f,V){if(1!==f){var Z=this;Z._14o&&Z._14o.stop(!0);var v=Z._orthoWidth,R=v/f-v;if(!(v<Z._moveStep&&f>1))return(V=aj(V))?(V.action=function(s){Z.fi({kind:Z._zooming?"betweenZoom":"beginZoom"}),Z._zooming=1,Z.setOrthoWidth(v+R*s)},V._37o=function(){delete Z._14o,delete Z._zooming,Z.fi({kind:"endZoom"}),Z.onZoomEnded()},Z._14o=Wd(V)):(Z.setOrthoWidth(v/f),void 0)}},getPositionInfo:function(l){var K=this,j=K._eye,X=K._center,y=K.getAspect(),W=l?Fe(wr(X,j,!0),wr(l,j)):aq(j,X);if(K._ortho){var i=K._orthoWidth;return{length:W,height:i/y,width:i}}var Q=2*F(K._fovy/2)*W;return{length:W,height:Q,width:Q*y}},getCenterInfo:function(){var B=this;return B._81O||(B._81O=B.getPositionInfo()),Hm(B._81O)},rotate:function(A,m,t,o){var J=this;if(A||m){o==j&&(o=J._firstPersonMode),J._88O&&J._88O.stop(!0);var D=J._center,z=J._eye,F=J.getCenterInfo().length,U=o?D:z,Q=o?z:D,p=wr(U,Q),d=H(p[0],p[2]),V=H(n(p[0]*p[0]+p[2]*p[2]),p[1]),i=o?qp:or;return o&&(m=-m),(t=aj(t))?(t.action=function(g){J.fi({kind:J._rotating?"betweenRotate":"beginRotate"}),J._rotating=1;var $=d+A*g,n=V+m*g;n=Gm(n),p[0]=F*B(n)*B($),p[1]=F*v(n),p[2]=F*B(n)*v($),U[0]=Q[0]+p[0],U[1]=Q[1]+p[1],U[2]=Q[2]+p[2],J.fp(i,j,U)},t._37o=function(){delete J._88O,delete J._rotating,J.fi({kind:"endRotate"}),J.onRotateEnded()},J._88O=Wd(t)):(d+=A,V+=m,V=Gm(V),p[0]=F*B(V)*B(d),p[1]=F*v(V),p[2]=F*B(V)*v(d),U[0]=Q[0]+p[0],U[1]=Q[1]+p[1],U[2]=Q[2]+p[2],J.fp(i,j,U),void 0)}},pan:function(D,l,s,G){if(D||l){var T=this;G==j&&(G=T._firstPersonMode),T._89O&&T._89O.stop(!0);var r=nc(T),N=[r[0]*D,r[4]*D,r[8]*D],C=[r[1]*l,r[5]*l,r[9]*l],p=N[0]+C[0],F=N[1]+C[1],k=N[2]+C[2],J=T._center,W=T._eye;if(G){var t=Co(T.getBoundaries(),W[0],W[2],W[0]+p,W[2]+k,n(p*p+k*k));p=t[0],k=t[1]}if(s=aj(s)){var R=Hm(W),u=Hm(J);return s.action=function(B){T.fi({kind:T._panning?"betweenPan":"beginPan"}),T._panning=1,J[0]=u[0]+p*B,J[1]=u[1]+F*B,J[2]=u[2]+k*B,W[0]=R[0]+p*B,W[1]=R[1]+F*B,W[2]=R[2]+k*B,T.fp(or,j,W),T.fp(qp,j,J)},s._37o=function(){delete T._89O,delete T._panning,T.fi({kind:"endPan"}),T.onPanEnded()},T._89O=Wd(s)}J[0]+=p,J[1]+=F,J[2]+=k,W[0]+=p,W[1]+=F,W[2]+=k,T.fp(or,j,W),T.fp(qp,j,J)}},walk:function(R,s,$){if(R){var F=this;$==j&&($=F._firstPersonMode),F._90O&&F._90O.stop(!0);var c=F._center,q=F._eye,Z=wr(c,q,!0);if($){var C=Co(F.getBoundaries(),q[0],q[2],q[0]+Z[0]*R,q[2]+Z[2]*R,r(R));if(R=aq(C),!R)return;Z=[C[0]/R,0,C[1]/R]}if(s=aj(s)){var V=Hm(q),g=Hm(c);return s.action=function(o){F.fi({kind:F._walking?"betweenWalk":"beginWalk"}),F._walking=1;var T=R*o;q[0]=V[0]+Z[0]*T,q[1]=V[1]+Z[1]*T,q[2]=V[2]+Z[2]*T,c[0]=g[0]+Z[0]*T,c[1]=g[1]+Z[1]*T,c[2]=g[2]+Z[2]*T,F.fp(or,j,q),F.fp(qp,j,c)},s._37o=function(){delete F._90O,delete F._walking,F.fi({kind:"endWalk"}),F.onWalkEnded()},F._90O=Wd(s)}q[0]+=Z[0]*R,q[1]+=Z[1]*R,q[2]+=Z[2]*R,c[0]+=Z[0]*R,c[1]+=Z[1]*R,c[2]+=Z[2]*R,F.fp(or,j,q),F.fp(qp,j,c)}},handleScroll:function(A,x){A.preventDefault();var s=this,Z=s._moveStep;s.isFirstPersonMode()?s.isPannable()&&s.pan(0,x>0?Z:-Z):s.isZoomable()&&s.setZoom(0>x?1/ks:ks)},handlePinch:function(Q,A){this.isZoomable()&&this.setZoom(A>Q?1/sb:sb)},reset:function(){this.setCenter(V.graph3dViewCenter),this.setEye(V.graph3dViewEye),this.setUp(V.graph3dViewUp)
},moveSelection:function(R,O,W){var N=this;N.dm().beginTransaction(),gf(this.sm().toSelection(this.isMovable,this),R,O,W),N.dm().endTransaction()},getMoveMode:function(E,P){var D=P.s("3d.move.mode");if(D)return D;var m="88",S="89",a="90";return Wh(E)||Po[m]&&Po[S]&&Po[a]?"xyz":Po[m]&&Po[S]?"xy":Po[m]&&Po[a]?"xz":Po[S]&&Po[a]?"yz":Po[m]?"x":Po[S]?"y":Po[a]?"z":"xz"},handleTick:function(){var U=this,F=!1,y=U._moveStep,C=y,l=!1,u=!0,c=U._rotateStep*(u?-1:1);if(U.isWalkable()||(C=0),U.isPannable()||(y=0),U.isRotatable()||(c=0),U._32Q){var _=(Yk()-U._32Q)/50;C*=_,y*=_,c*=_}U._31Q&&(bp(U._31Q),delete U._31Q,delete U._32Q),Qc()&&(F=!0,U.pan(-y,0,l,u)),ad()&&(F=!0,U.pan(y,0,l,u)),fp()&&(F=!0,Wh()?U.pan(0,y,l,u):U.walk(C,l,u)),Tp()&&(F=!0,Wh()?U.pan(0,-y,l,u):U.walk(-C,l,u)),Dj()&&(F=!0,U.rotate(-c,0,l,u)),hh()&&(F=!0,U.rotate(c,0,l,u)),Pf()&&(F=!0,U.rotate(0,-c/2,l,u)),Rc()&&(F=!0,U.rotate(0,c/2,l,u)),F&&(U._32Q=Yk(),U._31Q=sc(U.handleTick,U))},handleKeyDown:function($){var T=this;!_o($)&&Zd[$.keyCode]?T.handleTick():Pr($)?T.selectAll():Oi($)?T.handleDelete($):kh($)&&this.isResettable()&&T.reset()},checkDoubleClickOnNote:function(l,w,P){var r=this;if(P===Jq){if(w.s("note.toggleable"))return w.s(al,!w.s(al)),r.fi({kind:"toggleNote",event:l,data:w,part:P}),!0}else if(P===Wk&&w.s("note2.toggleable"))return w.s(Qq,!w.s(Qq)),r.fi({kind:"toggleNote2",event:l,data:w,part:P}),!0;return!1},checkDoubleClickOnRotation:function(R,P,_){return _===pd?(P.setRotationX(0),!0):_===Ng?(P.setRotationY(0),!0):_===qq?(P.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},toViewPosition:function(g){var E=this,T=E.getWidth()/2,L=E.getHeight()/2,Z=E._18Q;return Z&&Z._wh===T/L||(Z=Aj(E),E._18Q=bf(Z,Z,nc(E)),E._18Q._wh!==T/L),g=pm([g[0],g[1],g[2],1],Z),{x:T+T*g[0]/g[3],y:L-L*g[1]/g[3]}},getHitPosition:function(l,K,U){var c=this,O=c.getWidth(),r=c.getHeight(),b=l.target?c.lp(l):l,t=b.x-O/2,W=b.y-r/2,V=c.getCenterInfo(),R=nc(c);K=K?K:[0,0,0],U=U?U:[0,1,0],t=t/O*V.width,W=-1*W/r*V.height;var e=[R[0]*t,R[4]*t,R[8]*t],s=[R[1]*W,R[5]*W,R[9]*W],G=[e[0]+s[0],e[1]+s[1],e[2]+s[2]],N=c.getCenter(),z=Qf(c,K,U,[G[0]+N[0],G[1]+N[1],G[2]+N[2]]);return z?z:[0,0,0]},getLineLength:function(H){this.validate();var t=this.getData3dUI(H);if(t&&t.getCache){var p=t.getCache();if(p)return p[p.length-1].length}return 0},getLineOffset:function(A,l){var w=this.getData3dUI(A);if(w&&w.getCache){var z=w.getCache();if(z)return Sg(z,l)}return j},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0}});var mb=Bj.Interactor=function(y){this.gv=y};fe("Interactor",N,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var Hi=Bj.DefaultInteractor=function(z){em(Hi,this,[z])};fe("DefaultInteractor",mb,{handle_contextmenu:function(s){Bk(s)},handle_mousewheel:function(A){this.gv.handleScroll(A,A.wheelDelta/40)},handle_DOMMouseScroll:function(t){2===t.axis&&this.gv.handleScroll(t,-t.detail)},handle_keydown:function(W){this.gv.handleKeyDown(W)},handle_mousedown:function(Y){this.handle_touchstart(Y)},handle_touchstart:function(y){Bk(y);var F=this,U=F.gv,n=Wr(y),w=U.getDataInfoAt(y),g=w?w.data:j,G=w?w.part:j,_=U.sm(),D=Ue(y),i=js(y);U.setFocus(y)&&(F._62O=j,F._57I=j,g?_o(y)?_.co(g)?_.rs(g):_.as(g):_.co(g)||_.ss(g):n&&(_o(y)?U.isRectSelectable()&&(F._62O=Yc):F._57I=Eq(y)),F._31Q&&(bp(F._31Q),delete F._31Q,delete F._32Q),F._62O||(U.isFirstPersonMode()&&(Wh(y)||i>2?F._62O="pan":U.isMouseRoamable()||q?(F._62O="roaming",F.foward=D&&Wr(y),F._32Q=Yk(),F._31Q=sc(F.tick,F)):n||(F._62O="roaming")),F._62O||(n&&D&&gr[G]?(F._62O=G,F.p3=g.p3()):n&&D&&Jl(g)&&U.isSelected(g)&&U.isMovable(g)?(F._62O="move",F.p3=g.p3(),F.movedata=g):q&&(i>2?F._62O="pan":2===i&&(F.dist=Hq(y),F._62O="pinch")))),F.point=U.lp(y),Xo(F,y),wo(y)?U.handleDoubleClick(y,g,G):U.handleClick(y,g,G))},tick:function(){var M=this,L=M.gv,d=L._moveStep;M.point&&L.isWalkable()&&(M._32Q&&(d*=(Yk()-M._32Q)/50),L.walk(M.foward?d:-d),M._32Q=Yk(),M._31Q=sc(M.tick,M))},handle_mouseup:function(A){this.handle_touchend(A)},handle_touchend:function(e){var t=this._57I;t&&(aq(t,Eq(e))<=1&&this.gv.sm().cs(),this._57I=j)},handleWindowMouseMove:function(F){this.handleWindowTouchMove(F)},handleWindowTouchMove:function(p){var g,T,_=this,s=_.gv,Z=_._62O,b=_.point,F=s.dm(),f=s.lp(p),o=f.x-b.x,X=f.y-b.y,c=-h*o/s.getWidth(),R=-h*X/s.getHeight();if("roaming"===Z)_.rotate(p,c/2,R/2);else if(Z===pd||Z===Ng||Z===qq)s._86O||F.beginTransaction(),s.fi({kind:s._86O?"betweenEditRotation":"beginEditRotation",event:p}),s._86O=1,s.sm().each(function(F){if(Jl(F)&&s.isRotationEditable(F)){var E=r(c)>r(R)?c:R;Z===pd?F.setRotationX(F.getRotationX()+E):Z===Ng?F.setRotationY(F.getRotationY()+E):Z===qq&&F.setRotationZ(F.getRotationZ()+E)}});else if("move"===Z||gr[Z]){Z===Fl||Z===hg||Z===co?(s._87O||F.beginTransaction(),s.fi({kind:s._87O?"betweenEditSize":"beginEditSize",event:p}),s._87O=1):(s._moving||F.beginTransaction(),s.fi({kind:s._moving?"betweenMove":"beginMove",event:p}),s._moving=1);var O,G=_.p3,l=s.getPositionInfo(G),x=nc(s);O=Z===wi?"x":Z===Fm?"y":Z===ud?"z":Z===Fl?"sx":Z===hg?"sy":Z===co?"sz":s.getMoveMode(p,_.movedata),o=o/s.getWidth()*l.width,X=-1*X/s.getHeight()*l.height;var C,D,J=[x[0]*o,x[4]*o,x[8]*o],q=[x[1]*X,x[5]*X,x[9]*X],m=J[0]+q[0],i=J[1]+q[1],e=J[2]+q[2],K=[G[0]+m,G[1]+i,G[2]+e],E=wr(s.getEye(),K,!0);if("xyz"===O?(C=K,s.moveSelection(m,i,e)):"xz"===O?(C=Qf(s,G,[0,1,0],K),C&&s.moveSelection(C[0]-G[0],0,C[2]-G[2])):"xy"===O?(C=Qf(s,G,[0,0,1],K),C&&s.moveSelection(C[0]-G[0],C[1]-G[1],0)):"yz"===O?(C=Qf(s,G,[1,0,0],K),C&&s.moveSelection(0,C[1]-G[1],C[2]-G[2])):"x"===O||"sx"===O?(E[0]=0,C=Qf(s,G,E,K),C&&(D=C[0]-G[0],"x"===O?s.moveSelection(D,0,0):s.sm().each(function(k){Jl(k)&&s.isSizeEditable(k)&&(g=Y(Ug,k.getWidth()+D),T=g/k.getWidth(),k.setWidth(g),Wh(p)&&(k.setHeight(k.getHeight()*T),k.setTall(k.getTall()*T)))}))):"y"===O||"sy"===O?(E[1]=0,C=Qf(s,G,E,K),C&&(D=C[1]-G[1],"y"===O?s.moveSelection(0,D,0):s.sm().each(function(f){Jl(f)&&s.isSizeEditable(f)&&(g=Y(Ug,f.getTall()+D),T=g/f.getTall(),f.setTall(g),Wh(p)&&(f.setHeight(f.getHeight()*T),f.setWidth(f.getWidth()*T)))}))):("z"===O||"sz"===O)&&(E[2]=0,C=Qf(s,G,E,K),C&&(D=C[2]-G[2],"z"===O?s.moveSelection(0,0,D):s.sm().each(function(r){Jl(r)&&s.isSizeEditable(r)&&(g=Y(Ug,r.getHeight()+D),T=g/r.getHeight(),r.setHeight(g),Wh(p)&&(r.setTall(r.getTall()*T),r.setWidth(r.getWidth()*T)))}))),!C)return;_.p3=C}else if(Z===Yc){var y=_.div;y||(y=_.div=Cc(),Pi(_.getView(),y),y.op=b,y.style.background=s.getRectSelectBackground()),s.fi({kind:s._rectSelecting?"betweenRectSelect":"beginRectSelect",event:p}),s._rectSelecting=1,y.rect=jq(y.op,f),Db(y,y.rect)}else if("pinch"===Z&&2===js(p)){s.fi({kind:s._pinching?"betweenPinch":"beginPinch",event:p}),s._pinching=1;var D=Hq(p);s.handlePinch(D,_.dist),_.dist=D}else"pan"===Z||Wh(p)?_.pan(p,o,X):s.isFirstPersonMode()||(Wr(p)?_.rotate(p,c,R):(_.pan(p,o,0),s.isWalkable()&&(s.fi({kind:s._walking?"betweenWalk":"beginWalk",event:p}),s._walking=1,s.walk(X/s.getHeight()*s.getCenterInfo().height))));_.point=f},pan:function(N,z,w){var n=this.gv;if(n.isPannable()){var J=n.getCenterInfo(),m=z/n.getWidth()*J.width,l=-1*w/n.getHeight()*J.height;n.fi({kind:n._panning?"betweenPan":"beginPan",event:N}),n._panning=1,n.pan(-m,-l)}},rotate:function(X,e,m){var i=this.gv;i.isRotatable()&&(i.fi({kind:i._rotating?"betweenRotate":"beginRotate",event:X}),i._rotating=1,i.rotate(e,m))},handleWindowMouseUp:function(E){this.handleWindowTouchEnd(E)},handleWindowTouchEnd:function(f){var T=this,I=T.gv,E=I.dm(),z=T.div;if(z){var F=I.getDatasInRect(z.rect);if(!F.isEmpty()){var i=I.sm(),x=i.toSelection();F.each(function(l){i.co(l)?x.remove(l):x.add(l)}),i.ss(x)}er(z)}I._moving&&(delete I._moving,I.fi({kind:"endMove",event:f}),I.onMoveEnded(),E.endTransaction()),I._panning&&(delete I._panning,I.fi({kind:"endPan",event:f}),I.onPanEnded()),I._rotating&&(delete I._rotating,I.fi({kind:"endRotate",event:f}),I.onRotateEnded()),I._86O&&(delete I._86O,I.fi({kind:"endEditRotation",event:f}),E.endTransaction()),I._87O&&(delete I._87O,I.fi({kind:"endEditSize",event:f}),E.endTransaction()),I._pinching&&(delete I._pinching,I.fi({kind:"endPinch",event:f}),I.onPinchEnded()),I._rectSelecting&&(delete I._rectSelecting,I.fi({kind:"endRectSelect",event:f}),I.onRectSelectEnded()),I._walking&&(delete I._walking,I.fi({kind:"endWalk",event:f}),I.onWalkEnded()),T.dist=T.point=T._62O=T.p3=T.movedata=T.div=T._57I=T._32Q=T._31Q=T.foward=j}});var zd=function(N){this.gv=N};Oq(zd,N,{_iv:!0,iv:function(){this._iv=!0},face:function(s,K){var t=this,_=t.gv.getGL();if(!_||!Jl(s))return j;var H=K.x,x=K.width,T=K.height,g=t.height-K.y-T,f=o(x/2),R=new Uint8Array(4*x*T),a=0;for(t.iv(),t.validate(s),tl(_,t.frame),_.readPixels(H,g,x,T,_.RGBA,_.UNSIGNED_BYTE,R),tl(_,j),t.iv();f>=a;a++)for(var Q=f-a,D=f+a,n=Q;D>=n;n++)for(var S=Q;D>=S;S++)if(n===Q||n===D||S===Q||S===D){var c=rk.m[R[4*(n*x+S)]];if(c)return c}},get:function(l,B){this.validate();var S=this,t=S.gv.getGL();if(!t)return j;var R,x,D=l.x,i=l.width,u=l.height,f=S.height-l.y-u,n=o(i/2),q=new Uint8Array(4*i*u),F=0,y=q.length,v=B?j:new rb,U=B?j:{};if(tl(t,S.frame),t.readPixels(D,f,i,u,t.RGBA,t.UNSIGNED_BYTE,q),tl(t,j),B){for(;n>=F;F++)for(var k=n-F,r=n+F,d=k;r>=d;d++)for(var T=k;r>=T;T++)if((d===k||d===r||T===k||T===r)&&(R=S.info(q,4*(d*i+T))))return R}else for(;y>F;F+=4)R=S.info(q,F),R&&(x=R.data,U[x._id]||(v.add(x),U[x._id]=x));return v},info:function(n,b){return this.colorMap[(n[b]<<16)+(n[b+1]<<8)+n[b+2]+((127&n[b+3])<<24)]},validate:function(o){var p=this,r=p.gv,E=r.getGL();if(E){var D=r.getWidth(),w=r.getHeight(),M=E.RGBA,t=E.TEXTURE_2D,g=E.RENDERBUFFER,d=E.FRAMEBUFFER;p.texture||(p.texture=wc(E),p.render=E.createRenderbuffer(),p.frame=E.createFramebuffer()),(p.width!==D||p.height!==w)&&(_i(E,p.texture),E.texImage2D(t,0,M,D,w,0,M,E.UNSIGNED_BYTE,j),Do(E,E.TEXTURE_MIN_FILTER,E.LINEAR),E.bindRenderbuffer(g,p.render),E.renderbufferStorage(g,E.DEPTH_COMPONENT16,D,w),tl(E,p.frame),E.framebufferTexture2D(d,E.COLOR_ATTACHMENT0,t,p.texture,0),E.framebufferRenderbuffer(d,E.DEPTH_ATTACHMENT,g,p.render),_i(E,j),E.bindRenderbuffer(g,j),tl(E,j),p.width=D,p.height=w),p._iv&&(p._iv=!1,tl(E,p.frame),r._42(o||(p.colorMap={}),1),tl(E,j))}}});var bi=function(G){this.gv=G};Oq(bi,N,{gap:0,size:0,_42:function(P,i){var K=this,M=K.gv,a=M._gridGap,d=M._gridSize;if(M._gridVisible){if(K.gap!==a||K.size!==d){for(var g=[],f=M._gridSize/2,w=a*f,n=0;2*f+1>n;n++){var o=6*n,V=6*(2*f+1)+o;g[o]=-w,g[o+1]=0,g[o+2]=-w+n*a,g[o+3]=w,g[o+4]=0,g[o+5]=-w+n*a,g[V]=-w+n*a,g[V+1]=0,g[V+2]=-w,g[V+3]=-w+n*a,g[V+4]=0,g[V+5]=w}K.vs=new up(g),K.gap=a,K.size=d}hk(M),Je(P,i),Md(P),xp(P,i,1,M._gridColor,M._buffer.vs,K.vs),Rn(P,0,K.vs.length/3,P.LINES),hb(P),ol(P,i)}else K.vs=K.gap=K.size=j}});var cf=function(T){this.gv=T};Oq(cf,N,{_42:function(X,N){var u=this.gv,n=u._buffer.vs,b=u._axisXColor,F=u._axisYColor,R=u._axisZColor,_=u._originAxisVisible,k=u._centerAxisVisible;if(_||k){var U=p?X.TRIANGLES:X.TRIANGLE_FAN,e=X.LINES;if(hk(u),Je(X,N),Md(X),_){var r=u.getCenterInfo(),O=K(r.width,r.height)/5,w=.8*O,x=.05*O;xp(X,N,1.5,b,n,new up([0,0,0,O,0,0,w,x,0,w,0,x,w,-x,0,w,0,-x,w,x,0,0,0,0,0,O,0,x,w,0,0,w,x,-x,w,0,0,w,-x,x,w,0,0,0,0,0,0,O,x,0,w,0,x,w,-x,0,w,0,-x,w,x,0,w])),Rn(X,0,2,e),Rn(X,1,6,U),xp(X,N,j,F),Rn(X,7,2,e),Rn(X,8,6,U),xp(X,N,j,R),Rn(X,14,2,e),Rn(X,15,6,U)}if(k){var Z=u._center,o=Z[0],H=Z[1],S=Z[2],r=u.getPositionInfo(Z);O=K(r.width,r.height)/20,xp(X,N,1.5,b,n,new up([o,H,S,o+O,H,S,o,H,S,o,H+O,S,o,H,S,o,H,S+O])),Rn(X,0,2,e),xp(X,N,j,F),Rn(X,2,2,e),xp(X,N,j,R),Rn(X,4,2,e)}hb(X),ol(X,N)}}});var Cg=function(F){this.gv=F},wi="edit_tx",Fm="edit_ty",ud="edit_tz",pd="edit_rx",Ng="edit_ry",qq="edit_rz",Fl="edit_sx",hg="edit_sy",co="edit_sz",gr={};gr[wi]=1,gr[Fm]=1,gr[ud]=1,gr[pd]=1,gr[Ng]=1,gr[qq]=1,gr[Fl]=1,gr[hg]=1,gr[co]=1,Oq(Cg,N,{_42:function(j,v,t){var G=this,T=G.gv,W=T.sm().ld();if(T.isEditable(W)&&!T.isEditHelperDisabled()&&Jl(W)&&(!T.isFirstPersonMode()||!T.isMouseRoamable()&&!q)){hk(T);var X,U,k=T.isMovable(W),f=T.isRotationEditable(W),m=T.isSizeEditable(W),i=T._axisXColor,A=T._axisYColor,R=T._axisZColor,w=T._editSizeColor,P=T.getCenterInfo(),E=K(P.width,P.height)/10,l=E/(t?5:10),s=.7*E,D=.4*s,g=W.p3(),y=g[0],Q=g[1],n=g[2];X=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],k&&G._17O(j,v,W,t,wi,i,X,[y,Q-l,n,y+s,Q-l,n,y+s,Q,n,y+s,Q,n,y,Q,n,y,Q-l,n,y,Q-l,n+l,y+s,Q-l,n+l,y+s,Q-l,n,y+s,Q-l,n,y,Q-l,n,y,Q-l,n+l]),U=y+s,m&&G._17O(j,v,W,t,Fl,w,X,[U,Q-l,n,U+D,Q-l,n,U+D,Q,n,U+D,Q,n,U,Q,n,U,Q-l,n,U,Q-l,n+l,U+D,Q-l,n+l,U+D,Q-l,n,U+D,Q-l,n,U,Q-l,n,U,Q-l,n+l]),U+=D,f&&G._17O(j,v,W,t,pd,i,X,[U,Q-l,n,U+D,Q-l,n,U+D,Q,n,U+D,Q,n,U,Q,n,U,Q-l,n,U,Q-l,n+l,U+D,Q-l,n+l,U+D,Q-l,n,U+D,Q-l,n,U,Q-l,n,U,Q-l,n+l]),X=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],k&&G._17O(j,v,W,t,Fm,A,X,[y,Q,n,y,Q+s,n,y-l,Q+s,n,y-l,Q+s,n,y-l,Q,n,y,Q,n,y,Q,n,y,Q,n-l,y,Q+s,n-l,y,Q+s,n-l,y,Q+s,n,y,Q,n]),U=Q+s,m&&G._17O(j,v,W,t,hg,w,X,[y,U,n,y,U+D,n,y-l,U+D,n,y-l,U+D,n,y-l,U,n,y,U,n,y,U,n,y,U,n-l,y,U+D,n-l,y,U+D,n-l,y,U+D,n,y,U,n]),U+=D,f&&G._17O(j,v,W,t,Ng,A,X,[y,U,n,y,U+D,n,y-l,U+D,n,y-l,U+D,n,y-l,U,n,y,U,n,y,U,n,y,U,n-l,y,U+D,n-l,y,U+D,n-l,y,U+D,n,y,U,n]),X=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],k&&G._17O(j,v,W,t,ud,R,X,[y,Q,n,y,Q,n+s,y,Q-l,n+s,y,Q-l,n+s,y,Q-l,n,y,Q,n,y,Q-l,n,y-l,Q-l,n,y-l,Q-l,n+s,y-l,Q-l,n+s,y,Q-l,n+s,y,Q-l,n]),U=n+s,m&&G._17O(j,v,W,t,co,w,X,[y,Q,U,y,Q,U+D,y,Q-l,U+D,y,Q-l,U+D,y,Q-l,U,y,Q,U,y,Q-l,U,y-l,Q-l,U,y-l,Q-l,U+D,y-l,Q-l,U+D,y,Q-l,U+D,y,Q-l,U]),U+=D,f&&G._17O(j,v,W,t,qq,R,X,[y,Q,U,y,Q,U+D,y,Q-l,U+D,y,Q-l,U+D,y,Q-l,U,y,Q,U,y,Q-l,U,y-l,Q-l,U,y-l,Q-l,U+D,y-l,Q-l,U+D,y,Q-l,U+D,y,Q-l,U])}},_17O:function(D,V,y,g,b,G,I,s){var n=this.gv._buffer;ic(D,V,g,!0,y,b),$b(D,V,j,!0,j,!0,j,!1),Mr(D,V.uDiffuse,G),xc(D,n.vs,new up(s),V.aPosition),xc(D,n.ns,new up(I),V.aNormal),Md(D),Rn(D,0,12),hb(D),Uq(D,V)}});var Nc=function(L,G){this.gv=L,this.s=function(Y,D,W){return D==j&&(D=W),D==j?G.getStyle(Y):Yg(D,G,L)},this.data=G};Oq(Nc,N,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(a,W,i,h){var _=this,w=_.data;if(!(w instanceof es)){var v,U,S,Y,q,V,Q,t=_.gv,J=w._id,H=_.s("shape3d.alwaysOnTop")?null:_.s("batch"),k=t._batchIndexMap,c=t._batchModelMap,T=t.isSelectable(w),K=t.getBrightness(w),A=K!=j&&1!==K;if(_.needValidate(a)){if(S=Rm(k,c,w,H),_.validate(S,H?jl[H]||gl:j),S&&(Y=k[J],q=Y.size=S.vs.length/3-Y.begin,Q=S.rs))for(K=A?K:1,V=0;q>V;V++)Q.push(K);if(Jl(w)){var u=t.getWireframeGeometry(w);if(u)Wc(t,w,u);else{var X=t.getWireframe(w);X&&Wc(t,w,X)}}_.labelInfo=_.label2Info=_.noteInfo=_.note2Info=_._38o=j,_._24O(Np,"getLabel"),_._24O(ro,"getLabel2"),_._26O(Jq,"getNote"),_._26O(Wk,"getNote2"),_._15O(),_._iv=!1}A&&Mr(a,W.uBrightness,K),Mr(a,W.uAlphaTest,_.s("alphaTest")),U=ic(a,W,i,T,w,ns),U&&(Le(U,k[J],c),Le(U,t._polylineIndexMap[J],t._polylineModelMap),Le(U,t._wireframeIndexMap[J],t._wireframeModelMap)),k[J]||_._80o(a,W,h),t.isLabelVisible(w)&&((v=_.labelInfo)&&(ic(a,W,i,T,w,Np),_._28O(v,Np,h)),(v=_.label2Info)&&(ic(a,W,i,T,w,ro),_._28O(v,ro,h))),t.isNoteVisible(w)&&((v=_.noteInfo)&&(ic(a,W,i,T,w,Jq),_._29O(v,Jq,h)),(v=_.note2Info)&&(ic(a,W,i,T,w,Wk),_._29O(v,Wk,h))),(v=_._38o)&&_._99O(a,W,v,i,T,h),A&&Mr(a,W.uBrightness,1)}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return Wq},_80o:function(){},dispose:function(){},_calcAnchorMat:function(y){if(y.hasOwnProperty("_anchor")||y.hasOwnProperty("_anchorElevation")){var Q=y.getAnchor3d(),f={x:Q.x-.5,y:Q.y-.5,z:Q.z-.5},L=jo();return ms(L,[-f.x,-f.y,-f.z]),L}},getBodyColor:function(J){var m=this.data,b=this.gv.getBodyColor(m);return b?b:J?m.getStyle(J):j},_24O:function(O,w){var q=this,C=q.data,D=q.gv,v=q.s,z=D[w](C);if(z!=j){var I=v(O+".scale"),x=v(O+".max"),y=q[O+"Info"]={label:z,textureScale:v(O+".texture.scale"),color:D[w+"Color"](C),font:v(O+".font"),align:v(O+".align"),background:D[w+"Background"](C)},g=y.rect=ng(y,z);x>0&&x<g.width&&(y.labelWidth=g.width,g.width=x),g.x=g.y=0,g.width*=I,g.height*=I,y.mat=q._16O(v(O+".autorotate"),v(O+".position"),g,v(O+".face"),v(O+".t3"),v(O+".r3"),v(O+".rotationMode"));var Z=g.width/2,F=g.height/2;y.vs=new up([-Z,F,0,-Z,-F,0,Z,-F,0,Z,F,0]),g.width/=I,g.height/=I}},_26O:function(N,V){var Y=this,P=Y.data,F=Y.gv,d=Y.s,J=F[V](P);if(J!=j){var C=d(N+".scale"),t=this[N+"Info"]={note:J,textureScale:d(N+".texture.scale"),expanded:d(N+".expanded"),font:d(N+".font"),color:d(N+".color"),align:d(N+".align"),borderWidth:d(N+".border.width"),borderColor:d(N+".border.color"),background:F[V+"Background"](P)};if(t.expanded){var E=d(N+".max"),f=ng(t,J);f.width+=6,f.height+=2,E>0&&E<f.width&&(t.labelWidth=f.width,f.width=E);var o={x:-f.width/2,y:-8-f.height,width:f.width,height:f.height+8}}else o={x:-6,y:-18,width:12,height:18};t.mat=Y._16O(d(N+".autorotate"),d(N+".position"),j,d(N+".face"),d(N+".t3"),d(N+".r3"),d(N+".rotationMode")),t.rect=o,1!==C&&(o=Hm(o),o.x*=C,o.height*=C,o.y=-o.height,o.width*=C);var $=o.x,Q=o.y,S=o.width,O=o.height;t.vs=new up([$,-Q,0,$,-Q-O,0,$+S,-Q-O,0,$+S,-Q,0])}},_28O:function(o,d,X){if(X(this.s(d+".transparent"))){var U=o.rect,$=o.textureScale,c=U.width*$,y=U.height*$;if(c>=1&&y>=1){var V=fs(c,y);1!==$&&(V.translate(V,U.x,U.y),V.scale($,$),V.translate(V,-U.x,-U.y)),Td(V,o),V.restore(),Zg(this,d,o.mat,o.vs,!0)}}},_29O:function(K,k,L){if(L(this.s(k+".transparent"))){var y=K.rect,e=K.textureScale,W=y.x,s=y.y,E=y.width*e,U=y.height*e;if(E>=1&&U>=1){y.x=y.y=0;var w=fs(E,U);1!==e&&w.scale(e,e),cj(w,K),w.restore(),y.x=W,y.y=s,Zg(this,k,K.mat,K.vs,!1)}}},_99O:function(L,R,B,t,N,b){if(B){var v=this,d=v.gv,k=v.data,x=d._buffer,W=d._1O,O=B.icons;for(var H in O){var J=O[H],n=B.rects[H];if(n&&b(Yg(J.transparent,k,d))){ic(L,R,t,N,k,H);var y=Yg(J.shape3d,k,d),p=y?[y]:Yg(J.names,k,d),c=p?p.length:0,u=Yg(J.textureScale,k,d)||1,g=Yg(J.light,k,d);g==j&&(g=y?!0:!1),$b(L,R,Yg(J.blend,k,d),g,Yg(J.opacity,k,d),Yg(J.reverseFlip,k,d),Yg(J.reverseColor,k,d),Yg(J.reverseCull,k,d));for(var G=0;c>G;G++){var m=p[G],s=n[G];if(Um(v,s.mat),y)il(d,k,fq(v,y),v);else{var e=El(m);if(e){var q=s.width*u,M=s.height*u;if(q>=1&&M>=1){var Y=fs(q,M);Dm(Y,e,Yg(J.stretch,k,d),0,0,q,M,k,d),Y.restore(),wc(L,yb,W),Md(L,R,W,Yg(J.discardSelectable,k,d),x.uv,_k),xc(L,x.vs,s.vs,R.aPosition),bm(L,x.ns,Io,R.aNormal),Fj(L,x.is,Eb),vp(L,0,Eb.length),hb(L,R,W)}}}Jn(d)}Uq(L,R)}}}}});var rh=function(s,r){em(rh,this,[s,r])};Oq(rh,Nc,{_16O:function(J,f,u,H,q,S,w,T,j){var z=this.data,Z=z.getFinalScale3d(),m=le(f,Z,u,H,T,j);if(z.hasOwnProperty("_anchor")||z.hasOwnProperty("_anchorElevation")){var C=z.getAnchor3d();m[0]-=(C.x-.5)*Z[0],m[1]-=(C.y-.5)*Z[1],m[2]-=(C.z-.5)*Z[2]}return hl(jo(),m,z.p3(),H,q,S,w,J,z.r3(),z.getRotationMode())},clear:function(){var b=this;b.faceMat=b.mat=b.shapeModel=b.left=b.right=b.front=b.back=b.top=b.bottom=b.csg=j},needValidate:function(u){if(this._iv)return this._validateFrameId=u._renderInfo.frame,!0;if(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen")){var T=u._renderInfo.frame;if(this._validateFrameId!==T)return this._validateFrameId=T,!0}return!1},validate:function(M,s){var S=this,f=S.gv,q=S.data,R=fq(S);S._updateAutoRotation(),S._updateFixSize2d(),(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen"))&&(Yi(f,q,"_wireframeModelMap","_wireframeIndexMap"),Yi(f,q,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var E=Hf(q,f.getMat(q),R?S.s("shape3d.scaleable"):!0),u=S._calcAnchorMat(q);if(u&&bf(E,E,u),S.clear(),M){var D=[];R?os(f,q,R,S,S.getBodyColor(),[E],M,D):(Ei(f,q,M,s,E,ie,D,Xn),Ei(f,q,M,s,E,yh,D,po),Ei(f,q,M,s,E,ni,D,Nf),Ei(f,q,M,s,E,ys,D,Ak),Ei(f,q,M,s,E,ze,D,gj),Ei(f,q,M,s,E,kc,D,rg)),D.length&&(zr(M.vs,D),zr(M.ns,hd(D)))}else S.mat=E,(S.shapeModel=R)||(S._cubeUvs=null,S.vf(ie,0),S.vf(yh,16),S.vf(ze,8),S.vf(kc,24),S.vf(ni,32),S.vf(ys,40))},_updateAutoRotation:function(){var G=this,Z=G.s("shape3d.autorotate");if(Z){var p,K=G.gv,W=G.data;p="string"==typeof Z?[Z.indexOf("x")<0?K._eye[0]:K._center[0],Z.indexOf("y")<0?K._eye[1]:K._center[1],Z.indexOf("z")<0?K._eye[2]:K._center[2]]:K._eye;var T=K._center,O=[p[0]-T[0],p[1]-T[1],p[2]-T[2]],i=W.p3(),h=dh([i[0]+O[0],i[1]+O[1],i[2]+O[2]],i,K._up),A=W.r3(),$=tj(h,W.getRotationMode());Math.abs(A[0]-$[0])<1e-5&&Math.abs(A[1]-$[1])<1e-5&&Math.abs(A[2]-$[2])<1e-5||W.r3($)}},_updateFixSize2d:function(){var S=this,Q=S.data,A=S.s("shape3d.fixSizeOnScreen");if(!A)return Q._dynamicScale3d&&delete Q._dynamicScale3d,void 0;var v=S.gv;Q.getFinalScale3d();var x=Hf(Q,v.getMat(Q)),n=De([0,0,0],x),r=v.toViewPosition(n);if(!isNaN(r.x)&&!isNaN(r.y)){var X=De([1,0,0],x),g=v.toViewPosition(X),H=De([0,1,0],x),T=v.toViewPosition(H),d=g.x-r.x,P=T.y-r.y,z=Q._dynamicScale3d||[1,1,1],$=El(Q.s("shape3d.image")),C=A[0]>0?A[0]:$?Fd($,S):20,G=A[1]>0?A[1]:$?Xk($,S):20,U=Math.abs(d/C),b=Math.abs(P/G);Math.abs(U-1)<.001&&Math.abs(b-1)<.001||(Q._dynamicScale3d=[z[0]/U,z[1]/b,z[2]])}},vf:function(n,I){var p=this;if(p.gv.getFaceVisible(p.data,n)){var d=gh(p,n);d.mat&&(p.faceMat=!0);var x=d.uv;if(x){var j=p._cubeUvs;j||(j=p._cubeUvs=new up([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var V=0;8>V;V++)j[I+V]=x[V]}return d}},_80o:function(d,M,F){var P=this,W=P.gv,V=P.data,s=W._cube,n=P.shapeModel;hk(W,P.mat),n?il(W,V,n,P,P.getBodyColor(),F):(xc(d,s.vs,j,M.aPosition),xc(d,s.ns,j,M.aNormal),Fi(d,s.is),P._18O(d,M,P.left,0,F),P._18O(d,M,P.front,6,F),P._18O(d,M,P.right,12,F),P._18O(d,M,P.back,18,F),P._18O(d,M,P.top,24,F),P._18O(d,M,P.bottom,30,F)),Jn(W),P.faceMat&&(P._18O(d,M,P.left,0,F,!0),P._18O(d,M,P.front,6,F,!0),P._18O(d,M,P.right,12,F,!0),P._18O(d,M,P.back,18,F,!0),P._18O(d,M,P.top,24,F,!0),P._18O(d,M,P.bottom,30,F,!0))},_18O:function(b,x,N,A,m,P){if(N){if(!m(N.transparent))return;if(P&&!N.mat||!P&&N.mat)return;P&&hk(this.gv,N.mat);var o=this,c=o.data,n=o.gv,h=n.getTexture(N.texture,c),Z=N.uv,w=N.uvScale,M=N.uvOffset,D=N.discardSelectable;h?Z?Md(b,x,h,D,n._buffer.uv,o._cubeUvs,M,w):Md(b,x,h,D,n._cube.uv,j,M,w):Md(b),$b(b,x,N.blend,N.light,N.opacity,N.reverseFlip,N.reverseColor,N.reverseCull),Mr(b,x.uDiffuse,N.color),vp(b,A,6),Uq(b,x),hb(b,x,h),P&&Jn(n)}}});var Zr=function(M,n){em(Zr,this,[M,n])};Oq(Zr,Nc,{_25Q:1,validate:function(g){var q=this,S=q.gv,s=q.data,o=q.s,L=o("edge.width"),X=s._40I,f=s._41I;if(q.shapeModel=q.info=j,X&&f){var b,Y,i,Z,B,M,A,h,n,e,R=s.isLooped(),r=o(bk),D=V.getEdgeType(r);if(D){var d=D(s,Ck(q,S,s,R,r),S,q._19Q);if(!d.points||d.points.isEmpty())return;M=q.info={},A=d.segments,B=d.points,h=B.size();for(var z=X.getElevation(),E=f.getElevation(),C=0;h>C;C++){var N=B.get(C);N.e==j&&(N.e=z+(E-z)*C/(h-1))}n=Zf(B.get(0)),e=Zf(B.get(h-1));var k=h%2;0===k?(M.c1=Zf(B.get(h/2-1)),M.c2=Zf(B.get(h/2))):M.p3=Zf(B.get((h-k)/2)),M.s1=n,M.s2=Zf(B.get(1)),M.t1=Zf(B.get(h-2)),M.t2=e}else{B=new rb,M=q.info={};var u=o("edge.offset"),I=o("edge.center"),x=o("edge.source.t3"),W=o("edge.target.t3"),v=X.p3(),w=f.p3();if(x&&(v[0]+=x[0],v[1]+=x[1],v[2]+=x[2]),W&&(w[0]+=W[0],w[1]+=W[1],w[2]+=W[2]),r===ag){A=o("edge.segments");var F=M.points=o(Tj)||Ee;if(h=F.size()){n=Zf(F.get(0)),e=Zf(F.get(h-1)),!I&&u&&(i=wr(n,v,!0),u=K(u,aq(v,n)),v=[v[0]+i[0]*u,v[1]+i[1]*u,v[2]+i[2]*u],i=wr(w,e,!0),u=K(u,aq(e,w)),w=[w[0]-i[0]*u,w[1]-i[1]*u,w[2]-i[2]*u]);var k=h%2;0===k?(b=Zf(F.get(h/2-1)),Y=Zf(F.get(h/2))):M.p3=Zf(F.get((h-k)/2)),M.s1=v,M.s2=n,M.t1=e,M.t2=w}else!I&&u&&(i=wr(w,v,!0),Z=aq(v,w),u=ne(u,Z),v=[v[0]+i[0]*u,v[1]+i[1]*u,v[2]+i[2]*u],w=[w[0]-i[0]*u,w[1]-i[1]*u,w[2]-i[2]*u]),b=v,Y=w;B.add({x:v[0],y:v[2],e:v[1]}),B.addAll(F),B.add({x:w[0],y:w[2],e:w[1]})}else{var G=Ck(q,S,s,R,r);if(q._19Q||(G=-G),R){var y=v[0],P=v[1],J=v[2],p=X.getTall()/2+G;b=[y-G,P+p,J],Y=[y+G,P+p,J],B.add({x:y-G,y:J,e:P}),B.add({x:y-G,y:J,e:P+p}),B.add({x:y+G,y:J,e:P+p}),B.add({x:y+G,y:J,e:P})}else{i=wr(w,v,!0),Z=aq(v,w);var a={x:v[0],y:v[2]},l={x:w[0],y:w[2]},O=cl(j,a,l,G),T=O.x-a.x,$=O.y-a.y;u=ne(u,Z),i[0]*=u,i[1]*=u,i[2]*=u,b=[v[0]+i[0]+T,v[1]+i[1],v[2]+i[2]+$],Y=[w[0]-i[0]+T,w[1]-i[1],w[2]-i[2]+$],I?(B.add({x:v[0],y:v[2],e:v[1]}),B.add({x:b[0],y:b[2],e:b[1]}),B.add({x:Y[0],y:Y[2],e:Y[1]}),B.add({x:w[0],y:w[2],e:w[1]})):(B.add({x:b[0],y:b[2],e:b[1]}),B.add({x:Y[0],y:Y[2],e:Y[1]}))}}M.c1=b,M.c2=Y}M.list=o(Al)===Lc?q.createTubeModel(B,A,L/2,g):q.createLineModel(B,A,L,"edge","edge.dash")}}});var ih=function(T,f){em(ih,this,[T,f])};Oq(ih,rh,{_80o:function(B,I,b){var R=this,e=R.gv,w=R.shapeModel;hk(e,R.mat),w?il(e,R.data,w,R,R.getBodyColor(),b):(ul(R,B,I,R.left,b),ul(R,B,I,R.front,b),ul(R,B,I,R.right,b),ul(R,B,I,R.back,b),ul(R,B,I,R.top,b),ul(R,B,I,R.bottom,b)),Jn(e)},validate:function(W,b){var H,V,P=this,f=P.s,F=P.data,l=F.p3(),G=F._thickness/2,u=F.isClosePath(),r=F.getPoints(),Y=F.getSegments(),s=f(Dp),X=W&&W.uv;if(P.clear(),0>G)V=P.shapeModel=Yj(r,Y,f(Fq),f(Sb),s,f(Dq),F.getTall(),F.getShapeElevation(),u),f(vo)?f("shape3d.image")||delete V.uv:(delete V.vs,delete V.ns,delete V.uv),f("shape3d.top.image")||delete V.top_uv,f("shape3d.bottom.image")||delete V.bottom_uv;else if(f(Al)===Lc)H=eo(r,Y,s,u),V=P.shapeModel={vs:[]},f("shape3d.image")&&(V.uv=[],V.sum=f(Dq)||Tg(H)||1,V.len=0),f(Fq)&&!u&&(V.top_vs=[],f("shape3d.top.image")&&(V.top_uv=[])),f(Sb)&&!u&&(V.bottom_vs=[],f("shape3d.bottom.image")&&(V.bottom_uv=[])),P._12O(H,G);else{var p,N,K,i,t,c,$,g,Q,q;if(H=eo(r,Y,s,u),t=P.vf(ze,X,!1,b),G&&(c=P.vf(kc,X,!1,b),$=u?j:P.vf(ie,X,!1,b),g=u?j:P.vf(yh,X,!1,b),Q=P.vf(ni,X,!1,b),q=P.vf(ys,X,!1,b)),G){for(var U=0,y=H.length;y>U;U++)H[U]=P._tryRemoveBezierPoints(H[U],G);P._12O(H,G)}else t&&H.forEach(function(m){if(i=m.length,i>0)for(p=m[0],K=1;i>K;K++)N=m[K],P.addV(t.vs,p,N),p=N});P._20Q(H),W||(t&&(t.ns=hd(t.vs),Vh(t,"vs"),Vh(t,Ze)),G&&(c&&(c.ns=hd(c.vs),Vh(c,"vs"),Vh(c,Ze)),$&&($.ns=hd($.vs),Vh($,"vs"),Vh($,Ze)),g&&(g.ns=hd(g.vs),Vh(g,"vs"),Vh(g,Ze)),Q&&(Q.ns=hd(Q.vs),Vh(Q,"vs"),Vh(Q,Ze)),q&&(q.ns=hd(q.vs),Vh(q,"vs"),Vh(q,Ze))))}var O=P.mat=jo();ms(O,l),Ur(O,F.r3(),F.getRotationMode());var e=F.getScale3d(),S=F._dynamicScale3d;S&&(e[0]*=S[0],e[1]*=S[1],e[2]*=S[2]),wm(O,e),ms(O,Fk(l)),W&&(_b(P,O,W,V),P.clear())},_20Q:function(F){var z,G,x,B,c,C,m,W=this,Z=W.front,f=W.back,V=W.top,v=W.bottom,M=Z?Z.tuv:j,a=f?f.tuv:j,w=V?V.tuv:j,J=v?v.tuv:j,t=0;(M||a||w||J)&&(z=W.s(Dq)||Tg(F)||1,F.forEach(function(i){if(G=i.length,G>0)for(C=i[0],x=1;G>x;x++)m=i[x],B=t/z,t+=aq(C,m),c=t/z,W._14O(Z,B,c),W._14O(f,1-c,1-B),W._14O(V,B,c),W._14O(v,B,c),C=m}))},_14O:function(y,i,N){if(y){var w=y.uv,q=y.tuv;if(q){if(w)var x=w[0]+(w[6]-w[0])*i,k=w[1]+(w[7]-w[1])*i,S=w[2]+(w[4]-w[2])*i,d=w[3]+(w[5]-w[3])*i,$=w[2]+(w[4]-w[2])*N,C=w[3]+(w[5]-w[3])*N,R=w[0]+(w[6]-w[0])*N,T=w[1]+(w[7]-w[1])*N;else x=i,k=0,S=i,d=1,$=N,C=1,R=N,T=0;q.push(S,d,$,C,R,T,R,T,x,k,S,d)}}},_13O:function(y){var p=y.uv,s=y.tuv;s&&(p?s.push(p[2],p[3],p[4],p[5],p[6],p[7],p[6],p[7],p[0],p[1],p[2],p[3]):s.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(h,c){var L=h.length;if(4>L)return h;var X,i,H,Y,W,U,b=!1,e=function(d){return h[d]},C=function(I){return h[L-1-I]};for(W=0;1>=W;W++)for(U=W?C:e,i=U(0),H=U(1),X=2;L-1>X;X++)if(Y=U(X),!Y.remove)if(Y.b){var T=cl(i,H,Y,c);T.adjust?(Y.remove=!0,b=!0):(i=H,H=Y)}else i=H,H=Y;if(!b)return h;var G=[];for(X=0;L>X;X++)h[X].remove||G.push(h[X]);return G},_12O:function(m,H){var $,p,k,i,J,h=this;m.forEach(function(I){if(J=I.length,J>0)for($={p:I[0],n:!0},i=1;J>i;i++)p=I[i],k=J-1>i?I[i+1]:j,h.addPoint($,p,k,H,I)})},addPoint:function(Z,T,R,$,t){var r,C,P,g,Q,l,k,F,J,K=this,d=Z.p,M=Z.f,w=Z.b,I=K.s("shape3d.side")||cb,_=K.s("shape3d.start.angle"),o=K.s("shape3d.sweep.angle"),H=K.shapeModel,Y=K.data.isClosePath();if(Z.n&&(Z.n=!1,M=Y&&t.length>2?cl(t[t.length-2],d,T,$):cl(j,d,T,$),w=km(d,M),H?H.top_vs&&K._10O(w,M,I,_,o,H.top_vs,H.top_uv):(r=K.left)&&(K.addV(r.vs,w,M),K._13O(r))),C=R?cl(d,T,R,$):Y&&t.length>2?cl(d,T,t[1],$):cl(d,T,j,$),P=km(T,C),H){var E,z,h=H.vs,D=H.uv,y=H.sum;for(D&&(E=H.len/y,H.len+=aq(d,T),z=H.len/y),l=K._9O(w,M,I,_,o),k=K._9O(P,C,I,_,o),F=0;I>F;F++)J=F+1,zr(h,l[J]),zr(h,k[F]),zr(h,l[F]),zr(h,k[F]),zr(h,l[J]),zr(h,k[J]),D&&(g=F/I,Q=J/I,D.push(E,Q,z,g,E,g,z,g,E,Q,z,Q));!R&&H.bottom_vs&&K._10O(P,C,I,_,o,H.bottom_vs,H.bottom_uv,!0)}else!R&&(r=K.right)&&(K.addV(r.vs,C,P),K._13O(r)),(r=K.front)&&K.addV(r.vs,M,C),(r=K.back)&&K.addV(r.vs,P,w),(r=K.top)&&K.addH(r.vs,M,C,P,w,!0),(r=K.bottom)&&K.addH(r.vs,w,P,C,M);Z.p=T,Z.f=C,Z.b=P},_10O:function(p,V,f,Y,U,l,z,k){var I,X,j=this,d=j.data,a=j._9O(p,V,f,Y,U),t=(p.x+V.x)/2,x=(p.y+V.y)/2,R=d.getShapeElevation(),N=0;for(N=0;f>N;N++)k?(zr(l,a[N]),zr(l,a[N+1])):(zr(l,a[N+1]),zr(l,a[N])),zr(l,[t,R,x]),z&&(k?(I=h*(N+1)/f+Y,X=h*N/f+Y):(I=h*N/f+Y,X=h*(N+1)/f+Y),z.push(.5-.5*v(X),.5-.5*B(X),.5-.5*v(I),.5-.5*B(I),.5,.5))},_9O:function(V,F,e,a,I){var z,P,k=this,$=k.data,c=[],_=(V.x+F.x)/2,Q=(V.y+F.y)/2,b=$.getTall()/2,T=$.getShapeElevation(),Y=0;for(I=I||h;e>=Y;Y++)z=I*Y/e+a,P=v(z),c.push([_+(V.x-_)*P,T+b*B(z),Q+(V.y-Q)*P]);return c},addV:function(c,s,M){var q=s.x,n=s.y,b=M.x,B=M.y,l=this.data,z=l.getShapeElevation(),k=l.getTall()/2;c.push(q,z-k,n,b,z-k,B,b,z+k,B,b,z+k,B,q,z+k,n,q,z-k,n)},addH:function(r,F,j,E,y,q){var V=this.data,X=V.getTall()/2,Z=V.getShapeElevation()+(q?X:-X);r.push(F.x,Z,F.y,j.x,Z,j.y,E.x,Z,E.y,E.x,Z,E.y,y.x,Z,y.y,F.x,Z,F.y)},vf:function(F,c,h,v){var q,g=this,Y=g.gv.getFaceVisible(g.data,F);return(h||Y)&&(q=gh(g,F,v),q.vs=[],q.tuv=Y&&(q.texture||c)?[]:j,q.visible=Y),q}});var Ab=function(o,n){em(Ab,this,[o,n])};Oq(Ab,Nc,{_25Q:1,validate:function(f){var e=this,M=e.data,R=e.s,G=M.getPoints(),F=G.size();if(e.shapeModel=e.info=j,F>1){var i=e.info={},q=M.getSegments(),v=M.getThickness(),y=Zf(G.get(0)),h=Zf(G.get(F-1)),Z=F%2;0===Z?(i.c1=Zf(G.get(F/2-1)),i.c2=Zf(G.get(F/2))):i.p3=Zf(G.get((F-Z)/2)),i.s1=y,i.s2=Zf(G.get(1)),i.t1=Zf(G.get(F-2)),i.t2=h,i.list=R(Al)===Lc?e.createTubeModel(G,q,v/2,f):e.createLineModel(G,q,v,"shape.border","shape.dash")}var T=M.p3(),O=e.mat=jo();ms(O,T),Ur(O,M.r3(),M.getRotationMode());var n=M.getScale3d(),l=M._dynamicScale3d;l&&(n[0]*=l[0],n[1]*=l[1],n[2]*=l[2]),wm(O,n),ms(O,Fk(T))},_80o:function(H,i,s){var o=this,N=o.shapeModel;if(N){var T=o.gv;hk(T,o.mat),il(T,o.data,N,o,o.getBodyColor(),s),Jn(T)}}}),_r(V,{accordionViewExpandIcon:Lq(Dn),accordionViewCollapseIcon:Lq(Dn,!0),accordionViewLabelColor:Kc,accordionViewLabelFont:Pq,accordionViewTitleBackground:Vf,accordionViewSelectBackground:Vm,accordionViewSelectWidth:3,accordionViewSeparatorColor:L,splitViewDividerSize:1,splitViewDividerBackground:Vf,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:Fr,rect:[2,2,12,12],background:Dn}]},propertyViewLabelColor:Ih,propertyViewLabelSelectColor:Kc,propertyViewLabelFont:Pq,propertyViewExpandIcon:Lq(Eg),propertyViewCollapseIcon:Lq(Eg,!0),propertyViewBackground:mp,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:qm,propertyViewColumnLineColor:qm,propertyViewSelectBackground:Vm,listViewLabelColor:Ih,listViewLabelSelectColor:Kc,listViewLabelFont:Pq,listViewRowLineVisible:!1,listViewRowLineColor:qm,listViewSelectBackground:Vm,treeViewLabelColor:Ih,treeViewLabelSelectColor:Kc,treeViewLabelFont:Pq,treeViewExpandIcon:Lq(id),treeViewCollapseIcon:Lq(id,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:qm,treeViewSelectBackground:Vm,treeViewDoubleClickToToggle:!0,tableViewLabelColor:Ih,tableViewLabelSelectColor:Kc,tableViewLabelFont:Pq,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:qm,tableViewColumnLineColor:qm,tableViewSelectBackground:Vm,treeTableViewLabelColor:Ih,treeTableViewLabelSelectColor:Kc,treeTableViewLabelFont:Pq,treeTableViewExpandIcon:Lq(id),treeTableViewCollapseIcon:Lq(id,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:qm,treeTableViewColumnLineColor:qm,treeTableViewSelectBackground:Vm,tableHeaderLabelColor:Ih,tableHeaderLabelFont:Pq,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:Tl,tableHeaderBackground:mp,tableHeaderMoveBackground:Pb,tableHeaderInsertColor:Vm,tableHeaderSortDescIcon:Yh(Eg,!0),tableHeaderSortAscIcon:Yh(Eg),tabViewTabGap:1,tabViewLabelColor:Kc,tabViewLabelFont:Pq,tabViewTabBackground:Vf,tabViewSelectWidth:3,tabViewSelectBackground:Vm,tabViewMoveBackground:Pb,tabViewInsertColor:Vm,toolbarLabelColor:Ih,toolbarLabelSelectColor:Kc,toolbarLabelFont:Pq,toolbarBackground:mp,toolbarSelectBackground:Vm,toolbarItemGap:8,toolbarSeparatorColor:Cd},!0);
var Gl={translateX:1,sortColumn:1},Mg={sortable:1,sortOrder:1,sortFunc:1},sr={focusData:1},Mf={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},fm={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},Jo=function(j,u){u.add(j),j.hasChildren()&&j.eachChild(function(K){Jo(K,u)})},sq=function(p,F,e,z,K,R,L,o,l,q,U){var D,P=e.getValueType(q),B=e.getAlign(q);if(e.getEnumValues(q)){var M=e.toEnumLabel(F,q),k=yo||0,C=0,r=R,J=V.getTextSize(z,M).width;return D=El(e.toEnumIcon(F,q)),D&&(C=R+yo/2,"center"===B?C+=(o-(k+J))/2:"right"===B&&(C=C+o-(k+J)),Rj(p,D,C,L+l/2,q,U),r=C+yo/2),M!=j&&(D?Wp(p,M,z,K,r,L,o-(r-R),l):Wp(p,M,z,K,R,L,o,l,B)),void 0}return F=e.formatValue(F),F!=j?P===Pk?(Yp(p,R,L,o,l,F),void 0):P===Ok||!P&&bc(F)?(D=El(F?uh:oc),Rj(p,D,R+o/2,L+l/2,q,U),void 0):(Wp(p,F,z,K,R,L,o,l,B),void 0):void 0},Em=function(b,J){var _=J.view,y=Vg(b),d=J.column||J.property;_.getDataModel().beginTransaction(),J.editor=b,b.info=J,_.setCurrentEditor(b),_.getView().insertBefore(y,_._79O),Db(b,J.editorRect),b.setFocus?b.setFocus():ch(b),b.commitValue=function(){b._17Q&&(b=b._17Q),_.setValue(J.data,d,b.getValue?b.getValue():b.value),b.close&&b.close(),er(y)},d.onEditorCreated&&d.onEditorCreated(J)},Aq=function(D,l,N,W,T){var P=Ce(D,N),s=l.value,J=l.view,R=T.getValueType(l.data);return P.onblur=P.onchange=function(){J.endEditing()},"input"===D?(s=T.formatValue(s),s!=j&&(P.value=s),P.onkeydown=function(v){qc(v)&&J.endEditing()},(R===Dd||R===Pm)&&P.addEventListener(uo,V.numberListener,!1)):D===Yc&&W.forEach(function(g){var b=u.createElement("option");b.innerHTML=T.toEnumLabel(g),b.value=g,T.isEnumEqual(s,g)&&(b.selected=!0),Pi(P,b)}),Em(P,l),P},Se=e.widget={},Ni=function(G,m,n){Oq(w+".widget."+G,m,n)};_r(Rp,{ms_value:function(u){u.getValue=function(I){var B=this.getItemById(I),J=B.element;return Ui(J)?J:J?J.getValue?J.getValue():J.value:B.selected},u.setValue=function(K,n){var M=this.getItemById(K),O=M.element;O&&!Ui(O)?O.setValue?O.setValue(n):O.value=n:bc(n)?(M.selected=n,this.iv()):(M.element=n,this.iv())},u.v=function(X,Y){var w=this;if(2===arguments.length)w.setValue(X,Y);else{if(!Hj(X))return w.getValue(X);for(var r in X)w.setValue(r,X[r])}return w}},_46o:function(f){f._icon=j,f._accessType=j,f._valueType=j,f._editable=!1,f._batchEditable=!0,f._align=ie,f._nullable=!0,f._emptiable=!1,f.setParent=Fh,f.formatValue=function(u){var K=this,P=K._valueType;return K.getEnumValues()?K.toEnumLabel(u):P===Ok?!!u:u!=j&&P===Dd?Z(u):u},f.setEnum=function(h,w,N,P,V,O,X){var r=this;h&&!ck(h)&&h.values&&(P=h.editable,N=h.icons,w=h.labels,V=h.strict,O=h.maxHeight,X=h.dropDownWidth,h=h.values),Hn(h)&&(h=h._as),Hn(w)&&(w=w._as),Hn(N)&&(N=N._as),r._enumValues=h,r._enumLabels=w,r._enumIcons=N,r._enumEditable=P,r._enumStrict=V==j?!0:V,r._enumMaxHeight=O,r._enumDropDownWidth=X,h&&h.length&&Gc(h[0])&&(r._valueType=Pm),r.fp("enum",!1,!0)},f.getEnumDropDownWidth=function(){return this._enumDropDownWidth},f.getEnumMaxHeight=function(){return this._enumMaxHeight},f.isEnumEditable=function(){return this._enumEditable},f.getEnumValues=function(){return this._enumValues},f.getEnumLabels=function(){return this._enumLabels},f.getEnumIcons=function(){return this._enumIcons},f.isEnumStrict=function(){return this._enumStrict},f.isEnumEqual=function(i,j){return this._enumStrict?i===j:i==j},f.toEnumLabel=function(w,A){var T=this,r=T.getEnumValues(A),v=T.getEnumLabels(A);if(r&&v)for(var R=0;R<r.length;R++)if(T.isEnumEqual(w,r[R]))return v[R];return w},f.toEnumIcon=function(s,A){var O=this,Y=O.getEnumValues(A),G=O.getEnumIcons(A);if(Y&&G)for(var T=0;T<Y.length;T++)if(O.isEnumEqual(s,Y[T]))return G[T];return L}},_45o:function(_){_._87o=function(o,D,w,U,A,N){if(o){var y=this,e=y._90I,h=Cc(1);y._columnLineVisible&&(A-=1),y._rowLineVisible&&(N-=1),0>=A||0>=N||(y._90I||(e=y._90I={}),e[D]||(e[D]=new rb),Db(h,y.tx()+w,y.ty()+U,A,N),Pi(h,o),y._view.insertBefore(h,y._79O),o.onParentAdded&&o.onParentAdded(h),e[D].add(h))}},_._76o=function(){var T=this,C=T._90I;if(C){for(var I in C)C[I].each(function(B){er(B)});delete T._90I}},_._77o=function(m){var b=this;if(b._90I){var x=b._90I[m];x&&(x.each(function(A){er(A)}),delete b._90I[m])}}},_47o:function(p){p.getValue=function(x,V){return V.getValue?V.getValue(x,V,this):pn(x,V.getAccessType(),V.getName())},p.setValue=function(f,n,U){if(n.isEmptiable(f)||""!==U||(U=L),n.isNullable(f)||U!=j){var T=this,z=n.getName(f),F=n.getAccessType(f),$=n.getValueType(f);$===Dd&&Ui(U)?U=c(U):$===Pm&&Ui(U)?U=parseFloat(U):$===Ok&&Ui(U)&&(U="true"===U),T._batchEditable&&n._batchEditable&&T.isSelected(f)?T.sm().each(function(v){n.setValue?n.setValue(v,n,U,T):ib(v,F,z,U)}):n.setValue?n.setValue(f,n,U,T):ib(f,F,z,U)}},p.setCurrentEditor=function(P){this.endEditing(),this._currentEditor=P,this.redraw()},p.isEditing=function(X,v){var E=this,P=E._currentEditor;if(!P)return!1;if(v){var y=P.info;return y?(y.column||y.property)===v&&y.data===X:!1}return!0},p.endEditing=function(){var r=this,S=r._currentEditor;S&&(delete r._currentEditor,S.commitValue&&S.commitValue(S.info),r.redraw(),r.getDataModel().endTransaction())},p.beginEditing=function(D){this.endEditing();var d=this,g=D.column||D.property;if(g.beginEditing)g.beginEditing(D);else{var i=D.data,H=D.value,U=d.getSelectBackground(i),_=g.getEnumValues(i),c=g.getSlider(i),h=g.getColorPicker(i);if(c){var K=gp(Se.Slider,c);return K.setValue(H),K.getView().onblur=function(){d.endEditing()},K.isInstant()&&(K.onValueChanged=function(){d.setValue(i,g,K.getValue())}),Em(K,D),void 0}if(h||g.getValueType(i)===Pk){var I=gp(Se.ColorPicker,h);return I.setValue(H),I.onClosed=function(){d.endEditing()},I.isInstant()&&(I.onValueChanged=function(q,K){d.setValue(i,g,K)}),Em(I,D),I.open(),void 0}if(_){if(Se.ComboBox){var e=new Se.ComboBox;e.setValue(H),e.setValues(_),e.setLabels(g.getEnumLabels(i)),e.setIcons(g.getEnumIcons(i)),e.setEditable(g.isEnumEditable(i)),e.setStrict(g.isEnumStrict(i)),e.setMaxHeight(g.getEnumMaxHeight(i)),e.setDropDownWidth(g.getEnumDropDownWidth(i)),e.onClosed=function(){d.endEditing()},Em(e,D),e.open()}else Aq(Yc,D,U,_,g);return}var C=g.getValueType(i);if(C===Ok||bc(H))return d.setValue(i,g,!H),void 0;if(g.getItemEditor(i)){var B=yp(g.getItemEditor(i)),r=new B(i,g,d,D),V=r.getView();return V._17Q=r,r.setValue(H),yc(V),Em(V,D),r.editBeginning&&r.editBeginning(),void 0}Aq("input",D,U,j,g)}}},_44o:function(e){e.init=function(a){var A=this,Z=A.th=new xe(a),d=A._view=Ul(1,A);A.tv=A._tableView=a,Pi(d,Z.getView()),Pi(d,a.getView()),Z.mp(function(E){E.property===Oc&&A.iv()}),A.iv()},e.getTableView=function(){return this.tv},e.getTableHeader=function(){return this.th},e.getDataModel=function(){return this.tv.dm()},e.getColumnModel=function(){return this.tv.getColumnModel()},e.setColumns=function(k){this.tv.setColumns(k)},e.addColumns=function(A){this.tv.addColumns(A)},e.endEditing=function(){this.tv.endEditing()},e.validateImpl=function(){var n=this,e=n.th,M=hi(e),H={x:0,y:0,width:n.getWidth(),height:M};Db(e,H),H.y=M,H.height=Y(0,n.getHeight()-M),Db(n.tv,H)}},ms_vs:function(H){H._41o=function(){return this._29I.height<this._59I},H._43o=function(){var Z=this;Z._41o()&&(Z._58I||(M(function(){Z._94O()},Mi),Z.iv()),Z._58I=new Date)},H._94O=function(){var v=this;if(v._58I){var N=new Date;N.getTime()-v._58I.getTime()>=Mi?(delete v._58I,v.iv()):M(function(){v._94O()},Mi)}},H._93I=function(){var K=this,D=K._27I;if(K._58I||!K._autoHideScrollBar){D||Pi(K._79O,D=K._27I=Cc());var d=K._29I,Z=d.height,X=K._59I,B=K.getScrollBarSize(),h=d.width-B-2,L=Z*(-K.ty()/X),I=Z*(Z/X),V=D.style;X>Z?(lk>I&&(L=L+I/2-lk/2,0>L&&(L=0),L+lk>Z&&(L=Z-lk),I=lk),V.visibility=Gr,V.background=K.getScrollBarColor(),V.borderRadius=B/2+vc,Db(D,h,L,B,I)):V.visibility=am}else D&&(D.style.visibility=am)}},ms_hs:function(B){B._40o=function(){return this._29I.width<this._91I},B._42o=function(){var T=this;T._40o()&&(T._95O||(M(function(){T._94I()},Mi),T.iv()),T._95O=new Date)},B._94I=function(){var S=this;if(S._95O){var k=new Date;k.getTime()-S._95O.getTime()>=Mi?(delete S._95O,S.iv()):M(function(){S._94I()},Mi)}},B._92I=function(){var q=this,$=q._28I;if(q._95O||!q._autoHideScrollBar){$||Pi(q._79O,$=q._28I=Cc());var C=q._29I,Z=C.width,N=q._91I,t=q.getScrollBarSize(),e=C.height-t-2,T=Z*(-q.tx()/N),H=Z*(Z/N),c=$.style;N>Z?(lk>H&&(T=T+H/2-lk/2,0>T&&(T=0),T+lk>Z&&(T=Z-lk),H=lk),c.visibility=Gr,c.background=q.getScrollBarColor(),c.borderRadius=t/2+vc,Db($,T,e,H,t)):c.visibility=am}else $&&($.style.visibility=am)}}}),wn(uh,hq(16,16,[{type:Iq,rect:[1,1,14,14],background:Vm},{type:Xf,rect:[1,1,14,14],width:1,color:br},{type:Lo,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),wn(oc,hq(16,16,{type:Xf,rect:[1,1,14,14],width:1,color:br})),wn(Jj,hq(16,16,[{type:df,rect:[2,2,12,12],borderWidth:1,borderColor:br,background:"#FFF"},{type:df,rect:[4,4,8,8],background:Vm}])),wn(Qo,hq(16,16,{type:df,rect:[2,2,12,12],borderWidth:1,borderColor:br})),Rp._15Q=function(B){B._29I=Vo,B._59I=0,B._91I=0,B._5o=function(M){var E=this;E._30I=new rb,E._rows=new rb,E._rowMap={},E._31I=0,E._14I=0,E._view=Ul(1,E),E._canvas=Ji(E._view),Pi(E._view,E._79O=Cc()),E.dm(M?M:new si)},B.getCheckIcon=function(w){var x=this.sm(),Q=x.co(w);return x.sg()?El(Q?Jj:Qo):El(Q?uh:oc)},B.checkData=function(P){var Z=this.sm(),Y=Z.co(P);Z.sg()&&Y||(this._32o=1,Y?Z.rs(P):Z.as(P),delete this._32o)},B.getDataAt=function(l){l.target&&(l=this.lp(l));var G=o(l.y/this._rowHeight),p=this._rows;return 0>G||G>=p.size()?j:p.get(G)},B.onDataDoubleClicked=function(){},B.onDataClicked=function(){},B.adjustTranslateX=function(){return 0},B.adjustTranslateY=function(x){var w=this.getHeight()-this._59I;return w>x&&(x=w),x>0?0:Z(x)},B.onPropertyChanged=function(k){var m=this,g=k.property;Mf[g]?m.ivm():sr[g]||m.redraw(),g===hj?m._42o():g===_c&&m._43o()},B.getLabel=function(I){return I.toLabel()},B.getLabelFont=function(){return this._labelFont},B.getLabelColor=function(b){var c=this;if(c.isCheckMode()){if(c._focusData===b)return c._labelSelectColor}else if(c.isSelected(b))return c._labelSelectColor;return c._labelColor},B.getStartRowIndex=function(){return this._31I},B.getEndRowIndex=function(){return this._14I},B.getRowDatas=function(){return this._rows},B.getRowIndex=function(o){return this._rowMap[o._id]},B.getRowSize=function(){return this._rows.size()},B.getViewRect=function(){return Hm(this._29I)},B.isVisible=function(H){return this._visibleFunc?this._visibleFunc(H):!0},B.getCurrentSortFunc=function(){return this._sortFunc},B.setDataModel=function(f){var p=this,P=p._dataModel,F=p._selectionModel;P!==f&&(P&&(P.umm(p.handleDataModelChange,p),P.umd(p.handleDataPropertyChange,p),P.umh(p.handleHierarchyChange,p),F||P.sm().ums(p.handleSelectionChange,p)),p._dataModel=f,f.mm(p.handleDataModelChange,p),f.md(p.handleDataPropertyChange,p),f.mh(p.handleHierarchyChange,p),F?F._21I(f):f.sm().ms(p.handleSelectionChange,p),p.fp("dataModel",P,f))},B.validateModel=function(){var t=this;t._rows.clear(),t._rowMap={},t.buildChildren(t._dataModel._roots);var I=t._rows=t._rows.toList(t.isVisible,t),V=0,g=t.getCurrentSortFunc(),G=I.size();for(g&&I.sort(g);G>V;V++)t._rowMap[I.get(V)._id]=V},B.buildChildren=function(S){var O=this;S.each(function(b){O._rows.add(b),O.buildChildren(b._children)})},B.handleDataModelChange=function(){this.ivm()},B.handleDataPropertyChange=function(x){"parent"===x.property?this.ivm():this.invalidateData(x.data)},B.handleHierarchyChange=function(){this.ivm()},B.handleSelectionChange=function(O){O.datas.each(this.invalidateData,this),this.onSelectionChanged(O)},B.onSelectionChanged=function(z){var j=this,Q=j.sm();!j.isAutoMakeVisible()||1!==Q.size()||"set"!==z.kind&&"append"!==z.kind||j._32o||j.makeVisible(Q.ld())},B.handleBackgroundClick=function(Y){Wr(Y)&&!this.isCheckMode()&&this.sm().cs()},B.makeVisible=function(a){a&&(this._23I=a,this.iv())},B.scrollToIndex=function(Y){var X=this,B=X._29I,H=B.height,W=X._rowHeight,r=W*Y;Y>=0&&Y<X._rows.size()&&H>0&&(r+W>B.y+H?X.ty(-r+H-W):r<B.y&&X.ty(-r))},B.autoScroll=function(h,u){var C=this,f=C._rowHeight,q=f,I=f/4,N=C._29I,E=C.lp(h),O={x:C.tx(),y:C.ty()};return f>0&&N&&(E.x-N.x<q?C.translate(I,0):N.x+N.width-E.x<q&&C.translate(-I,0),E.y-N.y<q?C.translate(0,I):N.y+N.height-E.y<q&&C.translate(0,-I)),O.x=C.tx()-O.x,O.y=C.ty()-O.y,u&&(u.x+=O.x,u.y+=O.y),O},B.getTopRowOrderSelection=function(){var v=this.sm().getTopSelection(),s={},N=new rb;return v.each(function(S){s[S._id]=S}),this._rows.each(function(Y){s[Y._id]&&N.add(Y)}),N},B.getRowOrderSelection=function(){var R=new rb;return this._rows.each(function(C){this.isSelected(C)&&R.add(C)},this),R},B.ivm=function(){this.invalidateModel()},B.invalidateModel=function(){var z=this;z._96I||(z._96I=1,z._32I=1,delete z._24I),z.iv()},B.redraw=function(){var h=this;h._32I||(h._32I=1,delete h._24I,h.iv())},B.invalidateData=function(O){var e=this;_?e.redraw():e._32I||(e._24I||(e._24I={}),e._24I[O._id]=O,e.iv())},B.getFocusData=function(){return this._focusData},B.setFocusDataById=function(j){this.setFocusData(this.dm().getDataById(j))},B.setFocusData=function(P){var I=this,g=I._focusData;g!==P&&(I._focusData=P,I.fp("focusData",g,P),g&&I.invalidateData(g),P&&(I.invalidateData(P),I.isAutoMakeVisible()&&I.makeVisible(P)))},B.drawRowBackground=function(_,z,x,i,s,c,P){var U=this,W=U.isCheckMode();(z===U._focusData&&W||x&&!W)&&Yp(_,i,s,c,P,U.getSelectBackground(z))},B.drawData=function(l,C,m){var U=this,$=U._rowHeight,E=$*m,A=U._29I,Z=A.x,J=A.width;l.save(),l.beginPath(),l.rect(Z,E,J,$),l.clip(),U._87o(U.drawRow(l,C,U.isSelected(C),Z,E,J,$),m,Z,E,J,$),l.restore(),U._rowLineVisible&&Yp(l,Z,E+$-1,J,1,U._rowLineColor)},B._12I=function(W){var P=this,Q=P._31I,t=P._29I,s=t.x,B=t.y,G=t.width,n=t.height;for(W.beginPath(),W.rect(s,B,G,n),W.clip(),W.clearRect(s,B,G,n),P._76o(),P._93db(W);Q<P._14I;Q++)P.drawData(W,P._rows.get(Q),Q);P._92db(W)},B._13I=function(b){for(var r,t=this,K=t._rowHeight,k=t._29I,I=k.x,P=k.width,Z=t._31I,$=t._30I;Z<t._14I;Z++)r=t._rows.get(Z),t._24I[r._id]&&$.add({data:r,index:Z});$.isEmpty()||(b.beginPath(),$.each(function(S){b.rect(I,S.index*K,P,K)}),b.clip(),$.each(function(_){b.clearRect(I,_.index*K,P,K)}),$.each(function(n){t._77o(n.index)}),t._93db(b),$.each(function(X){t.drawData(b,X.data,X.index)}),t._92db(b),$.clear())},B.validateImpl=function(){var p=this,C=p._canvas,z=p.getWidth(),F=p.getHeight(),M=p._rowHeight,W=p._32I;(z!==C.clientWidth||F!==C.clientHeight)&&(zm(C,z,F),W=1);var Q=g&&!T;p._96I&&!Q&&p.validateModel();var $=p._29I,n={x:-p.tx(),y:-p.ty(),width:z,height:F},L=p._rows.size(),l=Vq(C),t=p._23I;W||li(n,$)||(W=1),p._29I=n,p._59I=L*M,p._31I=o(n.y/M),p._14I=k((n.y+n.height)/M),p._31I<0&&(p._31I=0),p._14I>L&&(p._14I=L),p._99I&&W&&p._99I(),Wl(l,p.tx(),p.ty(),1),W?p._12I(l):p._24I&&p._13I(l),p._93I(),p._92I(),l.restore(),p._32I=p._24I=p._96I=j,t&&(p.scrollToIndex(p.getRowIndex(t)),delete p._23I),p.tx(p.tx()),p.ty(p.ty())}},Rp._48o=function(w){w._rootVisible=!0,w._rootData=j,w._35o=function(){this._expandMap={},this._levelMap={}},w.validateModel=function(){var i=this,D=i._rootData;i._rows.clear(),i._levelMap={},i._rowMap={},i._currentLevel=0,D?i._rootVisible?i.isVisible(D)&&i.buildData(D):i.buildChildren(D):i.buildChildren(),delete i._currentLevel},w.buildData=function(O){var N=this,w=O._id,$=N._rows;N._rowMap[w]=$.size(),$.add(O),N._levelMap[w]=N._currentLevel,N.isExpanded(O)&&(N._currentLevel++,N.buildChildren(O),N._currentLevel--)},w.buildChildren=function(f){var y=this,Z=f?f._children:y._dataModel._roots,o=y.getCurrentSortFunc();o&&y.isChildrenSortable(f)?Z.toList(y.isVisible,y).sort(o).each(y.buildData,y):Z.each(function(C){y.isVisible(C)&&y.buildData(C)})},w.getLevel=function(M){return this._levelMap[M._id]},w.getToggleIcon=function(z){var N=this,i=N._loader,P=N._collapseIcon;return i&&!i.isLoaded(z)?P:z.hasChildren()?N.isExpanded(z)?N._expandIcon:P:j},w.isCheckMode=function(){return this._checkMode!=j},w.isChildrenSortable=function(){return!0},w.handleDataModelChange=function(u){var Q=this;u.kind===qe?delete Q._expandMap[u.data._id]:u.kind===Oe&&(Q._expandMap={}),Q.ivm()},w.toggle=function(I){var p=this;p.isExpanded(I)?p.collapse(I):p.expand(I)},w.isExpanded=function(k){return 1===this._expandMap[k._id]},w.expand=function(F){var l=this,E=l._loader;l.isExpanded(F)||(E&&!E.isLoaded(F)&&E.load(F),l._expandMap[F._id]=1,l.ivm(),l.onExpanded(F))},w.onExpanded=function(){},w.collapse=function(V){var e=this;e.isExpanded(V)&&(delete e._expandMap[V._id],e.ivm(),e.onCollapsed(V))},w.onCollapsed=function(){},w.expandAll=function(F){if(F)this.expand(F),F.eachChild(function(V){this.expandAll(V)},this);else{var E=this;E._dataModel.each(function(x){x.hasChildren()&&(E._expandMap[x._id]=1)}),E.ivm()}},w.collapseAll=function(){this._expandMap={},this.ivm()},w.makeVisible=function(a){if(a){var i=this;if(!i._rootData||a.isDescendantOf(i._rootData)){for(var c=a._parent;c;)i.expand(c),c=c._parent;i._23I=a,i.iv()}}},w.checkData=function(b){var Y,l=this,J=l._checkMode,Z=l.sm(),y=Z.co(b);if(!Z.sg()||!y){if(l._32o=1,J===Dh)y?Z.rs(b):Z.as(b);else if(J===rq)Y=new rb(b),Y.addAll(b._children);else if("descendant"===J)Y=new rb,Jo(b,Y);else if("all"===J&&(Y=new rb,Jo(b,Y),!y))for(var v=b._parent;v;)Y.add(v),v=v._parent;Y&&(y?Z.rs(Y):Z.as(Y)),delete l._32o}},w._97I=function(r,k,H,O,g,Z,V){var i=this,s=i._indent,K=i._levelMap[k._id],t=i.getIconWidth(k),F=El(i.getToggleIcon(k));F?(O+=s*K,Rj(r,F,O+s/2,g+V/2,k,i),O+=s):O+=s*(K+1),i._checkMode&&(Rj(r,i.getCheckIcon(k),O+s/2,g+V/2,k,i),O+=s),i.drawIcon(r,k,O,g,t,V),i.drawLabel(r,k,O+t,g,V)}},Rp._14Q=function(O){O.getIcon=function(f){return f.getIcon()},O.getIconWidth=function(s){return this.getIcon(s)?this._indent:0},O.drawIcon=function(H,b,d,P,v,s){if(v){var X=this,y=X.getBodyColor(b),V=El(X.getIcon(b),y);V&&(s-=X.isRowLineVisible()?1:0,Dm(H,V,ai,d,P,v,s,b,X,y),$h(H,X.getBorderColor(b),d,P,v,s))}},O.drawLabel=function(T,q,o,n,t){var w=this;Wp(T,w.getLabel(q),w.getLabelFont(q),w.getLabelColor(q),o,n,0,t)}},Rp._50o=function(O){O._98I=function(){var H=this,L=H._39o=new si;H._60I=new rb,L.mm(H._17o,H),L.md(H._18o,H),L.mh(H._19o,H)},O.setColumns=function(y){this._39o.clear(),this.addColumns(y)},O.addColumns=function(i){var _=this._39o;i.forEach(function(d){if(!(d instanceof hm)){var w=yp(d.className);d=gp(w?w:hm,d)}_.add(d)})},O.onColumnClicked=function(){},O.onCheckColumnClicked=function(){},O._3Q=function(D){for(var y,R=0,c=this._60I,k=c.size();k>R;R++)if(y=c.get(R),y.column===D)return y;return j},O.getColumnAt=function(a){var C=this._4Q(a);return C?C.column:j},O._4Q=function(b){for(var h=this,n=b.target?h.lp(b).x:b.x,f=h._60I,R=0;R<f.size();R++){var N=f.get(R),s=N.startX;if(n>=s&&n<s+N.column.getWidth())return N}return j},O.getToolTip=function(E){var v=this,U=v.getDataAt(E),$=v.getColumnAt(E);return U&&$?$.getToolTip(U,v):j},O.adjustTranslateX=function(e){var X=this.getWidth()-this._91I;return X>e&&(e=X),e>0?0:Z(e)},O._99I=function(){var H=this,h=H._29I,i=H._60I;i.clear(),H._91I=0,H._39o._roots.each(function(c){if(c.isVisible()){var S=H._91I+c.getWidth();H._91I<=h.x+h.width&&S>=h.x&&i.add({column:c,startX:H._91I}),H._91I=S}})},O.drawData=function(Q,z,D){var E=this,F=E._rowHeight,l=F*D,P=E.isSelected(z),T=E._29I,U=T.x,w=T.width;E.drawRowBackground(Q,z,P,U,l,w,F),E._60I.each(function(x){var Y=x.column,K=x.startX,e=Y.getWidth();e>0&&!E.isEditing(z,Y)&&(Q.save(),Q.beginPath(),Q.rect(K,l,e,F),Q.clip(),E._87o(E.drawCell(Q,z,P,Y,K,l,e,F),D,K,l,e,F),E._columnLineVisible&&Yp(Q,K+e-1,l,1,F,E._columnLineColor),Q.restore())}),E._rowLineVisible&&Yp(Q,U,l+F-1,w,1,E._rowLineColor)},O.drawCell=function(F,y,l,Y,X,S,w,E){var A=this;if(Y.drawCell)return Y.drawCell(F,y,l,Y,X,S,w,E,A);var U=A.getValue(y,Y);sq(F,U,Y,A.getLabelFont(y,Y,U),A.getLabelColor(y,Y,U),X,S,w,E,y,A)},O.getColumnModel=function(){return this._39o},O._17o=function(){this.redraw()},O._18o=function(p){var g=this;p.data===g._sortColumn&&Mg[p.property]?g.ivm():(g._42o(),g.redraw())},O._19o=function(){this.redraw()},O.getCurrentSortFunc=function(){var _=this,e=_._sortColumn;if(e&&e.isSortable()){var V=e.getSortFunc(),z=us===e.getSortOrder()?1:-1;return V||(V=Wg),function(T,N){return V.call(_,_.getValue(T,e),_.getValue(N,e),T,N)*z}}return _._sortFunc},O.isCellEditable=function(w,U){return!this.isCheckMode()&&this.isSelected(w)||this.isCheckMode()&&w===this._focusData?U.isEditable()&&this.isEditable():!1},O._37O=function(Z,C){if(Wr(C))for(var n=this,K=n.lp(C),B=n._60I,q=n._rowHeight,j=n._29I,w=j.x,M=j.y,N=j.width,U=j.height,y=0;y<B.size();y++){var P=B.get(y),p=P.startX,s=P.column,a=s.getWidth();if(s!==n._31o&&s!==n._4o&&n.isCellEditable(Z,s,C)&&K.x>=p&&K.x<p+a){var l={x:p,y:n.getRowIndex(Z)*q,width:a,height:q},Q={x:l.x+n.tx(),y:l.y+n.ty(),width:l.width,height:l.height},d=0,R=0;return l.x<w?d=l.x-w:l.x+l.width>w+N&&(d=l.x+l.width-w-N),d&&(n.tx(n.tx()-d),Q.x-=d),l.y<M?R=l.y-M:l.y+q>M+U&&(R=l.y+q-M-U),R&&(n.ty(n.ty()-R),Q.y-=R),n.beginEditing({data:Z,column:s,value:n.getValue(Z,s),event:C,rect:l,editorRect:Q,view:n}),void 0}}}},Se.BaseItemEditor=function(E,d,K,T){this._data=E,this._column=d,this._master=K,this._editInfo=T},Ni("BaseItemEditor",N,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var sm=e.Tab=function(){em(sm,this)};ok("Tab",Yb,{ms_ac:["view","closable","disabled"],_icon:j,_closable:!1,_disabled:!1,setParent:Fh});var hm=e.Column=function(){em(hm,this)};ok("Column",Yb,{_46o:1,ms_ac:["accessType","valueType",Gr,Ph,_l,vm,"align",Pk,"sortOrder",dm,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:us,_sortFunc:j,_sortable:!0,_clickable:!0,setWidth:function(G){16>G&&(G=16);var V=this._width;this._width=G,this.fp(vm,V,G)},getToolTip:function($,P){return this.formatValue(P.getValue($,this))}});var Mh=e.Property=function(){em(Mh,this)};ok("Property",Yb,{_46o:1,ms_ac:["accessType","valueType",Ph,_l,"categoryName",Pk,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:j,getToolTip:function(m,z,V){var H=this;return z?H.formatValue(V.getValue(m,H)):V.getPropertyName(H)}}),Se.AccordionView=function(){var s=this;s._20o={},s._21o=new rb,s._10o=j,s._9o=j,s._11o=j,s._view=Ul(0,s),s.iv()},Ni("AccordionView",N,{ms_v:1,ms_fire:1,ms_ac:[ml,Gd,"titleHeight",Om,Cf,"titleBackground","selectWidth",gi,"orientation","separatorColor"],_expandIcon:V.accordionViewExpandIcon,_collapseIcon:V.accordionViewCollapseIcon,_titleHeight:Bs,_labelColor:V.accordionViewLabelColor,_labelFont:V.accordionViewLabelFont,_titleBackground:V.accordionViewTitleBackground,_selectBackground:V.accordionViewSelectBackground,_selectWidth:V.accordionViewSelectWidth,_orientation:"v",_separatorColor:V.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(m,S,R,Q){var I=this,v=Cc();if(I._20o[m])throw m+" already exists";v.onmousedown=Bk,v.style.cursor=On,v.addEventListener(q?lc:Tc,function(J){Bk(J)},!1),v.addEventListener(q?ur:Uo,function(w){Bk(w),Wr(w)&&(I._10o===m?I.collapse():I.expand(m))},!1),Pi(I._view,v),I._20o[m]={content:S,div:v,canvas:Ji(v),icon:Q},I._21o.add(m),R&&I.expand(m),I.iv()},remove:function(d){var Y=this,E=Y._20o[d];E&&(er(E.div),delete Y._20o[d],Y._21o.remove(d),Y.iv())},clear:function(){var U=this;U._20o={},U._21o.clear(),U.iv()},isExpanded:function(K){return this._10o===K},expand:function(W){var F=this;F._20o[W]&&F._10o!==W&&(F._10o=W,F.onExpanded(W),F.iv())},onExpanded:function(){},collapse:function(){var g=this;g._10o&&(g.onCollapsed(g._10o),delete g._10o,g.iv())},onCollapsed:function(){},initCanvas:function(i,H,V){zm(i,H,V);var r=Vq(i);return Wl(r,0,0,1),r.clearRect(0,0,H,V),r},drawTitle:function(u,k,R,c,$){var K=this,o=El($.icon),r=K.isExpanded(k),E=K._titleHeight,t=K._titleBackground,G=K._selectWidth,S=K._separatorColor,l=El(r?K._expandIcon:K._collapseIcon),m=G+4;Yp(u,0,0,R,c,t),r&&G&&Yp(u,0,0,G,c,K._selectBackground),(r||K._21o.get(K._21o.size()-1)!==k)&&Yp(u,0,c-1,R,1,S?S:xs(t)),o&&(Rj(u,o,m+Fd(o)/2,E/2),m+=Fd(o)+2),Wp(u,k,K.getLabelFont(k),K.getLabelColor(k),m,0,0,E),l&&Rj(u,l,R-Fd(l)/2-4,E/2)},validateImpl:function(){var O=this,J=O._view,D=0,S=0,c=O.getWidth(),w=O.getHeight(),h=O._titleHeight,t=O._21o.size()*h,z=O._11o,U=O._9o;delete O._11o,delete O._9o,O._21o.each(function(B){var j,u,H=O._20o[B],r=H.content,o=O._10o===B;Zk(O)?(Db(H.div,D,0,h,w),j=O.initCanvas(H.canvas,h,w),Lh(j,0,w),Xe(j,-P),O.drawTitle(j,B,w,h,H),j.restore(),o?(u=Y(0,c-t),r&&(O._11o=r,O._9o=Vg(r),Db(r,D+h,0,u,w)),D+=h+u):D+=h):(Db(H.div,0,S,c,h),j=O.initCanvas(H.canvas,c,h),O.drawTitle(j,B,c,h,H),j.restore(),o?(u=Y(0,w-t),r&&(O._11o=r,O._9o=Vg(r),Db(r,0,S+h,c,u)),S+=h+u):S+=h)});var l=O._9o;z&&z!==O._11o&&z.endEditing&&z.endEditing(),l&&l!==U&&Pi(J,l),U&&U!==l&&er(U)}}),Se.SplitView=function(W,Z,x,t){var b=this,f=b._dividerDiv=Cc(),O=b._60O=Ji(),G=b._61O=Ji(),q=O.style,o=G.style;b._view=Ul(1,b),Pi(b._view,f),q.msTouchAction=Zo,q.pointerEvents=Zo,q.cursor=On,o.msTouchAction=Zo,o.pointerEvents=Zo,o.cursor=On,W&&b.setLeftView(W),Z&&b.setRightView(Z),x&&b.setOrientation(x),t!=j&&b.setPosition(t),b.setStatus(Jr),new gb(b)},Ni("SplitView",N,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:V.splitViewDividerSize,_dividerBackground:V.splitViewDividerBackground,_dragOpacity:V.splitViewDragOpacity,_toggleIcon:V.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(O,p){var R=this,M=R._position;isNaN(O)||(p||(R._82O=0>O?-1:O>1?1:0),R._position=O,R.fp(Jm,M,O))},getLeftView:function(){return this._leftView},setLeftView:function(x){var t=this,g=t._leftView,a=t._view;if(t._leftView!==x){if(g&&g!==t._rightView){var J=Vg(g);J.parentNode===a&&er(J)}if(t._leftView=x,x){var w=Vg(x);w.parentNode!==a&&a.insertBefore(w,t._dividerDiv)}t.fp("leftView",g,x)}},getRightView:function(){return this._rightView},setRightView:function(v){var G=this,h=G._rightView,d=G._view;if(G._rightView!==v){if(h&&h!==G._leftView){var $=Vg(h);$.parentNode===d&&er($)}if(G._rightView=v,v){var y=Vg(v);y.parentNode!==d&&d.insertBefore(y,G._dividerDiv)}G.fp("rightView",h,v)}},validateImpl:function(){var b=this,j=b._draggable,$=b._position,B=b.getWidth(),N=b.getHeight(),k=b._dividerSize,u=b._dividerBackground,e=q?18:8,x=b._dividerDiv,C=b._82O,_=b._60O,J=b._61O,v=b._toggleIcon,F=b._status,s=x.style,W=null,z=q?20:4,t=v.comps[0];k>=e||0===k?b._coverDiv&&(er(b._coverDiv),delete b._coverDiv):b._coverDiv||(b._coverDiv=Cc(),p&&(b._coverDiv.style.background=As),Pi(x,b._coverDiv)),b._togglable?_.parentNode||(Pi(x,_),Pi(x,J)):(er(_),er(J));var c=b._coverDiv,S=b._leftView,V=b._rightView;if(Zk(b)){if(k>B&&(k=B),F===Jr)if(1===C)var L=K($,B),U=Y(0,B-k-L);else-1===C?(U=K(-$,B),L=Y(0,B-k-U)):(L=Z((B-k)*$),U=Y(0,B-k-L));else"cl"===F?(L=0,U=Y(0,B-k)):"cr"===F&&(U=0,L=Y(0,B-k));S&&Db(S,0,0,L,N),V&&Db(V,L+k,0,U,N),Db(x,L,0,k,N),b._22o=L,c&&(Db(c,k/2-e/2,0,e,N),c.style.cursor=j?Ij:""),x.style.cursor=j?Ij:"";var o=x.clientHeight/2,n=x.clientWidth;zm(_,n,n),Db(_,0,o-n-z,n,n),W=Vq(_),Wl(W,0,0,1),t.rotation=-P,db(W,v,0,0,n,n),W.restore(),zm(J,n,n),Db(J,0,o+z,n,n),W=Vq(J),Wl(W,0,0,1),t.rotation=P,db(W,v,0,0,n,n),W.restore()}else{if(k>N&&(k=N),F===Jr)if(1===C)var y=K($,N),Q=Y(0,N-k-y);else-1===C?(Q=K(-$,N),y=Y(0,N-k-Q)):(y=Z((N-k)*$),Q=Y(0,N-k-y));else"cl"===F?(y=0,Q=Y(0,N-k)):"cr"===F&&(Q=0,y=Y(0,N-k));S&&Db(S,0,0,B,y),V&&Db(V,0,y+k,B,Q),Db(x,0,y,B,k),b._22o=y,c&&(Db(c,0,k/2-e/2,B,e),c.style.cursor=j?im:""),s.cursor=j?im:"";var H=x.clientWidth/2,n=x.clientHeight;zm(_,n,n),Db(_,H-n-z,0,n,n),W=Vq(_),Wl(W,0,0,1),t.rotation=0,db(W,v,0,0,n,n),W.restore(),zm(J,n,n),Db(J,H+z,0,n,n),W=Vq(J),Wl(W,0,0,1),t.rotation=m,db(W,v,0,0,n,n),W.restore()}s.background=u}});var gb=function($){this.sv=$,this.addListeners()};Oq(gb,N,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(j){var V=this,N=V.sv,I=N._dividerDiv,p=N._60O,Z=N._61O,d=N._status,u=j.target;if(u===p)d===Jr?N.setStatus("cl"):"cr"===d&&N.setStatus(Jr);else if(u===Z)d===Jr?N.setStatus("cr"):"cl"===d&&N.setStatus(Jr);else if(Ue(j)&&(u===I||u===N._coverDiv)&&(Bk(j),N.isDraggable())){N.getLeftView(),N.getRightView();var U=V.maskDiv=Cc();if(U.style.left=0,U.style.top=0,U.style.width=N.getWidth()+"px",U.style.height=N.getHeight()+"px",N.getView().appendChild(U),!N.isContinuousLayout()){var f=V.resizeDiv=Cc();f.style.left=I.style.left,f.style.top=I.style.top,f.style.width=I.style.width,f.style.height=I.style.height,f.style.opacity=N.getDragOpacity(),f.style.background=N.getDividerBackground(),Pi(V.getView(),f)}V._lastAbsPosition=N._22o,V._86o=Zk(N)?Eq(j).x:Eq(j).y,Xo(V,j)}},handleWindowTouchMove:function(u){Ue(u)&&this.update(u,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(e){var Q=this;Q.update(e,!0),Q.sv.setStatus(Jr),Q.maskDiv&&er(Q.maskDiv),Q.resizeDiv&&er(Q.resizeDiv),Q.maskDiv=Q.resizeDiv=j},handle_mousedown:function(e){Wr(e)&&this.handle_touchstart(e)},handleWindowMouseMove:function(X){this.handleWindowTouchMove(X)},handleWindowMouseUp:function(f){this.handleWindowTouchEnd(f)},update:function(f,O){var L=this,H=L.sv,D=Zk(H)?H.getWidth():H.getHeight(),i=H._dividerSize,a=L._lastAbsPosition-L._86o;Zk(H)?(a+=Eq(f).x,a>D-i&&(a=D-i),0>a&&(a=0),L.resizeDiv&&(L.resizeDiv.style.left=a+vc)):(a+=Eq(f).y,a>D-i&&(a=D-i),0>a&&(a=0),L.resizeDiv&&(L.resizeDiv.style.top=a+vc)),O&&D!==i&&(1===H._82O?H.setPosition(a,1):-1===H._82O?H.setPosition(a-D+i,1):H.setPosition(a/(D-i),1))}}),Se.TabView=function(){var w=this,o=w._view=Ul(1,w),C=w._91O=Cc(1),z=w._tabModel=new si,K=z.sm(),Y=w.invalidate;w._7o=new rb,w._canvas=Ji(C),Pi(o,C),Pi(o,w._92O=Cc(1)),K.setSelectionMode(Wf),K.ms(Y,w),z.mm(Y,w),z.md(Y,w),z.mh(Y,w),new Yf(w),w.iv()},Ni("TabView",N,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Om,Cf,"tabBackground","selectWidth",gi,"moveBackground","insertColor"],_tabPosition:ni,_tabHeight:Bs,_tabGap:V.tabViewTabGap,_labelColor:V.tabViewLabelColor,_labelFont:V.tabViewLabelFont,_tabBackground:V.tabViewTabBackground,_selectWidth:V.tabViewSelectWidth,_selectBackground:V.tabViewSelectBackground,_moveBackground:V.tabViewMoveBackground,_insertColor:V.tabViewInsertColor,_movable:!0,getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(M,E,u){var $=new sm,y=this._tabModel;return $.setName(M),$.setView(E),y.add($),u&&y.sm().ss($),$},getLabel:function(r){return r.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(k){this._23o=k,this.iv()},get:function(d){var w=this,z=w._tabModel;if(Gc(d))return z._roots.get(d);if(Ui(d)){var i;return z.each(function(x){d===w.getLabel(x)&&(i=x)}),i}return d instanceof sm?d:j},select:function(x){this._tabModel.sm().ss(this.get(x))},remove:function(D){var e=this;if(D=e.get(D)){var _=e._tabModel,b=_._roots.indexOf(D);e._tabModel.remove(D),e._12Q(--b)}},getCurrentTab:function(){return this._8o},hideTabView:function(r,l){l.parentNode===this._92O&&(ke(l)?(l.style.display=Cp,l._tab_=r):er(l),nd())},showTabView:function(Q,w){ke(w)&&(w.style.display="block",w._tab_=Q),w.parentNode!==this._92O&&(Pi(this._92O,w),nd())},_24o:function(){var s,k=this,O=k._8o,V=k._9o,h=k._tabModel.sm().ld();h&&(s=Vg(h.getView())),s!==V&&(V&&(O.getView()&&O.getView().endEditing&&O.getView().endEditing(),k.hideTabView(O,V)),s&&k.showTabView(h,s)),k._8o=h,k._9o=s,O!==h&&k.onTabChanged(O,h)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(d,f){this._12Q(--f)},_12Q:function(t){var S=this,s=S._tabModel,u=s.size();if(u&&!s.sm().ld()){t==j&&(t=0),t>=u&&(t=u-1),0>t&&(t=0);for(var I=t;I>=0;I--){var Z=S.get(I);if(!Z.isDisabled())return S.select(Z),Z}for(I=t+1;u>I;I++)if(Z=S.get(I),!Z.isDisabled())return S.select(Z),Z
}},getTabWidth:function(k){var v=4,i=El(k.getIcon());i&&(v+=Fd(i,k)+4);var Z=this.getLabel(k);return Z&&(v+=Ed(this.getLabelFont(k),Z).width+4),k.isClosable()&&(v+=10),v},drawTab:function(G,I,e,B,h,W,_){var J,l=this,z=l._tabPosition,x=e+4,a=l._selectWidth,D=El(I.getIcon()),i=I.isDisabled(),r=l.getLabelColor(I),y=l.getLabelFont(I),g=l.getLabel(I),$=l._selectBackground,u=z===ie+"-vertical",p=z===yh+"-vertical";(u||p)&&(x=B+4),i&&(G.globalAlpha=Up),Yp(G,e,B,h,W,_),I===l._8o&&a&&(z===ni?Yp(G,e,B+W-a,h,a,$):z===ie?Yp(G,e+h-a,B,a,W,$):z===yh?Yp(G,e,B,a,W,$):u?Yp(G,e+h-a,B,a,W,$):p?Yp(G,e,B,a,W,$):Yp(G,e,B,h,a,$));var U=h/2;if(u&&(Lh(G,U,B+W/2),Xe(G,m),Lh(G,-U,-B-W/2)),D){var d=Xk(D,I),t=Fd(D,I);if(u||p){var E=e+h/2,C=x+d/2;Lh(G,E,C),Xe(G,P),Lh(G,-E,-C),Rj(G,D,e+h/2,x+d/2,I,l),Lh(G,E,C),Xe(G,-P),Lh(G,-E,-C),x+=d+4}else Rj(G,D,x+t/2,B+W/2,I,l),x+=t+4}return u||p?(Lh(G,h/2,x+h/2),Xe(G,P),Lh(G,-h/2,-x-h/2),Wp(G,g,y,r,e,x,W,h),Lh(G,h/2,x+h/2),Xe(G,-P),Lh(G,-h/2,-x-h/2)):Wp(G,g,y,r,x,B,h,W),u&&(Lh(G,U,B+W/2),Xe(G,-m),Lh(G,-U,-B-W/2)),I.isClosable()&&(J=p?{x:e+h-12,y:B+W-12,width:12,height:12}:{x:e+h-12,y:B+2,width:12,height:12},this.drawCloseIcon(I,G,r,J)),i&&(G.globalAlpha=1),J},drawCloseIcon:function(g,o,E,s){var n=s.x,r=s.y;o.strokeStyle=E,o.lineWidth=1,o.beginPath(),o.moveTo(n+2,r+8),o.lineTo(n+8,r+2),o.moveTo(n+8,r+8),o.lineTo(n+2,r+2),o.stroke()},validateImpl:function(){var c=this;c._24o();var r,S=c._canvas,V=c._tabPosition,I=c._91O,E=c._92O,B=c._tabModel,e=c.getWidth(),q=c.getHeight(),d=c._tabHeight,Z=c._7o,l=c._tabGap,A=V===ni,D=V===ie,K=V===yh,G=V===ie+"-vertical",y=V===yh+"-vertical",p=c._23o,m=0;if((D||K)&&B._roots.each(function(E){m=Y(c.getTabWidth(E),m)}),A?(Db(I,0,0,e,d),r={x:0,y:d,width:e,height:Y(0,q-d)}):D?(Db(I,0,0,m,q),r={x:m,y:0,width:Y(0,e-m),height:q}):K?(Db(I,e-m,0,m,q),r={x:0,y:0,width:Y(0,e-m),height:q}):G?(Db(I,0,0,d,q),r={x:d,y:0,width:Y(0,e-d),height:q}):y?(Db(I,e-d,0,d,q),r={x:0,y:0,width:Y(0,e-d),height:q}):(Db(I,0,q-d,e,d),r={x:0,y:0,width:e,height:Y(0,q-d)}),Db(E,r),G||y){c._9o&&(r.x=0,Db(c._8o.getView(),r)),zm(S,d,q);var J=Vq(S),t=0;if(Wl(J,0,c.ty(),1),J.clearRect(0,0,d,q),Z.clear(),B._roots.each(function(M){var V,Y=c.getTabWidth(M);p&&p.tab===M||(V=c.drawTab(J,M,0,t,d,Y,c._tabBackground)),Z.add({_75o:V,tab:M,startY:t,endY:t+Y,height:Y}),t+=Y+l}),c._23Q=Y(0,t-l),p){var O=p.position;c.drawTab(J,p.tab,0,p.startY,d,p.height,c._moveBackground),Yp(J,0,O,d,1,c._insertColor)}J.restore(),c.ty(c.ty())}else if(D||K){c._9o&&(r.x=0,Db(c._8o.getView(),r)),zm(S,m,q);var J=Vq(S),t=0;if(Wl(J,0,c.ty(),1),J.clearRect(0,0,m,q),Z.clear(),B._roots.each(function(V){var _;p&&p.tab===V||(_=c.drawTab(J,V,0,t,m,d,c._tabBackground)),Z.add({_75o:_,tab:V,startY:t,endY:t+d,height:d}),t+=d+l}),c._23Q=Y(0,t-l),p){var O=p.position;c.drawTab(J,p.tab,0,p.startY,m,p.height,c._moveBackground),Yp(J,0,O,m,1,c._insertColor)}J.restore(),c.ty(c.ty())}else{c._9o&&(r.y=0,Db(c._8o.getView(),r)),zm(S,e,d);var J=Vq(S),W=0;if(Wl(J,c.tx(),0,1),J.clearRect(0,0,e,d),Z.clear(),B._roots.each(function(k){var t,f=c.getTabWidth(k);p&&p.tab===k||(t=c.drawTab(J,k,W,0,f,d,c._tabBackground)),Z.add({_75o:t,tab:k,startX:W,endX:W+f,width:f}),W+=f+l}),c._64I=Y(0,W-l),p){var O=p.position;c.drawTab(J,p.tab,p.startX,0,p.width,d,c._moveBackground),Wm(J,c._insertColor,O,0,d)}J.restore(),c.tx(c.tx())}for(var U=[],u=E.children,z=0;z<u.length;z++){var H=u[z],i=H._tab_;i&&!B.contains(i)&&U.push(H)}U.forEach(function(P){E.removeChild(P)})}});var Yf=function(H){this.tv=H,this.addListeners()};Oq(Yf,N,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(r){this.handleScroll(r,10*(r.wheelDelta/40))},handle_DOMMouseScroll:function(R){this.handleScroll(R,10*-R.detail)},handleScroll:function(p,T){Bk(p);var M=this.tv,R=M._tabPosition;!M._40o()||R!==ni&&R!==ys||M.tx(this.tv.tx()+T),!M._41o()||R!==ie&&R!==yh&&R!==ie+"-vertical"&&R!==yh+"-vertical"||M.ty(this.tv.ty()+T)},_8Q:function(N){var t,P,Z=this.tv,E=Z._tabPosition,_=Z._7o;if(E===ni||E===ys){var A=Z.lp(N).x;for(t=0;t<_.size();t++)if(P=_.get(t),P.startX<=A&&A<=P.endX)return P}else if(E===ie||E===yh||E===ie+"-vertical"||E===yh+"-vertical"){var f=Z.lp(N).y;for(t=0;t<_.size();t++)if(P=_.get(t),P.startY<=f&&f<=P.endY)return P}return j},isClickable:function(S){var s=this.tv,J=s._tabPosition,t=this._73o=this._8Q(S);return!s._40o()||J!==ni&&J!==ys?!s._41o()||J!==ie&&J!==yh&&J!==ie+"-vertical"&&J!==yh+"-vertical"?t&&(!t.tab.isDisabled()||s.isMovable()):!0:!0},handle_mousemove:function(v){var M=this;Tk?M._74o=M._8Q(v):M.getView().style.cursor=M.isClickable(v)?On:""},handle_mousedown:function(G){this.handle_mousemove(G),this.handle_touchstart(G)},handle_touchstart:function(r){var m=this,V=m.tv,e=V._tabPosition;Bk(r),m.isClickable(r)&&(e===ni||e===ys?(m.x=Eq(r).x,m.lp=V.lp(r),m.tx=V.tx()):(m.y=Eq(r).y,m.lp=V.lp(r),m.ty=V.ty()),Xo(m,r))},handleWindowMouseMove:function(I){this.handleWindowTouchMove(I)},handleWindowTouchMove:function(T){var y,X=this,x=X.tv,U=x._tabPosition,R=X._73o;if(U===ni||U===ys){if(y=Eq(T).x-X.x,!X._25o&&!X.moving&&r(y)>2&&(x._40o()&&!_o(T)?X._25o=1:R&&x.isMovable()&&(X.moving=1)),X._25o)x.tx(X.tx+y);else if(X.moving){var N=X.lp.x+y,k=x._tabGap/2;x._7o.each(function(f){var j=f.endX,o=N-f.startX<j-N;N>=f.startX&&j>=N&&x._7Q({tab:R.tab,startX:R.startX+y,width:R.width,front:o,insertTab:f.tab,position:o?Y(0,f.startX-k):K(x._64I,j+k)})})}}else if(y=Eq(T).y-X.y,!X._25o&&!X.moving&&r(y)>2&&(x._41o()&&!_o(T)?X._25o=1:R&&x.isMovable()&&(X.moving=1)),X._25o)x.ty(X.ty+y);else if(X.moving){var W=X.lp.y+y,k=x._tabGap/2;x._7o.each(function(g){var o=g.endY,B=W-g.startY<o-W;W>=g.startY&&o>=W&&x._7Q({tab:R.tab,startY:R.startY+y,height:R.height,front:B,insertTab:g.tab,position:B?Y(0,g.startY-k):K(x._23Q,o+k)})})}},handleWindowMouseUp:function(K){this.handleWindowTouchEnd(K)},handleWindowTouchEnd:function(){var E=this,i=E.tv,K=i._tabPosition,M=i.getTabModel(),B=M._roots,$=E._73o;if(E.moving){var u=i._23o;if(u&&u.insertTab!==u.tab){var s=u.tab,O=B.remove(s),U=B.indexOf(u.insertTab);U>=0&&(u.front||U++,U<=B.size()&&(B.add(s,U),M._38I(s,O,U)))}i._7Q(j),delete E.moving}else if(!E._25o&&$){s=$.tab;var I=E._74o;if(!I||I.tab===s)if(!s.isDisabled()&&rn($._75o,E.lp)){var Y=function(){var Y=B.indexOf(s);M.remove(s),i.onTabClosed(s,Y)};i.onTabClosing(s,Y)&&Y()}else s.isDisabled()||i._8o===s||M.sm().ss(s)}E._25o=E._73o=E._74o=K===ni||K===ys?E.x=E.lp=E.tx=j:E.y=E.lp=E.ty=j}}),Se.PropertyView=function(k){var S=this;S._view=Ul(1,S),S._canvas=Ji(S._view),Pi(S._view,S._79O=Cc()),S._rows=new rb,S._28o=new rb,S._26o={},S._26Q={};var C=S._propertyModel=new si,T=S.ivm;C.mm(T,S),C.md(T,S),C.mh(T,S),S.dm(k?k:new si),new nb(S)},Ni("PropertyView",N,{ms_ac:[Om,ji,Cf,Ph,_l,"categorizable",zq,dm,Th,ml,Gd,Uj,bq,od,"selectRowIndex",gi,"background",zc,Sr,ec,Gk,Jg],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:Vo,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:yo,_background:V.propertyViewBackground,_expandIcon:V.propertyViewExpandIcon,_collapseIcon:V.propertyViewCollapseIcon,_scrollBarColor:qh,_scrollBarSize:Ec,_autoHideScrollBar:lj,_selectBackground:V.propertyViewSelectBackground,_rowHeight:Zc,_rowLineVisible:V.propertyViewRowLineVisible,_rowLineColor:V.propertyViewRowLineColor,_10I:.5,_columnLineVisible:V.propertyViewColumnLineVisible,_columnLineColor:V.propertyViewColumnLineColor,_labelColor:V.propertyViewLabelColor,_labelSelectColor:V.propertyViewLabelSelectColor,_labelFont:V.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(J){0>J&&(J=0),J>1&&(J=1);var v=this,b=v._10I;v._10I=J,v.fp("columnPosition",b,J)},getPropertyName:function(r){return r.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(y,Y,T){return T===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(J,F){return F===this._selectRowIndex?this._labelSelectColor:J.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(X){var F=this.getHeight()-this._59I;return F>X&&(X=F),X>0?0:Z(X)},isExpanded:function(V){if(!V)return!0;var C=this._26o[V];return C?C.isExpanded:!(this._26Q[V]===!1)},toggle:function(q){var Y=this;Y.isExpanded(q)?Y.collapse(q):Y.expand(q)},expandAll:function(){this.validate();for(var w in this._26o)this.expand(w)},expand:function(O){if(O&&O!==Cp){var W=this,o=W._26o[O];o&&!o.isExpanded&&(o.isExpanded=!0,W.onExpanded(O),W.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var _ in this._26o)this.collapse(_)},collapse:function(A){if(A&&A!==Cp){var p=this,Z=p._26o[A];Z&&Z.isExpanded&&(Z.isExpanded=!1,p.onCollapsed(A),p.ivm())}},onCollapsed:function(){},getCategoryName:function(b){if(!this.isCategorizable())return Cp;var o=b.getCategoryName();return o?o:Cp},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(H){var u=this,z=u._dataModel;z!==H&&(z&&(z.umd(u.handlePropertyChange,u),u._selectionModel||z.sm().ums(u.handleSelectionChange,u)),u._dataModel=H,H.md(u.handlePropertyChange,u),u._selectionModel?u._selectionModel._21I(H):H.sm().ms(u.handleSelectionChange,u),u.fp(hs,z,H))},isVisible:function(M){return this._visibleFunc?this._visibleFunc(M):!0},onPropertyChanged:function(D){var U=this,R=D.property;fm[R]?U.ivm():U.iv(),R===_c&&U._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:Ee},handlePropertyChange:function(a){this._27o===a.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var r=this;r._96I||(r.setSelectRowIndex(-1),r._96I=1,r.iv())},redraw:function(){this.iv()},validateModel:function(){var h=this,n=h._rows,a=h._28o,b={},m=new rb,F=h._27o;h.updateCurrentData(),F!==h._27o&&h.endEditing(),n.clear(),a.clear(),h.getRawProperties().each(function(W){if(h.isVisible(W)){m.add(W);var u=h.getCategoryName(W);b[u]||(a.add(u,u===Cp?0:L),b[u]={isExpanded:h.isExpanded(u),properties:new rb})}}),h._sortFunc&&m.sort(h._sortFunc);for(var o in h._26o)h._26Q[o]=h.isExpanded(o);h._26o=b,a.each(function(p){p!==Cp&&n.add(p);var V=b[p];V.isExpanded&&m.each(function(H){h.getCategoryName(H)===p&&(V.properties.add(H),n.add({property:H,data:h._27o}))},h)})},validateImpl:function(){var B=this;B._76o(),B._96I&&(B.validateModel(),delete B._96I);var h=B._canvas,r=B.getWidth(),T=B.getHeight(),z=-B.ty(),$=B._rowHeight,v=B._indent,c=r-v,e=B._rows,w=e.size(),J=B._9I=v+c*B._10I,b=B._59I=w*$;zm(h,r,T),B._29I={x:0,y:z,width:r,height:T},B._31I=o(z/$),B._14I=k((z+T)/$),B._31I<0&&(B._31I=0),B._14I>w&&(B._14I=w);var P,X=Vq(h),Y=B._background;Wl(X,0,-z,1),X.beginPath(),X.rect(0,z,r,T),X.clip(),X.clearRect(0,z,r,T),B._93db(X),Y&&Yp(X,0,0,v,b,Y);for(var W=B._31I;W<B._14I;W++){var Q=e.get(W),z=$*W;if(Ui(Q))Y&&Yp(X,v,z,c,$,Y),P=El(B.isExpanded(Q)?B._expandIcon:B._collapseIcon),P&&Dm(X,P,ai,0,z,v,$),X.save(),X.beginPath(),X.rect(v,z,c,$),X.clip(),B.drawCategoryName(X,Q,W,v,z,c,$),X.restore();else{var S=Q.property,F=Q.data,P=El(S.getIcon()),t=B._selectRowIndex===W?B.getSelectBackground():j;if(P&&Dm(X,P,ai,0,z,v,$),t&&Yp(X,v,z,c,$,t),X.save(),X.beginPath(),X.rect(v,z,J-v,$),X.clip(),B.drawPropertyName(X,S,W,v,z,J-v,$),X.restore(),!B.isEditing(F,S)){var i=J+1,C=r-J-1;X.save(),X.beginPath(),X.rect(i,z,C,$),X.clip(),B._87o(B.drawPropertyValue(X,S,B.getValue(F,S),W,i,z,C,$,F),W,i,z,C,$),X.restore()}}B._rowLineVisible&&Yp(X,v,z+$-1,c,1,B._rowLineColor)}B._columnLineVisible&&(Yp(X,J,0,1,b,B._columnLineColor),Yp(X,r-1,0,1,b)),B._92db(X),B._93I(),X.restore(),B.ty(B.ty())},drawCategoryName:function(h,T,D,F,s,Q,v){Wp(h,T,this.getCategoryFont(T),this.getCategoryColor(T),F,s,Q,v)},drawPropertyName:function(f,t,U,G,W,A,b){return t.drawPropertyName?(t.drawPropertyName(f,t,U,G,W,A,b,this),void 0):(Wp(f,this.getPropertyName(t),this.getPropertyFont(t,U),this.getPropertyColor(t,U),G,W,A,b),void 0)},drawPropertyValue:function(w,M,F,p,X,R,l,t,V){return M.drawPropertyValue?M.drawPropertyValue(w,M,F,p,X,R,l,t,V,this):(sq(w,F,M,this.getLabelFont(M,F,p),this.getLabelColor(M,F,p),X,R,l,t,V,this),void 0)},isPropertyEditable:function(B){return B.isEditable()&&this.isEditable()},setProperties:function(I){this._propertyModel.clear(),this.addProperties(I)},addProperties:function(T){if(T){var o=this._propertyModel;T.forEach(function($){if(!($ instanceof Mh)){var e=yp($.className);$=gp(e?e:Mh,$)}o.add($)})}},getRowIndexAt:function(E){var l=this,M=o(l.lp(E).y/l._rowHeight);return M>=0&&M<l._rows.size()?M:-1},getPropertyAt:function(z){var q=this,E=q.getRowIndexAt(z);return E>=0?q._rows.get(E).property:j},getToolTip:function(B){var $=this,t=$.getPropertyAt(B),R=$._27o;return t&&R?t.getToolTip(R,$._9I<$.lp(B).x,$):j}});var nb=function(F){this.pv=F,this.addListeners()};Oq(nb,N,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(D){this.getView().style.cursor=D},clear:function(){var M=this;M._62O=M.cp=M.ty=M.p=j,M.setCursor(Dh)},handle_mousedown:function(P){this.handle_touchstart(P)},handle_touchstart:function(O){var K=this,t=K.pv;Bk(O),t.setFocus(O)&&(Wr(O)?(K.cp=Eq(O),K.ty=t.ty(),K.p=t.getColumnPosition(),K.handle_touchmove(O)):t.setSelectRowIndex(t.getRowIndexAt(O)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(U){this.handle_touchend(U)},handle_touchend:function(R){var t=this;if(t.cp&&!t._62O){var E=t.pv,G=E.lp(R),J=G.x,i=G.y,e=E._indent,o=E.getRowIndexAt(R),B=E._9I;if(o>=0){var M=E._rowHeight,n=M*o,P=E._rows.get(o),w=P.property;if(Ui(P))El(E.isExpanded(P)?E._expandIcon:E._collapseIcon)&&J>=0&&e>=J&&i>=n&&n+M>=i?E.toggle(P):wo(R)&&E.toggle(P);else if(J>B&&E.isPropertyEditable(w,R)){var V={x:B+1,y:n,width:E.getWidth()-B-1,height:M},Y={x:V.x+E.tx(),y:V.y+E.ty(),width:V.width,height:V.height},S=0,u=E._29I;V.y<u.y?S=V.y-u.y:V.y+M>u.y+u.height&&(S=V.y+M-u.y-u.height),S&&(E.ty(E.ty()-S),Y.y-=S),E.beginEditing({data:P.data,property:w,value:E.getValue(P.data,w),event:R,rect:V,editorRect:Y,view:E})}}E.setSelectRowIndex(o)}t.clear()},handleWindowMouseMove:function(E){this.handleWindowTouchMove(E)},handleWindowTouchMove:function(y){var l=this,R=l.pv,c=l.ty,Q=l.cp,P=Eq(y),q=l._62O;if("p"===q)R.setTranslateY(c+P.y-Q.y);else if("c"===q){var b=R.getWidth()-R._indent;if(b>16){var j=l.p-(Q.x-P.x)/b,i=16/b;i>j&&(j=i),j>1-i&&(j=1-i),R.setColumnPosition(j)}}else"s"===q&&R.setTranslateY(c+(Q.y-P.y)*R._59I/R._29I.height)},handle_mousemove:function(J){this.handle_touchmove(J)},handle_touchmove:function(y){if(!Tk&&Wr(y)){var L=this,X=L.pv,e=r(X.lp(y).x-X._9I)<=(q?8:3);L.cp?L._62O||(e?(L._62O="c",Xo(L)):r(Eq(y).y-L.cp.y)>=2&&(L._62O=L.isV(y)?"s":"p",Xo(L))):(e?L.setCursor(Ij):L.setCursor(Dh),L.isV(y)&&X._43o())}},isV:function(k){var m=this.pv,O=m._29I;return m._41o()&&O.x+O.width-m.lp(k).x<bo},handle_mousewheel:function(R){this.handleScroll(R,R.wheelDelta/40)},handle_DOMMouseScroll:function(s){2===s.axis&&this.handleScroll(s,-s.detail)},handleScroll:function(z,I){var p=this.pv;Bk(z),p.endEditing(),p.translate(0,I*p.getRowHeight())},handle_keydown:function(n){var x=this.pv,t=x._rows.size(),W=x._selectRowIndex+(Pf(n)?-1:1);(Pf(n)||Rc(n))&&(0>W&&(W=0),W>=t&&(W=t-1),x.setSelectRowIndex(W))}}),Se.ListView=function(N){this._5o(N),new dd(this)},Ni("ListView",N,{ms_ac:[Om,ji,Cf,zc,zq,Sr,ec,dm,Th,Uj,bq,od,$g,gi],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:yo,_rowHeight:Zc,_rowLineVisible:V.listViewRowLineVisible,_rowLineColor:V.listViewRowLineColor,_scrollBarColor:qh,_scrollBarSize:Ec,_autoMakeVisible:mq,_autoHideScrollBar:lj,_selectBackground:V.listViewSelectBackground,_labelColor:V.listViewLabelColor,_labelSelectColor:V.listViewLabelSelectColor,_labelFont:V.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(R){var U=this,s=U._checkMode;U._checkMode=R,U.fp(Ki,s,R)},drawRow:function(I,h,K,u,C,_,n){var c=this,x=0,B=c._indent,j=c.getIconWidth(h);c.drawRowBackground(I,h,K,u,C,_,n),c._checkMode&&(Rj(I,El(c.getCheckIcon(h)),x+B/2,C+n/2,h,c),x+=B),c.drawIcon(I,h,x,C,j,n),c.drawLabel(I,h,x+j,C,n)}});var dd=function(A){this.list=A,this._lastSelectDataTime=Yk(),this.addListeners()};Oq(dd,N,{ms_listener:1,getView:function(){return this.list._view},clear:function(J){var F=this,z=F.list;J&&"d"===F._62O&&!F.dragCancel&&z.handleDragAndDrop(J,"end"),z.draggingData&&(z.draggingData=null,z.redraw()),F.dragCancel=F._62O=F._isV=F._isH=F.cp=F.tx=F.ty=j},handle_mousedown:function(Z){this.handle_touchstart(Z)},handle_touchstart:function(V){var m=this,x=m.list;if(Bk(V),x.setFocus(V)){var f=x.getDataAt(V);m.cp=Eq(V),m.tx=x.tx(),m.ty=x.ty(),Wr(V)?f&&x.handleDragAndDrop&&!m.isV(V)&&!m.isH(V)&&(x.draggingData=f,x.redraw(),x.handleDragAndDrop(V,"prepare")):(f&&m._33o(V,f),m.clear(V))}},handleWindowMouseUp:function(t){this.clear(t)},handleWindowTouchEnd:function(S){this.clear(S)},handle_mouseup:function(R){this.handle_touchend(R)},handle_touchend:function(f){var b=this,M=b.list;if(!b._isV&&!b._isH&&b.cp&&!b._62O){var R=M.getDataAt(f);R?(M.isCheckMode()?b._34o(f,R):b._33o(f,R),wo(f)?M.onDataDoubleClicked(R,f):M.onDataClicked(R,f)):M.handleBackgroundClick(f)}b.clear(f)},handleWindowMouseMove:function(A){this.handleWindowTouchMove(A)},handleWindowTouchMove:function(J){var Y=this,N=Y.list,j=Y._62O,V=Y.tx,T=Y.ty,G=Y.cp,i=Eq(J),D=N._29I;"p"===j?N.setTranslate(V+i.x-G.x,T+i.y-G.y):"v"===j?N.ty(T+(G.y-i.y)*N._59I/D.height):"h"===j?N.tx(V+(G.x-i.x)*N._91I/D.width):"d"===j&&(Y.dragCancel||N.handleDragAndDrop(J,"between"))},handle_mousemove:function(l){this.handle_touchmove(l)},handle_touchmove:function(B){if(!Tk&&Wr(B)){var h=this,m=h.list;if(h._isV=h.isV(B),h._isH=h.isH(B),h.cp){if(!h._62O){if(aq(Eq(B),h.cp)<2)return;h._isV?h._62O="v":h._isH?h._62O="h":m.draggingData&&!this.dragCancel?(h._62O="d",m.handleDragAndDrop(B,"begin")):h._62O="p",h._62O&&"d"!==h._62O&&m.draggingData&&(m.draggingData=null,m.redraw()),Xo(h)}}else h._isV&&m._43o(),h._isH&&m._42o()}},isV:function(W){var X=this.list,l=X._29I;return X._41o()&&l.x+l.width-X.lp(W).x<bo},isH:function(u){var m=this.list,X=m._29I;return m._40o()&&X.y+X.height-m.lp(u).y<bo},handle_mousewheel:function(f){this.handleScroll(f,f.wheelDelta/40,f.wheelDelta!==f.wheelDeltaX)},handle_DOMMouseScroll:function(J){this.handleScroll(J,-J.detail,1)},handleScroll:function(U,s,Y){var k=this.list;Bk(U),k.endEditing&&k.endEditing(),Y&&k._41o()?k.translate(0,s*k.getRowHeight()):k._40o()&&k.translate(10*s,0)},handle_keydown:function(e){if(!V.isInput(e.target)){var C,R=this.list,O=R.sm(),$=R._rows,W=$.size();if(Pr(e))R.selectAll();else if(Oi(e))R.handleDelete&&R.handleDelete(e);else if(bh(e))"d"!==this._62O||this.dragCancel||(R.handleDragAndDrop(e,"cancel"),this.dragCancel=!0);else if(kh(e))R.isCheckMode()&&(C=R.getFocusData(),C&&R.checkData(C));else if(Pf(e)||Rc(e)){var N=R.isCheckMode();if(C=N?R.getFocusData():O.ld()){var L=R.getRowIndex(C);L>=0&&(Pf(e)?0!==L&&(C=$.get(L-1),N?R.setFocusData(C):O.ss(C)):L!==W-1&&(C=$.get(L+1),N?R.setFocusData(C):O.ss(C)))}else W>0&&(C=$.get(0),N?R.setFocusData(C):O.ss(C))}}},_34o:function(X,k){var i=this.list,E=i.lp(X).x;return E>=0&&E<=i._indent?(i.checkData(k),void 0):(i.setFocusData(k),void 0)},_33o:function(U,Q){var $=this.list,A=$.sm(),o=A.ld();if(_o(U))$.isSelected(Q)?A.rs(Q):A.as(Q);else if(Wh(U))if(o)for(var x=$.getRowIndex(o),L=$.getRowIndex(Q);x!==L;)x+=L>x?1:-1,A.as($._rows.get(x));else A.ss(Q);else if(Wr(U)){var S=Yk();if(A.contains(Q)){var g=S-this._lastSelectDataTime;$.handleDataDoubleSelect&&g>500&&1500>g&&$.handleDataDoubleSelect(U,Q)}A.ss(Q),this._lastSelectDataTime=S}else A.contains(Q)||A.ss(Q)}}),Se.TreeView=function(G){var Y=this;Y._35o(),Y._5o(G),new Jf(Y)},Ni("TreeView",N,{ms_ac:[Om,ji,Cf,"rootVisible",Ki,"rootData",dm,Th,Uj,bq,od,zq,zc,Sr,ec,ml,Gd,$g,gi,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:j,_indent:yo,_rowHeight:Zc,_rowLineVisible:V.treeViewRowLineVisible,_rowLineColor:V.treeViewRowLineColor,_scrollBarColor:qh,_scrollBarSize:Ec,_autoHideScrollBar:lj,_expandIcon:V.treeViewExpandIcon,_collapseIcon:V.treeViewCollapseIcon,_autoMakeVisible:mq,_selectBackground:V.treeViewSelectBackground,_labelColor:V.treeViewLabelColor,_labelSelectColor:V.treeViewLabelSelectColor,_labelFont:V.treeViewLabelFont,_doubleClickToToggle:V.treeViewDoubleClickToToggle,drawRow:function(E,O,j,V,p,Q,D){var r=this;r.drawRowBackground(E,O,j,V,p,Q,D),r._97I(E,O,j,0,p,Q,D)},isOnToggleIcon:function(e){var g=this.getDataAt(e);if(g){var P=this.getIndent(),$=this.lp(e).x;if(El(this.getToggleIcon(g))){var R=P*this.getLevel(g);if($>=R&&R+P>=$)return!0}}return!1}});var Jf=function(X){em(Jf,this,[X])};Oq(Jf,dd,{toggle:function(a,Q,G,Z){var H=this.list,O=H.lp(a).x;if(El(H.getToggleIcon(Q))){var K=G*Z;if(O>=K&&K+G>=O)return H.toggle(Q),!0}return H.isDoubleClickToToggle()&&wo(a)?(H.toggle(Q),!0):!1},_34o:function(N,t){var v=this.list,w=v.lp(N).x,U=v._levelMap[t._id],F=v._indent,Z=F*(U+1);return w>=Z&&Z+F>=w?(v.checkData(t),void 0):(this.toggle(N,t,F,U)||v.setFocusData(t),void 0)},_33o:function(P,L){var I=this,F=I.list;I.toggle(P,L,F._indent,F.getLevel(L))||Jf.superClass._33o.call(I,P,L)},handle_keydown:function(r){if(Dj(r)||hh(r)){var D=this.list,N=D._rows,M=D.isCheckMode(),J=D.sm(),i=M?D.getFocusData():J.ld();i?i.hasChildren()&&(Dj(r)?D.collapse(i):D.expand(i)):N.size()>0&&(i=N.get(0),M?D.setFocusData(i):J.ss(i))}else Jf.superClass.handle_keydown.call(this,r)}});var oh=Se.TableView=function(M){this._98I(),this._5o(M),new ig(this)};Ni("TableView",N,{ms_ac:[Om,ji,Cf,"sortMode",Ph,_l,zc,Sr,ec,Gk,Jg,"sortColumn",dm,Th,Uj,bq,od,$g,gi],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:yl,_editable:!0,_batchEditable:!1,_rowHeight:Zc,_rowLineVisible:V.tableViewRowLineVisible,_rowLineColor:V.tableViewRowLineColor,_columnLineVisible:V.tableViewColumnLineVisible,_columnLineColor:V.tableViewColumnLineColor,_scrollBarColor:qh,_scrollBarSize:Ec,_autoHideScrollBar:lj,_autoMakeVisible:mq,_selectBackground:V.tableViewSelectBackground,_labelColor:V.tableViewLabelColor,_labelSelectColor:V.tableViewLabelSelectColor,_labelFont:V.tableViewLabelFont,getCheckColumn:function(){var I=this;if(!I._31o){var R=I._31o=new hm;R.setEditable(!0),R.setWidth(40),R.getValue=I.getCheckColumValue,R.drawCell=I.drawCheckColumnCell}return I._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(w){var b=this,s=b._39o,k=b.getCheckColumn();w!==b.isCheckMode()&&(w?s.add(k,0):s.remove(k),b.fp(Ki,!w,w))},getCheckColumValue:function(n,w,f){return f.isSelected(n)},drawCheckColumnCell:function(F,T,L,v,B,e,A,q,R){Rj(F,R.getCheckIcon(T),B+A/2,e+q/2,T,R)}});var ig=function(P){em(ig,this,[P])};Oq(ig,dd,{_34o:function($,x){var X=this.list,d=X._31o;if(X.isCellEditable(x,d,$)){var e=X._3Q(d),s=X.lp($).x;if(e&&s>=e.startX&&s<e.startX+d.getWidth())return X.checkData(x),void 0}X._37O(x,$),X.setFocusData(x)},_33o:function(J,O){this.list._37O(O,J),ig.superClass._33o.apply(this,arguments)}});var Ol=Se.TreeTableView=function(G){var W=this,v=W._4o=new hm;W._35o(),W._98I(),W._5o(G),v.setDisplayName("Name"),v.setEditable(!0),v.setWidth(180),v.drawCell=Ll,v.getValue=Nm,W._39o.add(v),new xr(W)},Ll=function(t,j,n,U,h,W,e,b,M){M._97I(t,j,n,h,W,e,b)},Nm=function(Z,X,e){return e.getLabel(Z)};Ni("TreeTableView",N,{ms_ac:[Om,ji,Cf,"sortMode",Ph,_l,zq,Ki,"rootData","rootVisible",dm,Th,"sortColumn",ml,Gd,Uj,bq,od,$g,ec,zc,Sr,Gk,Jg,gi,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:yl,_checkMode:j,_editable:!0,_batchEditable:!1,_indent:yo,_rowHeight:Zc,_rowLineVisible:V.treeTableViewRowLineVisible,_rowLineColor:V.treeTableViewRowLineColor,_columnLineVisible:V.treeTableViewColumnLineVisible,_columnLineColor:V.treeTableViewColumnLineColor,_expandIcon:V.treeTableViewExpandIcon,_collapseIcon:V.treeTableViewCollapseIcon,_scrollBarColor:qh,_scrollBarSize:Ec,_autoHideScrollBar:lj,_autoMakeVisible:mq,_selectBackground:V.treeTableViewSelectBackground,_labelColor:V.treeTableViewLabelColor,_labelSelectColor:V.treeTableViewLabelSelectColor,_labelFont:V.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var xr=function(P){em(xr,this,[P])};Oq(xr,dd,{_34o:function(r,v){var M=this.list,C=M._4o,H=M._3Q(C),_=M.lp(r).x;if(H){var m=M._indent,A=H.startX+m*M.getLevel(v);if(El(M.getToggleIcon(v))&&_>=A&&A+m>=_)return M.toggle(v),void 0;if(M.isCellEditable(v,C)&&(A+=m,_>=A&&A+m>=_))return M.checkData(v),void 0}M._37O(v,r),M.setFocusData(v)},_33o:function(C,x){var w=this.list,c=w.lp(C).x;if(El(w.getToggleIcon(x))){var d=w._3Q(w._4o);if(d){var V=w._indent,h=d.startX+V*w.getLevel(x);if(c>=h&&h+V>=c)return w.toggle(x),void 0}}w._37O(x,C),xr.superClass._33o.apply(this,arguments)}});var xe=Se.TableHeader=function(O){var z=this,L=z._view=Ul(1,z),U=z._39o=O.getColumnModel(),X=z.iv;z.tv=z._tableView=O,z._60I=new rb,z._canvas=Ji(L),L.style.background=V.tableHeaderBackground||"",L.style.height=gs+vc,U.mm(X,z),U.md(X,z),U.mh(X,z),O.mp(function(g){Gl[g.property]&&z.iv()},z),new vr(z),z.iv()};Ni("TableHeader",N,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Om,Cf,zq,"moveBackground","insertColor",Gk,Jg,"resizable","movable"],_checkIcon:oc,_movable:!0,_resizable:!0,_labelColor:V.tableHeaderLabelColor,_labelFont:V.tableHeaderLabelFont,_columnLineColor:V.tableHeaderColumnLineColor,_columnLineVisible:V.tableHeaderColumnLineVisible,_sortDescIcon:V.tableHeaderSortDescIcon,_sortAscIcon:V.tableHeaderSortAscIcon,_moveBackground:V.tableHeaderMoveBackground,_insertColor:V.tableHeaderInsertColor,_indent:yo,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(a){return a.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(N){return N.getColor()||this._labelColor},getLabelAlign:function(x){return x._align},onPropertyChanged:function(){this.iv()},_5Q:function(k){this._61I=k,this.iv()},getLogicalPoint:function(H){return yq(H,this._canvas,this.tv.tx())},validateImpl:function(){var u=this,D=u._canvas,N=u.getWidth(),m=u.getHeight(),T=u.tv,k=u._60I,t=u._61I,K=-T.tx(),c=0;(N!==D.clientWidth||m!==D.clientHeight)&&zm(D,N,m),k.clear(),u._39o._roots.each(function(r){if(r.isVisible()){var x=c+r.getWidth();K+N>=c&&x>=K&&k.add({column:r,startX:c}),c=x}});var J=Vq(D);if(Wl(J,-K,0,1),J.beginPath(),J.rect(K,0,N,m),J.clip(),J.clearRect(K,0,N,m),k.each(function(y){var l=y.column,Y=y.startX,h=l.getWidth();h>0&&(J.save(),J.beginPath(),J.rect(Y,0,h,m),J.clip(),t&&t.column===l||u.drawColumn(J,l,Y,0,h,m),u._columnLineVisible&&Yp(J,Y+h-1,0,1,m,u._columnLineColor),J.restore())}),t){var S=t.column,c=t.startX,g=t.position,I=S.getWidth();J.save(),J.beginPath(),J.rect(c,0,I,m),J.clip(),J.fillStyle=u._moveBackground,J.fill(),u.drawColumn(J,S,c,0,I,m),J.restore(),Wm(J,u._insertColor,g,0,m)}J.restore()},_6Q:function(O){var B=this.tv;return B._31o===O&&B.sm().getSelectionMode()===Xl},drawColumn:function(J,j,d,z,s,E){var u=this,m=u.tv,L=El(j.getIcon()),S=u.getLabelAlign(j);if(u._6Q(j)){var O=El(u._checkIcon);Rj(J,O,d+s/2,z+E/2,j,u)}else{var k=u.getLabel(j),W=u.getLabelFont(j),R=u.getLabelColor(j),T=Ed(W,k).width,o=L?u._indent:0;S===ie?(L&&Dm(J,L,ai,d,z,o,E),Wp(J,k,W,R,d+o,z,s,E,ie)):S===yh?(L&&Dm(J,L,ai,d+s-T-o,z,o,E),Wp(J,k,W,R,d,z,s,E,yh)):(L&&Dm(J,L,ai,d+(s-T-o)/2,z,o,E),Wp(J,k,W,R,d+(s-T+o)/2,z,0,E,ie))}if(j.isSortable()&&m.getSortColumn()===j&&(L=El(j.getSortOrder()===us?u._sortAscIcon:u._sortDescIcon))){var K=Fd(L,j)/2+2;Rj(J,L,S===yh?d+K:d+s-K,z+E/2,j,m)}}});var vr=function(o){var E=this;E.th=o,E.tv=o._tableView,E.addListeners()};Oq(vr,N,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(M){this.getView().style.cursor=M},handle_mousemove:function(v){if(!Tk){var c=this;delete c._29o,c.setCursor(Dh);for(var x=c.th,Q=x._60I,i=x.lp(v).x,p=Q.size()-1;p>=0;p--){var y=Q.get(p),K=y.column,F=y.startX+K.getWidth();if(x.isResizable()&&r(F-i)<=(q?10:3))return c._29o=y,c.setCursor(Ij),void 0;i>y.startX&&F>i&&(c._29o=y),(K.isClickable()||K.isSortable()||x.isMovable()||c.tv.getCheckColumn&&K===c.tv.getCheckColumn())&&i>y.startX&&F>i&&c.setCursor(On)}}},handle_mousedown:function(i){this.handle_touchstart(i)},handle_touchstart:function(j){var V=this;Bk(j),V.tv.endEditing(),V.handle_mousemove(j),V._29o&&(V.x=Eq(j).x,V.lx=V.th.lp(j).x,V.w=V._29o.column.getWidth(),Xo(V,j))},handleWindowMouseMove:function(N){this.handleWindowTouchMove(N)},handleWindowTouchMove:function(e){var P=this,x=P.th,Z=P.getView().style.cursor,N=P._29o,S=Eq(e).x-P.x;if(P.resizing||P.moving||(Z===Ij?P.resizing=1:x.isMovable()&&Z===On&&r(S)>2&&(P.moving=1)),P.resizing)N.column.setWidth(P.w+S);else if(P.moving){var C=P.lx+S;x._60I.each(function(R){var L=R.startX,V=L+R.column.getWidth();if(C>=L&&V>=C){var P={column:N.column,startX:N.startX+S,front:V-C>C-L,insertColumn:R.column};P.position=P.front?L:V,x._5Q(P)}})}},_16Q:function(H,C){var O=this,q=O.tv,J=O.th,r=J._checkIcon;if(J._6Q(H)){var Q=El(r),t=O.lx,u=H.getWidth(),U=Fd(Q,H);if(t>=C+u/2-U&&C+u/2+U>=t){J.setCheckIcon(r===uh?oc:uh);var e=q.sm(),w=q._rows;return r===uh?e.rs(w):e.ss(w),q.onCheckColumnClicked(H),!0}}return!1},handleWindowMouseUp:function(m){this.handleWindowTouchEnd(m)},handleWindowTouchEnd:function(f){var r=this,H=r.tv,W=r.th,D=r._29o;if(r.moving){var p=W._61I;if(p&&p.insertColumn!==p.column){var g=p.column,x=H.getColumnModel()._roots,U=x.remove(g),K=x.indexOf(p.insertColumn);K>=0&&(p.front||K++,K<=x.size()&&(x.add(g,K),H.getColumnModel()._38I(g,U,K)))}W._5Q(j),delete r.moving}else if(!r.resizing&&D){g=D.column;var Q=W.lp(f).x,C=D.startX,b=!0;if(W.onColumnClicked){var P=W.onColumnClicked(g,f,C);P===!1&&(b=!1)}if(b&&Q>=C&&Q<=C+g.getWidth()&&!r._16Q(g,C)){if(g.isSortable()){var n=H.getSortMode(),k=g.getSortOrder();n===yl?H.getSortColumn()===g?(k===fn&&H.setSortColumn(j),g.setSortOrder(k===us?fn:us)):H.setSortColumn(g):"bistate"===n&&(H.getSortColumn()===g?g.setSortOrder(k===us?fn:us):H.setSortColumn(g))}H.onColumnClicked(g,f,C)}}r._29o=r.resizing=r.x=r.lx=r.w=j}}),Se.TablePane=function(H){this.init(new oh(H))},Ni("TablePane",N,{ms_v:1,_44o:1}),Se.TreeTablePane=function(B){this.init(new Ol(B))},Ni("TreeTablePane",N,{ms_v:1,_44o:1}),Se.Toolbar=function(i){var o=this,z=o._view=Ul(1,o),l=z.style;l.background=V.toolbarBackground||"",l.height=Bs+vc,o._canvas=Ji(z),o._30o=new rb,o._90I=new rb,o.setItems(i||[]),z.handleGroupSelectedChanged=function(Y){if(Y.isSelected()){var f=Y.getGroupId();null!=f&&o._items.forEach(function(q){var Z=q.element;Z&&Z!==Y&&Z.setSelected&&Z.getGroupId&&Z.getGroupId()===f&&Z.setSelected(!1)})}},new ab(o)},Ni("Toolbar",N,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[Wo,Om,Cf,ji,gi,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:V.toolbarLabelColor,_labelSelectColor:V.toolbarLabelSelectColor,_labelFont:V.toolbarLabelFont,_selectBackground:V.toolbarSelectBackground,_itemGap:V.toolbarItemGap,_separatorColor:V.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function($){var y=this.getItemInfoAt($);return y?y.item.toolTip:j},getLabelColor:function(z){return z&&z.selected&&z.type!==uh&&z.type!==sn?this._labelSelectColor:this._labelColor},onPropertyChanged:function(D){this.iv(),D.property===Wo&&this._items.forEach(function(J){tr(J)})},redraw:function(){this.iv()},addItem:function(I,e){var $=this._items;e==j?$.push(I):$.splice(e,0,I),this.fp(Wo,j,$)},removeItem:function(G){if(G)for(var w=this._items,k=0;k<w.length;k++)G===w[k]&&(w.splice(k,1),this.fp(Wo,j,w))
},removeItemById:function(O){if(O!=j)for(var q=this._items,w=0;w<q.length;w++)if(O===q[w].id){var M=q.splice(w,1)[0];return this.fp(Wo,j,q),M}},getItemById:function(V){if(V!=j)for(var o=this._items,f=0;f<o.length;f++){var M=o[f];if(V===M.id)return M}},setItemVisible:function(N,g){var Q=this.getItemById(N);Q&&(Q.visible=g)},getItemInfos:function(){return this._30o},getItemInfoAt:function(I){var h=this,O=0,G=h._30o,C=h.lp(I),W=C.x,R=C.y;if(R>=0&&R<=h.getHeight())for(;O<G.size();O++){var T=G.get(O);if(T.startX<=W&&W<=T.endX)return T}return j},drawItem:function(j,f,S,n,g){if(f.visible===!1)return 0;if(Af(f.visible)&&!f.visible())return 0;var W=this,d=f.disabled;d&&(j.globalAlpha=Up);var V=W.drawItemImpl(j,f,S,n,g),A=W._itemGap;return d&&(j.globalAlpha=1),this._currentItem!==f||"separator"===f||f.separator===!0||f.unfocusable||$h(j,W._separatorColor,S-A/2,0,V+A,n),V},drawItemImpl:function(b,S,M,p,J){var B=this,o=B._view,i=B._itemGap,t=p/2,Q=S.type,y=S.element,O=S.label;Ui(y)&&(O=y,y=j);var C,Z=B.getLabelFont(S),u=B.getLabelColor(S),v=S.selected,K=El(S.icon),G=Fd(K,S),m=0,P=G+(O?Ed(Z,O).width:0);if("separator"===S||S.separator===!0)return Wm(b,B._separatorColor,M,p/4,t),1;if(y){K&&Rj(b,K,M+G/2,t,S,B),Wp(b,O,Z,u,M+G,0,0,p);var X=Vg(y);J||B._90I.add(X),X.parentNode!==o&&Pi(o,X),y.iv&&y.iv(),y.validate&&y.validate();var r=X.getBoundingClientRect(),W=r.width,R=X.style;return yc(X),R.left=B.tx()+M+P+vc,R.top=(p-r.height)/2+vc,P+W}return Q===sn?C=El(v?Jj:Qo):Q===uh&&(C=El(v?uh:oc)),C?(m=Fd(C,S),Rj(b,C,M+m/2,t,S,B),M+=m,P+=m):v&&Yp(b,M-i/2,0,P+i,p,B.getSelectBackground(S)),K&&Rj(b,K,M+G/2,t,S,B),Wp(b,O,Z,u,M+G,0,0,p),P},validateImpl:function(){var H=this,o=H._canvas,I=H.getWidth(),Q=H.getHeight(),z=H._30o,d=H._items;zm(o,I,Q);var r=Vq(o),$=H._itemGap,s=$/2;Wl(r,H.tx(),0,1),r.clearRect(0,0,I,Q);var m=H._90I;H._90I=new rb,z.clear(),d.forEach(function(h){var A=H.drawItem(r,h,s,Q);z.add({item:h,startX:s,endX:s+A,width:A}),A&&(s+=A+$)}),m.each(function(T){H._90I.contains(T)||er(T)});var K=H._64I;H._64I=Y(0,s),r.restore(),H._stickToRight?(H._65O=0,r=Vq(o),s=I-H._64I+$,Wl(r,0,0,1),r.clearRect(0,0,I,Q),z.clear(),d.forEach(function(m){var D=H.drawItem(r,m,s,Q,!0);z.add({item:m,startX:s,endX:s+D,width:D}),D&&(s+=D+$)}),r.restore()):H.tx(H.tx()),K!==H._64I&&H.onSumWidthChanged(K,H._64I)},onSumWidthChanged:function(){},handleClick:function(J,o){var E=this,g=J.type,Y=J.action,D=J.groupId,t=J.selected;J.disabled||(D!=j?t||(J.selected=!0,this._items.forEach(function(A){A.groupId===D&&J!==A&&(A.selected=!1)}),Y&&J.action(J,E,o)):g===uh||"toggle"===g?(J.selected=!t,Y&&J.action(J,E,o)):Y&&J.action(J,E,o)),nd(),E.iv()}});var ab=function(o){this.tb=o,this.addListeners()};Oq(ab,N,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(W){this.handleScroll(W,10*(W.wheelDelta/40))},handle_DOMMouseScroll:function(F){this.handleScroll(F,10*-F.detail)},handleScroll:function(d,n){Bk(d);var b=this.tb;b.isScrollable()&&!b._stickToRight&&(b.tx(b.tx()+n),$f())},handle_mousemove:function(K){var Q=this;Tk||Q.setItem(K)},handle_mouseout:function(F){var l=this;F.target===l.getView()?l.tb.setCurrentItem(j):l.handle_mousemove(F)},handle_mousedown:function(Z){this.handle_mousemove(Z),this.handle_touchstart(Z)},handle_touchstart:function(z){var d=this,j=d.tb,W=z.target;Wr(z)&&(W===d.getView()||W===j._canvas)&&(Bk(z),j.setFocus(z)&&(this.setItem(z,!0),(j.isScrollable()||d.info&&!d.info.item.disabled)&&(d.x=Eq(z).x,d.tx=j.tx(),Xo(d,z))))},handleWindowMouseMove:function(M){this.handleWindowTouchMove(M)},handleWindowTouchMove:function(U){var z=this,Y=z.tb;if(!Y._stickToRight){var b=Eq(U).x-z.x;!z._25o&&r(b)>2&&Y.isScrollable()&&(z._25o=1),z._25o&&Y.tx(z.tx+b)}},handleWindowMouseUp:function(e){this.handleWindowTouchEnd(e)},handleWindowTouchEnd:function(y){var X=this,J=X.tb,Y=X.info,U=X.tb.getItemInfoAt(y);if(!X._25o&&Y){var T=Y.item;U&&U.item===T&&J.handleClick(T,y)}X._25o=X.x=X.tx=j,X.setItem()},setItem:function(l,C){var r=this,u=r.tb,X=r.info=l?u.getItemInfoAt(l):j,U=X?X.item:j;u.setCurrentItem(U),C&&U&&Af(U.onDown)&&U.onDown(l)}}),Se.BorderPane=function(){this._view=Ul(1,this),this.iv()},Ni("BorderPane",N,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(n,Y){this._12o("leftView",n),Y!=j&&this.setLeftWidth(Y)},getRightView:function(){return this._rightView},setRightView:function($,m){this._12o("rightView",$),m!=j&&this.setRightWidth(m)},getTopView:function(){return this._topView},setTopView:function(O,a){this._12o("topView",O),a!=j&&this.setTopHeight(a)},getBottomView:function(){return this._bottomView},setBottomView:function(K,B){this._12o("bottomView",K),B!=j&&this.setBottomHeight(B)},getCenterView:function(){return this._centerView},setCenterView:function(V){this._12o("centerView",V)},_12o:function(w,J){var O=this,r="_"+w,j=O._view,D=O[r];D!==J&&(D&&(D.getView?er(D.getView()):er(D)),O[r]=J,J&&(J.getView?Pi(j,J.getView(),1):Pi(j,J,1)),O.fp(w,D,J))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var O=this,y=O._topView,L=O._bottomView,h=O._leftView,X=O._rightView,n=O._centerView,s=O.getWidth(),Q=O.getHeight(),p=0,x=0,M=s,E=Q,k=0,V=0,H=0,i=0;y&&(k=O._topHeight==j?hi(y):O._topHeight,x=k),L&&(V=O._bottomHeight==j?hi(L):O._bottomHeight,E=Q-V),h&&(H=O._leftWidth==j?dr(h):O._leftWidth,p=H),X&&(i=O._rightWidth==j?dr(X):O._rightWidth,M=s-i);var u=Y(0,M-p),T=Y(0,E-x);y&&Db(y,0,0,s,k),L&&Db(L,0,E,s,V),h&&Db(h,0,x,H,T),X&&Db(X,M,x,i,T),n&&Db(n,p,x,u,T)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);