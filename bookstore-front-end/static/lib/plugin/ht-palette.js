!function(G,z,m){"use strict";var U="px",L="0",l="innerHTML",I="className",i=ht.Default,t=ht.Color,O=ht.Node,n="position",W="top",N="left",C=i.animate,v=i.getInternal(),s="width",L="0",Y="none",Z="max-height",f="font",e="background",V="border-box",K="user-select",E="box-sizing",y="overflow",A=i.isTouchable,v=i.getInternal(),D=t.titleIconBackground,B=i.scrollBarInteractiveSize,H=/msie 9/.test(G.navigator?G.navigator.userAgent.toLowerCase():""),R=null,g=function(){return document},w=function(B){return g().createElement(B)},h=function(){return w("div")},o=function(){var F=h(),Z=F.style;return Z.msTouchAction=Y,Z.cursor="default",A&&Z.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",R),Z.position="absolute",Z.left=L,Z.top=L,F},X=function(){return w("canvas")},u=function(){return document.body},Q=function(E,l,B){E.style.setProperty(l,B,R)},M=function(U,i){U.style.removeProperty(i)},d=function(x,I,A){i.def(ht.widget[x],I,A)},$=function(B,q){B.appendChild(q)},F=function(O,k){O.removeChild(k)},q=function(l,G,X,O){l.addEventListener(G,X,!!O)};v.addMethod(i,{paletteExpandIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:D,rotation:3.14}]},paletteCollapseIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:D}]},paletteTitleLabelColor:i.labelSelectColor,paletteTitleLabelFont:i.labelFont,paletteContentLabelFont:i.labelFont,paletteContentLabelColor:"#777",paletteContentBackground:"#fff",paletteTitleHeight:i.widgetTitleHeight,paletteTitleBackground:t.titleBackground,paletteTitleHoverBackground:t.titleBackground,paletteSeparatorWidth:1,paletteSeparatorColor:m,paletteItemHoverBorderColor:t.highlight,paletteItemSelectBackground:t.highlight},!0);var b=".palette-item:hover{border: 1px solid "+i.paletteItemHoverBorderColor+" !important}"+" .palette-header:hover{background: "+i.paletteTitleHoverBackground+" !important}",j=document.createElement("style");A||(j.styleSheet?j.styleSheet.cssText=b:j.appendChild(g().createTextNode(b))),g().getElementsByTagName("head")[0].appendChild(j);var p=function(W){var s=this;s.$22h=W,s.addListeners()};i.def(p,z,{ms_listener:1,getView:function(){return this.$22h.getView()},$26h:function(){var m=this;m.$36h&&u().removeChild(m.$36h),m.$23h=m.$24h=m.$25h=m.$35h=m.$36h=R},handle_touchstart:function(p){for(var M,Y=this,c=Y.$22h,W=p.target,n=c.sm(),$=c.dm(),q="palette-header",P="palette-header-tool",r="palette-item",L=!1,V=!1,x=!1;W&&(W[I]||"").indexOf(q)<0&&(W[I]||"").indexOf(r)<0;)W=W.parentNode;if(W&&W[I].indexOf(P)>=0?L=!0:W&&W[I].indexOf(q)>=0?x=!0:W&&W[I].indexOf(r)>=0&&(V=!0),i.isLeftButton(p))if(Y.$27h(p))Y.$24h=i.getClientPoint(p),Y.$25h=c.ty();else if(L){i.preventDefault(p),M=W.parentNode.$11h;var h=$.getDataById(M),G=h.s("tools")[W.toolIndex];G.action&&G.action.call(c)}else if(x){i.preventDefault(p),M=W.$11h;var h=$.getDataById(M);h.isExpanded()?h.setExpanded(!1):h.setExpanded(!0)}else if(V){M=W.$11h;var o=$.getDataById(M);n.ss(o),c.handleDragAndDrop&&(i.preventDefault(p),o.s("draggable")&&(c.handleDragAndDrop(p,"prepare"),Y.$35h=0)),o.s("draggable")||(i.preventDefault(p),Y.$24h=i.getClientPoint(p),Y.$25h=c.ty())}else i.preventDefault(p),Y.$24h=i.getClientPoint(p),Y.$25h=c.ty();else Y.$26h(p)},handle_mousedown:function(q){this.handle_touchstart(q)},handle_mousewheel:function(O){this.handleScroll(O,O.wheelDelta/40,O.wheelDelta!==O.wheelDeltaX)},handle_DOMMouseScroll:function(p){this.handleScroll(p,-p.detail,1)},handleScroll:function(f,d,p){var I=this.$22h;i.preventDefault(f),p&&I._41o()&&I.ty(I.ty()+20*d)},handle_mouseup:function(L){this.handle_touchend(L)},handle_touchend:function(O){var w=this;w.$37h(O),w.$26h(O)},handleWindowMouseUp:function(Q){this.handleWindowTouchEnd(Q)},handleWindowTouchEnd:function(T){var Y=this;Y.$37h(T),Y.$26h(T)},$37h:function(J){var C=this,l=C.$22h;2===C.$35h&&(C.$35h=3,l.handleDragAndDrop(J,"end"))},handleWindowMouseMove:function(K){this.handleWindowTouchMove(K)},handleWindowTouchMove:function(g){var $=this,l=$.$22h,s=$.$23h,D=$.$24h,c=$.$25h,P=i.getClientPoint(g),z=l._29I,y=$.$36h;if(1===$.$35h||2===$.$35h){if($.$35h=2,l.handleDragAndDrop(g,"between"),A){var t=g.touches[0];g=t?t:g.changedTouches[0]}y.style.left=g.pageX-parseInt(y.width)/2+U,y.style.top=g.pageY-parseInt(y.height)/2+U}else"p"===s?l.ty(c+P.y-D.y):"v"===s&&l.ty(c+(D.y-P.y)/z.height*l._59I)},handle_mousemove:function(c){this.handle_touchmove(c)},handle_touchmove:function(E){if(!i.isDragging()&&i.isLeftButton(E)){var B=this,f=B.$22h,J=B.$27h(E);if(B.$24h){if(!B.$23h){if(i.getDistance(i.getClientPoint(E),B.$24h)<2)return;B.$23h=J?"v":"p",i.startDragging(B)}}else if(J)f._43o();else if(0===B.$35h){if(B.$35h=1,f.handleDragAndDrop(E,"begin"),A){var I=E.touches[0];E=I?I:E.changedTouches[0]}var c=B.$36h=new Image,l=f.$10h[f.sm().ld().getId()].querySelector(".image-box"),S=parseInt(l.style.width),P=parseInt(l.style.height);c.draggable=!1,c.src=l.toDataURL(),c.width=S,c.height=P,c.style.position="absolute",c.style.left=E.pageX-S/2+U,c.style.top=E.pageY-P/2+U,u().appendChild(c),i.startDragging(B)}}},$27h:function(L){var U=this.$22h,A=U.getView(),i=A.getBoundingClientRect(),D=U._29I,r=L.clientX-i.left+A.scrollLeft;return U._41o()&&D.x+D.width-r<B}}),ht.widget.Palette=function(c){var S=this,l=S._view=v.createView(null,S);S.$9h={},S.$10h={},S.$4h={},S._29I={x:0,y:0,width:0,height:0},S._59I=0,S.dm(c?c:new ht.DataModel),l[I]="ht-widget-palette",S.$29h=new p(S),Q(l,e,i.paletteContentBackground),Q(l,y,"auto"),Q(l,E,V),Q(l,"-moz-"+E,V),Q(l,"-webkit-"+K,Y),Q(l,"-moz-"+K,Y),Q(l,"-ms-"+K,Y),Q(l,K,Y),Q(l,"position","absolute"),Q(l,"overflow","hidden"),$(l,S._79O=o()),q(l,"dragstart",function(U){U.dataTransfer&&(U.dataTransfer.setData("Text","nodeid:"+U.target.$11h),U.dataTransfer.effectAllowed="all",S.$29h.$26h())})},d("Palette",z,{ms_v:1,ms_fire:1,ms_dm:1,ms_sm:1,ms_vs:1,ms_ac:["itemImageWidth","itemImageHeight","itemImagePadding","itemMargin","layout","autoHideScrollBar","scrollBarSize","scrollBarColor"],$30h:0,_itemImagePadding:4,_itemImageWidth:70,_itemImageHeight:50,_itemMargin:10,_layout:"largeicons",_autoHideScrollBar:i.autoHideScrollBar,_scrollBarSize:i.scrollBarSize,_scrollBarColor:i.scrollBarColor,getViewRect:function(){return this._29I},ty:function(A){return A?(this.setTranslateY(A),void 0):this.getTranslateY()},setTranslateY:function(L){if(this.$32h==R){var g=this,x=g.$33h(L),p=g.$30h;g.$30h=x,g.fp("translateY",p,x)}},getTranslateY:function(){return this.$30h},setLayout:function(Y){var m,J,W=this,O=W._layout;W._layout=Y,"smallicons"===Y?m=J=20:"iconsonly"===Y?m=J=50:(m=70,J=50),W.setItemImageWidth(m),W.setItemImageHeight(J),W.setItemImagePadding(4),W.fp("layout",O,Y)},getDataAt:function(e){for(var n=e.target;n&&n.$11h==R;)n=n.parentNode;return n&&n.$11h!=R?this.getDataModel().getDataById(n.$11h):void 0},$20h:function(){var o=16;return A&&(o*=1.2),o},$19h:function(){return i.paletteTitleHeight},$18h:function(){var $=i.paletteSeparatorWidth,T=i.paletteTitleBackground,c=i.paletteSeparatorColor||i.brighter(T);return $+U+" solid "+c},$17h:function(f){Q(f,"cursor","pointer"),Q(f,"display","inline-block"),Q(f,"margin-right",(A?8:4)+U),Q(f,"vertical-align",W)},$1h:function(M){var P=this,_=h(),b=h(),G=w("span");_[I]="palette-header",Q(_,n,"relative"),Q(_,e,i.paletteTitleBackground),Q(_,"color",i.paletteTitleLabelColor),Q(_,W,L),Q(_,E,V),Q(_,"-moz-"+E,V),Q(_,"padding","0 5px 0 0"),Q(_,"border-top",P.$18h()),Q(_,s,"100%"),Q(_,"cursor","pointer"),Q(_,"white-space","nowrap"),Q(_,y,"hidden"),Q(_,f,i.paletteTitleLabelFont),Q(_,"line-height",P.$19h()+U),_.$11h=M.getId();var R=X(),C=P.$19h(),p=P.$20h();P.$17h(R),v.setCanvas(R,p,C),$(_,R);var o=M.s("tools");if(o)for(var F=0;F<o.length;F++){var H=X();P.$17h(H),v.setCanvas(H,p,C),H[I]="palette-header-tool palette-header-tool"+M.getId()+"-"+F,H.style.position="absolute",H.style.right=(p+10)*F+"px",H.toolIndex=F,$(_,H)}return R[I]="palette-toggle-icon-"+M.getId(),b[I]="palette-content",Q(b,"max-height",0+U),Q(b,f,i.paletteContentLabelFont),Q(b,y,"hidden"),b.$11h=M.getId(),P.$9h[M.getId()]=b,G[l]=M.getName(),Q(G,f,i.paletteTitleLabelFont),$(_,R),$(_,G),[_,b]},$2h:function(j){var d=this,y=d._layout,P=H&&j.s("draggable")?w("a"):h(),Z=X(),M=h(),t=j.getName()||"",s=j.s("title")||j.getToolTip()||t,u=d._itemMargin;Z[I]="image-box";var D=d.getItemImageWidth(),O=d.getItemImageHeight();return v.setCanvas(Z,D,O),$(P,Z),M[l]=t,M[I]="label-box","iconsonly"!==y&&$(P,M),P[I]="palette-item",Q(P,"vertical-align",W),Q(P,"cursor","pointer"),Q(P,"border-radius",5+U),Q(P,"border","1px solid transparent"),Q(P,"text-align","center"),Q(P,"display","inline-block"),Q(P,"margin-left",u+U),Q(P,"margin-top",u+U),Q(P,"color",i.paletteContentLabelColor),"smallicons"===y?(Q(Z,"vertical-align","middle"),Q(P,"margin-left",2+U),Q(P,"margin-top",2+U),Q(P,"padding",2+U),Q(P,"text-align",N),Q(M,"display","inline-block"),Q(M,"min-width",d.$21h+d._itemMargin+U)):"largeicons"===y&&(Q(M,"max-width",D+U),Q(M,"overflow","hidden")),P.$11h=j.getId(),s&&(P.title=s),j.s("draggable")&&!d.handleDragAndDrop&&(H?(P.href="#",Q(P,"text-decoration",Y)):P.draggable="true"),P},$16h:function(R,k,S,b){var u=v.initContext(R);v.translateAndScale(u,0,0,1),u.clearRect(0,0,S,S);var h=(S-b)/2;i.drawStretchImage(u,i.getImage(k),"fill",0,h,b,b),u.restore()},$15h:function(L){var g=this,r=L.getId(),a=g._view.querySelector(".palette-toggle-icon-"+r),u=L.isExpanded()?i.paletteCollapseIcon:i.paletteExpandIcon;if(a&&u){var h=g.$19h(),J=g.$20h();g.$16h(a,u,h,J)}},_drawToolsIcon:function(G){var T=this,R=G.s("tools");if(R)for(var g=0;g<R.length;g++){var B=T._view.querySelector(".palette-header-tool"+G.getId()+"-"+g),Z=R[g].icon,b=T.$19h(),K=T.$20h();T.$16h(B,Z,b,K)}},$14h:function(H){var A=this,r=H.getId(),j=A.$10h[r].querySelector(".image-box"),L=H.getImage(),Z=H.s("image.stretch");if(j&&L){var R=v.initContext(j),U=A.getItemImagePadding();U="smallicons"===A._layout?U/2:U;var K=A.getItemImageWidth()-2*U,C=A.getItemImageHeight()-2*U;v.translateAndScale(R,0,0,1),R.clearRect(0,0,K,C),i.drawStretchImage(R,i.getImage(L),Z,U,U,K,C,H,A),R.restore()}},validateImpl:function(){var y,V,W,c=this,J=c.$9h,Y=c._layout,v=c.$10h,h=c.$4h,g=c._view,P=c.dm();if(c.$13h&&(delete c.$13h,h={},P.each(function(P){h[P.getId()]=P})),"smallicons"===Y)for(var T in h){var k=h[T];if(k instanceof O){var B=k.getName()||"",S=i.getTextSize(i.paletteContentLabelFont,B).width;c.$21h!=R&&c.$21h>S||(c.$21h=S)}}for(var T in h){W=h[T];var o,Q;if(P.contains(W)){if(W instanceof ht.Group){var b,z=c.$1h(W),t=v[W.getId()];t&&(b=t.nextSibling,F(g,b),F(g,t)),V=P.getSiblings(W).indexOf(W);var G=g.children[2*V]||c._79O;G&&G.parentNode?(g.insertBefore(z[0],G),g.insertBefore(b||z[1],G)):(g.appendChild(z[0]),g.appendChild(b||z[1])),v[W.getId()]=z[0],y=J[W.getId()]=b||z[1],Q=W.$12h;var H=W.s("promptText");Q||(W.$12h=w("div"),W.$12h[l]=H||"",Q=W.$12h),0===W.getChildren().size()?y.contains(Q)||$(y,Q):y.contains(Q)&&F(y,Q)}else if(o=W.getParent()){var d=c.$2h(W),I=v[W.getId()];y=J[o.getId()],I&&F(I.parentNode,I),V=P.getSiblings(W).indexOf(W);var p=y.children[V];p?y.insertBefore(d,p):$(y,d),v[W.getId()]=d,c.$14h(W)}}else{var M=v[W.getId()],f=M.parentNode;if(W instanceof ht.Group){var K=M.nextSibling;F(g,M),F(g,K),delete J[W.getId()]}else F(f,M),0===f.children.length&&(o=P.getDataById(f.$11h),Q=o.$12h,Q&&!f.contains(Q)&&$(f,Q));delete v[W.getId()]}}c.$4h={};var q=function(){var Q=c._59I,K=0;c.$32h!=R&&(clearInterval(c.$32h),K=0,delete c.$32h),c.$32h=setInterval(function(){c.$31h(),Q===c._59I?(K++,K>=2&&(clearInterval(c.$32h),delete c.$32h)):(K=0,Q=c._59I)},30)};for(var D in J)if(y=J[D],W=P.getDataById(J[D].$11h),c.$15h(W),c._drawToolsIcon(W),W.isExpanded()){if(y.style.maxHeight===0+U){var N=y.scrollHeight+c._itemMargin+U;C(y).duration(200).set(Z,N).set("padding-bottom",c._itemMargin+U).end(function(){return function(){q()}}(N))}else y.style.maxHeight=y.scrollHeight+U;y.style.paddingBottom=c._itemMargin+U}else y.style.maxHeight!==0+U&&C(y).duration(200).set(Z,L).set("padding-bottom",L).end(function(){return function(){q()}}(y));c.$28h(),c.$31h()},$31h:function(){for(var O=this,w=O._view,R=0,j=w.children,o=0;o<j.length;o++){var q=j[o];q.className&&q.className.indexOf("palette-")>=0&&(R+=q.offsetHeight)}O._59I=R,O.$30h=O.$33h(O.ty());var c=O.ty();w.scrollTop=-c,O._29I={x:0,y:-c,width:w.clientWidth,height:w.clientHeight},Q(O._79O,W,-c+U),O._93I()},$33h:function(q){var Q=this,j=Q._29I.height-Q._59I;return j>q&&(q=j),q>0?0:Math.round(q)},redraw:function(){this.$13h||(this.$13h=1,this.iv())},onPropertyChanged:function(N){["autoHideScrollBar","scrollBarSize","scrollBarColor","translateY"].indexOf(N.property)<0&&this.redraw(),"translateY"===N.property&&(this.iv(),this._43o())},findDataByName:function(o){for(var u=this.dm().getDatas(),D=0;D<u.size();D++){var J=u.get(D);if(J.getName()===o)return J}},setDataModel:function(K){var C=this,u=C._dataModel,S=C._selectionModel;u!==K&&(u&&(u.umm(C.$6h,C),u.umd(C.$8h,C),u.umh(C.$7h,C),S||u.sm().ums(C.$28h,C)),C._dataModel=K,K.mm(C.$6h,C),K.md(C.$8h,C),K.mh(C.$7h,C),S?S._21I(K):K.sm().ms(C.$28h,C),C.sm().setSelectionMode("single"),C.fp("dataModel",u,K))},$6h:function($){var f=this,G=f._view,k=$.data,I=f.$4h;"add"===$.kind?I[k.getId()]=k:"remove"===$.kind?I[k.getId()]=k:"clear"===$.kind&&(f.$10h={},f.$9h={},f.$4h={},G[l]=""),f.iv()},$7h:function(N){var U=this,F=N.data;U.$4h[F.getId()]=F,U.iv()},$8h:function(p){var t=this,R=p.data,m=p.property;"expanded"===m?t.iv():(t.$4h[R.getId()]=R,t.iv())},$28h:function(){var U,r=this,k=r.sm(),w="palette-item",x=k.ld();this.dm().each(function(c){U=r.$10h[c.getId()],U&&U[I].indexOf(w)>=0&&(c===x?Q(U,e,i.paletteItemSelectBackground):M(U,e))})}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);