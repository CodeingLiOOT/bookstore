!function(q,w){"use strict";var z="position",V="absolute",f="relative",x="px",A="left",l="right",i="top",j="bottom",b="display",v="none",X="block",Z=ht.Default,u=Z.getInternal(),Q=Math.floor,g=Math.ceil,R=Math.PI,W=null,E=q.parseInt,k=function(i){return i.getContext("2d")},C=function(){return document},a=function(h){return C().createElement(h)},Y=function(){return a("canvas")},B=function(I,B,f){I.style.setProperty(B,f,W)},I=function(c,T,I){Z.def(ht.widget[c],T,I)},J=function(c,F){c.appendChild(F)},U=function(L,v){L.removeChild(v)},m=function(p,P,x,U){p.addEventListener(P,x,!!U)},y=function(Y,T,L,W){Y.removeEventListener(T,L,!!W)};ht.widget.RulerFrame=function(t){var I=this,_=I._view=u.createView(null,I),i=I.$1k=Y(),P=I.$2k=Y(),N=I.$3k=Y(),E=I.$4k=Y();I._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},I._topRulerConfig={visible:!0},I._rightRulerConfig={visible:!1},I._bottomRulerConfig={visible:!1},I._leftRulerConfig={visible:!0},J(_,i),J(_,N),J(_,P),J(_,E),B(_,z,f),B(_,"box-sizing","border-box"),B(_,"-moz-box-sizing","border-box"),B(i,z,V),B(P,z,V),B(N,z,V),B(E,z,V),I.$14k=function(){I.$13k=1,I.iv()},I.$15k=function(j){if(I._topRulerConfig.guideVisible||I._rightRulerConfig.guideVisible||I._bottomRulerConfig.guideVisible||I._leftRulerConfig.guideVisible||I._defaultRulerConfig.guideVisible||(I._topRulerConfig.guideTipVisible||I._rightRulerConfig.guideTipVisible||I._bottomRulerConfig.guideTipVisible||I._leftRulerConfig.guideTipVisible||I._defaultRulerConfig.guideTipVisible)&&I._component){var u=_.getBoundingClientRect();I.$16k={x:j.clientX-u.left,y:j.clientY-u.top},I.$5k()}},I.setComponent(t)},I("RulerFrame",w,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(a){var g=this,W=g._component,d=g.getView();if(d){if(g._component=a,g.fp("component",W,a),W){var S=g.getComponentView(W);U(d,S),y(d,"mousemove",g.$15k),g.removeComponentPropertyChangeListener(W,g.$14k)}if(a){var p=g.getComponentView(a);J(d,p),B(p,z,V),m(d,"mousemove",g.$15k),g.addComponentPropertyChangeListener(a,g.$14k)}}},addComponentPropertyChangeListener:function(J,Z){J&&J.mp&&J.mp(Z)},removeComponentPropertyChangeListener:function(R,l){R&&R.ump&&R.ump(l)},getComponentHZoom:function(g){return g&&g.getZoom?g.getZoom():1},getComponentVZoom:function(Q){return Q&&Q.getZoom?Q.getZoom():1},getComponentViewRect:function(Z){return Z&&Z.getViewRect?Z.getViewRect():void 0},getComponentView:function(T){return T&&T.getView?T.getView():T},invalidateComponent:function(p){p&&p.iv&&p.iv()},validateComponent:function(m){m&&m.validate&&m.validate()},$7k:function(D,$,k,x,U,f,c,t,J,K,R,d){if($.visible){var r=this._defaultRulerConfig,w="borderStyle",Y="borderColor",p="borderWidth",g="background",e=$[w]||r[w],A=$[Y]||r[Y],m=$[p]||r[p],l=$.size!=W?$.size:r.size,C=$[g]||r[g],T=l+m,F=this.$6k(m,e,A,D,k,U,T,c,t,J,K,R,d);B(D,U,"0px"),f?u.setCanvas(D,x-F,l):u.setCanvas(D,l,x-F),B(D,"background",C),B(D,b,X)}else B(D,b,v),B(this.getComponentView(this._component),U,"0px")},$6k:function(H,U,S,R,O,K,w,A,m,J,W,f,$){var _=0;return B(R,O,H+"px "+U+" "+S),B(this.getComponentView(this._component),K,w+x),A?(B(R,m,J+x),_+=J):B(R,m,"0px"),W?(B(R,f,$+x),_+=$):B(R,f,"0px"),_},validateImpl:function(){var O=this,_=O._component,d=O.$1k,n=O.$2k,z=O.$3k,h=O.$4k,Q=O._view,P=O._defaultRulerConfig,Z=O._topRulerConfig,p=O._rightRulerConfig,$=O._bottomRulerConfig,U=O._leftRulerConfig,t=P.size;if(Q&&_){var m=Z.size!=W?Z.size:t,x=p.size!=W?p.size:t,I=$.size!=W?$.size:t,Y=U.size!=W?U.size:t;O.$7k(d,Z,"border-bottom",Q.offsetWidth,i,!0,U.visible,A,Y,p.visible,l,x),O.$7k(n,p,"border-left",Q.offsetHeight,l,!1,Z.visible,i,m,$.visible,j,I),O.$7k(z,$,"border-top",Q.offsetWidth,j,!0,U.visible,A,Y,p.visible,l,x),O.$7k(h,U,"border-right",Q.offsetHeight,A,!1,Z.visible,i,m,$.visible,j,I),O.$13k?delete O.$13k:O.invalidateComponent(_),O.validateComponent(_),O.$5k()}},$5k:function(){function E(S,E,L,X,i,a){if(E.visible){var p=k(S),l=E[z]||G,Z=E[v]!=W?E[v]:o,t=E[U]||T,D=E[J]||V,j=E.size!=W?E.size:q,wn=E[P]||H,Um=E[Y]||C,re=E[d]||Q,fr=E[b]!=W?E[b]:x,Uh=E[$]!=W?E[$]:g,wg=E[R]!=W?E[R]:f,rl=E[u]!=W?E[u]:M,ps=E[I]!=W?E[I]:n,Ed=E[N]!=W?E[N]:O,Xm=E[F]||ff,Ag=E[_]||Eg;Z&&(l=r[a]=r.$8k(r[a]||l,E[m]||s,E[h]||K,X?e:w,Um)),L.call(r,p,y,B,A,c,j,X?e:w,l,t,D,i,wn,re);var Kf=r.$16k;(fr||Uh)&&Kf&&(X?r.$9k(p,Kf.x,j,Xm,Ag,fr,Uh,wg,rl,ps,Ed):r.$10k(p,Kf.y,j,Xm,Ag,fr,Uh,wg,rl,ps,Ed,i))}}var r=this,i=r.$1k,a=r.$2k,D=r.$3k,p=r.$4k,S=r._topRulerConfig,L=r._rightRulerConfig,t=r._bottomRulerConfig,l=r._leftRulerConfig,X=r._defaultRulerConfig,Z=r._component,j=r.getComponentViewRect(Z),e=r.getComponentHZoom(Z),w=r.getComponentVZoom(Z),y=j.x*e,A=y+j.width*e,B=j.y*w,c=B+j.height*w,q=r._defaultRulerConfig.size,z="defaultMajorTickSpacing",m="maxPhysicalMajorTickSpacing",h="minPhysicalMajorTickSpacing",v="tickSpacingAdaptable",U="majorTickTextFont",J="majorTickTextColor",P="majorTickColor",d="minorTickColor",b="guideVisible",$="guideTipVisible",R="guideTipBorderColor",u="guideTipTextColor",I="guideTipTextFont",N="guideTipBackground",F="guideColor",_="guideWidth",Y="minMajorTickSpacing",G=X[z],s=X[m],K=X[h],o=X[v],T=X[U],V=X[J],H=X[P],C=X[Y],Q=X[d],x=X[b],g=X[$],f=X[R],M=X[u],n=X[I],O=X[N],ff=X[F],Eg=X[_];r._view&&Z&&(E(i,S,r.$11k,!0,!1,"_currentTopMajorTickSpacing"),E(a,L,r.$12k,!1,!0,"_currentRightMajorTickSpacing"),E(D,t,r.$11k,!0,!0,"_currentBottomMajorTickSpacing"),E(p,l,r.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(P,$,j,H,l){return j>P*H?P=Q($/H/l)*l:P*H>$&&(P=g(j/H/l)*l),P},getHTipText:function(X){var y=this,K=y._component,G=0,f=y._view.getBoundingClientRect();return K.lp?G=E(K.lp({clientX:X.x+f.left,clientY:X.y}).x):G-=E(this.getComponentView(K).style.left)||0,G},$9k:function(R,e,f,O,T,C,X,n,i,g,U){var M=this,Y=M._component;R.save(),u.translateAndScale(R,0,0,1);var j=e-(E(this.getComponentView(Y).style.left)||0),F=0;if(e=M.getHTipText(M.$16k),C&&(R.beginPath(),R.fillStyle=O,R.rect(j,F,T,f),R.fill()),X){R.beginPath(),R.textAlign="center",R.textBaseline="middle",R.font=g;var q=R.measureText(e).width+6;R.fillStyle=U,R.rect(j-q/2,F,q,f),R.fill(),R.strokeStyle=n,R.stroke(),R.beginPath(),R.fillStyle=i,R.fillText(e,j,F+f/2)}R.restore()},getVTipText:function(t){var L=this,q=L._component,b=0,M=L._view.getBoundingClientRect();return q.lp?b=E(q.lp({clientX:t.x,clientY:t.y+M.top}).y):b-=E(this.getComponentView(q).style.top)||0,b},formatScaleText:function(P){return Math.round(P)},$10k:function(e,r,n,S,C,s,U,g,L,H,y,N){var B=this,w=B._component;e.save(),u.translateAndScale(e,0,0,1);var $=n/2,b=r-(E(this.getComponentView(w).style.top)||0);if(r=B.getVTipText(B.$16k),s&&(e.beginPath(),e.fillStyle=S,e.rect($-n/2,b,n,C),e.fill()),U){e.translate($,b),e.rotate((N?90:-90)*R/180),e.translate(-$,-b),e.beginPath(),e.textAlign="center",e.textBaseline="middle",e.font=H;var v=e.measureText(r).width+6;e.fillStyle=y,e.rect($-v/2,b-n/2,v,n),e.fill(),e.strokeStyle=g,e.stroke(),e.fillStyle=L,e.fillText(r,$,b)}e.restore()},$11k:function($,e,z,v,i,I,g,R,y,C,O,d,_){$.save(),z=0;var K=e,l=v,q=(K+l)/2;e=0,v=l-K,u.translateAndScale($,0,0,1);var j=0,J=0,X=E(I/2),n=I-X,c=O?0:X,W=R*g,m=W/10;e-=W,v+=W,$.clearRect(e,0,v-e,I),$.beginPath(),$.fillStyle=_;var F=Q(q/m)*m-K;for(j=F;v>j;j+=m)$.rect(j,z+c,1,n);for(j=F;j>e;j-=m)$.rect(j,z+c,1,n);for($.fill(),c=O?0:1,$.beginPath(),$.fillStyle=d,F=Q(q/W)*W-K,j=F;v>j;j+=W)$.rect(j,z+c,1,I-1);for(j=F;j>e;j-=W)$.rect(j,z+c,1,I-1);$.fill();var U=E(/\d+px/.exec(y)[0]),f=(U||10)/2;$.textBaseline="middle",c=O?I-f-2:f+2,$.beginPath(),$.fillStyle=C,$.font=y;var x=Q(q/W)*W/g;for(j=F,J=x;v>j;j+=W,J+=R){var S=this.getHScaleText?this.getHScaleText(j):J;$.fillText(this.formatScaleText(S),j+2,z+c)}for(j=F,J=x;j>e;j-=W,J-=R){var S=this.getHScaleText?this.getHScaleText(j):J;$.fillText(this.formatScaleText(S),j+2,z+c)}$.restore()},$12k:function(c,e,l,t,J,$,O,o,n,w,K,U,g){function G(Y,X,W,m,N,s){N=B.getVScaleText?B.getVScaleText(W):N,N=B.formatScaleText(N),c.translate(Y+X,W),c.rotate(-m),c.translate(-Y-X,-W),c.fillText(N,Y+X+(s?2:1),W),c.translate(Y+X,W),c.rotate(m),c.translate(-Y-X,-W)}c.save(),e=0;var Y=l,P=J,m=(Y+P)/2;l=0,J=P-Y,u.translateAndScale(c,0,0,1);var r=0,B=this,A=0,V=E($/2),L=$-V,i=K?0:V,z=o*O,I=z/10;l-=z,J+=z,c.clearRect(e,0,$,J-l),c.beginPath(),c.fillStyle=g;var W=Q(m/I)*I-Y;for(r=W;J>r;r+=I)c.rect(e+i,r,L,1);for(r=W;r>l;r-=I)c.rect(e+i,r,L,1);for(c.fill(),i=K?0:1,c.beginPath(),c.fillStyle=U,W=Q(m/z)*z-Y,r=W;J>r;r+=z)c.rect(e+i,r,$-1,1);for(r=W;r>l;r-=z)c.rect(e+i,r,$-1,1);c.fill();var a=E(/\d+px/.exec(n)[0]),C=(a||10)/2,T=90*R/180;c.textBaseline="middle",i=K?$-C:C+2,T=K?-T:T,c.beginPath(),c.fillStyle=w,c.font=n;var S=Q(m/z)*z/O;for(r=W,A=S;J>r;r+=z,A+=o)G(e,i,r,T,A,K);for(r=W,A=S;r>l;r-=z,A-=o)G(e,i,r,T,A,K);c.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var R=this,g=R._component,h=R._view;g&&R.removeComponentPropertyChangeListener(g,R.$14k),h&&(y(h,"mousemove",R.$15k),U(h.parentNode,h),R._view=null)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);