!function(P,g,a){"use strict";var r=P.ht;r.Astar={},function(d){var D=d();P.AStar=D.astar,P.AStar.Graph=D.Graph}(function(){function G(r){for(var w=r,H=[];w.parent;)H.unshift(w),w=w.parent;return H}function U(){return new e(function(Y){return Y.f})}function Y(O,X){X=X||{},this.nodes=[],this.diagonal=!!X.diagonal,this.grid=[];for(var Z=0;Z<O.length;Z++){this.grid[Z]=[];for(var K=0,M=O[Z];K<M.length;K++){var h=new o(Z,K,M[K]);this.grid[Z][K]=h,this.nodes.push(h)}}this.$13x()}function o(A,K,y){this.x=A,this.y=K,this.weight=y}function e(W){this.content=[],this.scoreFunction=W}var m={search:function(Y,y,e,S){Y.$6x(),S=S||{};var b=S.heuristic||m.$4x.manhattan,q=S.closest||!1,i=U(),C=y;for(y.h=b(y,e),Y.$7x(y),i.push(y);i.size()>0;){var g=i.pop();if(g===e)return G(g);g.closed=!0;for(var J=Y.neighbors(g),r=0,H=J.length;H>r;++r){var W=J[r];if(!W.closed&&!W.$9x()){var o=g.g+W.getCost(g),l=W.visited;(!l||o<W.g)&&(W.visited=!0,W.parent=g,W.h=W.h||b(W,e),W.g=o,W.f=W.g+W.h,Y.$7x(W),q&&(W.h<C.h||W.h===C.h&&W.g<C.g)&&(C=W),l?i.$10x(W):i.push(W))}}}return q?G(C):[]},$4x:{manhattan:function(x,q){var B=Math.abs(q.x-x.x),z=Math.abs(q.y-x.y);return B+z},diagonal:function(y,S){var P=1,M=Math.sqrt(2),r=Math.abs(S.x-y.x),A=Math.abs(S.y-y.y);return P*(r+A)+(M-2*P)*Math.min(r,A)}},$5x:function(R){R.f=0,R.g=0,R.h=0,R.visited=!1,R.closed=!1,R.parent=null}};return Y.prototype.$13x=function(){this.dirtyNodes=[];for(var k=0;k<this.nodes.length;k++)m.$5x(this.nodes[k])},Y.prototype.$6x=function(){for(var H=0;H<this.dirtyNodes.length;H++)m.$5x(this.dirtyNodes[H]);this.dirtyNodes=[]},Y.prototype.$7x=function(C){this.dirtyNodes.push(C)},Y.prototype.neighbors=function(J){var s=[],G=J.x,E=J.y,W=this.grid;return W[G-1]&&W[G-1][E]&&s.push(W[G-1][E]),W[G+1]&&W[G+1][E]&&s.push(W[G+1][E]),W[G]&&W[G][E-1]&&s.push(W[G][E-1]),W[G]&&W[G][E+1]&&s.push(W[G][E+1]),this.diagonal&&(W[G-1]&&W[G-1][E-1]&&s.push(W[G-1][E-1]),W[G+1]&&W[G+1][E-1]&&s.push(W[G+1][E-1]),W[G-1]&&W[G-1][E+1]&&s.push(W[G-1][E+1]),W[G+1]&&W[G+1][E+1]&&s.push(W[G+1][E+1])),s},Y.prototype.toString=function(){for(var o=[],V=this.grid,T=0;T<V.length;T++){for(var N=[],G=V[T],s=0;s<G.length;s++)N.push(G[s].weight);o.push(N.join(" "))}return o.join("\n")},o.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},o.prototype.getCost=function(h){return h&&h.x!=this.x&&h.y!=this.y?1.41421*this.weight:this.weight},o.prototype.$9x=function(){return 0===this.weight},e.prototype={push:function(Y){this.content.push(Y),this.$11x(this.content.length-1)},pop:function(){var Y=this.content[0],_=this.content.pop();return this.content.length>0&&(this.content[0]=_,this.$12x(0)),Y},remove:function(X){var E=this.content.indexOf(X),J=this.content.pop();E!==this.content.length-1&&(this.content[E]=J,this.scoreFunction(J)<this.scoreFunction(X)?this.$11x(E):this.$12x(E))},size:function(){return this.content.length},$10x:function(d){this.$11x(this.content.indexOf(d))},$11x:function(j){for(var c=this.content[j];j>0;){var K=(j+1>>1)-1,q=this.content[K];if(!(this.scoreFunction(c)<this.scoreFunction(q)))break;this.content[K]=c,this.content[j]=q,j=K}},$12x:function(y){for(var i=this.content.length,Q=this.content[y],C=this.scoreFunction(Q);;){var r,W=y+1<<1,z=W-1,f=null;if(i>z){var L=this.content[z];r=this.scoreFunction(L),C>r&&(f=z)}if(i>W){var m=this.content[W],F=this.scoreFunction(m);(null===f?C:r)>F&&(f=W)}if(null===f)break;this.content[y]=this.content[f],this.content[f]=Q,y=f}}},{astar:m,Graph:Y}});var u=r.Astar.Finder=function(P,b){var K=this;K.gv=P,K.$13x(b),K.refreshMap()};u.prototype={},u.prototype.constructor=u,u.prototype.$13x=function(V){var d=this,c=d.$14x={};V=V||{};var L=V.gridSize||10;c.gridSizeX=V.gridSizeX||L,c.gridSizeY=V.gridSizeY||L,c.rect=V.rect,c.filter=V.filter,c.extendBlocks=V.extendBlocks||3,c.fastOverlap=V.fastOverlap===a?!0:V.fastOverlap,c.nodeRectExtend=V.nodeRectExtend||0,c.diagonal=V.diagonal===a?!0:V.diagonal,c.closest=V.closest===a?!0:V.closest},u.prototype.refreshMap=function(){var s,g=this,w=g.$14x,e=w.gridSizeX,G=w.gridSizeY,$=w.extendBlocks;w.rect?s=w.rect:(s=g.$15x(),r.Default.grow(s,e*$,G*$)),r.Default.grow(s,e,G);var c=Math.floor(s.x/e)*e,X=Math.floor(s.y/G)*G,d=Math.ceil(s.width/e),k=Math.ceil(s.height/G),D=d*e,W=k*G;g.$16x={x:c,y:X,w:D,h:W,gridX:e,gridY:G,xLen:d,yLen:k},g.$17x(),g.$21x()},u.prototype.$15x=function(){var T=this.gv;if(T instanceof r.graph.GraphView)return T.getContentRect();var l,S=r.Default.unionRect;return T.dm().each(function(h){T.isVisible(h)&&h.getRect&&(l=S(l,h.getRect()))}),l},u.prototype.$17x=function(){var Y,H,l,k,B=this,a=B.$16x,F=a.xLen,O=a.yLen;for(Y=new Array(F),l=0;F>l;l++)for(Y[l]=H=new Array(O),k=O;k--;)H[k]=1;var m=B.$14x.filter;for(B.gv.dm().each(function(n){m&&m(n)===!1||(!B._debugInfo||n!==B._debugInfo.grid&&n!=B._debugInfo.path)&&B.$1cw(Y,n)}),l=0;F>l;l++)Y[l][0]=1,Y[l][O-1]=1;for(k=0;O>k;k++)Y[0][k]=1,Y[F-1][k]=1;B.grid=Y;var f=new AStar.Graph(Y,{diagonal:B.$14x.diagonal});B.graph=f},u.prototype.$18x=function(A,H,q,W,F,E,s,O){var x=this.$19x,Y=x(q-A,F-s,W-H,E-O);if(1e-6>=Y&&Y>=-1e-6)return!1;var M=x(F-A,F-s,E-H,E-O)/Y;if(0>M||M>1)return!1;var h=x(q-A,F-A,W-H,E-H)/Y;return 0>h||h>1?!1:!0},u.prototype.$19x=function(w,Z,j,G){return w*G-Z*j},u.prototype.$1aw=function(v,U,g,I){for(var h=[-(U[1]-v[1]),U[0]-v[0]],R=h[0]*(g[0]-v[0])+h[1]*(g[1]-v[1])>=0,J=0,i=I.length;i>J;J+=2)if(h[0]*(I[J]-v[0])+h[1]*(I[J+1]-v[1])>=0===R)return!1;return!0},u.prototype.$1bw=function(a,O){for(var z,j,o=this,r=0,b=a.length;b>r;r+=2)if(z=r===b-2?0:r+2,j=z===b-2?0:z+2,o.$1aw([a[r],a[r+1]],[a[z],a[z+1]],[a[j],a[j+1]],O))return!1;for(var r=0,b=O.length;b>r;r+=2)if(z=r===b-2?0:r+2,j=z===b-2?0:z+2,o.$1aw([O[r],O[r+1]],[O[z],O[z+1]],[O[j],O[j+1]],a))return!1;return!0},u.prototype.$1cw=function(Z,O){if(O.getRect){var Y=this,Q=O.getRect();r.Default.grow(Q,Y.$14x.nodeRectExtend);var i,u,l,V,w,b,a,C,s,X,v,G=Y.$1dw({x:Q.x,y:Q.y}),A=Y.$1dw({x:Q.x+Q.width,y:Q.y+Q.height}),E=Y.$14x.fastOverlap;if(!E){var P=O.getCorners();a=[],P.forEach(function(Q){a.push(Q.x,Q.y)}),X=Y.$14x.gridSizeX/2,v=Y.$14x.gridSizeY/2}for(u=Math.max(0,G.x),l=Math.min(A.x,Z.length-1),w=Math.max(0,G.y),b=Math.min(A.y,Z.length?Z[0].length-1:-1),i=u;l>=i;i++)for(V=w;b>=V;V++)if(E)Z[i][V]=0;else{s=Y.$1ew({x:i,y:V});var B=s.x-X,d=s.x+X,t=s.y-v,f=s.y+v;C=[B,t,B,f,d,f,d,t],Y.$1bw(a,C)&&(Z[i][V]=0)}}},u.prototype.$1dw=function(n,k){var j=this,S=j.$16x,$=(n.x-S.x)/S.gridX,D=(n.y-S.y)/S.gridY;return k!==!1&&($=Math.round($),D=Math.round(D)),{x:$,y:D}},u.prototype.$1ew=function(q){var f=this,p=f.$16x;return{x:q.x*p.gridX+p.x,y:q.y*p.gridY+p.y}},u.prototype.$1fw=function(D){var H=this,r=H.$16x,I=r.xLen,j=r.yLen;if(D.x>=0&&D.x<I&&D.y>=0&&D.y<j)return D;var d={x:D.x,y:D.y};return d.x<0?d.x=0:d.x>=I&&(d.x=I-1),d.y<0?d.y=0:d.y>=j&&(d.y=j-1),d},u.prototype.findPath=function(D,U){var b,X,a,u,f=this,l=f.$1dw(D),H=f.$1dw(U);if(a=f.$1fw(l),u=f.$1fw(H),a!==l&&u!==H){var R=f.$16x,r=R.x-R.gridX/2,T=R.y-R.gridY/2,e=r+R.gridX*R.xLen,$=T+R.gridY*R.yLen;if(!(f.$18x(D.x,D.y,U.x,U.y,r,T,e,T)||f.$18x(D.x,D.y,U.x,U.y,e,T,e,$)||f.$18x(D.x,D.y,U.x,U.y,e,$,r,$)||f.$18x(D.x,D.y,U.x,U.y,r,$,r,T)))return[D,U]}a!==l&&(b=!0,l=a),u!==H&&(X=!0,H=u);var S=f.graph.grid[l.x][l.y],Q=f.graph.grid[H.x][H.y],i=AStar.search(f.graph,S,Q,{closest:f.$14x.closest});if(!i||!i.length)return null;var v=[];v.push(D),b&&v.push(f.$1ew(i[0]));for(var M=1,j=i.length;j-1>M;M++)v.push(f.$1ew(i[M]));if(X)v.push(f.$1ew(i[j-1])),v.push(U);else{var z=i[j-1];H.x===z.x&&H.y===z.y?v.push(U):v.push(f.$1ew(z))}return f.$20x=v,f.$21x(),v},u.prototype.debugOn=function(i){this.debugFlag=!0,this.debugSettings=i||{},this.$21x()},u.prototype.$21x=function(){var H=this;if(H.$22x(),this.debugFlag){var u=H.grid;if(u){var e;if(H.debugSettings.$16x!==!1){e=[];for(var E,Z,Y,B,A,F=[],n=H.$14x.gridSizeX/2,V=H.$14x.gridSizeY/2,W=u.length,t=W?u[0].length:0,N=1;W-1>N;N++)for(var v=1;t-1>v;v++)u[N][v]||(E=H.$1ew({x:N,y:v}),Z=E.x-n,Y=E.x+n,B=E.y-V,A=E.y+V,e.push({x:Z,y:B},{x:Z,y:A},{x:Y,y:A},{x:Y,y:B}),F.push(1,2,2,2,5));var _=new r.Shape;_.s("shape.border.color","rgba(50, 50, 50, 0.2)"),_.s("shape.border.width",1),_.s("shape.background","rgba(200, 50, 100, 0.2)"),_.s("2d.editable",!1),_.s("2d.selectable",!1),_.setPoints(e),_.setSegments(F),H._debugInfo={grid:_},gv.dm().add(_)}H.debugSettings.path!==!1&&(e=new r.Shape,H.$20x&&(e.setPoints(H.$20x),e.s("shape.border.color","red"),e.s("shape.border.width",1),e.s("2d.editable",!1),e.s("2d.selectable",!1),e.s("shape.background",null),H._debugInfo||(H._debugInfo={}),H._debugInfo.path=e,gv.dm().add(e)))}}},u.prototype.debugOff=function(){this.debugFlag=!1,this.$22x()},u.prototype.$22x=function(){var x=this;if(x._debugInfo){var g=x._debugInfo.grid,k=x._debugInfo.path;g&&gv.dm().remove(g),k&&gv.dm().remove(k),x._debugInfo=null}}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);