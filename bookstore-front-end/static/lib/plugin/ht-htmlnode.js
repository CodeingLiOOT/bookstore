!function(X){"use strict";var w="ht",d=X[w],A=function(){return document},M=function(){return A().body},K=function(I,l,C){I.style.setProperty(l,C,null)},E=function(a){return A().createElement(a)},x=function(){return E("div")},p=function(){var U=E("canvas");return U},o=function(L,H){K(L,"-webkit-transform",H),K(L,"-ms-transform",H),K(L,"transform",H)},Y=function(I,X){K(I,"-webkit-transform-origin",X),K(I,"-ms-transform-origin",X),K(I,"transform-origin",X)},V=function($,N){$.appendChild(N)},i=function(v,i){v.removeChild(i)},l=X.parseInt,q=d.Default,f=q.getInternal(),H=Math.PI,y="white-space",$="visibility",n="left",s="top",P="width",u="height",b="position",C="display",B="z-index",R="px",k="0 0",e="absolute",J="visible",_="hidden",F="none",U="block",a="nowrap",D="rgba(0, 0, 0, 0.005)";q.setImage("node_dragger","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAN9JREFUeNrsV9sNhDAMKyzQVdgARmGzrMJNUFZhAh6nfkVcG9PQgHSR8lEksJs6pnGuLCimSRzAa0yyBK9O4gy8GokU+O0kJOAwiQYg0LP1xNYDW3+0CfBYNb7VOuN4LAGpiOaYUhFDas9F2NPHDELNENJqaHgBgSQJ3ufakfQJqckERcOiK+Ae1FGWBNKGh9oX5WPpLpdNYfffijbsxTHh7VKP7388n1g1h7OKUoUuyGpJakQEuhwkZAKcDXVOdWcrOrL/feBVBHI/q8fcjE1nA9PpyHQ+NJ2Qi8A3AQYAOtS27fCoRY0AAAAASUVORK5CYII=");var j=d.graph.GraphView.prototype,S=j._42;j.adjustHtmlNodeIndex=!0,j._42=function(U,N){if(S.call(this,U,N),this.adjustHtmlNodeIndex)for(var p=this.getDataModel()._datas._as,P=p.length,d=1,n=0;P>n;n++){var T=p[n];if(T instanceof O){var D=this.getDataUI(T);K(D.$2f,B,d+""),K(D.$3f,B,d+1+""),d+=2}}};var T=d.HtmlNodeUI=function(j,Z){var G=this;T.superClass.constructor.call(G,j,Z);var D=G.$2f=x(),q=G.$3f=p();K(D,b,e),K(D,$,_),K(D,y,a),q.draggable=!1,K(q,b,e),K(q,C,F),Y(q,k),D.addEventListener("change",function(j){var b=j.target,Q=b.bind||b.getAttribute("bind"),X=b.type&&"checkbox"===b.type?b.checked:b.value,Y=Z.getContext();Q&&Y&&(Y[Q]=X,G.$4f=JSON.stringify(Y))}),["mousedown","touchstart","keydown","mousewheel","DOMMouseScroll"].forEach(function(p){D.addEventListener(p,this.$9f.bind(this))},G)};q.def(T,f.ui().NodeUI,{_visible:!0,$11f:function(){var c=this,S=c.$3f,Z=c._data,W=Z.getDraggerImageWidth(),u=Z.getDraggerImageHeight(),b=Z.getDraggerImage(),E=f.initContext(S);E.beginPath(),f.setCanvas(S,W,u),f.translateAndScale(E,0,0,1),E.clearRect(0,0,W,u),q.drawImage(E,q.getImage(b),0,0,W,u),E.restore()},_80o:function(w){T.superClass._80o.call(this,w);var E=this,t=E._data,N=t._padding,I=2*N,f=E.$2f,k=E.$3f,c=E.gv,Z=c.getZoom(),y=c.getTranslateX(),g=c.getTranslateY(),L=c.getView(),a=E._83o,r=t._width,G=t._height,q=a.position,h=a.rotation,Y=(r-I)/t.$5f*Z,O=(G-I)/t.$6f*Z,X=E._html,A=t._html,Q=t.getHtmlType();if("html"===Q){var v=t.getContext()||{},z=E.$4f,p=t.$10f,W=JSON.stringify(v);X&&z&&X===A&&z===W||(E.$4f=W,E._html=A,f.innerHTML=p?p(v):A)}else if(null!=Q){var M=t.getHtml();"ht"===Q&&(M=M.getView()),X&&X===M&&f.contains(X)||(E._html=M,f.innerHTML="",V(f,M))}if(!f.parentNode){var m=c.$1f;if(!m){var i=x();K(i,b,e),K(i,B,"0"),m=c.$1f=i;var S=c._canvas.nextSibling;S?L.insertBefore(i,S):V(L,i)}V(m,f),V(m,k),t.onContentInitialized&&t.onContentInitialized(f)}if(t._scalable){var j=t.$5f,d=t.$6f;o(f,"rotate("+180*(h/H)+"deg) scale("+Y+","+O+")"),K(f,P,""),K(f,u,""),K(f,n,(q.x-j/Z/2)*Z+y+R),K(f,s,(q.y-d/Z/2)*Z+g+R)}else{var Bj=l(f.style.width),eq=l(f.style.height),ff=l((r-I)*Z),nm=l((G-I)*Z),Eh="100%",hd=f.children[0];K(hd,P,Eh),K(hd,u,Eh),(Bj!==ff||eq!==nm)&&(K(f,P,ff+R),K(f,u,nm+R),"ht"===Q&&A.invalidate()),o(f,"rotate("+180*(h/H)+"deg)"),K(f,n,(q.x-ff/Z/2)*Z+y+R),K(f,s,(q.y-nm/Z/2)*Z+g+R)}var am=E.dragRect;c.isMovable(t)&&c.isSelected(t)&&am?(w.save(),w.fillStyle=D,w.fillRect(am.x,am.y,am.width,am.height),w.restore(),K(k,n,am.x*Z+y+R),K(k,s,am.y*Z+g+R),o(k,"scale("+Z+","+Z+")"),K(k,C,U),E.$11f()):K(k,C,F),K(f,$,this._visible?J:_)},dispose:function(){var S=this.gv.$1f;this.$2f.parentNode===S&&S.removeChild(this.$2f),this.$3f.parentNode===S&&S.removeChild(this.$3f)},_84o:function(L){this._visible=L,K(this.$2f,$,L?J:_),K(this.$3f,C,L?U:F)},_3O:function(){var W=this,z=W.gv,x=W._data;T.superClass._3O.call(W);var w=x.getRect();z.isEditable(x)&&(W.dragRect={x:w.x+w.width+x._padding,y:w.y+10,width:x.getDraggerImageWidth(),height:x.getDraggerImageHeight()},W._68o(W.dragRect))},rectIntersects:function(s){var X=this._79o();return d.Default.intersection(X,s)?!0:void 0},$9f:function(m){var q=this.gv,_=this._data;q.sm().contains(_)&&m.stopPropagation()}});var O=d.HtmlNode=function(){O.superClass.constructor.call(this)};d.Default.def(O,d.Node,{ms_ac:["html","context","scalable","padding","draggerImage","draggerImageWidth","draggerImageHeight"],_padding:d.Default.isTouchable?12:6,_image:null,_scalable:!0,_draggerImage:"node_dragger",_draggerImageWidth:20,_draggerImageHeight:20,setHtml:function(j){var u=this,S=u._html;u._html=j,"html"===u.getHtmlType()&&"Handlebars"in X&&(u.$10f=Handlebars.compile(j)),u.$13f(),u.fp("html",S,j)},setContext:function(f){var q=this,$=q._context;q._context=f,q.fp("context",$,f),q.$13f()},setScalable:function($){var e=this,N=e._scalable;e._scalable=$,e.fp("scalable",N,$),e.$13f()},getHtmlType:function(){var B=this._html;return B?"string"==typeof B?"html":B.getView?"ht":"dom":null},$13f:function(){var t=this,H=t._html,g=t.$10f;if(H){var p=x(),n=!1,E=t.getHtmlType();if(K(p,b,e),K(p,y,a),K(p,$,_),"html"===E?(p.innerHTML=g?g(t.getContext()||{}):H,n=!0):"ht"===E?(V(p,H.getView()),n=!0):"dom"===E&&(V(p,H),n=!0),n){var v=2*t._padding;V(M(),p),t.$5f=p.scrollWidth,t.$6f=p.scrollHeight,t._width=t.$5f+v,t._height=t.$6f+v,t._originWidth=t._width,t._originHeight=t._height,i(M(),p)}}},getUIClass:function(){return d.HtmlNodeUI}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);