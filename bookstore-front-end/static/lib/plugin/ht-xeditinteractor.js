!function(D,n,A){"use strict";var b="ht",w=D[b],u=w.Default,N=w.graph,L=u.getInternal(),G=L.ui(),J=G.NodeUI.prototype,z=G.ShapeUI.prototype,o=N.GraphView,Q=o.prototype,r=G.EdgeUI.prototype,U=w.Node,i=w.Shape,Z=w.Edge,M=w.Group,h=u.isTouchable,v=u.preventDefault,T=D.setTimeout,c=u.grow,a=u.isDragging,O=u.getDistance,I=null,B=w.List,W="undefined"!=typeof Float32Array?Float32Array:Array,S=Math,H=S.PI,R="Crossing",p="No Crossing",C=H/2,s=2*H,X=S.atan2,g=S.sqrt,$=S.pow,E=S.sin,k=S.cos,Y=S.min,l=S.max,P=S.abs,q=S.ceil,f=S.round,d=u.unionPoint,m=u.unionRect,j=u.containsPoint,t=u.clone,K="rgb(52, 152, 219)",V="red",x={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},_={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var k=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],M=0;M<k.length;M++){var K=k[M];K=0===M%2?K/400*_.width:K/100*_.height,k[M]=K}return _.width>120&&(k[4]=_.width-26,k[6]=_.width-40,k[10]=_.width-40,k[12]=_.width-26,k[18]=33),k}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},y={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:K,rotation:.61},{type:"circle",rect:[200,120,70,70],background:K,rotation:.61},{type:"circle",rect:[200,220,70,70],background:K,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:K},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:K}]},e={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:V,rotation:.61}]},F={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:K},{type:"circle",rect:[0,210,90,90],background:K},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:K}]},br={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:V},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:V}]},Kp={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:K}]},Dg={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:V}]},Hj={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},qq={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},Nf=function(d){var D=d.touches[0];return D?D:d.changedTouches[0]},fk=function(w,f,n,u){return X(u-f,n-w)},pe=function(M,W){return{x:M.x*W,y:M.y*W}},bd=function($,B){$.each(function(E){return $.isSelected(E)?B(E):void 0})},qg=function(J,V){J.reverseEach(function(r){return J.isSelected(r)?V(r):void 0})},_g=function(O,f,G){var T,R,n,u,A,K=this,m=f,e=K.gv;if(O instanceof i){n=O.getSegments();var F=e.getDataUI(O);A=F._55O.$15l,n&&n.size()||(n=Ll(A)),O.isClosePath()&&n.indexOf(5)<0&&(n=new B(n._as),n.add(5)),T=oj(O,F,m),R=A[T]}else{var E=e.getDataUI(O);A=ee(E,O.s("edge.points")),n=O.s("edge.segments"),n&&n.size()||(n=Ll(A)),A=A._as,T=oj(O,E,m),R=A[T]}if(n&&(u=n.get(m)),2===u||1===u||5===u){var W=A[T+1];5===u&&(W=A[0]);var k=oq(R,G,W);return k}return G},Lm=function(O,D,L,l){var v=D/2,G=L/2,i=qe(O,-v,-G,l),o=qe(O,v,-G,l),T=qe(O,-v,G,l),W=qe(O,v,G,l),N=qe(O,0,-G,l),K=qe(O,v,0,l),Y=qe(O,0,G,l),j=qe(O,-v,0,l);return[i,o,T,W,N,K,Y,j]},oq=function(a,Z,W){var E={x:Z.x-a.x,y:Z.y-a.y},q={x:W.x-a.x,y:W.y-a.y},x=g($(W.x-a.x,2)+$(W.y-a.y,2)),X={x:q.x/x,y:q.y/x},y=E.x*X.x+E.y*X.y,e={x:X.x*y,y:X.y*y};return{x:a.x+e.x,y:a.y+e.y}},qe=function(W,G,d,Z){var z=k(Z)*G-E(Z)*d,K=E(Z)*G+k(Z)*d;return W?{x:W.x+z,y:W.y+K}:{x:z,y:K}},ij=function(x,l){return l>2*x?x:l/2},Nm=function(g,h,o,F){var c=O(g,h);return o=F?Y(o,c):ij(o,c),c?o/=c:o=0,{x:g.x+(h.x-g.x)*o,y:g.y+(h.y-g.y)*o}},Wf=function(n,v){var A,m,Q=n.gv,S=n._data,J=S._40I,y=S._41I,Z=S.s("edge.offset"),q=S.s("edge.source.position"),f=S.s("edge.target.position"),P=S.s("edge.source.offset.x"),M=S.s("edge.source.offset.y"),a=S.s("edge.target.offset.x"),X=S.s("edge.target.offset.y"),o=S.s("edge.source.anchor.x"),N=S.s("edge.source.anchor.y"),T=S.s("edge.target.anchor.x"),t=S.s("edge.target.anchor.y");if(v?(A=L.getEdgeAgentPosition(Q,J,q,P,M,o,N),m=L.getEdgeAgentPosition(Q,y,f,a,X,T,t)):(A=L.getEdgeAgentPosition(Q,J,q,0,0,o,N),m=L.getEdgeAgentPosition(Q,y,f,0,0,T,t)),"points"===S.s("edge.type")&&Z&&!S.s("edge.center")&&A){var D=S.s("edge.points")||new B,V=D.size(),_=Nm(A,V?D.get(0):m,Z,V),b=Nm(m,V?D.get(V-1):A,Z,V);A=_,m=b}return[A,m]},ee=function(s,$,N){var H=s._78o,A=s._data,E=A.s("edge.type"),p=[H.sourcePoint,H.targetPoint];return"points"===E?N&&(p=Wf(s)):p=H.center?E?N?Wf(s):Wf(s,!0):N?Wf(s):[H.c1,H.c2]:N?Wf(s):Wf(s,!0),$=new B($?$._as:I),$.add(p[0],0),$.add(p[1]),$},lh=function(M){return M=new B(M._as),M.removeAt(0),M.removeAt(M.size()-1),M},Ll=function(I){I._as||(I=new B(I));var r=new B;r.add(1);for(var q=1;q<I.size();q++)r.add(2);return r},Hl=function(X,A){return{x:(X.x+A.x)/2,y:(X.y+A.y)/2}},yd=function(I,r){return{x:I.x+1*(r.x-I.x)/4,y:I.y+1*(r.y-I.y)/4}},kr=function(H,$){return{x:H.x+3*($.x-H.x)/4,y:H.y+3*($.y-H.y)/4}},gh=function(b,Q,J,j){var f=Q.x+Q.width/2,U=Q.y+Q.height/2,F=g(f*f+U*U),G=X(U,f)+J;return{x:j.x+F*k(G),y:j.y+F*E(G)}},El=Q.validateImpl,oe=Q.isRectEditable,Tl=Q.isPointEditable,ih=Q._42,rd=z._79o,Rq=r._79o,We=z._48O,Dk=z._47O,Hf=J._48O,lf=J._80o,ff=z._80o,mf=J.getSelectWidth,og=J._47O,Yc=r._47O,Gf=Q.isEditable,Wi=["northwest","north","northeast","east","southeast","south","southwest","west"],lg=function(T,e,Z,B,N,x,_,u,A,i){var y=T.x,R=T.y,s=T.width,C=T.height,X={x:y+s/2,y:R+C/2};B=B||0,e=qe(X,e.x-X.x,e.y-X.y,-B),_&&!u&&(e.x+=A,e.y+=i);var V=.01;if("northwest"===Z?(e.x+N>y+s-V&&(e.x=y+s-N-V),e.y+N>R+C-V&&(e.y=R+C-N-V),T=d(e,{x:y+s,y:R+C})):"north"===Z?(e.y+N>R+C-V&&(e.y=R+C-N-V),T=d({x:y,y:e.y},{x:y+s,y:R+C})):"northeast"===Z?(e.x<y+N+V&&(e.x=y+N+V),e.y+N>R+C-V&&(e.y=R+C-N-V),T=d({x:y,y:e.y},{x:e.x,y:R+C})):"west"===Z?(e.x+N>y+s-V&&(e.x=y+s-N-V),T=d({x:e.x,y:R},{x:y+s,y:R+C})):"east"===Z?(e.x<y+N+V&&(e.x=y+N+V),T=d({x:y,y:R},{x:e.x,y:R+C})):"southwest"===Z?(e.x+N>y+s-V&&(e.x=y+s-N-V),e.y<R+N+V&&(e.y=R+N+V),T=d({x:e.x,y:R},{x:y+s,y:e.y})):"south"===Z?(e.y<R+N+V&&(e.y=R+N+V),T=d({x:y,y:R},{x:y+s,y:e.y})):"southeast"===Z&&(e.x<y+N+V&&(e.x=y+N+V),e.y<R+N+V&&(e.y=R+N+V),T=d({x:y,y:R},e)),"keepRatio"===x&&(!_&&u||_&&!u)&&("northeast"===Z||"southeast"===Z||"northwest"===Z||"southwest"===Z)){var M=T.width,E=T.height,j=M/s,J=E/C,G=Y(j,J);T.width=s*G,T.height=C*G,"northeast"===Z?T.y=R+(C-T.height):"northwest"===Z?(T.y=R+(C-T.height),T.x=y+(s-T.width)):"southwest"===Z&&(T.x=y+(s-T.width))}T.x-=X.x,T.y-=X.y;var g=gh(I,T,B,X);return T.x=g.x-T.width/2,T.y=g.y-T.height/2,T},Db=function(Y,A,O,x){var T=Y.getRotation(),j=A,K=j.x,c=j.y,g=j.width,R=j.height,z={x:K+j.width/2,y:c+j.height/2};x=qe(z,x.x-z.x,x.y-z.y,-T),"northwest"===O?j=d(x,{x:K+g,y:c+R}):"north"===O?j=d({x:K,y:x.y},{x:K+g,y:c+R}):"northeast"===O?j=d({x:K,y:x.y},{x:x.x,y:c+R}):"west"===O?j=d({x:x.x,y:c},{x:K+g,y:c+R}):"east"===O?j=d({x:K,y:c},{x:x.x,y:c+R}):"southwest"===O?j=d({x:x.x,y:c},{x:K+g,y:x.y}):"south"===O?j=d({x:K,y:c},{x:K+g,y:x.y}):"southeast"===O&&(j=d({x:K,y:c},x)),Y.setRect(j),j.x-=z.x,j.y-=z.y;var k=gh(Y,j,T,z);Y.p(k.x,k.y)},eg=function(U,x,Q,S,o,L,M,v){var C=I;L?(C=qe(I,o.x-x.x,o.y-x.y,-Q),C.x-=M.x,C.y-=M.y):C=qe(I,o.x-x.x,o.y-x.y,0);var n={x:x.x+C.x,y:x.y+C.y};v&&(n=v(n.x,n.y)),n.e=U.getPoints().get(S).e,U.setPoint(S,n);var p=U.getWidth(),i=U.getHeight(),H=U.p().x-p/2,A=U.p().y-i/2;H-=x.x,A-=x.y;var b=gh(U,{x:H,y:A,width:p,height:i},Q,x);U.p(b.x,b.y)},oj=function(O,S,J){var V,I;if(O instanceof i?(V=O.getPoints(),I=O.getSegments()):O instanceof Z&&"points"===O.s("edge.type")&&(V=O.s("edge.points"),I=O.s("edge.segments"),V=ee(S,V)),I&&I.size()||(I=Ll(V)),O instanceof i&&O.isClosePath()&&I.indexOf(5)<0&&(I=new B(I._as),I.add(5)),I)for(var h=-1,Y=0;Y<I.size();Y++){if(Y===J)return h;var D=I.get(Y);1===D?h+=1:2===D?h+=1:3===D?h+=2:4===D&&(h+=3)}},Dc=function(N,Y,W){var p,A;if(N instanceof i?(p=N.getPoints(),A=N.getSegments()):N instanceof Z&&"points"===N.s("edge.type")&&(p=N.s("edge.points"),A=N.s("edge.segments"),p=ee(Y,p)),A&&A.size()||(A=Ll(p)),A)for(var n=-1,m=0;m<A.size();m++){var C=A.get(m);if(1===C?n+=1:2===C?n+=1:3===C?n+=2:4===C&&(n+=3),n===W)return m}},th=function(l,T){var E=[l[0]-T[0],l[1]-T[1],l[2]-T[2]];return E},cd=function(){var j=new W(16);return j[0]=1,j[1]=0,j[2]=0,j[3]=0,j[4]=0,j[5]=1,j[6]=0,j[7]=0,j[8]=0,j[9]=0,j[10]=1,j[11]=0,j[12]=0,j[13]=0,j[14]=0,j[15]=1,j},Xf=function(k,z){var y=k[0],W=k[1],G=k[2];return k[0]=z[0]*y+z[4]*W+z[8]*G+z[12],k[1]=z[1]*y+z[5]*W+z[9]*G+z[13],k[2]=z[2]*y+z[6]*W+z[10]*G+z[14],k},qf=function(o,L){if(L){var y=E(L),R=k(L),A=o[0],C=o[1],w=o[2],g=o[3],d=o[8],P=o[9],S=o[10],j=o[11];o[0]=A*R-d*y,o[1]=C*R-P*y,o[2]=w*R-S*y,o[3]=g*R-j*y,o[8]=A*y+d*R,o[9]=C*y+P*R,o[10]=w*y+S*R,o[11]=g*y+j*R}},ph=function(P,H){for(var $=P.s("grid.row.count"),a=P.s("grid.column.count"),l=0;$>l;l++)for(var U=0;a>U;U++){var Q=P.getCellRect(l,U);if(j(Q,H))return{rowIndex:l,columnIndex:U,rect:Q,grid:P}}return null},Gn=function(M,h,C,D,O,K){var e={},Z=C-M,o=D-h,t=S.sqrt(Z*Z+o*o),y=Z/t,J=o/t,$=(-M+O)*y+(-h+K)*J;return 0>=$?(e.x=M,e.y=h):$>=t?(e.x=C,e.y=D):(e.x=M+$*y,e.y=h+$*J),Z=O-e.x,o=K-e.y,e.z=S.sqrt(Z*Z+o*o),e},$i=function(l,z){var u,L,F,w,x,Z,S,t,R=l.getPoints(),o=l.getSegments(),Q=l.p(),$=l.getRotation();if(!o||!(o.indexOf(3)>0||o.indexOf(4)>0)){for(t=0;t<=R.size()-1;t++)if(t===R.size()-1?(x=R.get(0),w=R.get(t)):(w=R.get(t),x=R.get(t+1)),w=qe(Q,w.x-Q.x,w.y-Q.y,$),x=qe(Q,x.x-Q.x,x.y-Q.y,$),Z=Gn(w.x,w.y,x.x,x.y,z.x,z.y),S=Z.z,S<(l.s("shape.border.width")||10)){L=w,F=x,u=t;break}if(u!=I){var B=Gn(L.x,L.y,F.x,F.y,z.x,z.y),m=O(L,B);return{attachIndex:u,attachOffset:m}}}},tj=function(A){for(var x=A._data,S=x.p(),Y=x.getRotation(),T=x.getPoints(),t=I,P=[],H=0;H<T.size();H++)t=T.get(H),P.push(qe(S,t.x-S.x,t.y-S.y,Y));A._55O.$15l=P};u.setImage("xeditinteractor_parentIcon",y),u.setImage("xeditinteractor_hostIcon",e),u.setImage("xeditinteractor_edgeIcon",F),u.setImage("xeditinteractor_removeIcon",br),u.setImage("xeditinteractor_sourceIcon",Kp),u.setImage("xeditinteractor_targetIcon",Dg),u.setImage("xeditinteractor_elevationIcon",Hj),u.setImage("xeditinteractor_tallIcon",qq),Q._editPointSize=h?24:9,Q._edgeHelpers=["parent","remove","source","target"],Q._leftTopHelpers=["parent"],Q._rightTopHelpers=["host"],Q._leftBottomHelpers=["edge"],Q._rightBottomHelpers=["remove"],Wi=Wi.concat(Wi).concat(Wi),r._79o=function(){var T=this,O=T.gv,g=O.getZoom(),B=O._editInteractor,b=Rq.call(T);if(!b)return null;var H=Wf(T,!0),k=H[0],f=H[1],D={x:b.x,y:b.y,width:b.width,height:b.height},e=d(k,f);if(B instanceof N.XEditInteractor){D=m(D,e);var i=T._55O,y=O.getEditPointSize()/g+2,o=0;i&&i._43O&&(o+=y/2,c(D,o))}return D},r._47O=function(v){var E=this,x=E.gv,Z=x._editInteractor;Z instanceof N.XEditInteractor||Yc.call(E,v)},r.rectIntersects=function(t){var a=this,W=a._data,Q=a.gv,F=Q.getZoom(),D=a._55O,d=Q._editInteractor;if(d instanceof N.XEditInteractor&&Q.isEditable(W)&&D&&D._43O&&"points"===W.s("edge.type")){var w=W.s("edge.points"),m=W.s("edge.segments");w=ee(a,w),m&&m.size()||(m=Ll(w)),w=w._as;var o=!1,V=h?5:1,u=t.x+V,x=t.y+V,P={x:u,y:x};if(d._edge===W&&d._hoverSegmentIndex>=0){var q=Q._editInteractor._hoverSegmentIndex,M=m.get(q),i=oj(W,a,q),v=I;if(i!=I&&i>=0){var T=w[i],J=Q.getSegmentHoverWidth()/F;if(2===M||1===M){var p=w[i+1];v=Bs(new fp(T.x,T.y),new fp(p.x,p.y),new fp(P.x-J,P.y-J),new fp(P.x+2*J,P.y+2*J)),v.$62l===R&&(o=!0)}else if(3===M){var $=w[i+1],p=w[i+2];v=wi(new fp(T.x,T.y),new fp($.x,$.y),new fp(p.x,p.y),new fp(P.x-J,P.y-J),new fp(P.x+2*J,P.y+2*J)),v.$62l===R&&(o=!0)}else if(4===M){var L=w[i+1],X=w[i+2];p=w[i+3],v=Dp(new fp(T.x,T.y),new fp(L.x,L.y),new fp(X.x,X.y),new fp(p.x,p.y),new fp(P.x-J,P.y-J),new fp(P.x+2*J,P.y+2*J)),v.$62l===R&&(o=!0)}}}if(o)return!0}return I},z._47O=function(U){var D=this,f=D.gv,w=f._editInteractor;w instanceof N.XEditInteractor||Dk.call(D,U)},z.rectIntersects=function(m){var s=this,O=s._data,d=s.gv,W=d.getZoom(),Y=s._55O,g=d._editInteractor;if(g instanceof N.XEditInteractor&&d.isEditable(O)&&Y&&Y._43O){var j=Y.$15l,Z=!1,J=h?5:1,H=m.x+J,z=m.y+J,B={x:H,y:z};if(j&&j.length===O.getPoints().size()||(tj(s),j=Y.$15l),g._shape===O&&g._hoverSegmentIndex>=0){var A=O.getSegments();A&&A.size()||(A=Ll(j));var f=d._editInteractor._hoverSegmentIndex,C=A.get(f),E=oj(O,s,f),S=I;if(E!=I&&E>=0){var Q=j[E],q=d.getSegmentHoverWidth()/W;if(2===C||1===C){var o=j[E+1];S=Bs(new fp(Q.x,Q.y),new fp(o.x,o.y),new fp(B.x-q,B.y-q),new fp(B.x+2*q,B.y+2*q)),S.$62l===R&&(Z=!0)}else if(3===C){var $=j[E+1],o=j[E+2];S=wi(new fp(Q.x,Q.y),new fp($.x,$.y),new fp(o.x,o.y),new fp(B.x-q,B.y-q),new fp(B.x+2*q,B.y+2*q)),S.$62l===R&&(Z=!0)}else if(4===C){var K=j[E+1],G=j[E+2];o=j[E+3],S=Dp(new fp(Q.x,Q.y),new fp(K.x,K.y),new fp(G.x,G.y),new fp(o.x,o.y),new fp(B.x-q,B.y-q),new fp(B.x+2*q,B.y+2*q)),S.$62l===R&&(Z=!0)}}}if(Z)return!0}return I},z._48O=function(){var X=this,M=X.gv,k=M._editInteractor;k instanceof N.XEditInteractor?(J._48O.call(X),X._55O._43O&&tj(X)):We.call(X)},z._79o=function(){var v=this,g=v.gv,_=g.getZoom(),R=g._editInteractor,P=rd.call(v);if(P){var W={x:P.x,y:P.y,width:P.width,height:P.height};if(R instanceof N.XEditInteractor){var D=v._55O,f=g.getEditPointSize()/_+2,p=0;D&&D._43O&&(p+=f/2,c(W,p))}return W}},J._47O=function(K){var s=this,H=s.gv,S=H._editInteractor;if(S instanceof N.XEditInteractor);else{var P=s._55O;P&&P._98o&&og.call(s,K)}},J.getSelectWidth=function(){var E=this,e=E.gv,W=e._editInteractor,C=E._data;return e.isEditable(C)&&W instanceof N.XEditInteractor?0:mf.call(E)},J._80o=function(j){var z=this,b=z.gv._editInteractor;if(lf.call(z,j),b&&b._debug){j.save(),j.beginPath(),j.lineWidth=1,j.strokeStyle="green";var k=z._79o();k&&(j.rect(k.x,k.y,k.width,k.height),j.stroke()),j.restore()}},z._80o=function(w){var L=this,o=L.gv._editInteractor;if(ff.call(L,w),o&&o._debug){w.save(),w.beginPath(),w.lineWidth=1,w.strokeStyle="green";var j=L._79o();w.rect(j.x,j.y,j.width,j.height),w.stroke(),w.restore()}},J._48O=function(){var U=this,j=U.gv,u=U._data,I=j._editInteractor,S=U._55O,L=u.p(),F=u.getRotation();if(I instanceof N.XEditInteractor){if(S._42O){var z=Lm(L,u.getWidth(),u.getHeight(),F),C=z[0],V=z[1],n=z[2],o=z[3],J=z[4],t=z[5],y=z[6],i=z[7];S.$45l=[C,J,V,t,o,y,n,i]}}else Hf.call(U)},Q.getResizeMode=function(){return this.$25l||"normal"},Q.setResizeMode=function(N){var f=this.$25l;this.$25l=N,this.fp("resizeMode",f,N)},Q.getSnapAngle=function(){return this.$26l||Math.PI/36},Q.setSnapAngle=function(O){var Z=this.$26l;this.$26l=O,this.fp("snapAngle",Z,O)},Q.getSnapSpacing=function(){return this.$27l},Q.setSnapSpacing=function(b){var v=this.$27l;this.$27l=b,this.fp("snapSpacing",v,b)},Q.getPointSnapSpacing=function(){return this._pointSnapSpacing},Q.setPointSnapSpacing=function(R){var F=this._pointSnapSpacing;this._pointSnapSpacing=R,this.fp("pointSnapSpacing",F,R)},Q.setHelperEditableFunc=function(Z){var W=this._helperEditableFunc;this._helperEditableFunc=Z,this.fp("helperEditableFunc",W,Z)},Q.getHelperEditableFunc=function(){return this._helperEditableFunc},Q.setLeftTopHelpers=function(A){var D=this._leftTopHelpers;this._leftTopHelpers=A,this.fp("leftTopHelpers",D,A)},Q.getLeftTopHelpers=function(){return this._leftTopHelpers},Q.setLeftTopHelpersAlign=function(B){var x=this._leftTopHelpersAlign;this._leftTopHelpersAlign=B,this.fp("leftTopHelpersAlign",x,B)},Q.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},Q.setRightTopHelpers=function(Y){var r=this._rightTopHelpers;this._rightTopHelpers=Y,this.fp("rightTopHelpers",r,Y)},Q.getRightTopHelpers=function(){return this._rightTopHelpers},Q.setRightTopHelpersAlign=function(s){var C=this._rightTopHelpersAlign;this._rightTopHelpersAlign=s,this.fp("rightTopHelpersAlign",C,s)},Q.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},Q.setLeftBottomHelpers=function(U){var t=this._leftBottomHelpers;this._leftBottomHelpers=U,this.fp("leftBottomHelpers",t,U)},Q.getLeftBottomHelpers=function(){return this._leftBottomHelpers},Q.setLeftBottomHelpersAlign=function(d){var x=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=d,this.fp("leftBottomHelpersAlign",x,d)},Q.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},Q.setRightBottomHelpers=function(Y){var _=this._rightBottomHelpers;this._rightBottomHelpers=Y,this.fp("rightBottomHelpers",_,Y)},Q.getRightBottomHelpers=function(){return this._rightBottomHelpers},Q.setRightBottomHelpersAlign=function(s){var d=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=s,this.fp("rightBottomHelpersAlign",d,s)},Q.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},Q.setEdgeHelpers=function(N){var k=this._edgeHelpers;this._edgeHelpers=N,this.fp("edgeHelpers",k,N)},Q.getEdgeHelpers=function(){return this._edgeHelpers},Q.isHelperEditable=function(w,s){return w instanceof Z&&("host"===s||"edge"===s||"elevation"===s||"tall"===s)?!1:w instanceof U&&("source"===s||"target"===s)?!1:"pointElevation"===s?this._helperEditableFunc?this._helperEditableFunc(w,s):!1:this._helperEditableFunc?this._helperEditableFunc(w,s):!0},Q.getEditHelperSize=function(){return this._editHelperSize||(h?28:16)},Q.setEditHelperSize=function(Z){var b=this._editHelperSize;this._editHelperSize=Z,this.fp("editHelperSize",b,Z)},Q.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},Q.setEditRectBorderColor=function(o){var d=this.$28l;this.$28l=o,this.fp("editRectBorderColor",d,o)},Q.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},Q.setNodeBorderColor=function(L){var n=this.$29l;this.$29l=L,this.fp("nodeBorderColor",n,L)},Q.getEditRectBorderStyle=function(){return this.$30l||"dashed"},Q.setEditRectBorderStyle=function(y){var S=this.$30l;this.$30l=y,this.fp("editRectBorderStyle",S,y)},Q.getControlPointBackground=function(){return this.$31l||"#ff0"},Q.setControlPointBackground=function(f){var D=this.$31l;this.$31l=f,this.fp("controlPointBackground",D,f)},Q.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},Q.setControlPointBorderColor=function(v){var V=this.$32l;this.$32l=v,this.fp("controlPointBorderColor",V,v)},Q.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},Q.setJoinPointBackground=function(W){var l=this.$33l;this.$33l=W,this.fp("joinPointBackground",l,W)},Q.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},Q.setJoinPointBorderColor=function(y){var j=this.$34l;this.$34l=y,this.fp("joinPointBorderColor",j,y)},Q.getDirectionLineColor=function(){return this.$35l||"#888"},Q.setDirectionLineColor=function($){var r=this.$35l;this.$35l=$,this.fp("directionLineColor",r,$)},Q.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},Q.setSegmentHoverColor=function(K){var U=this.$36l;this.$36l=K,this.fp("segmentHoverColor",U,K)},Q.getSegmentHoverWidth=function(){return this.$22l||(h?16:8)},Q.setSegmentHoverWidth=function(L){var S=this.$22l;this.$22l=L,this.fp("segmentHoverWidth",S,L)},Q.getSnapPointBorderColor=function(){return this.$38l||"#f00"},Q.setSnapPointBorderColor=function(f){var C=this.$38l;this.$38l=f,this.fp("snapPointBorderColor",C,f)},Q.getEditRectPadding=function(){return this.$39l!=I?this.$39l:6},Q.setEditRectPadding=function(v){var e=this.$39l;this.$39l=v,this.fp("editRectPading",e,v)},Q.isRectEditable=function(f){var z=this,m=z._editInteractor;return m instanceof N.XEditInteractor?z._rectEditableFunc?z._rectEditableFunc(f):!0:oe.call(z,f)},Q.isPointEditable=function(t){var H=this,B=H._editInteractor;return B instanceof N.XEditInteractor?H._pointEditableFunc?H._pointEditableFunc(t):!0:Tl.call(H,t)},Q.validateImpl=function(){var r=this,U=r.$14l,F=r._editInteractor;if(U){var $=r.getWidth(),q=r.getHeight();($!==U.clientWidth||q!==U.clientHeight)&&(F&&(F._68I=1),L.setCanvas(U,$,q),r._32I=1)}El.call(this)},Q.isEditable=function(j){var H=Gf.call(this,j),A=this._editInteractor;if(A instanceof N.XEditInteractor&&j instanceof Z){if(!j.s("2d.editable"))return!1;var u=this.getEditableFunc();H=u?u(j):!0}return H},Q._42=function(u,R){var H=this,I=H._editInteractor;ih.call(H,u,R),I instanceof N.XEditInteractor&&I._68I&&I._42()},Q.isSnapPoint=function(){return!0};var Tr=function(c){arguments.length>0&&this.$58l(c)},ms=Tr.prototype;ms.$58l=function(m){this.$62l=m,this.points=new Array},ms.$56l=function(b){this.points.push(b)},ms.$57l=function(S){this.points=this.points.concat(S)};var fp=function(b,S){arguments.length>0&&this.$58l(b,S)},Bd=fp.prototype;Bd.$58l=function(R,c){this.x=R,this.y=c},Bd.add=function(y){return new fp(this.x+y.x,this.y+y.y)},Bd.addEquals=function(v){return this.x+=v.x,this.y+=v.y,this},Bd.$55l=function(K){return new fp(this.x*K,this.y*K)},Bd.eq=function(j){return this.x==j.x&&this.y==j.y},Bd.lt=function(B){return this.x<B.x&&this.y<B.y},Bd.lte=function(t){return this.x<=t.x&&this.y<=t.y},Bd.gt=function(l){return this.x>l.x&&this.y>l.y},Bd.gte=function(x){return this.x>=x.x&&this.y>=x.y},Bd.lerp=function(Q,R){return new fp(this.x+(Q.x-this.x)*R,this.y+(Q.y-this.y)*R)},Bd.distanceFrom=function(P){var Q=this.x-P.x,R=this.y-P.y;return g(Q*Q+R*R)},Bd.min=function(N){return new fp(Y(this.x,N.x),Y(this.y,N.y))},Bd.max=function(Y){return new fp(l(this.x,Y.x),l(this.y,Y.y))},Bd.toString=function(){return this.x+","+this.y};var Wc=function(){this.$58l(arguments)},Ap=Wc.prototype;Wc.TO=1e-6,Wc.AC=6,Ap.$58l=function(A){this.co=new Array;for(var w=A.length-1;w>=0;w--)this.co.push(A[w])},Ap.$55l=function(p){for(var i=new Wc,j=0;j<=this.$50l()+p.$50l();j++)i.co.push(0);for(var j=0;j<=this.$50l();j++)for(var A=0;A<=p.$50l();A++)i.co[j+A]+=this.co[j]*p.co[A];return i},Ap.$59l=function(){for(var d=this.$50l();d>=0&&P(this.co[d])<=Wc.TO;d--)this.co.pop()},Ap.$50l=function(){return this.co.length-1},Ap.$51l=function(){var T;switch(this.$59l(),this.$50l()){case 0:T=new Array;break;case 1:T=this.$52l();break;case 2:T=this.$53l();break;case 3:T=this.$54l();break;case 4:T=this.$63l();break;default:T=new Array}return T},Ap.$52l=function(){var G=new Array,r=this.co[1];return 0!=r&&G.push(-this.co[0]/r),G},Ap.$53l=function(){var x=new Array;if(2==this.$50l()){var y=this.co[2],_=this.co[1]/y,w=this.co[0]/y,h=_*_-4*w;if(h>0){var m=g(h);x.push(.5*(-_+m)),x.push(.5*(-_-m))}else 0==h&&x.push(.5*-_)}return x},Ap.$63l=function(){var K=new Array;if(4==this.$50l()){var A=this.co[4],Q=this.co[3]/A,h=this.co[2]/A,O=this.co[1]/A,G=this.co[0]/A,u=new Wc(1,-h,Q*O-4*G,-Q*Q*G+4*h*G-O*O).$54l(),e=u[0],t=Q*Q/4-h+e;if(P(t)<=Wc.TO&&(t=0),t>0){var F=g(t),H=3*Q*Q/4-F*F-2*h,B=(4*Q*h-8*O-Q*Q*Q)/(4*F),p=H+B,s=H-B;if(P(p)<=Wc.TO&&(p=0),P(s)<=Wc.TO&&(s=0),p>=0){var E=g(p);K.push(-Q/4+(F+E)/2),K.push(-Q/4+(F-E)/2)}if(s>=0){var E=g(s);K.push(-Q/4+(E-F)/2),K.push(-Q/4-(E+F)/2)}}else if(0>t);else{var B=e*e-4*G;if(B>=-Wc.TO){if(0>B&&(B=0),B=2*g(B),H=3*Q*Q/4-2*h,H+B>=Wc.TO){var f=g(H+B);K.push(-Q/4+f/2),K.push(-Q/4-f/2)}if(H-B>=Wc.TO){var f=g(H-B);K.push(-Q/4+f/2),K.push(-Q/4-f/2)}}}}return K},Ap.$54l=function(){var q=new Array;if(3==this.$50l()){var u=this.co[3],b=this.co[2]/u,e=this.co[1]/u,G=this.co[0]/u,R=(3*e-b*b)/3,C=(2*b*b*b-9*e*b+27*G)/27,r=b/3,O=C*C/4+R*R*R/27,Q=C/2;if(P(O)<=Wc.TO&&(O=0),O>0){var p,J,Y=g(O);p=-Q+Y,J=p>=0?$(p,1/3):-$(-p,1/3),p=-Q-Y,p>=0?J+=$(p,1/3):J-=$(-p,1/3),q.push(J-r)}else if(0>O){var A=g(-R/3),F=X(g(-O),-Q)/3,i=k(F),K=E(F),t=g(3);q.push(2*A*i-r),q.push(-A*(i+t*K)-r),q.push(-A*(i-t*K)-r)}else{var p;p=Q>=0?-$(Q,1/3):$(-Q,1/3),q.push(2*p-r),q.push(-p-r)}}return q};var Pl=function(J,z){arguments.length>0&&this.$58l(J,z)},ef=Pl.prototype;ef.$58l=function(h,d){this.x=h,this.y=d},ef.length=function(){return g(this.x*this.x+this.y*this.y)},ef.$60l=function(C){return this.x*C.x+this.y*C.y};var up=function(B,A,L,S){var Z,h=(S.x-L.x)*(B.y-L.y)-(S.y-L.y)*(B.x-L.x),W=(A.x-B.x)*(B.y-L.y)-(A.y-B.y)*(B.x-L.x),K=(S.y-L.y)*(A.x-B.x)-(S.x-L.x)*(A.y-B.y);if(0!=K){var y=h/K,z=W/K;y>=0&&1>=y&&z>=0&&1>=z?(Z=new Tr(R),Z.points.push(new fp(B.x+y*(A.x-B.x),B.y+y*(A.y-B.y)))):Z=new Tr(p)}else Z=0==h||0==W?new Tr("C"):new Tr("P");return Z},Hg=function(u,U,n,W,h){var N,e,I,x,T,q,m,O=W.min(h),$=W.max(h),F=new Tr(p);N=U.$55l(-2),I=u.add(N.add(n)),N=u.$55l(-2),e=U.$55l(2),x=N.add(e),T=new fp(u.x,u.y),m=new Pl(W.y-h.y,h.x-W.x),q=W.x*h.y-h.x*W.y;for(var S=new Wc(m.$60l(I),m.$60l(x),m.$60l(T)+q).$51l(),J=0;J<S.length;J++){var o=S[J];if(o>=0&&1>=o){var E=u.lerp(U,o),P=U.lerp(n,o),V=E.lerp(P,o);W.x==h.x?O.y<=V.y&&V.y<=$.y&&(F.$62l=R,F.$56l(V)):W.y==h.y?O.x<=V.x&&V.x<=$.x&&(F.$62l=R,F.$56l(V)):V.gte(O)&&V.lte($)&&(F.$62l=R,F.$56l(V))}}return F},wi=function(j,D,t,I,h){var E=I.min(h),H=I.max(h),y=new fp(H.x,E.y),r=new fp(E.x,H.y),m=Hg(j,D,t,E,y),g=Hg(j,D,t,y,H),Z=Hg(j,D,t,H,r),z=Hg(j,D,t,r,E),$=new Tr(p);return $.$57l(m.points),$.$57l(g.points),$.$57l(Z.points),$.$57l(z.points),$.points.length>0&&($.$62l=R),$},gi=function(M,z,l,I,t,X){var L,H,j,Z,T,C,v,S,q,W,Q=t.min(X),x=t.max(X),e=new Tr(p);L=M.$55l(-1),H=z.$55l(3),j=l.$55l(-3),Z=L.add(H.add(j.add(I))),T=new Pl(Z.x,Z.y),L=M.$55l(3),H=z.$55l(-6),j=l.$55l(3),Z=L.add(H.add(j)),C=new Pl(Z.x,Z.y),L=M.$55l(-3),H=z.$55l(3),j=L.add(H),v=new Pl(j.x,j.y),S=new Pl(M.x,M.y),W=new Pl(t.y-X.y,X.x-t.x),q=t.x*X.y-X.x*t.y;for(var $=new Wc(W.$60l(T),W.$60l(C),W.$60l(v),W.$60l(S)+q).$51l(),n=0;n<$.length;n++){var m=$[n];if(m>=0&&1>=m){var F=M.lerp(z,m),O=z.lerp(l,m),s=l.lerp(I,m),d=F.lerp(O,m),G=O.lerp(s,m),E=d.lerp(G,m);t.x==X.x?Q.y<=E.y&&E.y<=x.y&&(e.$62l=R,e.$56l(E)):t.y==X.y?Q.x<=E.x&&E.x<=x.x&&(e.$62l=R,e.$56l(E)):E.gte(Q)&&E.lte(x)&&(e.$62l=R,e.$56l(E))}}return e},Dp=function(n,Z,g,L,r,$){var k=r.min($),F=r.max($),W=new fp(F.x,k.y),v=new fp(k.x,F.y),y=gi(n,Z,g,L,k,W),C=gi(n,Z,g,L,W,F),H=gi(n,Z,g,L,F,v),V=gi(n,Z,g,L,v,k),N=new Tr(p);return N.$57l(y.points),N.$57l(C.points),N.$57l(H.points),N.$57l(V.points),N.points.length>0&&(N.$62l=R),N},Bs=function(x,t,_,$){var D=_.min($),L=_.max($),h=new fp(L.x,D.y),y=new fp(D.x,L.y),I=up(D,h,x,t),w=up(h,L,x,t),Y=up(L,y,x,t),l=up(y,D,x,t),s=new Tr(p);return s.$57l(I.points),s.$57l(w.points),s.$57l(Y.points),s.$57l(l.points),s.points.length>0&&(s.$62l=R),s},Ic=N.XEditInteractor=function(b){var L=this,A=L._view=document.createElement("canvas");A.className="editCanvas",A.style.position="absolute",Ic.superClass.constructor.call(L,b)};u.def(Ic,N.Interactor,{ms_edit:1,setUp:function(){var u=this,$=u.gv,U=$.getView(),b=u._view;Ic.superClass.setUp.call(u),$.setEditInteractor(u),$.$14l=b,$._79O?U.insertBefore(b,$._79O):U.appendChild(b);var M=u.$49l=u.$11l.bind(u);$.dm().md(M),$.sm().ms(M),$.mp(M)},tearDown:function(){var x=this,Y=x.gv,i=Y.getView(),n=x.$49l;Ic.superClass.tearDown.call(x),Y.setEditInteractor(I),Y.$14l=I,i.removeChild(x._view),Y.dm().umd(n),Y.sm().ums(n),Y.ump(n)},clear:function(){var J=this,T=J.gv;delete J._hoverSegmentIndex,delete J._edge,delete J._shape,delete T._editing,delete J.$10l,delete J.$13l,delete J.$9l,delete J._removePointIndex,delete J._lp,J.$12l="",delete J.$40l,delete J.$67l,delete J.$72l,delete J.$73l,delete J.$75l,delete J.$1l,delete J.$3l,delete J.$2l,delete J.$92l,delete J.$93l,delete J.$94l,J.clearDragging()},handle_keydown:function(e){this.$48l!==e.shiftKey&&(this.$48l=e.shiftKey,this.handle_mousemove(e,A,!0))},handle_keyup:function(w){this.$48l!==w.shiftKey&&(this.$48l=w.shiftKey,this.handle_mousemove(w,A,!0))},handle_touchstart:function(M){this.handle_mousemove(M),this.handle_mousedown(M)},handle_mousedown:function(S){v(S);var A=this,y=A.$13l,N=A.gv,h=N.dm(),M=N.sm(),l=N.getZoom(),w=N.lp(S),X=u.isDoubleClick(S),m=u.isLeftButton(S),q=A.$7l,p=A._shape,b=A._hoverSegmentIndex,s=A._edge,L=A.$87l,G=A.$88l,E=function(){A._68I||L===A.$87l&&G===A.$88l||A.$43l()};if(7!==A.$67l&&(delete A.$87l,delete A.$88l),m&&(p||s)&&b>=0&&X&&(p&&M.contains(p)||s&&M.contains(s))){var Y=_g.call(A,p||s,b,w);return A.addShapePoint(p||s,b,Y),T(function(){A.handle_mousemove(S)},40),void 0}if(m&&(p||s)&&A._removePointIndex>=0&&X)return A.removeShapePoint(),A.$5l=1,T(function(){A.handle_mousemove(S)},40),void 0;if(!m||!N._editing)return E(),void 0;if(p&&y>=0){var V=p.getPoints().get(y),J=p.p(),B=qe(J,V.x-J.x,V.y-J.y,-q+p.getRotation());o=qe(J,w.x-J.x,w.y-J.y,-q),A.$24l={x:o.x-B.x,y:o.y-B.y},A.startDragging(S),h.beginTransaction(),A.fi({kind:"beginEditPoint",event:S,data:p,index:y}),A.$88l=y,A.$87l=p}else if(A.$10l){var a=N.sm().getSelection(),f=A.$6l,K=A.$1l={},g=A.$3l={},O=A.$16l[x[A.$10l]],W={x:f.x,y:f.y},F={x:f.x+f.width/2,y:f.y+f.height/2};A.$24l={x:w.x-O.x/l,y:w.y-O.y/l},A.$2l=t(A.$8l),A.$4l=t(f),a.each(function(x){if(x instanceof U){var y=x.p(),O=x.getWidth(),C=x.getHeight(),L=qe(F,y.x-F.x,y.y-F.y,-q);K[x.getId()]={x:y.x-O/2,y:y.y-C/2,width:O,height:C},g[x.getId()]={x:(L.x-W.x)/f.width,y:(L.y-W.y)/f.height}}}),A.startDragging(S),h.beginTransaction(),A.fi({kind:"beginEditRect",event:S,direction:A.$10l})}else if(s&&y>=0){var j=ee(N.getDataUI(s),s.s("edge.points")),V=j.get(y);A.$24l={x:w.x-V.x,y:w.y-V.y},A.startDragging(S),h.beginTransaction(),A.fi({kind:"beginEditPoint",event:S,data:s,index:y}),A.$88l=y,A.$87l=s}else if(A.$40l){var f=A.$6l,F={x:f.x+f.width/2,y:f.y+f.height/2},d=t(A.$23l);d.x/=l,d.y/=l;var Q=qe(F,d.x-F.x,d.y-F.y,-q),o=qe(F,w.x-F.x,w.y-F.y,-q);A.$24l={x:o.x-Q.x,y:o.y-Q.y},A.startDragging(S),h.beginTransaction(),A.fi({kind:"beginEditRotation",event:S,data:A._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(A.$67l)>=0){var I=A.$67l;(7===I||8===I||9===I)&&h.beginTransaction(),A.startDragging(S)}else if(A.$71l&&X&&A.$79l(A.$71l,w)){var i=M.toSelection();h.beginTransaction(),i.each(function(G){h.remove(G)}),h.endTransaction()}E()},$11l:function(){var E=this,J=E.gv;J._editing&&(E.$13l==I||E._shape==I&&E._edge==I)&&(E.$73l==I||1!==E.$67l&&5!==E.$67l&&6!==E.$67l)||(E.$5l=1),E._68I=1},$46l:function(O){var y=this,A=y.gv,T=A.lp(O),U=[];return qg(A,function(b){var h=A.getDataUI(b);if(h){var o=h._79o();j(o,T)&&U.push(b)}}),U},$47l:function(v){var O=this,y=O.$13l,l=O.gv.dm();O.$10l?(O.fi({kind:"endEditRect",event:v,direction:O.$10l}),l.endTransaction()):O._shape&&y>=0?(O.fi({kind:"endEditPoint",event:v,data:O._shape,index:y}),l.endTransaction()):O._edge&&y>=0?(O.fi({kind:"endEditPoint",event:v,data:O._edge,index:y}),l.endTransaction()):O.$23l&&O.$40l&&(O.fi({kind:"endEditRotation",event:v}),l.endTransaction())},handleWindowTouchEnd:function(S){this.handleWindowMouseUp(S)},handleWindowMouseUp:function(D){var u=this,_=u.gv,L=_.dm(),V=u._shape,s=u._edge,F=u.$13l,c=u.$40l,K=u.$9l,X=u.$10l,J=u.$67l;if((V||s)&&F>=0&&K>=0){var R,g;if(V){var Q=V.p(),Y=V.getRotation();R=V.getPoints(),g=R.get(K),eg(V,Q,Y,F,g,!1)}else if(R=ee(_.getDataUI(s),s.s("edge.points"),!0),g=R.get(K),0===F){var n=R.get(0);s.s("edge.source.offset.x",g.x-n.x),s.s("edge.source.offset.y",g.y-n.y)}else if(F===R.size()-1){var o=R.get(R.size()-1);s.s("edge.target.offset.x",g.x-o.x),s.s("edge.target.offset.y",g.y-o.y)}else"points"===s.s("edge.type")&&(R.set(F,g),s.s("edge.points",lh(R)))}u.$47l(D);var S=u.$73l;1===J?(L.beginTransaction(),S?_.sm().each(function(J){if(J.setHost&&_.isHelperEditable(J,"host")){J.setHost(S);
var g=u.$75l,a=u.$74l;g&&(J.s("attach.row.index",g.rowIndex),J.s("attach.column.index",g.columnIndex)),a&&(J.s("attach.index",a.attachIndex),J.s("attach.offset",a.attachOffset),J.s("attach.offset.relative",!1),J.s("attach.offset.opposite",!1))}}):_.sm().each(function(K){K.setHost&&_.isHelperEditable(K,"host")&&(K.setHost(I),K.s("attach.row.index",A),K.s("attach.column.index",A),K.s("attach.index",A),K.s("attach.offset",A),K.s("attach.offset.relative",!1),K.s("attach.offset.opposite",!1))}),L.endTransaction()):2===J?(L.beginTransaction(),S?_.sm().each(function(A){A.setParent&&_.isHelperEditable(A,"parent")&&A.setParent(S)}):_.sm().each(function(Z){Z.setParent&&_.isHelperEditable(Z,"parent")&&Z.setParent(I)}),L.endTransaction()):3===J?S&&(L.beginTransaction(),_.sm().each(function(o){if(_.isHelperEditable(o,"edge")&&o instanceof U&&S instanceof U){var v=new w.Edge;L.add(v),v.setSource(o),v.setTarget(S),u.onEdgeCreated&&u.onEdgeCreated(D,v)}}),L.endTransaction()):5===J||6===J?S&&(L.beginTransaction(),_.sm().each(function(v){v instanceof Z&&S instanceof U&&(5===J&&_.isHelperEditable(v,"source")?v.setSource(S):6===J&&_.isHelperEditable(v,"source")&&v.setTarget(S))}),L.endTransaction()):(7===J||8===J||9===J)&&L.endTransaction(),(X||c)&&u.$43l(!0),h?(u.clear(),delete u.$64l,u._68I||u.$43l()):(u.handle_mousemove(D,!0),J&&!u._68I&&u.$43l())},handleWindowTouchMove:function(U){this.handleWindowMouseMove(U)},handleWindowMouseMove:function(W){this._78I(W)},handle_mousemove:function(J,V,Q){if(!this._pause){if(!Q){var Z=h?Nf(J):J;this.$61l={clientX:Z.clientX,clientY:Z.clientY}}if(V===!0||!a()){var z=this,C=z.gv,F=!1,W=I;z.clear(),C.sm().size()>0&&(W=C.lp(Q?z.$61l:J),F=z._79I(J,W)),F&&(C._editing=1),z.$12l!==z.$65l&&(z.$65l=z.$12l,z.setCursor(z.$12l)),z.$40l!==z.$64l&&(z.$64l=z.$40l,z._68I||z.$43l()),z._hoverSegmentIndex!==z.$66l&&(z.$66l=z._hoverSegmentIndex,z._68I||z.$43l())}}},_78I:function(w){this.autoScroll(w);var N=this,v=N.gv,D=v.lp(w),l=v.getZoom(),S=N.$13l;if((N._shape||N._edge)&&S>=0){var q,t,e,m=N._shape,x=N._edge,b=N.$24l,F=v.getPointSnapSpacing(),V=function(z,j){return F==I||isNaN(F)?{x:z,y:j}:{x:f(z/F)*F,y:f(j/F)*F}};if(m){q=m.getPoints();var $=m.p(),A=m.getRotation(),J=0;t=qe($,D.x-$.x,D.y-$.y,-A),eg(m,$,A,S,D,!0,b,V),N.fi({kind:"betweenEditPoint",event:w,data:m,index:S})}else if(x){q=ee(v.getDataUI(x),x.s("edge.points"),!0),D.x-=b.x,D.y-=b.y,t=D;var z,B,h=x.s("edge.offset"),G=q.size(),K=G>2;if(0===S){var L=q.get(0);h&&(L=Nm(L,q.get(1),-h,K),D=Nm(D,q.get(1),-h,K)),z=D.x-L.x,B=D.y-L.y,e=V(z,B),x.s("edge.source.offset.x",e.x),x.s("edge.source.offset.y",e.y)}else if(S===G-1){var n=q.get(G-1);h&&(n=Nm(n,q.get(G-2),-h,K),D=Nm(D,q.get(G-2),-h,K)),z=D.x-n.x,B=D.y-n.y,e=V(z,B),x.s("edge.target.offset.x",e.x),x.s("edge.target.offset.y",e.y)}else"points"===x.s("edge.type")&&(e=V(D.x,D.y),e.e=q.get(S).e,q.set(S,e),x.s("edge.points",lh(q)));N.fi({kind:"betweenEditPoint",event:w,data:x,index:S})}if(delete N.$9l,v.isSnapPoint(m)||v.isSnapPoint(x))for(J=0;J<q.size();J++)if(J!==S){var d=q.get(J);if(O(d,t)<v.getEditPointSize()/l){N.$9l=J;break}}}else if(N.$10l){var b=N.$24l;D.x-=b.x,D.y-=b.y;var a=v.sm().getSelection(),R=N.$1l,k=N.$7l,E=N.$10l,_=N.$4l,Y=N.$2l,r=v.getEditRectPadding()/l,M=2*r,y=v.getSnapSpacing(),Q=y!=I&&!isNaN(y),p=lg(Y,D,E,k,2*r,v.getResizeMode(),Q,!0),W=N.$6l;if(Q){var o=p.width-M,j=p.height-M,c=f(o/y)*y,km=f(j/y)*y,Ek=c-o,ci=km-j;("west"===E||"northwest"===E||"southwest"===E)&&(Ek=-Ek),("north"===E||"northwest"===E||"northeast"===E)&&(ci=-ci),p=lg(Y,D,E,k,2*r,v.getResizeMode(),Q,!1,Ek,ci)}N.$8l=p,W.x=p.x+r,W.y=p.y+r,W.width=p.width-M,W.height=p.height-M;var Bf=p.x+p.width/2,lj=p.y+p.height/2,Ec=W.x,ql=W.y,rb=W.width/_.width,bj=W.height/_.height;a.each(function(O){if(O instanceof U&&v.isEditable(O)&&v.isRectEditable(O)){var m=R[O.getId()],K=N.$3l[O.getId()],e={x:m.x+m.width/2,y:m.y+m.height/2},T=0,Q=0,z=E,d=180*P(k-O.getRotation())/H;"northeast"===E?d>=315||45>d?(T=m.width*rb+m.x,Q=m.height*(1-bj)+m.y,z="northeast"):d>=45&&135>d?(T=m.width*(1-bj)+m.x,Q=m.height*(1-rb)+m.y,z="northwest"):d>=135&&225>d?(T=m.width*(1-rb)+m.x,Q=m.height*bj+m.y,z="southwest"):(T=m.width*bj+m.x,Q=m.height*rb+m.y,z="southeast"):"north"===E?d>=315||45>d?(Q=m.height*(1-bj)+m.y,z="north"):d>=45&&135>d?(T=m.width*(1-bj)+m.x,z="west"):d>=135&&225>d?(Q=m.height*bj+m.y,z="south"):(T=m.width*bj+m.x,z="east"):"northwest"===E?d>=315||45>d?(T=m.width*(1-rb)+m.x,Q=m.height*(1-bj)+m.y,z="northwest"):d>=45&&135>d?(T=m.width*(1-bj)+m.x,Q=m.height*rb+m.y,z="southwest"):d>=135&&225>d?(T=m.width*rb+m.x,Q=m.height*bj+m.y,z="southeast"):(T=m.width*bj+m.x,Q=m.height*(1-rb)+m.y,z="northeast"):"west"===E?d>=315||45>d?(T=m.width*(1-rb)+m.x,z="west"):d>=45&&135>d?(Q=m.height*rb+m.y,z="south"):d>=135&&225>d?(T=m.width*rb+m.x,z="east"):(Q=m.height*(1-rb)+m.y,z="north"):"southwest"===E?d>=315||45>d?(T=m.width*(1-rb)+m.x,Q=m.height*bj+m.y,z="southwest"):d>=45&&135>d?(T=m.width*bj+m.x,Q=m.height*rb+m.y,z="southeast"):d>=135&&225>d?(T=m.width*rb+m.x,Q=m.height*(1-bj)+m.y,z="northeast"):(T=m.width*(1-bj)+m.x,Q=m.height*(1-rb)+m.y,z="northwest"):"east"===E?d>=315||45>d?(T=m.width*rb+m.x,z="east"):d>=45&&135>d?(Q=m.height*(1-rb)+m.y,z="north"):d>=135&&225>d?(T=m.width*(1-rb)+m.x,z="west"):(Q=m.height*rb+m.y,z="south"):"south"===E?d>=315||45>d?(Q=m.height*bj+m.y,z="south"):d>=45&&135>d?(T=m.width*bj+m.x,z="east"):d>=135&&225>d?(Q=m.height*(1-bj)+m.y,z="north"):(T=m.width*(1-bj)+m.x,z="west"):"southeast"===E&&(d>=315||45>d?(T=m.width*rb+m.x,Q=m.height*bj+m.y,z="southeast"):d>=45&&135>d?(T=m.width*bj+m.x,Q=m.height*(1-rb)+m.y,z="northeast"):d>=135&&225>d?(T=m.width*(1-rb)+m.x,Q=m.height*(1-bj)+m.y,z="northwest"):(T=m.width*(1-bj)+m.x,Q=m.height*rb+m.y,z="southwest"));var _=qe(e,T-e.x,Q-e.y,O.getRotation());Db(O,m,z,{x:_.x,y:_.y});var V=Ec+W.width*K.x,o=ql+W.height*K.y,h={x:V,y:o};h=qe({x:Bf,y:lj},h.x-Bf,h.y-lj,k),O.p(h.x,h.y)}}),N.fi({kind:"betweenEditRect",event:w,direction:E})}else if(N.$23l&&N.$40l){var mn=N.$8l,Gf=mn.width,dd=mn.height,$={x:mn.x+Gf/2,y:mn.y+dd/2},b=N.$24l,hn=N.$23l,Yg=hn.x/l-$.x,tc=hn.y/l-$.y,Lc=g(Yg*Yg+tc*tc),zr=Math.asin(b.x/Lc),fh=v.sm().getSelection(),tk=C+X(D.y-$.y,D.x-$.x)-zr,pk=v.getSnapAngle(),tk=f(tk/pk)*pk;0>tk&&(tk+=s);var Ae=tk-N.$7l,bk=[$.x,0,$.y];fh.each(function(S){if(v.isEditable(S)&&v.isRotationEditable(S)&&v.isVisible(S)){var b=th(S.p3(),bk),p=cd();qf(p,-Ae),S.setRotation(S.getRotation()+Ae),Xf(b,p),S.p3(bk[0]+b[0],bk[1]+b[1],bk[2]+b[2])}}),N.$7l=tk,N.fi({kind:"betweenEditRotation",event:w})}else if([1,2,3,5,6].indexOf(N.$67l)>=0)N.$72l=w,N.$78l||(N.$78l=1,T(function(){u.isDragging()&&N.$43l(),delete N.$78l},12));else if(7===N.$67l){if(N.$87l instanceof i){var m=N.$87l,nd=N.$88l,Yl=u.clone(m.getPoints().get(nd)),Fc=D.y-Yl.y;Yl.e||(Yl.e=0),N.$92l||(N.$92l=Yl.e),Yl.e=N.$92l-Fc,m.setPoint(nd,Yl)}else if(N.$87l instanceof Z){var x=N.$87l,nd=N.$88l,q=ee(v.getDataUI(x),x.s("edge.points")),Yl=q.get(nd),Fc=D.y-Yl.y;Yl.e||(Yl.e=0),N.$92l||(N.$92l=Yl.e),Yl.e=N.$92l-Fc,q.set(nd,Yl),x.s("edge.points",lh(q))}}else if(8===N.$67l){var fh=v.sm().getSelection(),Zn=N.$93l;Zn||(Zn=N.$93l={}),fh.each(function(k){if(k.p3){var W=k.p3(),r=Zn[k.getId()];r==I&&(r=Zn[k.getId()]=W[1]),k.p3([W[0],r-(D.y-N.$90l.y/l),W[2]])}})}else if(9===N.$67l){var fh=v.sm().getSelection(),yj=N.$94l;yj||(yj=N.$94l={}),fh.each(function(x){if(x.s3){var g=x.s3(),V=yj[x.getId()];V==I&&(V=yj[x.getId()]=g[1]);var p=V-(D.y-N.$91l.y/l);0>p&&(p=.01),x.s3([g[0],p,g[2]])}})}},$79l:function(V,m){var F=this,Z=F.gv,r=Z.getZoom(),w=Z.getEditHelperSize(),n=V.x/r,h=V.y/r,$=w/r,e=$/2;return j({x:n-e,y:h-e,width:$,height:$},m)?!0:void 0},getHelperCursor:function(){return"crosshair"},_79I:function(u,S){for(var C=this,_=C.gv,c=_.getZoom(),Q=_.getEditPointSize(),d=Q/c,o=d/2,E=C.$46l(u),f=0;f<E.length;f++){var G,J,y=E[f],K=_.getDataUI(y);if(K&&K._55O){var b=K._55O;if(b._43O&&y instanceof Z){if(G=y.s("edge.points"),G=ee(K,G),J=y.s("edge.segments"),J&&J.size()||(J=Ll(G)),C.$42l(y,S,G._as,J,"edge"))return!0;if("points"===y.s("edge.type"))return C.$41l(y,S,G._as,J,"edge"),void 0}if(b._43O&&y instanceof i&&b.$15l&&b.$15l.length===y.getPoints().size()){if(G=b.$15l,J=y.getSegments(),J&&J.size()||(J=Ll(G)),C.$42l(y,S,G,J,"shape"))return!0;if(C.$41l(y,S,G,J,"shape"))return}}}if(C.$16l){var G,r=C.$16l,X=r[3].x-r[7].x,P=r[3].y-r[7].y,t=g(X*X+P*P),D=r[1].x-r[5].x,R=r[1].y-r[5].y,H=g(D*D+R*R),$={x:S.x*c,y:S.y*c};if(C._80I($,0,r[0],"northwest",t,H)||C._80I($,1,r[1],"north",t,H)||C._80I($,2,r[2],"northeast",t,H)||C._80I($,7,r[7],"west",t,H)||C._80I($,3,r[3],"east",t,H)||C._80I($,6,r[6],"southwest",t,H)||C._80I($,5,r[5],"south",t,H)||C._80I($,4,r[4],"southeast",t,H))return!0}if(C.$23l){var x=C.$23l,p=x.x/c,I=x.y/c;if(j({x:p-o,y:I-o,width:d,height:d},S))return C.$40l=1,C.$12l=C.getHelperCursor("rotation")||"crosshair",!0}return C.$68l&&C.$79l(C.$68l,S)?(C.$67l=1,C.$12l=C.getHelperCursor("host")||"crosshair",!0):C.$69l&&C.$79l(C.$69l,S)?(C.$67l=2,C.$12l=C.getHelperCursor("parent")||"crosshair",!0):C.$70l&&C.$79l(C.$70l,S)?(C.$67l=3,C.$12l=C.getHelperCursor("edge")||"crosshair",!0):C.$71l&&C.$79l(C.$71l,S)?(C.$67l=4,C.$12l=C.getHelperCursor("remove")||"crosshair",!0):C.$82l&&C.$79l(C.$82l,S)?(C.$67l=5,C.$12l=C.getHelperCursor("source")||"crosshair",!0):C.$83l&&C.$79l(C.$83l,S)?(C.$67l=6,C.$12l=C.getHelperCursor("target")||"crosshair",!0):C._pointElevationHelperPoint&&C.$79l(C._pointElevationHelperPoint,S)?(C.$67l=7,C.$12l=C.getHelperCursor("pointElevation")||"crosshair",!0):C.$90l&&C.$79l(C.$90l,S)?(C.$67l=8,C.$12l=C.getHelperCursor("elevation")||"crosshair",!0):C.$91l&&C.$79l(C.$91l,S)?(C.$67l=9,C.$12l=C.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function(O,t,T,n,q,k){var Z=this,d=Z.gv,m=d.getEditPointSize(),a=m/2,p=d.sm(),y=d.isDirectionEditable;if(y&&1===p.size()){var o=p.ld();if(y=y.bind(d),o instanceof U){if(!y(o,n))return!1;if("east"===n){if(y(o,"northeast")&&y(o,"southeast")&&2*m>=k)return!1}else if("west"===n){if(y(o,"northwest")&&y(o,"southwest")&&2*m>=k)return!1}else if("north"===n){if(y(o,"northwest")&&y(o,"northeast")&&2*m>=q)return!1}else if("south"===n&&y(o,"southwest")&&y(o,"southeast")&&2*m>=q)return!1}}else{if(2*m>=q&&("north"===n||"south"===n))return!1;if(2*m>=k&&("east"===n||"west"===n))return!1}if(j({x:T.x-a,y:T.y-a,width:m,height:m},O)){if(Z.$10l!==n){var c=180*Z.$7l/H,E="";c>=337.5||22.5>c?E="north":c>=22.5&&67.5>c?E="northeast":c>=67.5&&112.5>c?E="east":c>=112.5&&157.5>c?E="southeast":c>=157.5&&202.5>c?E="south":c>=202.5&&247.5>c?E="southwest":c>=247.5&&292.5>c?E="west":c>=292.5&&337.5>c&&(E="northwest");var z=Wi.indexOf(E),E=Wi[t-(1-z)+8];switch(E){case"northwest":Z.$12l="nwse-resize";break;case"northeast":Z.$12l="nesw-resize";break;case"southwest":Z.$12l="nesw-resize";break;case"southeast":Z.$12l="nwse-resize";break;case"north":Z.$12l="ns-resize";break;case"east":Z.$12l="ew-resize";break;case"south":Z.$12l="ns-resize";break;case"west":Z.$12l="ew-resize"}Z.$10l=n}return!0}return!1},$42l:function(_,D,g,X,z){var f,k=this,i=k.gv,R=i.getEditPointSize(),C=R/i.getZoom(),h=-1,$={x:D.x,y:D.y,width:0,height:0},m=function(Q){"shape"===z?k._shape=_:k._edge=_,k._removePointIndex=Q},e=function(Y){"shape"===z?k._shape=_:k._edge=_,k.$13l=Y,k.$12l="crosshair"};for(c($,C/2),h=g.length-1,f=X.size()-1;f>=0;f--){var Y=X.get(f);if(1===Y||2===Y)h-=1;else if(3===Y){var P=g[h-1];if(j($,P))return e(h-1),!0;h-=2}else if(4===Y){var W=g[h-1],M=g[h-2];if(j($,W))return e(h-1),!0;if(j($,M))return e(h-2),!0;h-=3}}for(h=g.length-1,f=X.size()-1;f>=0;f--){var Y=X.get(f),T=g[h];if(j($,T))return m(h),e(h),!0;1===Y||2===Y?h-=1:3===Y?h-=2:4===Y&&(h-=3)}return!1},$41l:function(V,S,h,X,f){var $=this,j=$.gv,O=-1,e=0,N={x:S.x,y:S.y,width:0,height:0},s=function(x,I){$._hoverSegmentIndex=I,$._lp=S,"shape"===f?$._shape=V:$._edge=V};for(c(N,j.getSegmentHoverWidth()/2/j.getZoom()),V instanceof i&&V.isClosePath()&&X.indexOf(5)<0&&(X=new B(X._as),X.add(5));e<X.size();e++){var o=X.get(e);if(1===o){var k=h[O],E=h[O+1];if(k){var z=Bs(new fp(k.x,k.y),new fp(E.x,E.y),new fp(N.x,N.y),new fp(N.x+N.width,N.y+N.height));if(z.$62l===R&&z.points.length>0)return s(z,e),!0}O+=1}else if(2===o){var k=h[O],E=h[O+1],z=Bs(new fp(k.x,k.y),new fp(E.x,E.y),new fp(N.x,N.y),new fp(N.x+N.width,N.y+N.height));if(z.$62l===R&&z.points.length>0)return s(z,e),!0;O+=1}else if(3===o){var k=h[O],t=h[O+1],b=h[O+2],z=wi(new fp(k.x,k.y),new fp(t.x,t.y),new fp(b.x,b.y),new fp(N.x,N.y),new fp(N.x+N.width,N.y+N.height));if(z.$62l===R)return s(z,e),!0;O+=2}else if(4===o){var k=h[O],Q=h[O+1],Z=h[O+2],b=h[O+3],z=Dp(new fp(k.x,k.y),new fp(Q.x,Q.y),new fp(Z.x,Z.y),new fp(b.x,b.y),new fp(N.x,N.y),new fp(N.x+N.width,N.y+N.height));if(z.$62l===R)return s(z,e),!0;O+=3}else if(5===o){var k=h[O],E=h[0];if(k){var z=Bs(new fp(k.x,k.y),new fp(E.x,E.y),new fp(N.x,N.y),new fp(N.x+N.width,N.y+N.height));if(z.$62l===R&&z.points.length>0)return s(z,e),!0}}}return!1},addShapePoint:function(l,m,Y){var t=this,S=t.gv,O=S.dm();if(O.beginTransaction(),0===arguments.length&&(l=t._shape||t._edge,m=t._hoverSegmentIndex,Y=t._lp),l instanceof i||l instanceof Z){var c=oj(l,S.getDataUI(l),m);if(!isNaN(m)&&Y&&!isNaN(c)){var X=Y;if(l instanceof i){var U=l.p(),$=l.getRotation(),f=l.toSegments();f&&f.size()||(f=Ll(l.getPoints())),l.isClosePath()&&f.indexOf(5)<0&&(f=new B(f._as),f.add(5));var E=f.get(m),g="addPoint",n="removePointAt";if(2===E||1===E){var u={x:X.x,y:X.y};f.add(E,m),u=qe(U,u.x-U.x,u.y-U.y,-$),l[g](u,c+1)}else if(3===E){var p=l.getPoints(),N=p.get(c),a=p.get(c+2),u={x:X.x,y:X.y};u=qe(U,u.x-U.x,u.y-U.y,-$);var T=Hl(N,u),j=Hl(u,a);f.removeAt(m),f.add(3,m),f.add(3,m),l.setPoint(c+1,u),l[g](j,c+2),l[g](T,c+1)}else if(4===E){var p=l.getPoints(),N=p.get(c),a=p.get(c+3),u={x:X.x,y:X.y};u=qe(U,u.x-U.x,u.y-U.y,-$);var T=yd(N,u),j=kr(N,u),R=yd(u,a),k=kr(u,a);f.removeAt(m),f.add(4,m),f.add(4,m),l[n](c+1),l[n](c+1),l[g](u,c+1),l[g](k,c+2),l[g](R,c+2),l[g](j,c+1),l[g](T,c+1)}else if(5===E){var u={x:X.x,y:X.y};f.add(2,m),u=qe(U,u.x-U.x,u.y-U.y,-$),l[g](u,c+1)}l.isClosePath()&&f.remove(5),l.setSegments(f);var h=l.getWidth(),o=l.getHeight(),x=l.p().x-h/2,P=l.p().y-o/2;x-=U.x,P-=U.y;var d=gh(l,{x:x,y:P,width:h,height:o},$,U);l.p(d.x,d.y)}else if(l instanceof Z){if("points"!==l.s("edge.type"))return O.endTransaction(),void 0;var p=l.s("edge.points");f=l.s("edge.segments"),p=ee(S.getDataUI(l),p),f&&f.size()||(f=Ll(p)),f=new B(f._as.slice(0)),p=new B(p._as.slice(0));var E=f.get(m);if(2===E||1===E){var u={x:X.x,y:X.y};f.add(E,m),p.add(u,c+1)}else if(3===E){var N=p.get(c),a=p.get(c+2),u={x:X.x,y:X.y},T=Hl(N,u),j=Hl(u,a);f.removeAt(m),f.add(3,m),f.add(3,m),p.set(c+1,u),p.add(j,c+2),p.add(T,c+1)}else if(4===E){var N=p.get(c),a=p.get(c+3),u={x:X.x,y:X.y},T=yd(N,u),j=kr(N,u),R=yd(u,a),k=kr(u,a);f.removeAt(m),f.add(4,m),f.add(4,m),p.removeAt(c+1),p.removeAt(c+1),p.add(u,c+1),p.add(k,c+2),p.add(R,c+2),p.add(j,c+1),p.add(T,c+1)}l.s("edge.points",lh(p)),l.s("edge.segments",f)}}}O.endTransaction()},removeShapePoint:function(e,X){var x=this,V="removeAt",A=x.gv,r=A.dm();if(r.beginTransaction(),0===arguments.length&&(e=x._shape||x._edge,X=x._removePointIndex),X>=0&&(e instanceof i||e instanceof Z)){var M=Dc(e,x.gv.getDataUI(e),X),R=X;if(e instanceof i){var C=e.p(),S=e.toSegments();S&&S.size()||(S=Ll(e.getPoints()));var $=S.get(M),g="removePointAt";if(1===$&&0===R)if(e.getPoints().size()>1){var D=S.get(M+1);S[V](M+1),3===D?e[g](R+1):4===D&&(e[g](R+2),e[g](R+1)),e[g](R)}else e.dm().remove(e);else 2===$||1===$?(S[V](M),e[g](R)):3===$?(S[V](M),e[g](R),e[g](R-1)):4===$&&(S[V](M),e[g](R),e[g](R-1),e[g](R-2));e.setSegments(S);var P=e.getWidth(),t=e.getHeight(),I=e.p().x-P/2,N=e.p().y-t/2;I-=C.x,N-=C.y;var H=gh(e,{x:I,y:N,width:P,height:t},e.getRotation(),C);e.p(H.x,H.y)}else if(e instanceof Z){if("points"!==e.s("edge.type"))return r.endTransaction(),void 0;var j=e.s("edge.points");if(S=e.s("edge.segments"),j&&(j=ee(x.gv.getDataUI(e),j),S&&S.size()||(S=Ll(j))),0===X||X===j.size()-1)return r.endTransaction(),void 0;S=new B(S._as.slice(0)),j=new B(j._as.slice(0));var $=S.get(M);2===$||1===$?(S[V](M),j[V](R)):3===$?(S[V](M),j[V](R),j[V](R-1)):4===$&&(S[V](M),j[V](R),j[V](R-1),j[V](R-2)),e.s("edge.segments",S),e.s("edge.points",lh(j))}}r.endTransaction()},changeShapeSegment:function(U,h,l){var d=this,V=d.gv,y=V.dm();if(y.beginTransaction(),1!==arguments.length||isNaN(U)||(l=U,U=d._shape||d._edge,h=d._hoverSegmentIndex),U instanceof i||U instanceof Z){var x=oj(U,d.gv.getDataUI(U),h);if(!isNaN(h)&&!isNaN(x))if(U instanceof i){var u=U.p(),r=U.toSegments();r&&r.size()||(r=Ll(U.getPoints()));var R=r.get(h),n=U.toPoints();if(1===l||2===l)1===R||2===R?r.set(h,l):3===R?(r.set(h,l),n.removeAt(x+1)):4===R&&(r.set(h,l),n.removeAt(x+1),n.removeAt(x+1));else if(3===l){var C=function(){var o=n.get(x),I=n.get(x+1),u=Hl(o,I);r.set(h,3),n.add(u,x+1)};2===R||1===R?C():4===R&&(n.removeAt(x+1),n.removeAt(x+1),C())}else if(4===l){var f=function(){var e=n.get(x),O=n.get(x+1),C=yd(e,O),u=kr(e,O);r.set(h,4),n.add(C,x+1),n.add(u,x+2)};2===R||1===R?f():3===R&&(n.removeAt(x+1),f())}U.setSegments(r),U.setPoints(n);var E=U.getWidth(),e=U.getHeight(),M=U.p().x-E/2,g=U.p().y-e/2;M-=u.x,g-=u.y;var H=new gh(U,{x:M,y:g,width:E,height:e},U.getRotation(),u);U.p(H.x,H.y)}else if(U instanceof Z){if("points"!==U.s("edge.type"))return y.endTransaction(),void 0;var n=U.s("edge.points");r=U.s("edge.segments"),n&&(n=ee(d.gv.getDataUI(U),n),r&&r.size()||(r=Ll(n))),r=new B(r._as.slice(0)),n=new B(n._as.slice(0));var R=r.get(h);if(1===l||2===l)1===R||2===R?r.set(h,l):3===R?(r.set(h,l),n.removeAt(x+1)):4===R&&(r.set(h,l),n.removeAt(x+1),n.removeAt(x+1));else if(3===l){var C=function(){var y=n.get(x),C=n.get(x+1),q=Hl(y,C);r.set(h,3),n.add(q,x+1)};2===R||1===R?C():4===R&&(n.removeAt(x+1),n.removeAt(x+1),C())}else if(4===l){var f=function(){var u=n.get(x),H=n.get(x+1),P=yd(u,H),L=kr(u,H);r.set(h,4),n.add(P,x+1),n.add(L,x+2)};2===R||1===R?f():3===R&&(n.removeAt(x+1),f())}U.s("edge.points",lh(n)),U.s("edge.segments",r)}}y.endTransaction()},getDefaultSegments:function(A){var e=this.gv,a=e.getDataUI(A);if(A instanceof Z){var O=A.s("edge.points");return O=ee(a,O),Ll(O)}if(A instanceof i){var O=A.getPoints(),h=A.getSegments();return h&&h.size()>0?h:Ll(O)}},$43l:function(M){var s=this;M&&(s.$5l=1),s._68I=1,s._42()},_42:function(){var X=this;if(X._68I){delete X._68I;var x=X.gv,T=X.$5l,v=x.getZoom(),j=x.getEditPointSize(),H=j/2,p=new B,J=X._view,D=X._edge,G=X._shape,o=J.getContext("2d"),z=x.tx(),b=x.ty(),O=I,f=x.getEditPointBackground(),n=x.getControlPointBackground(),h=x.getControlPointBorderColor(),C=x.getEditPointBorderColor(),R=x.getEditRectBorderColor(),k=x.getDirectionLineColor(),F=x.getSegmentHoverColor(),E=x.getSnapPointBorderColor(),Q=x.getJoinPointBackground(),e=x.getJoinPointBorderColor(),r=x.getSegmentHoverWidth(),a=[5,5],P=x.getEditRectBorderStyle();bd(x,function(w){x.isSelected(w)&&x.isVisible(w)&&p.add(w)}),o.clearRect(0,0,q(J.width),q(J.height)),o.save(),L.translateAndScale(o,z,b,1);var y=I,S={x:0,y:0,width:0,height:0},l=0,$=0,Y=0,N=0,W=0,A=0,pp=0,_m=0,xk=0,Yb=0,nf=[];if(T?(delete X.$6l,delete X.$8l,delete X.$7l,delete X.$16l,delete X.$23l):(y=X.$6l,O=X.$7l),delete X.$68l,delete X.$69l,delete X.$71l,delete X.$70l,delete X.$82l,delete X.$83l,delete X._pointElevationHelperPoint,delete X.$90l,delete X.$91l,delete X.$75l,delete X.$74l,p.each(function(e){var G=x.getDataUI(e);if(G){var D=G._55O;if(x.isEditable(e))D._56O&&e instanceof U&&$++,nf.push(e),D._42O&&e instanceof U&&l++,x.isHelperEditable(e,"host")&&N++,x.isHelperEditable(e,"parent")&&Y++,x.isHelperEditable(e,"remove")&&W++,x.isHelperEditable(e,"edge")&&A++,x.isHelperEditable(e,"source")&&pp++,x.isHelperEditable(e,"target")&&_m++,x.isHelperEditable(e,"elevation")&&xk++,x.isHelperEditable(e,"tall")&&Yb++;else if(e instanceof M&&e.isExpanded()){var i=!0,z=x.getEditableFunc();z&&(i=z(e)),i&&(x.isHelperEditable(e,"host")&&N++,x.isHelperEditable(e,"parent")&&Y++,x.isHelperEditable(e,"remove")&&W++,x.isHelperEditable(e,"edge")&&A++,x.isHelperEditable(e,"source")&&pp++,x.isHelperEditable(e,"target")&&_m++,x.isHelperEditable(e,"elevation")&&xk++,x.isHelperEditable(e,"tall")&&Yb++,nf.push(e))}}}),o.beginPath(),o.lineWidth=1,o.strokeStyle=x.getNodeBorderColor(),nf.forEach(function(b){var B=x.getDataUI(b),K=B._55O;if(T)if(O==I&&(O=b instanceof Z?0:b instanceof M&&b.isExpanded()?0:b.getRotation(),X.$7l=O),y==I){var h,r,q;if(b instanceof M&&b.isExpanded()||b instanceof Z){var J=x.getDataUIBounds(b);r=J.width,q=J.height,h={x:J.x+r/2,y:J.y+q/2}}else h=b.p(),r=b.getWidth(),q=b.getHeight();y={x:h.x,y:h.y,width:0,height:0},S.x=h.x-r/2,S.y=h.y-q/2,S.width=r,S.height=q,y=m(y,S)}else{var h,r,q,w,j=y.x+y.width/2,u=y.y+y.height/2,f={x:j,y:u};if(b instanceof M&&b.isExpanded()||b instanceof Z){w=0;var J=x.getDataUIBounds(b);r=J.width,q=J.height,h={x:J.x+r/2,y:J.y+q/2}}else h=b.p(),r=b.getWidth(),q=b.getHeight(),w=b.getRotation();var L={x:h.x-r/2,y:h.y-q/2,width:r,height:q},t={x:L.x,y:L.y},W={x:L.x+L.width,y:L.y},$={x:L.x,y:L.y+L.height},c={x:L.x+L.width,y:L.y+L.height},t=qe(h,t.x-h.x,t.y-h.y,w),$=qe(h,$.x-h.x,$.y-h.y,w),c=qe(h,c.x-h.x,c.y-h.y,w),W=qe(h,W.x-h.x,W.y-h.y,w),E=-O,C=qe(f,t.x-f.x,t.y-f.y,E),k=qe(f,W.x-f.x,W.y-f.y,E),F=qe(f,$.x-f.x,$.y-f.y,E),p=qe(f,c.x-f.x,c.y-f.y,E),H=d([C,k,F,p]);y=m(y,H),y.x-=j,y.y-=u;var _=gh(I,y,O,f);y.x=_.x-y.width/2,y.y=_.y-y.height/2}if(l>1&&x.isEditable(b)&&x.isRectEditable(b)&&b instanceof U){var z=b.getRect(),R=K.$45l,s=pe(R[0],v),D=pe(R[2],v),e=pe(R[4],v),n=pe(R[6],v);b.getRotation()?(o.moveTo(s.x,s.y),o.lineTo(D.x,D.y),o.lineTo(e.x,e.y),o.lineTo(n.x,n.y),o.lineTo(s.x,s.y)):o.rect(z.x*v,z.y*v,z.width*v,z.height*v)}}),o.stroke(),y){X.$6l=t(y),c(y,x.getEditRectPadding()/v);var Oh={x:y.x+y.width/2,y:y.y+y.height/2},Ip=Lm(Oh,y.width,y.height,O),Cq=Ip[0],gs=Ip[1],Il=Ip[2],Bd=Ip[3],ji=Ip[4],Qc=Ip[5],fb=Ip[6],Cf=Ip[7];if(Cq=pe(Ip[0],v),gs=pe(Ip[1],v),Il=pe(Ip[2],v),Bd=pe(Ip[3],v),ji=pe(Ip[4],v),Qc=pe(Ip[5],v),fb=pe(Ip[6],v),Cf=pe(Ip[7],v),X.$8l=y,l>0&&(X.$16l=[Cq,ji,gs,Qc,Bd,fb,Il,Cf],o.beginPath(),o.lineWidth=1,o.strokeStyle=R,"dashed"===P&&o.setLineDash&&o.setLineDash(a),o.moveTo(Cq.x,Cq.y),o.lineTo(gs.x,gs.y),o.lineTo(Bd.x,Bd.y),o.lineTo(Il.x,Il.y),o.lineTo(Cq.x,Cq.y),o.stroke(),"dashed"===P&&o.setLineDash&&o.setLineDash([])),o.beginPath(),o.lineWidth=1,o.fillStyle=f,o.strokeStyle=C,l>0){var ld=Qc.x-Cf.x,pn=Qc.y-Cf.y,bg=g(ld*ld+pn*pn),Nc=ji.x-fb.x,An=ji.y-fb.y,kg=g(Nc*Nc+An*An),ik=2*j;if(x.isDirectionEditable&&1===nf.length){var Cn=nf[0],Pe=x.getDataUI(Cn),Kl=Pe._55O,zr=x.isDirectionEditable.bind(x);if(Kl._42O){var sn,rg,ki,Af;zr(Cn,"northwest")&&(sn=!0,o.rect(Cq.x-H,Cq.y-H,j,j)),zr(Cn,"northeast")&&(rg=!0,o.rect(gs.x-H,gs.y-H,j,j)),zr(Cn,"southwest")&&(ki=!0,o.rect(Il.x-H,Il.y-H,j,j)),zr(Cn,"southeast")&&(Af=!0,o.rect(Bd.x-H,Bd.y-H,j,j)),zr(Cn,"north")&&(sn&&rg?bg>ik&&o.rect(ji.x-H,ji.y-H,j,j):o.rect(ji.x-H,ji.y-H,j,j)),zr(Cn,"south")&&(Af&&ki?bg>ik&&o.rect(fb.x-H,fb.y-H,j,j):o.rect(fb.x-H,fb.y-H,j,j)),zr(Cn,"west")&&(ki&&sn?kg>ik&&o.rect(Cf.x-H,Cf.y-H,j,j):o.rect(Cf.x-H,Cf.y-H,j,j)),zr(Cn,"east")&&(Af&&rg?kg>ik&&o.rect(Qc.x-H,Qc.y-H,j,j):o.rect(Qc.x-H,Qc.y-H,j,j))}}else bg>ik&&(o.rect(ji.x-H,ji.y-H,j,j),o.rect(fb.x-H,fb.y-H,j,j)),kg>ik&&(o.rect(Qc.x-H,Qc.y-H,j,j),o.rect(Cf.x-H,Cf.y-H,j,j)),o.rect(Cq.x-H,Cq.y-H,j,j),o.rect(gs.x-H,gs.y-H,j,j),o.rect(Il.x-H,Il.y-H,j,j),o.rect(Bd.x-H,Bd.y-H,j,j)}if($>0){var dp=X.$23l=qe(ji,0,2*-j,O);o.moveTo(dp.x+H,dp.y),o.arc(dp.x,dp.y,H,0,s,!1)}o.fill(),o.stroke(),X.$40l&&X.$44l(o,y,O);var ne,uh,yn=x.getLeftTopHelpers(),Sd=x.getRightTopHelpers(),ys=x.getLeftBottomHelpers(),$g=x.getRightBottomHelpers(),Dm=x.getEdgeHelpers(),Zo=x.getEditHelperSize(),ep=Zo/2,vh=function(p,k,Q,d){"leftTop"===k?(ne=y.x*v-Zo-H-("h"===d?Q*(Zo+H):0)-1,uh=y.y*v-Zo-H-("v"===d?Q*(Zo+H):0)-1):"rightTop"===k?(ne=(y.x+y.width)*v+H+("h"===d?Q*(Zo+H):0)+1,uh=y.y*v-Zo-H-("v"===d?Q*(Zo+H):0)-1):"leftBottom"===k?(ne=y.x*v-Zo-H-("h"===d?Q*(Zo+H):0)-1,uh=(y.y+y.height)*v+H+("v"===d?Q*(Zo+H):0)+1):"rightBottom"===k&&(ne=(y.x+y.width)*v+H+("h"===d?Q*(Zo+H):0)+1,uh=(y.y+y.height)*v+H+("v"===d?Q*(Zo+H):0)+1);var $=ne+ep,n=uh+ep,K=(y.x+y.width/2)*v,J=(y.y+y.height/2)*v,r=qe({x:K,y:J},$-K,n-J,O);if("host"===p){if(N>0)return X.$77l(o,O,r),!0}else if("edge"===p){if(A>0)return X.$80l(o,O,r),!0}else if("remove"===p){if(W>0)return nf&&1===nf.length&&nf[0]instanceof Z?X.$81l(o,O,{x:K+Zo/2+5,y:J}):X.$81l(o,O,r),!0}else if("parent"===p){if(Y>0)return nf&&1===nf.length&&nf[0]instanceof Z?X.$76l(o,O,{x:K-Zo/2-5,y:J}):X.$76l(o,O,r),!0}else if("elevation"===p){if(xk>0)return X.$85l(o,O,r),!0}else if("tall"===p){if(Yb>0)return X.$86l(o,O,r),!0}else if("source"===p||"target"===p){var s=nf[0],B=x.getDataUI(s),C=Wf(B,!0),t=C[0],q=C[1];if(pp&&"source"===p)return X.$84l(o,y,t,!0,s.isLooped(),k,Q,d),!0;if(_m&&"target"===p)return X.$84l(o,y,q,!1,s.isLooped(),k,Q,d),!0}};if(yn&&yn.length>0){var om=0;yn.forEach(function(k){vh(k,"leftTop",om,x.getLeftTopHelpersAlign()||"h")&&om++})}if(Sd&&Sd.length>0){var om=0;Sd.forEach(function(d){vh(d,"rightTop",om,x.getRightTopHelpersAlign()||"h")&&om++})}if(ys&&ys.length>0){var om=0;ys.forEach(function(B){vh(B,"leftBottom",om,x.getLeftBottomHelpersAlign()||"h")&&om++})}if($g&&$g.length>0){var om=0;$g.forEach(function(X){vh(X,"rightBottom",om,x.getRightBottomHelpersAlign()||"h")&&om++})}if(Dm&&Dm.length>0&&((pp||_m)&&nf&&1===nf.length&&nf[0]instanceof Z?!0:!1)){var om=0;Dm.forEach(function(y){vh(y,"edge",om,"h")&&om++})}if(X.$72l){var Pn,ss=X.$67l,Mr=X.$68l,Dg=X.$69l,Lb=(X.$71l,X.$70l),dc=X.$82l,jf=X.$83l;if(1===ss?Pn=Mr:2===ss?Pn=Dg:3===ss?Pn=Lb:5===ss?Pn=dc:6===ss&&(Pn=jf),Pn){var ai=x.lp(X.$72l),Gm=x.getDataAt(X.$72l);if(Gm&&Gm instanceof U){var Bm,nr,Ae;if(X.$73l=Gm,1===ss)if(Gm instanceof w.Grid)Bm=X.$75l=ph(Gm,ai);else if(Gm instanceof w.Shape){Ae=X.$74l=$i(Gm,ai);var vj=Gm.getPoints();if(Ae){var Tj=Ae.attachIndex,an=oj(Gm,x.getDataUI(Gm),Tj)+1,Te=an+1>=vj.size()?0:an+1,Ph=vj.get(an),lq=vj.get(Te),Nl=Gm.p(),fm=Gm.getRotation();Ph=qe(Nl,Ph.x-Nl.x,Ph.y-Nl.y,fm),lq=qe(Nl,lq.x-Nl.x,lq.y-Nl.y,fm),o.beginPath(),o.strokeStyle=F,o.lineWidth=r,o.moveTo(Ph.x*v,Ph.y*v),o.lineTo(lq.x*v,lq.y*v),o.stroke()}}Bm?nr=Bm.rect:(nr=u.clone(x.getDataUIBounds(Gm)),u.grow(nr,2)),o.beginPath(),o.rect(nr.x*v,nr.y*v,nr.width*v,nr.height*v),o.strokeStyle=1===ss||4===ss||6===ss?V:K,o.lineWidth=2,o.setLineDash&&o.setLineDash([8,8]),o.stroke()}else delete X.$73l;ai.x=ai.x*v,ai.y=ai.y*v;var mr=fk(Pn.x,Pn.y,ai.x,ai.y),ei=qe(Pn,ai.x-Pn.x,ai.y-Pn.y,-mr),fj=ei.x-Pn.x;o.translate(Pn.x,Pn.y),o.rotate(mr),_.width=fj,_.height=40;var qi=K;(1===ss||4===ss||6===ss)&&(qi=V),_.comps[0].gradientColor=qi,u.drawImage(o,_,0,-20,fj,40)}}}if(p.each(function(b){var O=x.getDataUI(b);if(O){var K,y,Z=O._55O,f=O._78o;if(Z&&Z._43O&&b instanceof i?(K=Z.$15l,y=b.getSegments(),y&&y.size()||(y=Ll(K)),b.isClosePath()&&y.indexOf(5)<0&&(y=new B(y._as),y.add(5))):Z&&f&&Z._43O&&(K=b.s("edge.points"),y=b.s("edge.segments"),K=ee(O,K),y&&y.size()||(y=Ll(K)),K&&(K=K._as)),K&&y){var m=0,L=y.size(),T=X._hoverSegmentIndex;K=K.slice(0);for(var R=0;R<K.length;R++)K[R]=pe(K[R],v);o.beginPath(),o.strokeStyle=k,o.lineWidth=1,m=0;for(var R=0;L>R;R++){var t=y.get(R);if(1===t||2===t)m++;else if(3===t){var l=K[m-1],z=K[m],w=K[m+1];o.moveTo(l.x,l.y),o.lineTo(z.x,z.y),o.lineTo(w.x,w.y),m+=2}else if(4===t){var l=K[m-1],N=K[m],U=K[m+1],w=K[m+2];o.moveTo(l.x,l.y),o.lineTo(N.x,N.y),o.moveTo(U.x,U.y),o.lineTo(w.x,w.y),m+=3}}if(o.stroke(),G===b||D===b&&"points"===D.s("edge.type")){o.beginPath(),m=0,o.strokeStyle=F,o.lineWidth=r;for(var R=0;L>R;R++){var t=y.get(R);if(1===t||2===t){if(T===R){var l=K[m-1],w=K[m];o.moveTo(l.x,l.y),o.lineTo(w.x,w.y);break}m++}else if(3===t){if(T===R){var l=K[m-1],z=K[m],w=K[m+1];o.moveTo(l.x,l.y),o.quadraticCurveTo(z.x,z.y,w.x,w.y);break}m+=2}else if(4===t){if(T===R){var l=K[m-1],N=K[m],U=K[m+1],w=K[m+2];o.moveTo(l.x,l.y),o.bezierCurveTo(N.x,N.y,U.x,U.y,w.x,w.y);break}m+=3}else if(5===t&&T===R){var l=K[m-1],w=K[0];o.moveTo(l.x,l.y),o.lineTo(w.x,w.y);break}}o.stroke()}o.beginPath(),m=0,o.strokeStyle=e,o.lineWidth=1,o.fillStyle=Q;for(var R=0;L>R;R++){var t=y.get(R);if(1===t||2===t){var w=K[m];o.moveTo(w.x+H,w.y),o.arc(w.x,w.y,H,0,s,!0),m++}else if(3===t){var w=K[m+1];o.moveTo(w.x+H,w.y),o.arc(w.x,w.y,H,0,s,!0),m+=2}else if(4===t){var w=K[m+2];o.moveTo(w.x+H,w.y),o.arc(w.x,w.y,H,0,s,!0),m+=3}}o.fill(),o.stroke(),o.beginPath(),m=0,o.strokeStyle=h,o.lineWidth=1,o.fillStyle=n;for(var R=0;L>R;R++){var t=y.get(R);if(1===t||2===t)m++;else if(3===t){var z=K[m];o.moveTo(z.x+H,z.y),o.arc(z.x,z.y,H,0,s,!0),m+=2}else if(4===t){var N=K[m],U=K[m+1];o.moveTo(N.x+H,N.y),o.arc(N.x,N.y,H,0,s,!0),o.moveTo(U.x+H,U.y),o.arc(U.x,U.y,H,0,s,!0),m+=3}}if(o.fill(),o.stroke(),o.beginPath(),m=0,o.strokeStyle=E,o.lineWidth=2,(G===b||D===b)&&X.$9l!=I){var w=K[X.$9l];o.moveTo(w.x+H,w.y),o.arc(w.x,w.y,H,0,s,!0),o.stroke()}}}}),X.$87l&&x.sm().contains(X.$87l)){var km,Pp=X.$87l,qn=X.$88l,Zo=x.getEditHelperSize(),ep=Zo/2;if(x.isHelperEditable(Pp,"pointElevation"))if(Pp instanceof i){var $d=Pp.getPosition();km=u.clone(Pp.getPoints().get(qn)),km=qe({x:$d.x,y:$d.y},km.x-$d.x,km.y-$d.y,Pp.getRotation()),km.x*=v,km.y*=v,o.translate(km.x,km.y),u.drawImage(o,u.getImage("xeditinteractor_elevationIcon"),ep,-ep,Zo,Zo),o.translate(-km.x,-km.y),X._pointElevationHelperPoint={x:km.x+Zo,y:km.y}}else if(Pp instanceof Z){var Nd=ee(x.getDataUI(Pp),Pp.s("edge.points")),km=u.clone(Nd.get(qn));km.x*=v,km.y*=v,o.translate(km.x,km.y),u.drawImage(o,u.getImage("xeditinteractor_elevationIcon"),ep,-ep,Zo,Zo),o.translate(-km.x,-km.y),X._pointElevationHelperPoint={x:km.x+Zo,y:km.y}}}o.restore(),X.$5l=0}},$89l:function(E,C,g,L){E.save();var K=this,Z=K.gv,e=Z.getEditHelperSize(),r=e/2;E.beginPath(),E.translate(g.x,g.y),E.rotate(C),u.drawImage(E,L,-r,-r,e,e),E.restore()},$85l:function($,v,n){var l=this;l.$90l=n,l.$89l($,v,n,u.getImage("xeditinteractor_elevationIcon"))},$86l:function(d,W,y){var P=this;P.$91l=y,P.$89l(d,W,y,u.getImage("xeditinteractor_tallIcon"))},$77l:function(R,q,g){var Z=this;Z.$68l=g,Z.$89l(R,q,g,u.getImage("xeditinteractor_hostIcon"))},$80l:function(S,M,Z){var Y=this;Y.$70l=Z,Y.$89l(S,M,Z,u.getImage("xeditinteractor_edgeIcon"))},$81l:function(J,r,U){var A=this;A.$71l=U,A.$89l(J,r,U,u.getImage("xeditinteractor_removeIcon"))},$76l:function(M,Q,X){var g=this;g.$69l=X,g.$89l(M,Q,X,u.getImage("xeditinteractor_parentIcon"))},$84l:function(W,G,D,F,B){var a,$=this,w=$.gv,L=w.getZoom(),n=w.getEditHelperSize(),k=n/2;D.x*=L,D.y*=L,B&&(F?D.x-=k+5:D.x+=k+5),D.y-=n-2,F?($.$82l=D,a=u.getImage("xeditinteractor_sourceIcon")):($.$83l=D,a=u.getImage("xeditinteractor_targetIcon")),W.beginPath(),W.translate(D.x,D.y),u.drawImage(W,a,-k,-k,n,n),W.translate(-D.x,-D.y)},$44l:function(q,z,Z){q.save();var I=this.gv.getZoom(),v=g($(z.width,2)+$(z.height,2))/2*I+10,G=v,O=G+8,R=G+18,y=Z,M=z.x+z.width/2,e=z.y+z.height/2;q.translate(M*I,e*I),q.beginPath(),q.strokeStyle="rgb(150, 150, 150)";for(var x=0,i=0,p=0,h=0,_=0,t=0;360>t;t++)x=t*H/180,0===t%5&&(i=k(x)*G,p=E(x)*G,h=k(x)*O,_=E(x)*O,q.moveTo(i,p),q.lineTo(h,_)),0===t%45&&(i=k(x)*G,p=E(x)*G,h=k(x)*R,_=E(x)*R,q.moveTo(i,p),q.lineTo(h,_));q.stroke(),q.beginPath(),q.rotate(-C),q.beginPath(),q.fillStyle="rgba(255, 0, 0, 0.1)",q.strokeStyle="rgb(157, 157, 157)",q.moveTo(0,0),q.arc(0,0,R,0,Z,!1),q.fill(),q.beginPath(),q.moveTo(0+R,0),q.arc(0,0,R,0,Z,!1),q.stroke(),q.rotate(C),q.font="bold 12px Verdana, Arial";var r=20*E(y),b=20*k(y),Q=f(180*y/H)+"°";q.textAlign="center",q.textBaseline="middle",q.beginPath();var n=q.measureText("365.°").width;q.fillStyle="white",q.rect(r-n/2,-b-10,n,20),q.fill(),q.beginPath(),q.fillStyle="rgb(79,79,79)",q.fillText(Q,r,-b),q.restore()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);